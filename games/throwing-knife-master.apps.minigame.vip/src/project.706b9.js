window.__require=function t(e,i,o){function n(a,c){if(!i[a]){if(!e[a]){var r=a.split("/");if(r=r[r.length-1],!e[r]){var l="function"==typeof __require&&__require;if(!c&&l)return l(r,!0);if(s)return s(r,!0);throw new Error("Cannot find module '"+a+"'")}}var h=i[a]={exports:{}};e[a][0].call(h.exports,function(t){return n(e[a][1][t]||t)},h,h.exports,t,e,i,o)}return i[a].exports}for(var s="function"==typeof __require&&__require,a=0;a<o.length;a++)n(o[a]);return n}({ADShareManager:[function(t,e,i){"use strict";cc._RF.push(e,"28468P/9VFBwJmXXgpb82DS","ADShareManager");var o=e.exports,n=t("Tools"),s=t("CommonEnum"),a=t("CommonValue"),c=t("CommonSdk"),r=t("CommonConfig"),l=t("CommonFunc"),h=t("GameData"),d=function(){function t(){this.adShareDict={},this.shareDict={},this._adCountDict={},this._shareCountDict={},this._shareTotalCount=0,this._adCountTime=0,this._shareCountTime=0,this.name_adCount="ad_count",this.name_shareCount="share_count",this.name_adCountTime="ad_count_time",this.name_shareCountTime="share_count_time",this.name_shareTotalCount="share_total_count",this.shareMaxCount=0,this.shareTime=0,this.shareProbDict={},this._shareProbCountDict={},this.shareId=0,this.shareCallback=null,this.shareFailCall=null,this.ShareShowTime=0}return t.prototype.addAdShareData=function(t){this.adShareDict[t.id]=t},t.prototype.getAdShareData=function(t){return this.adShareDict[t]},t.prototype.addShareData=function(t){this.shareDict[t.id]=t},t.prototype.initAdShare=function(){this.initParam(),this.initAdShareCount()},t.prototype.initParam=function(){this.shareTime=Number(r.GConfig.getGbData(s.Enum_Gb.shareTime)),this.shareMaxCount=Number(r.GConfig.getGbData(s.Enum_Gb.shareCount));for(var t=r.GConfig.getGbData(s.Enum_Gb.shareProb).split("#"),e=0;e<t.length;e++){var i=n.DYTools.stringToPoint(t[e],"*");this.shareProbDict[i.x]=i.y}},t.prototype.clearData=function(){this._shareCountDict={},this._shareCountTime=l.GFunc.getCurTime(),this._shareTotalCount=0,this.save_share_count(),this._adCountDict={},this._adCountTime=l.GFunc.getCurTime(),this.save_ad_count()},t.prototype.getData=function(t){return cc.sys.localStorage.getItem(t)},t.prototype.saveData=function(t,e){"number"==typeof e&&(e=e.toString());try{cc.sys.localStorage.setItem(t,e)}catch(i){c.GSDK.saveData(t,e),n.DYTools.error("\u4fdd\u5b58\u6570\u636e\u51fa\u9519\u4e86--"+i,t,e),c.GSDK.sendSaveDataErr(t)}},t.prototype.initAdShareCount=function(){var t=this.getData(this.name_shareCountTime);if(t&&""!=t&&(this._shareCountTime=Number(t)),(t=this.getData(this.name_adCountTime))&&""!=t&&(this._adCountTime=Number(t)),(t=this.getData(this.name_adCount))&&""!=t&&(this._adCountDict=JSON.parse(t)),(t=this.getData(this.name_shareCount))&&""!=t&&(this._shareCountDict=JSON.parse(t)),(t=this.getData(this.name_shareTotalCount))&&""!=t&&(this._shareTotalCount=Number(t)),n.DYTools.isLaterDay(1e3*this._adCountTime)){for(var e in this._adCountDict)this._adCountDict[e]=0;this._adCountTime=l.GFunc.getCurTime(),this.save_ad_count()}if(n.DYTools.isLaterDay(1e3*this._shareCountTime)){for(var e in this._shareCountDict)this._shareCountDict[e]=0;this._shareCountTime=l.GFunc.getCurTime(),this._shareTotalCount=0,this.save_share_count()}n.DYTools.warn("&&&"+JSON.stringify(this._adCountDict)+",## "+JSON.stringify(this._shareCountDict)+",** "+this._shareTotalCount)},t.prototype.save_ad_count=function(){this.saveData(this.name_adCount,JSON.stringify(this._adCountDict)),this.saveData(this.name_adCountTime,this._adCountTime)},t.prototype.save_share_count=function(){this.saveData(this.name_shareCount,JSON.stringify(this._shareCountDict)),this.saveData(this.name_shareCountTime,this._shareCountTime),this.saveData(this.name_shareTotalCount,this._shareTotalCount)},t.prototype.setAdCount=function(t){this.getData(this.name_adCountTime)||""==t||(this.adCountDict=JSON.parse(t))},t.prototype.setAdTime=function(t){this.getData(this.name_adCountTime)||""==t||(this.adCountTime=Number(t))},t.prototype.setShareCount=function(t){this.getData(this.name_shareCountTime)||""==t||(this.shareCountDict=JSON.parse(t))},t.prototype.setShareTime=function(t){this.getData(this.name_shareCountTime)||""==t||(this.shareCountTime=Number(t))},t.prototype.setShareTotalCount=function(t){this.getData(this.name_shareCountTime)||""==t||(this._shareTotalCount=parseInt(t))},t.prototype.shareCountChange=function(t,e){var i=this._shareCountDict[t];void 0!=i&&null!=i||(i=0),this._shareCountDict[t]=i+e,this._shareTotalCount+=e,this.save_share_count(),n.DYTools.warn("\u5206\u4eab\u6b21\u6570--"+t+" = "+this._shareCountDict[t])},t.prototype.getShareCount=function(t){var e=this._shareCountDict[t];return void 0!=e&&null!=e||(e=0,this._shareCountDict[t]=0),e},Object.defineProperty(t.prototype,"shareCountDict",{get:function(){return this._shareCountDict},set:function(t){this._shareCountDict=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shareCountTime",{get:function(){return this._shareCountTime},set:function(t){this._shareCountTime=t},enumerable:!0,configurable:!0}),t.prototype.getAdTotalCount=function(){var t=0;for(var e in this._adCountDict){var i=this._adCountDict[e];i&&(t+=i)}return t},t.prototype.adCountChange=function(t,e){var i=this._adCountDict[t];void 0!=i&&null!=i||(i=0),this._adCountDict[t]=i+e,this.save_ad_count(),n.DYTools.warn("\u5e7f\u544a\u6b21\u6570--"+t+" = "+this._adCountDict[t])},t.prototype.getAdCount=function(t){var e=this._adCountDict[t];return void 0!=e&&null!=e||(e=0,this._adCountDict[t]=0),e},Object.defineProperty(t.prototype,"adCountDict",{get:function(){return this._adCountDict},set:function(t){this._adCountDict=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"adCountTime",{get:function(){return this._adCountTime},set:function(t){this._adCountTime=t},enumerable:!0,configurable:!0}),t.prototype.adShare=function(t,e,i,o,n,s){void 0===o&&(o=null),void 0===n&&(n=null),void 0===s&&(s=null),window.loadSuc=e,window.loadFail=n,window.xmgame.showVideo(function(){e&&e()},function(){console.log("showVideossss"),n&&n()},function(){window.xmgame.showPanelLoad()})},t.prototype.preLoadAdver=function(t){},t.prototype.createAdver=function(t,e,i,o,n,s){},t.prototype.clearShareProbCount=function(t){this._shareProbCountDict[t]=0},t.prototype.shareGame=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=null),t!=s.Enum_ADShare.AS_Menu)if(r.GConfig.isDevelop)this.shareCountChange(t,1),l.GFunc.showFloatTips("\u5206\u4eab\u6210\u529f!"),e&&e();else{var o=this.getShareData(t);if(o){o.imageUrl;switch(r.GConfig.channel){case s.Enum_Channel.WeiXin:"shareID="+t+"&imageId="+o.id+"&otherId="+h.TData.getUserID()}this.ShareShowTime=n.DYTools.getCurTimestamp(),this.shareId=t,this.shareCallback=e,this.shareFailCall=i}else n.DYTools.error("\u5206\u4eab\u6570\u636e\u627e\u4e0d\u5230:"+t)}else e&&e()},t.prototype.getShareData=function(t){var e=null,i=this.getAdShareData(t);if(i){var o=i.shareId,s=n.DYTools.random_int(0,o.length-1);e=this.shareDict[o[s]]}if(!e){n.DYTools.error("\u6ca1\u6709\u5bf9\u5e94\u7684\u5206\u4eab\u6570\u636e:"+t);var a=0;for(var c in this.shareDict)a++;var r=n.DYTools.random_int(0,a-1);e=this.shareDict[r]}return e},t.prototype.onShareIn=function(){},t.prototype.shareBackGame=function(){var t=!1;if(this.shareId!=s.Enum_ADShare.AS_Menu){var e=this,i=n.DYTools.getCurTimestamp();if(Math.floor((i-this.ShareShowTime)/1e3)<Number(this.shareTime))c.GSDK.show_model("\u63d0\u793a","\u5206\u4eab\u5931\u8d25\uff0c\u8bf7\u5206\u4eab\u5230\u4e0d\u540c\u7fa4",function(){e.shareGame(e.shareId,e.shareCallback,e.shareFailCall)},function(){e.shareFailCall&&e.shareFailCall()},"\u6211\u77e5\u9053\u4e86");else{var o=this._shareProbCountDict[this.shareId];o||(o=0,this._shareProbCountDict[this.shareId]=0),this._shareProbCountDict[this.shareId]+=1,o=this._shareProbCountDict[this.shareId];var a=!0,r=this.shareProbDict[o];r||(r=100),n.DYTools.random_int(0,99)>=r&&(a=!1),a?t=!0:c.GSDK.show_model("\u63d0\u793a","\u5206\u4eab\u5931\u8d25\uff0c\u8bf7\u5206\u4eab\u5230\u4e0d\u540c\u7fa4",function(){e.shareGame(e.shareId,e.shareCallback,e.shareFailCall)},function(){e.shareFailCall&&e.shareFailCall()},"\u6211\u77e5\u9053\u4e86")}t&&(this._shareProbCountDict[this.shareId]=0,this.shareCallback&&(this.shareCallback(),this.shareCountChange(this.shareId,1)),this.shareCallback=null,this.shareId=-1,this.shareFailCall=null)}},t.prototype.getAdShare=function(t){var e=0,i=this.getAdShareData(t),o=this.getAdCount(t),n=this.getShareCount(t),s=this._shareTotalCount<this.shareMaxCount;if(i)switch(i.type){case 1:if(o+n<i.value.length)for(var a=0,c=0,r=0;r<i.value.length;r++)if(1==i.value[r]){if(++a>o){e=1;break}}else if(s&&++c>n){e=2;break}}return e},t.prototype.getActualAdShare=function(t){return a.GValue.AdShareSwitch?this.getAdShare(t):0},t.prototype.checkShareAble=function(t){if(this._shareTotalCount>=this.shareMaxCount)return!1;var e=!1,i=this.getAdShareData(t),o=this.getShareCount(t);if(i)switch(i.type){case 1:for(var n=0,s=0;s<i.value.length;s++)2==i.value[s]&&n++;e=n>o}return e},t.instance=new t,t}();o.ADShareManager=d,o.ADShareMgr=d.instance,cc._RF.pop()},{CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonSdk:"CommonSdk",CommonValue:"CommonValue",GameData:"GameData",Tools:"Tools"}],AndroidManager:[function(t,e,i){"use strict";cc._RF.push(e,"f0237SkKexEF49lP5PU2Da7","AndroidManager");var o=e.exports,n=t("CommonEnum"),s=t("CommonFunc"),a=function(){function t(){this.isAfStatus=-1,this.callbackEnd=!1,this.rewardAdResultCall=null}return t.prototype.initAfStatus=function(t){var e=this;setTimeout(function(){e.isAfStatus=t,e.callbackEnd=!0},50)},t.prototype.setAfStatus=function(t){this.isAfStatus=t},t.prototype.getAfStatus=function(){return this.isAfStatus},t.prototype.virbrate=function(t){},t.prototype.trackEvent=function(t,e){},t.prototype.playRewardAd=function(t,e){},t.prototype.rewardAdOver=function(t){setTimeout(function(){console.log("aaaa-\u5173\u95ed"),o.AndroidMgr.rewardAdResultCall&&(o.AndroidMgr.rewardAdResultCall(t),o.AndroidMgr.rewardAdResultCall=null)},100)},t.prototype.playInterstitialAd=function(t){},t.prototype.isHaveAd=function(){},t.prototype.showLoading=function(t){setTimeout(function(){t?s.GFunc.showLoading():s.GFunc.hideLoading()},100)},t.prototype.hideAdLoading=function(){s.GFunc.showFloatTips("Video is not available, please try again later."),this.rewardAdOver(!1)},t.prototype.isCallbackEnd=function(){return this.callbackEnd},t.prototype.sendDate=function(t,e){},t.prototype.sendInfor=function(t,e,i){switch(void 0===i&&(i=""),t){case n.Enum_AfType.load:this.sendDate("BladeMaster_loading","{value:"+e+"}");break;case n.Enum_AfType.guide:this.sendDate("BladeMaster_guide","{value:"+e+"}");break;case n.Enum_AfType.stageWin:this.sendDate("BladeMaster_stage_win","{value:"+e+"}");break;case n.Enum_AfType.video_finish:this.sendDate("BladeMaster_video_finish","{value:"+e+"}");break;case n.Enum_AfType.mainLvup:this.sendDate("BladeMaster_main_weapon","{level:"+e+"}");break;case n.Enum_AfType.subLvup:this.sendDate("BladeMaster_sub_weapon","{id:"+e+",level:"+i+"}")}},t.instance=new t,t}();o.AndroidManager=a,window.AndroidMgr=a.instance,o.AndroidMgr=a.instance,cc._RF.pop()},{CommonEnum:"CommonEnum",CommonFunc:"CommonFunc"}],BossKnivesComponent:[function(t,e,i){"use strict";cc._RF.push(e,"4d9e5isKMxKCZZOO7pjfINQ","BossKnivesComponent");var o=t("Tools");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.enemyEntity=null,this.knives=[],this.lights=[],this.isDirty=!1,this.startGame=!1},init:function(t){this.enemyEntity=t,this.node.on("reduceKnife",this.reduceKnife,this),this.node.on("resetDirty",this.resetDirty,this)},update:function(t){for(var e=0;e<this.knives.length;e++){var i=this.knives[e];i&&i.emit("startChangeToAttack")}},resetDirty:function(){this.isDirty=!1},reduceKnife:function(t){o.DYTools.arrRemove(this.knives,t),this.isDirty=!0},emitAllKnivesCountChange:function(){for(var t=this.knives.length,e=0;e<t;e++)this.knives[e].emit("updateCount",[e,t]);return t},addKnife:function(t){o.DYTools.arrContains(this.knives,t)||(this.knives.push(t),t.emit("updateOwner",this),this.isDirty=!0)}}),cc._RF.pop()},{Tools:"Tools"}],BossKnivesCtrl:[function(t,e,i){"use strict";cc._RF.push(e,"553e5cG2EJLD4Stpk8G1EWG","BossKnivesCtrl"),cc.Class({extends:cc.Component,properties:{},ctor:function(){this.enemy=null,this.followEnemy=null},init:function(t,e){this.enemy=t,this.followEnemy=e},addKnife:function(t){this.followEnemy.knivesCmp.addKnife(t)},getKnives:function(){return this.followEnemy.knivesCmp.knives}}),cc._RF.pop()},{}],BossKnivesDropCtrl:[function(t,e,i){"use strict";cc._RF.push(e,"8dc70ZYH1RJXKl9/hlkFsQL","BossKnivesDropCtrl");var o=t("CommonConfig"),n=t("Tools"),s=t("Types"),a=t("CEntityKnife");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.bossEntity=null,this.initBlood=0,this.dropArr1=[],this.dropArr2=[]},init:function(t){this.bossEntity=t,this.initBlood=this.bossEntity.data.blood;for(var e=this.bossEntity.data.kData,i=e.dropParam1.split(o.GConfig.SeparatorI),s=0;s<i.length;s++)(a=n.DYTools.stringToNumber(i[s],o.GConfig.SeparatorII))[0]=a[0]/100,this.dropArr1.push(a);for(i=e.dropParam2.split(o.GConfig.SeparatorI),s=0;s<i.length;s++){for(var a,c=((a=n.DYTools.stringToNumber(i[s],o.GConfig.SeparatorII))[0]-a[1])/(a[2]+1),r=[],l=0;l<a[3];l++){for(var h=n.DYTools.random_int(1,a[2]);n.DYTools.arrContain(r,h);)h=n.DYTools.random_int(1,a[2]);r.push(h)}for(l=1;l<=a[2];l++){var d=a[0]-c*l;d+=n.DYTools.random_int(-2,2);var u=[];u.push(d/100),n.DYTools.arrContain(r,l)?u.push(1):u.push(0),this.dropArr2.push(u)}}},bloodChange:function(t){var e,i,o=t/this.initBlood;if(this.dropArr1.length>0&&o<=(e=this.dropArr1[0])[0]){for(var c=this.bossEntity.followCtrl.getKnives(),r=0;r<e[2];r++)(d=c[n.DYTools.random_int(0,c.length-1)]).emit("throwKnife",-s.EntityTag.Enemy),(i=d.getChildByName("tail"))&&(i.opacity=0);var l=e[1]-e[2];if(l>=c.length)for(r=c.length-1;r>=0;r--)(d=c[r]).getComponent(a).bossDiscarded=!0,d.emit("throwKnife",-s.EntityTag.Enemy),(i=d.getChildByName("tail"))&&(i.opacity=0);else{var h=[];for(r=0;r<l;r++){for(var d=c[n.DYTools.random_int(0,c.length-1)];n.DYTools.arrContain(h,d);)d=c[n.DYTools.random_int(0,c.length-1)];h.push(d),d.getComponent(a).bossDiscarded=!0,(i=d.getChildByName("tail"))&&(i.opacity=0)}for(var u=0,m=h;u<m.length;u++)d=m[u],c.indexOf(d)>=0&&(d.emit("throwKnife",-s.EntityTag.Enemy),(i=d.getChildByName("tail"))&&(i.opacity=0));h.splice(0)}this.dropArr1.splice(0,1)}this.dropArr2.length>0&&(o<(e=this.dropArr2[0])[0]&&((i=(d=(c=this.bossEntity.followCtrl.getKnives())[n.DYTools.random_int(0,c.length-1)]).getChildByName("tail"))&&(i.opacity=0),1==e[1]?d.emit("throwKnife",-s.EntityTag.Enemy):(d.getComponent(a).bossDiscarded=!0,d.emit("throwKnife",-s.EntityTag.Enemy)),this.dropArr2.splice(0,1)))}}),cc._RF.pop()},{CEntityKnife:"CEntityKnife",CommonConfig:"CommonConfig",Tools:"Tools",Types:"Types"}],CBaseCollisionHandleSystem:[function(t,e,i){"use strict";cc._RF.push(e,"0a8d0TZWBpKfIcYwAJ0zxjD","CBaseCollisionHandleSystem");var o=t("CollisionEventManager");cc.Class({extends:cc.Component,properties:{},ctor:function(){this._eventListName="",this._collisionEventMgr=null},onLoad:function(){this._collisionEventMgr=o.CollisionEventManager.getInstance()},updateGameLogic:function(t){if(this._collisionEventMgr[this._eventListName])for(var e=0,i=this._collisionEventMgr[this._eventListName];e<i.length;e++){var o=i[e];this.handelCollisionEvent(o)}},handelCollisionEvent:function(t){}}),cc._RF.pop()},{CollisionEventManager:"CollisionEventManager"}],CEnemyEffect:[function(t,e,i){"use strict";cc._RF.push(e,"e9ebcQZYe9O2JmmEtyXJoMu","CEnemyEffect");var o=t("CommonConfig"),n=t("Tools"),s=t("CommonValue"),a=t("PfFrameAnim"),c=t("Types");cc.Class({extends:cc.Component,properties:{dbNode:cc.Node,pf_db:cc.Prefab,node_die:cc.Node,hurtLightNode:cc.Node,knifeLightNode:cc.Node,hitNode:cc.Node,skel_snake_hit_shine:sp.Skeleton},ctor:function(){this.hpPlaying=!1,this.hlpPlaying=!1,this._particleList=[]},init:function(t){this._entity=t,this.animDieCom=this.node_die.getComponent(cc.Animation),this.knifeLightCom=this.knifeLightNode.getComponent(cc.Animation);var e,i=this;(e=cc.instantiate(s.GValue.pf_anim)).scale=1.8,this.hpFrameAnim=e.getComponent(a),this.hpFrameAnim.init(s.GValue.Atlas_Enemy,"ah_",5,o.GConfig.actionFrameTime,function(){i.onHpAnimFinished()}),this.hpFrameAnim.selfUpdate=!0,this.node.addChild(e),(e=cc.instantiate(s.GValue.pf_anim)).scale=3,e.anchorY=1,this.hlpFrameAnim=e.getComponent(a),this.hlpFrameAnim.init(s.GValue.Atlas_Enemy,"ahl_",9,.02,function(){i.onHlpCAnimFinished()}),this.dbNode.addChild(e),(e=cc.instantiate(s.GValue.pf_anim)).scale=2,this.dpFrameAnim=e.getComponent(a),this.dpFrameAnim.init(s.GValue.Atlas_Enemy,"aed_",23,o.GConfig.actionFrameTime,function(){i.onDpAnimFinished()}),this.dpFrameAnim.selfUpdate=!0,this.node.addChild(e),(e=cc.instantiate(s.GValue.pf_anim)).scale=1.3,this.iceFrameAnim=e.getComponent(a),this.iceFrameAnim.init(s.GValue.Atlas_Enemy,"aei_",8,1.3*o.GConfig.actionFrameTime,null,function(){i.onIceAnimStop()}),this.node.addChild(e,-1),(e=cc.instantiate(s.GValue.pf_anim)).scale=1.5,this.fireFrameAnim=e.getComponent(a),this.fireFrameAnim.init(s.GValue.Atlas_Enemy,"aef_",7,1.3*o.GConfig.actionFrameTime,null,function(){i.onFireAnimStop()}),this.node.addChild(e)},updateGameLogic:function(t){!this._entity.isDead&&this._entity.buffCom.isDirty&&(this._entity.hasBuff(c.EnemyBuff.Frozen)?this.iceFrameAnim.isPlaying()||this.iceFrameAnim.reset():this._entity.hasBuff(c.EnemyBuff.Firing)?this.fireFrameAnim.isPlaying()||this.fireFrameAnim.reset():(this.iceFrameAnim.isPlaying()&&this.iceFrameAnim.stop(),this.fireFrameAnim.isPlaying()&&this.fireFrameAnim.stop(!0)),this._entity.buffCom.isDirty=!1)},onHpAnimFinished:function(){this.hpPlaying=!1,this.hpFrameAnim.stop()},onHlpCAnimFinished:function(){this.hlpPlaying=!1,this.hlpFrameAnim.stop()},onDpAnimFinished:function(){this.dpFrameAnim.stop(),this.hpFrameAnim.stop(),this.hpPlaying=!1,this.dieCall&&this.dieCall()},onIceAnimStop:function(){},onFireAnimStop:function(){},hurt:function(t,e){this.playHurtLightAnim(t),this.playHurtParticle(t,e)},playHurtLightAnim:function(t){var e=this,i=.7*o.GConfig.actionFrameTime;this.hurtLightNode.opacity=255,this.hurtLightNode.scale=1;var s=n.DYTools.random_int(0,40)-20;this.hurtLightNode.position=t.add(cc.v2(s,.5*Math.abs(s)));var a=cc.fadeTo(3*i,178),c=cc.scaleTo(3*i,1.46);this.hurtLightNode.runAction(cc.sequence(cc.spawn(a,c),cc.callFunc(function(){e.hurtLightNode.opacity=0}))),this.knifeLightNode.opacity=255,this.knifeLightNode.position=t.add(cc.v2(n.DYTools.random_int(0,60)-30,n.DYTools.random_int(0,20)-10)),this.knifeLightCom.play()},playHurtParticle:function(t,e){this.hpPlaying||(this.hpPlaying=!0,this.hpFrameAnim.reset(),this.hpFrameAnim.node.position=t,this.hpFrameAnim.node.color=e)},hit:function(t,e,i){if(!this.skel_snake_hit_shine.node.active){var o=this;this.skel_snake_hit_shine.node.active=!0,this.skel_snake_hit_shine.node.setPosition(t),this.skel_snake_hit_shine.node.angle=-e,this.skel_snake_hit_shine.node.angle=-i,this.skel_snake_hit_shine.setAnimation(0,"play",!1),this.skel_snake_hit_shine.setCompleteListener(function(t,e){"play"==(t.animation?t.animation.name:"")&&(o.skel_snake_hit_shine.node.active=!1)})}},laserHurt:function(t,e,i){this.playLaserHurtParticle(t,e,i)},playLaserHurtParticle:function(t,e,i){this.hlpPlaying||(this.hlpFrameAnim.reset(),this.hlpFrameAnim.node.position=t,this.hlpFrameAnim.node.angle=-e,this.hlpFrameAnim.node.color=i)},die:function(t,e,i,n){var a=this;void 0===n&&(n=!0),this.dieCall=i,n&&(this.animDieCom.node.opacity=255,this.animDieCom.play("die")),this.dpFrameAnim.reset(),this.dpFrameAnim.node.color=e,t&&t>0&&s.GValue.EntityWorld.gameUI.playGoldEnemyDie(this.node.convertToWorldSpaceAR(cc.v2(0,0)),t);var c=o.GConfig.actionFrameTime;this.scheduleOnce(function(){var t=new cc.Node;a.dbNode.addChild(t),t.addComponent(cc.Sprite).spriteFrame=s.GValue.Atlas_Enemy.getSpriteFrame("edl"),t.scale=1.55,t.runAction(cc.sequence(cc.scaleTo(3*c,.56),cc.removeSelf()))},c)}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonValue:"CommonValue",PfFrameAnim:"PfFrameAnim",Tools:"Tools",Types:"Types"}],CEntityBase:[function(t,e,i){"use strict";cc._RF.push(e,"e094dh6ixBDL7k8tiHuTD42","CEntityBase"),cc.Class({extends:cc.Component,properties:{teamID:cc.Integer},updateGameLogic:function(t){}}),cc._RF.pop()},{}],CEntityBossCircle:[function(t,e,i){"use strict";cc._RF.push(e,"d9c14RYuhJLBr/g6saZwAAu","CEntityBossCircle");var o=t("ConfigData"),n=t("CommonFunc"),s=t("CommonValue"),a=t("Tools"),c=t("Types"),r=t("CommonConfig"),l=t("EntityEnemy"),h=t("CommonEnum"),d=t("EnemyBase");cc.Class({extends:d,properties:{},ctor:function(){this.data=null,this.parent=null,this.collider_p=null,this.list_name=[],this.dic_node={},this.dic_shine={},this.dic_enemy={},this.dic_angle={},this.dic_dline_node={},this.dic_dline_angle={},this.dic_dline_shadow={},this.dic_dline={},this.startRadius=0,this.curRadius=0,this.curTime=0,this.curIndex_tr=0,this.curTime_tr=0,this.curMoveDir=cc.v2(-1,-1),this.curSpeed=0,this.curAcc_index=0,this.curAcc_time=0,this.curRotateSpeed=0,this.curRotateAcc_index=0,this.curRotateAcc_time=0,this.stateCom=null,this.moveCom=null,this.moveFixCom=null,this.isTargetIn=!1,this.isStop=!1,this.isDead=!1,this.enterCall=null,this.cur_name_shine=""},init:function(t,e){void 0===e&&(e=null),this.type=c.EnemyType.Circle;var i=this;this.data=t,this.curMoveDir=t.start_dir.normalize(),this.enterCall=e,this.curSpeed=this.data.move_speed,this.curRotateSpeed=this.data.rotate_speed,this.init_data(),this.create_parent(),this.create_show(),this.move_targetIn(),this.scheduleOnce(function(){i.check_shine()},.5)},init_data:function(){this.startRadius=this.data.start_radius,this.curRadius=this.data.start_radius;for(var t=this.data.list_enemy.length,e=0;e<t;e++)this.list_name.push(e),this.dic_enemy[e]=this.data.list_enemy[e],this.dic_angle[e]=this.data.list_angle[e],this.dic_dline[e]=this.data.list_dline[e];for(var i in this.data.dic_line)this.dic_dline_angle[i]=this.data.dic_line[i]},create_parent:function(){this.parent=new cc.Node,this.parent.group="enemy",this.node.addChild(this.parent),this.collider_p=this.parent.addComponent(cc.CircleCollider),this.collider_p.radius=this.curRadius,this.collider_p.tag=h.E_CTag.Boss_Circle,this.stateCom=a.DYTools.addScript(this.parent,"EnemyStateComponent"),this.stateCom.init(null),this.moveCom=a.DYTools.addScript(this.parent,"EnemyActionMoveComponent"),this.moveFixCom=a.DYTools.addScript(this.parent.parent,"EnemyMoveFix"),this.moveFixCom.initByMoveType(c.EnemyMoveType.Elastic,this.parent),a.DYTools.addScript(this.collider_p.node,"EnemyCollisionWallListener")},create_show:function(){var t=this,e="e_line_"+this.data.lineId,i="se_line_"+this.data.lineId;for(var c in this.dic_dline_angle){var l=new cc.Node;this.parent.addChild(l);var h=l.addComponent(cc.Sprite);n.GFunc.changeAtlasSprite(s.GValue.Atlas_Shadow,h,i),this.dic_dline_shadow[c]=l;var d=new cc.Node;d.parent=this.parent,this.dic_dline_node[c]=d;var u=new cc.Node;d.addChild(u);var m=u.addComponent(cc.Sprite);n.GFunc.changeAtlasSprite(s.GValue.Atlas_Enemy,m,e),this.adjust_dline(parseInt(c))}for(var p=function(e){var i=f.list_name[e],c=f.dic_enemy[i],l=r.GConfig.getEnemyData(c);if(l){var h=new o.EnemyData;h.id=l.id,h.blood=a.DYTools.random_int(l.blood.x,l.blood.y),h.moveSpeed=a.DYTools.random_int(l.speed.x,l.speed.y),h.scale=a.DYTools.random_int(l.size.x,l.size.y)/100,h.adjustDuration=a.DYTools.random_int(l.adjustDuration.x,l.adjustDuration.y)/10,h.cData=l;var d=s.GValue.EntityWorld.addEntitySys._addEntityEnemy(h,cc.Vec2.ZERO,4);if(d.node.parent=f.parent,d.callback_bossDie=function(){t.die_item(i)},d.isItem=!0,d.node.name=i.toString(),f.dic_node[i]=d.node,d.node.angle=0,d.uiNode){var u=d.uiNode.getChildByName("role_shine");if(u){var m=new cc.Node,p=m.addComponent(cc.Sprite);n.GFunc.changeAtlasSprite(s.GValue.Atlas_Enemy,p,"e_202"),m.setAnchorPoint(.5,.5),u.addChild(m),m.opacity=0,f.dic_shine[i]=m}}f.adjust_item(i.toString())}},f=this,_=0;_<this.list_name.length;_++)p(_)},check_shine:function(){var t="",e=-1;for(var i in this.dic_node){var o=this.dic_node[i];if(o){var n=o.getComponent(l);if(n){var s=n._curBlood;-1==e?(e=s,t=i):s<e&&(e=s,t=i)}}}var a,c=!1;if((this.cur_name_shine.length>0?this.cur_name_shine==t||((a=this.dic_shine[this.cur_name_shine])&&(a.stopAllActions(),a.opacity=0),c=!0):c=!0,c&&t.length>0)&&(a=this.dic_shine[t])){var h=r.GConfig.actionFrameTime,d=cc.fadeTo(2*h,255),u=cc.delayTime(2*h),m=cc.fadeTo(0*h,0),p=cc.delayTime(2*h),f=cc.sequence(d,u,m,p),_=cc.repeatForever(f);a.runAction(_),this.cur_name_shine=t}},adjust_dline:function(t){var e=this.dic_dline_node[t];if(e){var i=this.dic_dline_angle[t],o=this.get_speedXY_by_rotate(i,this.curRadius);e.setPosition(o),e.angle=-i;var n=this.dic_dline_shadow[t];n.setPosition(o.add(cc.v2(20,-20))),n.angle=-i}},adjust_item:function(t){var e=this.dic_node[t];if(e){var i=this.dic_angle[t],o=this.get_speedXY_by_rotate(i,this.curRadius);e.setPosition(o)}},die_item:function(t){if(!this.isDead){for(var e=this,i=0;i<this.list_name.length;i++)if(t==this.list_name[i]){this.list_name.splice(i,1),delete this.dic_node[t];var o=this.dic_shine[t];o&&(o.destroy(),delete this.dic_shine[t]);for(var n=this.dic_dline[t],a=0;a<n.length;a++){var c=n[a],r=this.dic_dline_node[c];r&&(r.destroy(),delete this.dic_dline_node[c]);var l=this.dic_dline_shadow[c];l&&(l.destroy(),delete this.dic_dline_shadow[c])}break}this.list_name.length<=0&&(this.isDead=!0,s.GValue.EntityWorld.bossDie(this.node),delete s.GValue.EntityWorld.CircleEnemys[this.data.id],this.data.gold>0&&s.GValue.EntityWorld.playGoldFlyEffect(1,this.data.gold,this.parent.convertToWorldSpaceAR(cc.v2(0,0))),this.scheduleOnce(function(){e.node.destroy()},1))}},adjust_dt:function(){for(var t in this.dic_node)this.adjust_item(t.toString());for(var e in this.dic_dline_angle)this.adjust_dline(parseInt(e))},get_real_rotate:function(t){for(var e=t;e>360;)e-=360;for(;e<0;)e+=360;return e},get_speedXY_by_rotate:function(t,e){var i=cc.v2(0,0);if(0==t||360==t)i=cc.v2(0,-e);else if(90==t)i=cc.v2(-e,0);else if(180==t)i=cc.v2(0,e);else if(270==t)i=cc.v2(e,0);else if(t>180&&t<270){var o=(t-180)/180*Math.PI;i=cc.v2(e*Math.sin(o),e*Math.cos(o))}else t>90&&t<180?(o=(t-90)/180*Math.PI,i=cc.v2(-e*Math.cos(o),e*Math.sin(o))):t>0&&t<90?(o=t/180*Math.PI,i=cc.v2(-e*Math.sin(o),-e*Math.cos(o))):t>270&&t<360&&(o=(t-270)/180*Math.PI,i=cc.v2(e*Math.cos(o),-e*Math.sin(o)));return i},updateRotate:function(t){this.curRotateAcc_index=this.curRotateAcc_index<this.data.ar_list_time.length?this.curRotateAcc_index:0;var e=this.data.ar_list_acc[this.curRotateAcc_index];for(var i in this.curRotateAcc_time+=t,this.curRotateAcc_time>=this.data.ar_list_time[this.curRotateAcc_index]&&(this.curRotateAcc_time=0,this.curRotateAcc_index++),this.curRotateSpeed+=e*t,this.dic_node){var o=this.dic_angle[i];o+=this.curRotateSpeed*t,this.dic_angle[i]=this.get_real_rotate(o)}for(var n in this.dic_dline_angle)o=this.dic_dline_angle[n],o+=this.curRotateSpeed*t,this.dic_dline_angle[n]=this.get_real_rotate(o)},updatePos:function(t){s.GValue.PropMgr.hasProp(c.PropType.Slow)&&(t*=s.GValue.SlowRatio),this.curAcc_index=this.curAcc_index<this.data.as_list_time.length?this.curAcc_index:0;var e=this.data.as_list_acc[this.curAcc_index];this.curAcc_time+=t,this.curAcc_time>=this.data.as_list_time[this.curAcc_index]&&(this.curAcc_time=0,this.curAcc_index++),this.curSpeed+=e*t;var i=cc.v2(this.curMoveDir.x*this.curSpeed,this.curMoveDir.y*this.curSpeed),o=cc.v2(i.x*t,i.y*t);if(this.node.setPosition(this.node.position.add(o)),this.moveFixCom.resetRadius(),this.moveFixCom.fixPositionByWall(),this.moveFixCom.fixPositionByScreen(),this.moveFixCom._dxDirty){var n=this.data.rv.x+(this.data.rv.y-this.data.rv.x)*Math.random();this.curMoveDir.x=this.curMoveDir.x>0?1:-1,this.curMoveDir.y=this.curMoveDir.y>0?1:-1,this.curMoveDir.x*=n,this.curMoveDir=this.curMoveDir.normalize(),this.moveFixCom._dxDirty=!1}this.moveFixCom._dyDirty&&(n=this.data.rv.x+(this.data.rv.y-this.data.rv.x)*Math.random(),this.curMoveDir.x=this.curMoveDir.x>0?1:-1,this.curMoveDir.y=this.curMoveDir.y>0?1:-1,this.curMoveDir.y*=n,this.curMoveDir=this.curMoveDir.normalize(),this.moveFixCom._dyDirty=!1)},move_targetIn:function(){var t=this,e=cc.moveBy(this.data.targetIn_time,this.data.targetIn_pos),i=cc.callFunc(function(){t.enterCall&&t.enterCall(t),t.isStop=!0,t.data.isIn||t.setTargetIn(!0)}),o=cc.sequence(e,i);this.node.runAction(o)},setTargetIn:function(t){this.isTargetIn=t,t&&(this.isStop=!1)},updateGameLogic:function(t){if(!this.isDead&&!this.isStop){if(this.data.list_time.length>0){this.curIndex_tr>=this.data.list_time.length&&(this.curIndex_tr=0);var e=this.data.list_time[this.curIndex_tr],i=this.data.list_radius[this.curIndex_tr];this.curTime+=t,this.curRadius=this.startRadius+(i-this.startRadius)*(this.curTime/e),this.collider_p.radius=this.curRadius,this.curTime>=e&&(this.curIndex_tr++,this.curTime=0,this.startRadius=this.curRadius)}this.adjust_dt(),this.isTargetIn&&(this.updateRotate(t),this.updatePos(t))}}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonValue:"CommonValue",ConfigData:"ConfigData",EnemyBase:"EnemyBase",EntityEnemy:"EntityEnemy",Tools:"Tools",Types:"Types"}],CEntityBossElectr:[function(t,e,i){"use strict";cc._RF.push(e,"86ba6b4qKpNVIgi6v0Mrk35","CEntityBossElectr");var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=t("CEntityBoss"),s=t("CommonFunc"),a=t("CommonValue"),c=t("CommonConfig"),r=t("CommonEnum"),l=t("PfNum"),h=t("CommonAudio"),d=t("CEnemyEffect"),u=t("Tools"),m=t("Types");cc.Class({extends:n,properties:{},ctor:function(){cc.Enum({None:0,Launch:1,Gun:2,Idle:3}),this.data=null,this.node_p_shadow=null,this.node_p_circle=null,this.node_circle=null,this.node_p_item=null,this.node_p_head=null,this.node_head=null,this.skel_die=null,this.color_effect=cc.color(130,30,155),this.dic_item_hp={},this.dic_item_rotate={},this.dic_item={},this.dic_item_edge={},this.dic_item_launch={},this.dic_item_launch_shine={},this.dic_item_gun={},this.dic_item_gun_shine={},this.dic_skel_item_smoke={},this.dic_skel_item_ball={},this.dic_skel_item_shine={},this.dic_skel_item_line={},this.dic_item_hp_node={},this.dic_item_hp_com={},this.dic_item_com_effect={},this.dic_item_shadow_launch={},this.dic_item_shadow_gun={},this.pos_item_out=cc.v2(0,30),this.pos_item_in=cc.v2(0,60),this.pos_item_die=cc.v2(0,100),this.pos_edge_launch=cc.v2(0,0),this.pos_edge_gun=cc.v2(0,-40),this.pos_launch_out=cc.v2(0,5),this.pos_launch_in=cc.v2(0,50),this.pos_gun_out=cc.v2(0,7),this.pos_gun_in=cc.v2(0,50),this.pos_shadow=cc.v2(20,-20),this.cur_state=_.None,this.attack_index=0,this.attack_time=0,this.attack_finish=!1,this.list_attack_time_dis=[],this.dic_attack_time_last={},this.dic_attack_enemys={},this.is_rotate=!1,this.is_move=!1,this.stateCom=null,this.moveCom=null,this.moveFixCom=null,this.curMoveDir=cc.v2(-1,-1),this.curSpeed=0,this.rv=cc.v2(-2,-1)},init:function(t,e){var i=this;this.data=t,this.init_parent(t,e,this.beginFunc,this.updateFunc,this.attackFunc),this.init_data(t),this.create_show(),this.moveTo_target(),this.schedule(function(){if(!i.isDead){for(var t in i.dic_skel_item_shine){var e=i.dic_skel_item_shine[t];i.play_skel(e,"show")}h.GAudio.playSound(h.Enum_Audio.bossElectrIn)}},3,cc.macro.REPEAT_FOREVER),this.stateCom=u.DYTools.addScript(this.node,"EnemyStateComponent"),this.stateCom.init(null),this.moveCom=u.DYTools.addScript(this.node,"EnemyActionMoveComponent"),this.moveFixCom=u.DYTools.addScript(this.node,"EnemyMoveFix"),this.moveFixCom.initByMoveType(m.EnemyMoveType.Elastic,this.target),u.DYTools.addScript(this.collider_p.node,"EnemyCollisionWallListener")},init_data:function(t){for(var e=t.enemys,i=0;i<e.length;i++)if(2==(s=e[i].split("*")).length){var o=i+1;this.dic_item_rotate[o]=parseFloat(s[0]),this.dic_item_hp[o]=parseInt(s[1])}this.dic_item_hp[0]=this.data.hp;var n=t.attack;for(i=0;i<n.length;i++){var s;if((s=n[i].split("=")).length>=1){var a=s[0].split("*");if(2==a.length&&(o=this.list_attack_time_dis.length,this.list_attack_time_dis.push(parseFloat(a[0])),this.dic_attack_time_last[o]=parseFloat(a[1]),s.length>=2)){var c=s[1].split("&");this.dic_attack_enemys[o]=c}}}},create_show:function(){this.node_p_shadow=new cc.Node,this.node_p_shadow.setPosition(this.pos_shadow),this.show.addChild(this.node_p_shadow),this.node_p_circle=new cc.Node,this.show.addChild(this.node_p_circle),this.node_p_item=new cc.Node,this.show.addChild(this.node_p_item),this.node_p_head=new cc.Node,this.show.addChild(this.node_p_head);var t=new cc.Node;this.node_p_shadow.addChild(t);var e=t.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(a.GValue.Atlas_Boss,e,"el_circle_shadow"),this.node_circle=new cc.Node,this.node_p_circle.addChild(this.node_circle);var i=this.node_circle.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(a.GValue.Atlas_Boss,i,"el_circle"),this.radius_p=.5*this.node_circle.width,this.collider_p.radius=this.radius_p,this.addListShineNode(0,this.node_circle);var o=function(t){var e=parseInt(t),i=n.dic_item_rotate[t],o=n.dic_item_hp[t],c=new cc.Node;n.node_p_item.addChild(c),c.angle=-i;var h=new cc.Node;c.addChild(h),h.setPosition(n.pos_item_out),n.dic_item[t]=h;var u=new cc.Node;h.addChild(u);var m=u.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(a.GValue.Atlas_Boss,m,"el_arm"),u.setAnchorPoint(.5,1);var p=u.height;n.addListShineNode(e,u);var f=new cc.Node;h.addChild(f),f.setPosition(0,-p-50);var _=new cc.Node;_.setAnchorPoint(.5,0),n.node_p_shadow.addChild(_);var y=_.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(a.GValue.Atlas_Boss,y,"el_el_shadow"),_.angle=-i,n.dic_item_shadow_launch[t]=_;var g=new cc.Node;g.setAnchorPoint(.5,0),n.node_p_shadow.addChild(g);var v=g.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(a.GValue.Atlas_Boss,v,"el_enemy_shadow"),g.angle=-i,n.dic_item_shadow_gun[t]=g;var C=f.convertToWorldSpaceAR(cc.v2(0,-30)),S=n.node_p_item.convertToNodeSpace(C);_.setPosition(S),g.setPosition(S);var D=new cc.Node;f.addChild(D,1);var T=D.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(a.GValue.Atlas_Boss,T,"el_bed"),D.setAnchorPoint(.5,0),n.addListShineNode(e,D),D.group="enemy";var G=D.addComponent(cc.CircleCollider);G.offset=cc.v2(0,.5*D.height),G.radius=.5*D.width,G.tag=r.E_CTag.Boss_ElectrHead+parseInt(t),G.name=n.data.id.toString(),n.addListCollider(G);var A=new cc.Node;A.setPosition(n.pos_edge_launch),f.addChild(A,2),n.dic_item_edge[t]=A;var w=new cc.Node;A.addChild(w);var b=w.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(a.GValue.Atlas_Boss,b,"el_bed_l"),w.setAnchorPoint(1,0),w.setPosition(-25,0),n.addListShineNode(e,w);var E=new cc.Node;A.addChild(E);var P=E.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(a.GValue.Atlas_Boss,P,"el_bed_l"),E.setAnchorPoint(1,0),E.setPosition(25,0),E.scaleX=-1,n.addListShineNode(e,E);var N=cc.instantiate(a.GValue.pf_num);N.setPosition(cc.v2(0,.35*D.height)),f.addChild(N,3);var k=N.getComponent(l.default);k.setParam(r.Enum_Num.Blood,cc.v2(.5,.5),2,a.GValue.Atlas_Game),k.setString(s.GFunc.getNumK(Math.ceil(o))),N.scale=.4,n.dic_item_hp_node[t]=N,n.dic_item_hp_com[t]=k,n.addListShinePfnum(e,k);var F=new cc.Node;F.setPosition(n.pos_launch_out),f.addChild(F),n.dic_item_launch[t]=F;var V=new cc.Node;F.addChild(V);var x=V.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(a.GValue.Atlas_Boss,x,"el_launch"),V.setAnchorPoint(.5,1),n.addListShineNode(e,V);var I=new cc.Node;F.addChild(I);var R=I.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(a.GValue.Atlas_Boss,R,"el_launch_shine"),I.setAnchorPoint(.5,1),I.setPosition(0,10),n.dic_item_launch_shine[t]=I,I.opacity=0;var B=new cc.Node;B.setPosition(n.pos_gun_in),f.addChild(B),n.dic_item_gun[t]=B;var M=new cc.Node;B.addChild(M);var L=M.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(a.GValue.Atlas_Boss,L,"el_gun"),M.setAnchorPoint(.5,1);var O=M.height;n.addListShineNode(e,M);var W=new cc.Node;B.addChild(W);var Y=W.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(a.GValue.Atlas_Boss,Y,"el_gun_shine"),W.setAnchorPoint(.5,0),W.setPosition(0,-O-5),n.dic_item_gun_shine[t]=W,W.opacity=0;var K=new cc.Node;c.addChild(K),K.setPosition(0,.5*-p);var H=n.create_skel(K,"skel_electr_smoke","hide");n.dic_skel_item_smoke[t]=H;var U=new cc.Node;f.addChild(U,10),U.setPosition(0,50);var z=n.create_skel(U,"skel_electr_shine","hide");n.dic_skel_item_shine[t]=z;var q=new cc.Node;f.addChild(q,10),q.setPosition(0,-20);var X=n.create_skel(q,"skel_electr_ball","hide");n.dic_skel_item_ball[t]=X,X.setCompleteListener(function(t,e){"show"==(t.animation?t.animation.name:"")&&X.setAnimation(0,"idle",!0)});var j=new cc.Node;f.addChild(j,10),j.setPosition(0,-20);var Z=n.create_skel(j,"skel_electr_line","hide");n.dic_skel_item_line[t]=Z,j.scaleY=0;var J=new cc.Node;J.group="otherKnife",j.addChild(J);var Q=J.addComponent(cc.BoxCollider),$=cc.size(20,220);Q.size=$,Q.offset=cc.v2(0,.5*-$.height),Q.tag=r.E_CTag.Boss_ElectrLine;var tt=cc.instantiate(a.GValue.pf_enemy_effect);tt.setPosition(0,.8*-p),c.addChild(tt,11);var et=tt.getComponent(d.CEnemyEffect);et.init(n),n.dic_item_com_effect[t]=et,tt.scale=.7},n=this;for(var c in this.dic_item_rotate)o(c);this.node_head=new cc.Node,this.node_p_head.addChild(this.node_head);var h=this.node_head.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(a.GValue.Atlas_Boss,h,"el_head"),this.addListShineNode(0,this.node_head),this.node_head.group="enemy";var u=this.node_head.addComponent(cc.CircleCollider);u.radius=.5*this.node_head.width,u.tag=r.E_CTag.Boss_ElectrHead,u.name=this.data.id.toString(),this.addListCollider(u);var m=cc.instantiate(a.GValue.pf_num);m.setPosition(cc.v2(0,-10)),this.node_head.addChild(m);var p=m.getComponent(l.default);p.setParam(r.Enum_Num.Blood,cc.v2(.5,.5),2,a.GValue.Atlas_Game),p.setString(s.GFunc.getNumK(Math.ceil(this.data.hp))),m.scale=.6,this.dic_item_hp_node[0]=m,this.dic_item_hp_com[0]=p,this.addListShinePfnum(0,p);var f=new cc.Node;this.node_head.addChild(f,10),f.setPosition(0,0);var _=this.create_skel(f,"skel_electr_shine","hide");this.dic_skel_item_shine[0]=_,f.scale=1.5;var y=cc.instantiate(a.GValue.pf_enemy_effect);y.setPosition(0,0),this.node_head.addChild(y);var g=y.getComponent(d.CEnemyEffect);g.init(this),this.dic_item_com_effect[0]=g,y.scale=1;var v=new cc.Node;this.parent.addChild(v),this.skel_die=this.create_skel(v,"skel_electr_die","hide"),this.setShadowState(!0)},create_skel:function(t,e,i){var o=t.addComponent(sp.Skeleton),n="skel/"+e+"/"+e;return cc.loader.loadRes(n,sp.SkeletonData,function(t,e){t||(o.skeletonData=e,o.premultipliedAlpha=!1,o.setAnimation(0,i,!1))}),o},play_skel:function(t,e){t&&t.skeletonData&&t.setAnimation(0,e,!1)},change_state:function(t,e){if(t!=this.cur_state){this.cur_state=t;var i=this,o=c.GConfig.actionFrameTime;for(var n in this.dic_item){var s=this.dic_item[n];s.stopAllActions();var a=this.dic_item_launch[n];a.stopAllActions();var r=this.dic_item_gun[n];r.stopAllActions();var l=this.dic_item_edge[n];l.stopAllActions();var h=this.dic_skel_item_smoke[n];if(!this.isDead)switch(t){case _.Idle:var d=cc.moveTo(4*o,this.pos_item_out);s.runAction(d),this.play_skel(h,"show");break;case _.Launch:this.is_rotate=!1,this.is_move=!1,d=cc.moveTo(4*o,this.pos_item_out),s.runAction(d);var u=cc.moveTo(4*o,this.pos_gun_in);r.runAction(u);var m=cc.delayTime(9*o),p=cc.moveTo(5*o,this.pos_launch_out),f=cc.callFunc(function(){i.cur_state=_.None,i.trigger_launch(e),i.setShadowState(!0)}),y=cc.sequence(m,p,f);a.runAction(y);var g=cc.delayTime(14*o),v=cc.moveTo(5*o,this.pos_edge_launch),C=cc.sequence(g,v);l.runAction(C);break;case _.Gun:this.is_rotate=!1,this.is_move=!1,d=cc.moveTo(4*o,this.pos_item_out),s.runAction(d);var S=cc.moveTo(4*o,this.pos_launch_in);a.runAction(S);var D=cc.delayTime(9*o),T=cc.moveTo(5*o,this.pos_gun_out),G=cc.callFunc(function(){i.cur_state=_.None,i.trigger_gun(e),i.setShadowState(!1)}),A=cc.sequence(D,T,G);r.runAction(A),g=cc.delayTime(14*o),v=cc.moveTo(5*o,this.pos_edge_gun),C=cc.sequence(g,v),l.runAction(C)}}}},trigger_launch:function(t){var e=this;h.GAudio.playSound(h.Enum_Audio.bossElectrLaunch);var i=this.dic_attack_time_last[t],n=c.GConfig.actionFrameTime,s=function(t){var o=a.dic_item[t];o.stopAllActions();var s=a.dic_item_launch_shine[t];s.stopAllActions();var c=a.dic_skel_item_ball[t],r=a.dic_skel_item_line[t];if(!r.node)return{value:void 0};if(r.node.stopAllActions(),r.node.scaleY=0,a.isDead)return"continue";var l=cc.moveTo(6*n,a.pos_item_in);o.runAction(l);var h=cc.delayTime(6*n),d=cc.callFunc(function(){e.play_skel(c,"show"),e.play_skel(r,"show")}),u=cc.fadeTo(0*n,255),m=cc.sequence(h,d,u);s.runAction(m);var p=cc.delayTime(1),f=cc.callFunc(function(){e.play_skel(c,"hide")}),y=cc.scaleTo(4*n,1,10),g=cc.callFunc(function(){e.is_rotate=!0}),v=cc.delayTime(i),C=cc.scaleTo(1*n,1,0),S=cc.callFunc(function(){s.opacity=0,e.change_state(_.Idle,-1),e.is_move=!0}),D=cc.sequence(p,f,y,g,v,C,S);r.node.runAction(D)},a=this;for(var r in this.dic_item){var l=s(r);if("object"==(void 0===l?"undefined":o(l)))return l.value}},trigger_gun:function(t){var e=this,i=this;h.GAudio.playSound(h.Enum_Audio.bossElectrGun);var o=this.dic_attack_time_last[t],n=this.dic_attack_enemys[t],s=c.GConfig.actionFrameTime,a=function(t){var a=r.dic_item[t];a.stopAllActions();var c=r.dic_item_gun_shine[t];if(c.stopAllActions(),r.isDead)return"continue";var l=cc.moveTo(6*s,r.pos_item_in);a.runAction(l);var h=cc.fadeTo(6*s,255),d=cc.delayTime(0),u=cc.callFunc(function(){var o=c.convertToWorldSpaceAR(cc.v2(0,0)),s=e.node.convertToNodeSpaceAR(o),a=e.node.position.add(s),r=e.node_p_circle.angle+e.dic_item_rotate[t];i.addEnemys(a,r,n)}),m=cc.delayTime(o),p=cc.callFunc(function(){c.opacity=0,i.change_state(_.Idle,-1),i.is_rotate=!0,i.is_move=!0}),f=cc.sequence(h,d,u,m,p);c.runAction(f)},r=this;for(var l in this.dic_item)a(l)},addEnemys:function(t,e,i){for(var o=this,n=cc.v2(0,-1).rotate(cc.misc.degreesToRadians(-e)),s=function(e){var s=i[e].split("*");if(2==s.length){var r=parseInt(s[0]),l=parseFloat(s[1]);l=l<0?0:l,c.scheduleOnce(function(){o.isDead||a.GValue.EntityWorld.addEntitySys.addBossFireEnemys(r,n,t)},l)}},c=this,r=0;r<i.length;r++)s(r)},setShadowState:function(t){for(var e in this.dic_item_shadow_launch){var i=this.dic_item_shadow_launch[e],o=this.dic_item_shadow_gun[e];i&&(i.opacity=t?255:0),o&&(o.opacity=t?0:255)}},attackFunc:function(t,e,i){var o=i-r.E_CTag.Boss_ElectrHead,n=this.dic_item_hp[o];n=(n-=e)<0?0:n,this.dic_item_hp[o]=n;var c=this.dic_item_hp_com[o];c&&(c.setString(s.GFunc.getNumK(Math.ceil(n))),n<=0&&(c.node.opacity=0));var l=this.dic_item_com_effect[o];if(l){var h=cc.v2(0,0),d=a.GValue.EntityWorld.player.radius,u=a.GValue.EntityWorld.player.node.convertToWorldSpaceAR(cc.v2(0,0)),m=l.node.convertToNodeSpaceAR(u),p=m.mag();if(p>0){var f=(p-d)/p;h=cc.v2(m.x*f,m.y*f)}l.hit(h,0,1),l.hurt(cc.v2(0,0),this.color_effect)}if(n<=0)if(0==o){for(var _ in this.isDead=!0,a.GValue.EntityWorld.bossDie(this.node),this.die_effect(),this.dic_item_shadow_launch){var y=this.dic_item_shadow_launch[_],g=this.dic_item_shadow_gun[_];y&&y.destroy(),g&&g.destroy()}for(var v in this.dic_skel_item_line)(D=this.dic_skel_item_line[v])&&D.node&&D.node.destroy();for(var C in this.dic_skel_item_ball)(T=this.dic_skel_item_ball[C])&&T.node&&T.node.destroy()}else{var S=this.dic_item[o];if(y=this.dic_item_shadow_launch[o],g=this.dic_item_shadow_gun[o],S){var D,T;if(delete this.dic_item[o],delete this.dic_item_shadow_launch[o],delete this.dic_item_shadow_gun[o],l)l.die(0,this.color_effect,null,!0),(D=this.dic_skel_item_line[o])&&D.node&&D.node.destroy(),(T=this.dic_skel_item_ball[o])&&T.node&&T.node.destroy();var G=S.parent;S.destroy(),y&&y.destroy(),g&&g.destroy(),this.scheduleOnce(function(){G.destroy()},1)}var A=!0;for(var w in this.dic_item_hp)if(parseInt(w)>0&&this.dic_item_hp[w]>0){A=!1;break}A&&(this.is_rotate=!0,this.is_move=!0)}},die_effect:function(){var t=this,e=this,i=c.GConfig.actionFrameTime;for(var o in this.data.gold>0&&this.addGold(this.node.convertToWorldSpaceAR(cc.v2(0,0)),this.data.gold),h.GAudio.playSound(h.Enum_Audio.bossElectrDie),a.GValue.EntityWorld.setTouching(!0),a.GValue.EntityWorld.touchAvaliable=!1,this.dic_item){var n=this.dic_item[o];n.stopAllActions();var s=cc.moveTo(10*i,this.pos_item_die),r=cc.fadeTo(10*i,0),l=cc.spawn(s,r);n.runAction(l)}var u=this.data.speed_rotate>0?90:-90;this.node_p_circle.stopAllActions(),this.node_p_item.stopAllActions();var m=cc.rotateBy(10*i,u);this.node_p_circle.runAction(m),this.node_p_item.runAction(m.clone()),this.node_p_shadow.runAction(m.clone()),this.show.stopAllActions();var p=cc.scaleTo(10*i,1.15),f=cc.sequence(cc.delayTime(5*i),cc.callFunc(function(){e.play_skel(e.skel_die,"show")})),_=cc.spawn(p,f),y=cc.callFunc(function(){e.shineDead=!0}),g=cc.scaleTo(2*i,1.18),v=cc.moveBy(2*i,cc.v2(3,-5)),C=cc.spawn(g,v),S=cc.scaleTo(2*i,1.15),D=cc.moveBy(2*i,cc.v2(-3,5)),T=cc.spawn(S,D),G=cc.sequence(C,T),A=cc.repeat(G,10),w=cc.callFunc(function(){for(var i=[cc.v2(-50,50),cc.v2(0,0)],o=[.7,1.2],n=[0,.1],s=i.length,c=function(c){var r=cc.instantiate(a.GValue.pf_enemy_effect);r.scale=o[c],r.setPosition(i[c]),t.parent.addChild(r);var l=r.getComponent(d.CEnemyEffect);l.init(t),e.scheduleOnce(function(){l.die(0,e.color_effect,null,c==s-1)},n[c])},r=0;r<s;r++)c(r);e.scheduleOnce(function(){e.node.destroy(),e.removeDataDicBossEnemy()},1)}),b=cc.fadeTo(5*i,0),E=cc.sequence(_,y,A,w,b);this.show.runAction(E)},beginFunc:function(){this.is_rotate=!0,this.is_move=!0},updateFunc:function(t){if(a.GValue.PropMgr.hasProp(m.PropType.Slow)&&(t*=a.GValue.SlowRatio),this.is_rotate){var e=-this.node_p_circle.angle;e+=this.data.speed_rotate*t,this.node_p_circle.angle=e,this.node_p_item.angle=e,this.node_p_shadow.angle=e}if(this.is_move&&this.updatePos(t),this.is_move&&this.list_attack_time_dis.length>0){this.attack_time+=t;var i=this.list_attack_time_dis[this.attack_index],o=this.dic_attack_time_last[this.attack_index];if(!this.attack_finish&&this.attack_time>i){var n=this.dic_attack_enemys[this.attack_index];n&&n.length>0?this.change_state(_.Gun,this.attack_index):this.change_state(_.Launch,this.attack_index),this.attack_finish=!0}this.attack_time>i+o+1&&(this.attack_time=0,this.attack_index++,this.attack_finish=!1,this.attack_index>=this.list_attack_time_dis.length&&(this.attack_index=0))}},updatePos:function(t){this.curSpeed=this.data.speed_move,this.moveFixCom.curDir=this.curMoveDir;var e=cc.v2(this.curMoveDir.x*this.curSpeed,this.curMoveDir.y*this.curSpeed),i=cc.v2(e.x*t,e.y*t);if(this.node.setPosition(this.node.position.add(i)),this.moveFixCom.resetRadius(),this.moveFixCom.fixPositionByWall(),this.moveFixCom.fixPositionByScreen(),this.moveFixCom._dxDirty){var o=this.rv.x+(this.rv.y-this.rv.x)*Math.random();this.curMoveDir.x=this.curMoveDir.x>0?1:-1,this.curMoveDir.y=this.curMoveDir.y>0?1:-1,this.curMoveDir.x*=o,this.curMoveDir=this.curMoveDir.normalize(),this.moveFixCom._dxDirty=!1}this.moveFixCom._dyDirty&&(o=this.rv.x+(this.rv.y-this.rv.x)*Math.random(),this.curMoveDir.x=this.curMoveDir.x>0?1:-1,this.curMoveDir.y=this.curMoveDir.y>0?1:-1,this.curMoveDir.y*=o,this.curMoveDir=this.curMoveDir.normalize(),this.moveFixCom._dyDirty=!1)}}),cc._RF.pop()},{CEnemyEffect:"CEnemyEffect",CEntityBoss:"CEntityBoss",CommonAudio:"CommonAudio",CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonValue:"CommonValue",PfNum:"PfNum",Tools:"Tools",Types:"Types"}],CEntityBossFire:[function(t,e,i){"use strict";cc._RF.push(e,"e0b84QOPeRNW6X17JuUaNdW","CEntityBossFire");var n=t("CommonFunc"),s=t("CommonValue"),a=t("CommonConfig"),c=t("PfNum"),r=t("CommonEnum"),l=t("CommonAudio"),h=t("CEnemyEffect"),d=t("EnemyBase"),u=t("Types");cc.Class({extends:d,properties:{},ctor:function(){this.data=null,this.isDead=!1,this.shineDead=!1,this.parent=null,this.center_parent=null,this.hand_parent=null,this.head_follow=null,this.head_p_parent=null,this.head_parent=null,this.head_body=null,this.node_head=null,this.node_body=null,this.node_eyes=null,this.node_mouth_close=null,this.node_mouth_open=null,this.skel_boss_fire_effect=null,this.node_collider=null,this.node_shadow_close=null,this.node_shadow_open=null,this.node_hand_l=null,this.node_hand_r=null,this.list_hand_collider=[],this.bloodNum=null,this._bloodNum=null,this.curBlood=0,this.radius=0,this.height_body=0,this.height_factor=1,this.cur_state=o.Enum_BFState.None,this.can_attack=!1,this.com_attacked_effect=null,this.color_effect=cc.color(185,42,42),this.pos_enemy=cc.v2(0,0),this.list_enemys_time=[],this.list_enemys_last=[],this.dic_enemys={},this.cur_index_enemy=0,this.cur_time_enemy=0,this.enterCall=null,this.pos_hand_l=cc.v2(-350,-450),this.pos_hand_r=cc.v2(350,-480),this.color_normal=cc.color(255,255,255),this.color_attack=cc.color(236,128,37),this.color_cur=cc.color(255,255,255),this.color_times=0},onLoad:function(){this.type=u.EnemyType.Fire},update:function(){},init:function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null);var o=this;this.enterCall=e,this.data=t,this.isDead=!1,this.curBlood=t.hp,this.initEnemysData(),this.create_parent(),this.create_show(),this.schedule(function(){o.set_color()},.1,cc.macro.REPEAT_FOREVER)},initEnemysData:function(){for(var t=this.data.enemys,e=0;e<t.length;e++){var i=t[e].split("=");if(3==i.length){var o=parseFloat(i[0]),n=parseFloat(i[1]),s=i[2].split("&");this.list_enemys_time.push(o),this.list_enemys_last.push(n),this.dic_enemys[e]=s}}this.cur_index_enemy=0,this.cur_time_enemy=9999},create_parent:function(){this.parent=new cc.Node,this.node.addChild(this.parent),this.hand_parent=new cc.Node,this.node.addChild(this.hand_parent),this.hand_parent.setPosition(0,0),this.center_parent=new cc.Node,this.node.addChild(this.center_parent),this.center_parent.setPosition(0,800)},create_show:function(){a.GConfig.actionFrameTime,this.node_shadow_close=new cc.Node,this.center_parent.addChild(this.node_shadow_close);var t=this.node_shadow_close.addComponent(cc.Sprite);n.GFunc.changeAtlasSprite(s.GValue.Atlas_Test,t,"bf_shadow_close"),this.node_shadow_close.anchorY=0,this.node_shadow_close.scale=1.6,this.node_shadow_open=new cc.Node,this.center_parent.addChild(this.node_shadow_open);var e=this.node_shadow_open.addComponent(cc.Sprite);n.GFunc.changeAtlasSprite(s.GValue.Atlas_Test,e,"bf_shadow_open"),this.node_shadow_open.anchorY=0,this.node_shadow_open.scale=1.6,this.head_body=new cc.Node,this.center_parent.addChild(this.head_body),this.node_body=new cc.Node,this.head_body.addChild(this.node_body);var i=this.node_body.addComponent(cc.Sprite);n.GFunc.changeAtlasSprite(s.GValue.Atlas_Test,i,"bf_body_"+this.data.image),this.node_body.anchorY=1,this.height_body=this.node_body.height,this.create_hands(this.hand_parent),this.head_follow=new cc.Node,this.center_parent.addChild(this.head_follow),this.head_p_parent=new cc.Node,this.head_follow.addChild(this.head_p_parent),this.head_parent=new cc.Node,this.head_p_parent.addChild(this.head_parent),this.node_mouth_open=new cc.Node,this.head_parent.addChild(this.node_mouth_open);var l=this.node_mouth_open.addComponent(cc.Sprite);n.GFunc.changeAtlasSprite(s.GValue.Atlas_Test,l,"bf_mouth_open"),this.node_mouth_open.anchorY=1;var d=new cc.Node;this.head_parent.addChild(d),this.create_effect(d),this.node_head=new cc.Node,this.head_parent.addChild(this.node_head);var u=this.node_head.addComponent(cc.Sprite);n.GFunc.changeAtlasSprite(s.GValue.Atlas_Test,u,"bf_head_"+this.data.image);var m=this.node_head.height;this.node_head.anchorY=1,this.head_parent.color=cc.color(255,97,37),this.node_eyes=new cc.Node,this.node_head.addChild(this.node_eyes),this.node_eyes.opacity=0,this.node_eyes.y=-315;var p=new cc.Node;p.setPosition(-65,0),this.node_eyes.addChild(p);var f=p.addComponent(cc.Sprite);n.GFunc.changeAtlasSprite(s.GValue.Atlas_Test,f,"bf_eye"),p.scaleX=.8,p.scaleY=.8;var _=new cc.Node;_.setPosition(65,0),this.node_eyes.addChild(_);var y=_.addComponent(cc.Sprite);n.GFunc.changeAtlasSprite(s.GValue.Atlas_Test,y,"bf_eye"),_.scaleX=-.8,_.scaleY=.8,this.node_mouth_close=new cc.Node,this.head_parent.addChild(this.node_mouth_close);var g=this.node_mouth_close.addComponent(cc.Sprite);n.GFunc.changeAtlasSprite(s.GValue.Atlas_Test,g,"bf_mouth_close"),this.node_mouth_close.anchorY=1,this.bloodNum&&this.bloodNum.destroy(),this.bloodNum=cc.instantiate(s.GValue.pf_num),this.node_head.addChild(this.bloodNum),this._bloodNum=this.bloodNum.getComponent(c.default),this._bloodNum.setParam(r.Enum_Num.Blood,cc.v2(.5,.5),0,s.GValue.Atlas_Game),this._bloodNum.setString(n.GFunc.getNumK(Math.ceil(this.curBlood))),this.bloodNum.scale=1.5;var v=cc.instantiate(s.GValue.pf_enemy_effect);this.head_follow.addChild(v),this.com_attacked_effect=v.getComponent(h.CEnemyEffect),this.com_attacked_effect.init(this),this.node_mouth_close.setPosition(cc.v2(0,170-m)),this.node_mouth_open.setPosition(cc.v2(0,170-m)),d.setPosition(cc.v2(0,50-m)),this.bloodNum.setPosition(cc.v2(0,140-m)),v.setPosition(cc.v2(0,140-m)),this.adjust_follow(),this.change_state(o.Enum_BFState.In),this.radius=.5*this.node_head.width,this.node_collider=new cc.Node,this.node_collider.y=.5*-this.node_head.height,this.node_head.addChild(this.node_collider);var C=this.node_collider.addComponent(cc.CircleCollider);C.radius=this.radius,C.tag=r.E_CTag.Boss_Fire,C.node.group="enemy",C.name=this.data.id.toString()},create_hands:function(t){this.node_hand_l=new cc.Node,t.addChild(this.node_hand_l);var e=this.node_hand_l.addComponent(cc.Sprite);n.GFunc.changeAtlasSprite(s.GValue.Atlas_Test,e,"bf_hand_"+this.data.image),this.node_hand_l.anchorY=0,this.node_hand_l.setPosition(this.pos_hand_l.add(cc.v2(0,800)));for(var i=0;i<2;i++){var o=this.getHandColliderNode(100);o.setPosition(0,100*(i+.5)*2),this.node_hand_l.addChild(o)}this.node_hand_r=new cc.Node,t.addChild(this.node_hand_r);var a=this.node_hand_r.addComponent(cc.Sprite);for(n.GFunc.changeAtlasSprite(s.GValue.Atlas_Test,a,"bf_hand_"+this.data.image),this.node_hand_r.anchorY=0,this.node_hand_r.scaleX=-this.node_hand_r.scaleX,this.node_hand_r.setPosition(this.pos_hand_r.add(cc.v2(0,800))),i=0;i<2;i++){var c=this.getHandColliderNode(100);c.setPosition(0,100*(i+.5)*2),this.node_hand_r.addChild(c)}},getHandColliderNode:function(t){var e=new cc.Node,i=e.addComponent(cc.CircleCollider);return i.radius=t,i.tag=r.E_CTag.Boss_FireHand,i.node.group="enemy",i.name=this.data.id.toString(),this.list_hand_collider.push(e),e},action_hands:function(t,e,i,o){if(e.stopAllActions(),e.setPosition(i),!this.isDead){var n=this,s=a.GConfig.actionFrameTime,c=e.scaleX,r=e.scaleY,h=[];h.push(cc.delayTime(0));for(var d=0;d<t.length;d++){var u=t[d].split("*");if(6==u.length){var m=parseFloat(u[0]),p=parseFloat(u[1]),f=parseFloat(u[2]),_=parseFloat(u[3]),y=parseFloat(u[4]),g=parseFloat(u[5]),v=cc.delayTime(m),C=cc.callFunc(function(){l.GAudio.playSound(l.Enum_Audio.bossFireStep);var t=4*s,e=13*s,i=21*s,a=10*s;n.head_p_parent.stopAllActions();var c=cc.delayTime(t),r=cc.moveTo(e,cc.v2(40*o,-10)),h=cc.rotateTo(e,-5*o),d=cc.spawn(r,h),u=cc.moveTo(i,cc.v2(-25*o,-20)),m=cc.rotateTo(i,2*o),p=cc.spawn(u,m),f=cc.moveTo(a,cc.v2(0,0)),_=cc.rotateTo(a,0),y=cc.spawn(f,_),g=cc.sequence(c,d,p,y);n.head_p_parent.runAction(g)}),S=cc.moveTo(p,i.add(cc.v2(y,g))),D=cc.scaleTo(p,1.28*c,1.28*r),T=cc.spawn(S,D),G=cc.delayTime(f),A=cc.moveTo(_,i),w=cc.scaleTo(_,c,r),b=cc.spawn(A,w),E=cc.sequence(v,C,T,G,b);h.push(E)}}if(h.length>0){var P=cc.spawn(h);e.runAction(P)}}},create_effect:function(t){var e=this;this.skel_boss_fire_effect=t.addComponent(sp.Skeleton),cc.loader.loadRes("skel/skel_boss_fire_effect/skel_boss_fire_effect",sp.SkeletonData,function(t,i){t||(e.skel_boss_fire_effect.skeletonData=i,e.skel_boss_fire_effect.premultipliedAlpha=!1,e.skel_boss_fire_effect.setAnimation(0,"idle",!1))})},create_die_effect:function(t,e){var i=t.addComponent(sp.Skeleton);cc.loader.loadRes("skel/skel_boss_fire_die/skel_boss_fire_die",sp.SkeletonData,function(o,n){o||(i.skeletonData=n,i.premultipliedAlpha=!1,i.setAnimation(0,"show",!1),i.setCompleteListener(function(i,o){"show"==(i.animation?i.animation.name:"")&&(t.destroy(),e&&e())}),l.GAudio.playSound(l.Enum_Audio.bossFireBomb))})},adjust_follow:function(){this.head_follow&&this.head_follow.setPosition(0,-(this.height_body-.5*this.node_head.height+20)*this.height_factor)},adjust_shadow:function(){if(!this.isDead){var t=this.head_follow.getPosition(),e=this.head_p_parent.getPosition(),i=this.head_parent.getPosition(),o=this.node_head.getPosition(),n=cc.v2(0,-this.node_head.height),s=t.add(e).add(i).add(o).add(n);if(this.node_shadow_close){var a=s.add(cc.v2(20,-80));this.node_shadow_close.setPosition(a),this.node_shadow_close.angle=this.head_p_parent.angle}if(this.node_shadow_open){var c=s.add(cc.v2(20,-140));this.node_shadow_open.setPosition(c),this.node_shadow_open.angle=this.head_p_parent.angle}}},set_mouth_state:function(t,e,i){void 0===i&&(i=!0),i&&(this.node_mouth_open.stopAllActions(),this.node_mouth_close.stopAllActions());var o=t?255:0,n=t?0:255;this.node_mouth_close.opacity=n,this.node_mouth_open.opacity=o,this.node_mouth_open.scaleY=e,this.node_shadow_open.opacity=o,this.node_shadow_close.opacity=n},change_state:function(t,e){var i=this;if(void 0===e&&(e=null),!this.isDead&&this.cur_state!=t){var n=this;this.cur_state=t;var s=a.GConfig.actionFrameTime;switch(t){case o.Enum_BFState.None:break;case o.Enum_BFState.In:this.set_mouth_state(!1,1);for(var c=[this.node_hand_l,this.node_hand_r,this.center_parent],r=[this.pos_hand_l,this.pos_hand_r,cc.v2(0,0)],h=[this.data.il,this.data.ir,this.data.ih],d=[!1,!1,!0],u=0;u<c.length;u++){var m=[],p=cc.delayTime(h[u]);m.push(p);var f=cc.moveTo(21*s,r[u].add(cc.v2(0,-8)));m.push(f);var _=cc.moveTo(9*s,r[u]);if(m.push(_),d[u]){this.scheduleOnce(function(){l.GAudio.playSound(l.Enum_Audio.bossFireIn)},h[u]);var y=cc.callFunc(function(){n.enterCall&&n.enterCall(n),n.change_state(o.Enum_BFState.Normal)});m.push(y)}var g=cc.sequence(m);c[u].runAction(g)}break;case o.Enum_BFState.Normal:this.node_eyes.stopAllActions(),this.node_eyes.opacity=0,this.set_mouth_state(!1,1),this.node_body.stopAllActions();var v=cc.scaleTo(18*s,1,1.2),C=cc.scaleTo(31*s,1,1),S=(g=cc.sequence(v,C),cc.repeatForever(g));this.node_body.runAction(S),this.skel_boss_fire_effect.setAnimation(0,"idle",!1);break;case o.Enum_BFState.Charge:l.GAudio.playSound(l.Enum_Audio.bossFireCharge),this.node_eyes.stopAllActions();var D=cc.fadeTo(5*s,80),T=cc.fadeTo(11*s,255),G=cc.sequence(D,T),A=cc.repeatForever(G);this.node_eyes.runAction(A),this.set_mouth_state(!0,.92),this.node_mouth_open.stopAllActions();var w=cc.scaleTo(3*s,1,1.04);this.node_mouth_open.runAction(w),this.node_mouth_close.stopAllActions();var b=cc.delayTime(26*s),E=cc.callFunc(function(){n.set_mouth_state(!1,1,!1),n.skel_boss_fire_effect.setAnimation(0,"idle",!1)}),P=cc.sequence(b,E);this.node_mouth_close.runAction(P);var N=32*s;this.head_parent.stopAllActions();var k=cc.scaleTo(N,1.04,1),F=cc.moveTo(N,cc.v2(0,this.height_body)),V=cc.spawn(k,F);this.head_parent.runAction(V),this.node_body.stopAllActions(),v=cc.scaleTo(N,1,1),y=cc.callFunc(function(){n.change_state(o.Enum_BFState.Attack,e)}),g=cc.sequence(v,y),this.node_body.runAction(g),this.skel_boss_fire_effect.setAnimation(0,"play1",!0);break;case o.Enum_BFState.Attack:this.set_mouth_state(!1,1);var x=cc.delayTime(6*s),I=cc.callFunc(function(){i.set_mouth_state(!0,.92,!1),l.GAudio.playSound(l.Enum_Audio.bossFireAttack),i.skel_boss_fire_effect.setAnimation(0,"play2",!1),i.addEnemys(e)}),R=cc.scaleTo(7*s,1,1.04),B=cc.scaleTo(10*s,1,1),M=cc.scaleTo(16*s,1,1.04),L=cc.delayTime(3*s),O=e<this.list_enemys_last.length?this.list_enemys_last[e]:0,W=cc.delayTime(O),Y=cc.callFunc(function(){n.set_mouth_state(!1,1,!1),n.skel_boss_fire_effect.setAnimation(0,"idle",!1),n.action_hands(n.data.lhands,n.node_hand_l,n.pos_hand_l,1),n.action_hands(n.data.rhands,n.node_hand_r,n.pos_hand_r,-1)}),K=cc.sequence(x,I,R,B,M,L,W,Y);this.node_mouth_open.runAction(K),this.head_parent.stopAllActions(),k=cc.scaleTo(6*s,1.04,1),F=cc.moveTo(6*s,cc.v2(0,-4)),V=cc.spawn(k,F);var H=cc.scaleTo(5*s,1,1),U=cc.moveTo(5*s,cc.v2(-6,-25)),z=cc.spawn(H,U),q=cc.scaleTo(24*s,1,1),X=cc.moveTo(24*s,cc.v2(-21,-17)),j=cc.spawn(q,X),Z=cc.scaleTo(15*s,1,1),J=cc.moveTo(15*s,cc.v2(0,25)),Q=cc.spawn(Z,J),$=cc.scaleTo(13*s,1,1),tt=cc.moveTo(13*s,cc.v2(0,0)),et=cc.spawn($,tt),it=(y=cc.callFunc(function(){n.change_state(o.Enum_BFState.Normal)}),cc.sequence(V,z,j,Q,et,y));this.head_parent.runAction(it),this.node_body.stopAllActions(),v=cc.scaleTo(11*s,1,1.2),C=cc.scaleTo(52*s,1,1),g=cc.sequence(v,C),this.node_body.runAction(g)}}},addEnemys:function(t){var e=this,i=this.dic_enemys[t],o=this.node_head.convertToWorldSpaceAR(cc.v2(0,0));this.pos_enemy=this.node.convertToNodeSpaceAR(o).add(cc.v2(0,-this.node_head.height-200));for(var n=this.node.position.add(this.pos_enemy),a=function(t){var o=i[t].split("*");if(4==o.length){var a=parseInt(o[0]),r=parseFloat(o[1]),l=parseFloat(o[2]),h=parseFloat(o[3]);h=h<0?0:h,c.scheduleOnce(function(){e.isDead||s.GValue.EntityWorld.addEntitySys.addBossFireEnemys(a,cc.v2(r,l),n)},h)}},c=this,r=0;r<i.length;r++)a(r)},setCanAttack:function(t){this.can_attack=t},updateGameLogic:function(t){if(this.node_body&&(this.height_factor=this.node_body.scaleY,this.adjust_follow()),this.adjust_shadow(),this.can_attack){this.cur_index_enemy>=this.list_enemys_time.length&&(this.cur_index_enemy=0);var e=this.list_enemys_time[this.cur_index_enemy];this.cur_time_enemy+=t,this.cur_time_enemy>=e&&(this.change_state(o.Enum_BFState.Charge,this.cur_index_enemy),this.cur_time_enemy=0,this.cur_index_enemy++)}},set_color:function(){if(this.can_attack){this.shineDead&&(this.color_cur=this.color_attack);var t=this.color_normal;this.color_times=this.color_times%2,0!=this.color_times&&(t=this.color_cur,this.color_cur=this.color_normal),this.color_times++,this.change_color(t)}},change_color:function(t){this.node_head.color=t,this.node_body.color=t,this.node_mouth_close.color=t,this.node_mouth_open.color=t,this.node_hand_l.color=t,this.node_hand_r.color=t,this.bloodNum&&(this._bloodNum.color=t)},change_eyeshine_color:function(t){for(var e=0;e<this.node_eyes.children.length;e++)this.node_eyes.children[e].color=t},attack:function(t,e){if(l.GAudio.playEnemyHurtSound(),this.bloodChange(-e),this.com_attacked_effect){var i=cc.v2(0,0),o=s.GValue.EntityWorld.player.radius,n=s.GValue.EntityWorld.player.node.convertToWorldSpaceAR(cc.v2(0,0)),a=this.com_attacked_effect.node.convertToNodeSpaceAR(n),c=a.mag();if(c>0){var r=(c-o)/c;i=cc.v2(a.x*r,a.y*r)}this.com_attacked_effect.hit(i,0,1),this.com_attacked_effect.hurt(cc.v2(0,0),this.color_effect)}this.color_cur=this.color_attack},laserAttack:function(t,e){this.bloodChange(-t),this.com_attacked_effect&&this.com_attacked_effect.laserHurt(cc.v2(0,0),e,this.color_effect)},bloodChange:function(t){this.curBlood+=t,this.curBlood<=0&&(this.curBlood=0,this.die()),this._bloodNum&&this._bloodNum.setString(n.GFunc.getNumK(Math.ceil(this.curBlood)))},die:function(){this.isDead||(this.isDead=!0,s.GValue.EntityWorld.bossDie(this.node),this.bloodNum.destroy(),this.bloodNum=null,l.GAudio.playSound(l.Enum_Audio.bossFireDie),this.node_shadow_close.destroy(),this.node_shadow_open.destroy(),this.effect_die())},effect_die:function(){var t=this,e=this,i=a.GConfig.actionFrameTime,o=6*i;this.shineDead=!0,this.data.gold>0&&s.GValue.EntityWorld.playGoldFlyEffect(1,this.data.gold,this.node_head.convertToWorldSpaceAR(cc.v2(0,0))),s.GValue.EntityWorld.setTouching(!0),s.GValue.EntityWorld.touchAvaliable=!1,this.skel_boss_fire_effect.node.destroy(),s.GValue.GameUI.showStoneDrop(),this.scheduleOnce(function(){s.GValue.GameUI.showStoneDrop()},.5),s.GValue.EntityWorld.shakeTimes(30),this.head_parent.stopAllActions();var n=cc.scaleTo(o,1,1),c=cc.moveTo(o,cc.v2(0,0)),r=cc.spawn(n,c),l=cc.callFunc(function(){e.head_parent.stopAllActions();var o=cc.moveTo(14*i,cc.v2(-70,6)),n=cc.rotateTo(14*i,7),a=cc.spawn(o,n),c=cc.moveTo(18*i,cc.v2(22,91)),r=cc.scaleTo(18*i,1.2),l=cc.rotateTo(18*i,0),d=cc.spawn(c,r,l),u=cc.moveTo(13*i,cc.v2(15,71)),m=cc.scaleTo(13*i,1),p=cc.rotateTo(13*i,-2),f=cc.spawn(u,m,p),_=cc.callFunc(function(){e.shineDead=!1,e.node_eyes.stopAllActions(),e.change_eyeshine_color(cc.Color.BLACK),s.GValue.EntityWorld.shakeTimes(12)}),y=cc.moveTo(4*i,cc.v2(39,39)),g=cc.scaleTo(4*i,.78),v=cc.rotateTo(4*i,0),C=cc.spawn(y,g,v),S=cc.moveTo(4*i,cc.v2(24,32)),D=cc.scaleTo(4*i,.85),T=cc.rotateTo(4*i,2.8),G=cc.spawn(S,D,T),A=cc.callFunc(function(){var i=cc.color(150,150,150,150);t.color_normal=i,e.change_color(i),e.change_eyeshine_color(cc.Color.BLACK),e.set_mouth_state(!0,.92)}),w=cc.delayTime(3*i),b=cc.callFunc(function(){var o=new cc.Node;o.setPosition(0,-300),e.node_head.addChild(o),e.create_die_effect(o,function(){for(var o=t.com_attacked_effect.node.getPosition(),n=[cc.v2(-50,50),cc.v2(50,-50),cc.v2(0,0)],a=[1,.5,1.2],c=[0,.1,.4],r=n.length,l=function(i){var l=cc.instantiate(s.GValue.pf_enemy_effect);l.scale=a[i],l.setPosition(o.add(n[i])),t.head_follow.addChild(l);var d=l.getComponent(h.CEnemyEffect);d.init(t),e.scheduleOnce(function(){d.die(0,cc.color(230,70,50),null,i==r-1)},c[i])},d=0;d<r;d++)l(d);var u=cc.fadeTo(20*i,0);e.head_parent.runAction(u),e.node_body.runAction(u.clone()),e.node_hand_l.runAction(u.clone()),e.node_hand_r.runAction(u.clone()),e.scheduleOnce(function(){e.node.destroy(),delete s.GValue.EntityWorld.FireEnemys[e.data.id]},1)})}),E=cc.sequence(a,d,f,_,C,G,A,w,b);e.head_parent.runAction(E)}),d=cc.sequence(r,l);this.head_parent.runAction(d),e.set_mouth_state(!0,1),this.node_mouth_open.stopAllActions();var u=cc.scaleTo(7*i,1,1.04),m=cc.scaleTo(10*i,1,1),p=cc.sequence(u,m),f=cc.repeat(p,4);this.node_mouth_open.runAction(f),this.node_body.stopAllActions();var _=cc.scaleTo(o,1,1.2);this.node_body.runAction(_),this.node_hand_l.stopAllActions();var y=cc.scaleTo(6*i,1,1),g=cc.moveTo(6*i,this.pos_hand_l),v=cc.spawn(y,g);this.node_hand_l.runAction(v),this.node_hand_r.stopAllActions();var C=cc.scaleTo(6*i,-1,1),S=cc.moveTo(6*i,this.pos_hand_r),D=cc.spawn(C,S);this.node_hand_r.runAction(D)}}),cc._RF.pop()},{CEnemyEffect:"CEnemyEffect",CommonAudio:"CommonAudio",CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonValue:"CommonValue",EnemyBase:"EnemyBase",PfNum:"PfNum",Types:"Types"}],CEntityBoss:[function(t,e,i){"use strict";cc._RF.push(e,"e5795XAfoVFNrxziqzw43vG","CEntityBoss");var o=t("CommonEnum"),n=t("CommonValue"),s=t("CommonAudio");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.pdata=null,this.target=null,this.parent=null,this.show=null,this.collider_p=null,this.radius_p=0,this.isInTarget=!0,this.isDead=!1,this.enterCall=null,this.updateCall=null,this.beginCall=null,this.attackCall=null,this.list_collider=[],this.shineDead=!1,this.shineId=-1,this.dic_shine_node={},this.dic_shine_pfnum={},this.color_normal=cc.color(255,255,255),this.color_attack=cc.color(236,128,37),this.color_cur=cc.color(255,255,255),this.color_times=0},init_parent:function(t,e,i,o,n){this.pdata=t,this.enterCall=e,this.beginCall=i,this.updateCall=o,this.attackCall=n,this.create_parent(),this.addDataDicBossEnemy(this)},create_parent:function(){this.target=new cc.Node,this.target.group="enemy",this.node.addChild(this.target),this.collider_p=this.target.addComponent(cc.CircleCollider),this.collider_p.radius=this.radius_p,this.collider_p.tag=o.E_CTag.Boss_Parent,this.parent=new cc.Node,this.target.addChild(this.parent),this.parent.setPosition(this.pdata.in_pos),this.show=new cc.Node,this.parent.addChild(this.show)},moveTo_target:function(){var t=this,e=cc.moveTo(this.pdata.in_time,cc.v2(0,0)),i=cc.callFunc(function(){t.enterCall&&t.enterCall(t)}),o=cc.sequence(e,i);this.parent.runAction(o)},setIsInTarget:function(t){this.isInTarget=t},setBossBegin:function(){var t=this;this.setIsInTarget(!1),this.beginCall&&this.beginCall(),this.schedule(function(){t.set_color()},.1,cc.macro.REPEAT_FOREVER)},updateGameLogic:function(t){this.isDead||this.isInTarget||this.updateCall&&this.updateCall(t)},addListShineNode:function(t,e){var i=this.dic_shine_node[t];i?i.push(e):(i=[e],this.dic_shine_node[t]=i)},addListShinePfnum:function(t,e){var i=this.dic_shine_pfnum[t];i?i.push(e):(i=[e],this.dic_shine_pfnum[t]=i)},setShineId:function(t){this.shineId=t},set_color:function(){this.shineDead&&(this.color_cur=this.color_attack);var t=this.color_normal;this.color_times=this.color_times%2,0!=this.color_times&&(t=this.color_cur,this.color_cur=this.color_normal),this.color_times++,this.change_color(t)},change_color:function(t){for(var e in this.dic_shine_node){var i=parseInt(e);if(-1==this.shineId||this.shineId==i)for(var o=this.dic_shine_node[e],n=0;n<o.length;n++){var s=o[n];s&&""!=s.name&&(s.color=t)}}for(var e in this.dic_shine_pfnum)if(i=parseInt(e),-1==this.shineId||this.shineId==i)for(o=this.dic_shine_pfnum[e],n=0;n<o.length;n++){var a=o[n];a&&a.color&&(a.color=t)}},attack:function(t,e,i){!this.isDead&&this.attackCall&&(s.GAudio.playEnemyHurtSound(),this.attackCall(t,e,i),this.color_cur=this.color_attack)},getListDWLasterTarget:function(){return this.isDead,[]},addGold:function(t,e){n.GValue.EntityWorld.playGoldFlyEffect(2,e,t)},isPlayerDie:function(t,e,i){var o=!1;if(this.isDead)return o;if(!this.list_collider)return o;for(var n=0;n<this.list_collider.length;n++){var s=this.list_collider[n];if(this.isPlayerCollide(s,t,e,i)){o=!0;break}}return o},isPlayerCollide:function(t,e,i,o){var n=!1;if(t.node){var s=t.radius+o,a=cc.rect(i.x-s,i.y-s,2*s,2*s),c=t.node.convertToWorldSpaceAR(cc.v2(0,0));c=e.convertToNodeSpaceAR(c),a.contains(c)&&i.sub(c).mag()<=s&&(n=!0)}return n},addListCollider:function(t){for(var e=!1,i=0;i<this.list_collider.length;i++)if(t==this.list_collider[i]){e=!0;break}e||this.list_collider.push(t)},removeListCollider:function(t){for(var e=0;e<this.list_collider.length;e++)if(t==this.list_collider[e]){this.list_collider.splice(e,1);break}},addDataDicBossEnemy:function(t){var e=this.pdata.type,i=this.pdata.id;n.GValue.DicBossEnemy[e]||(n.GValue.DicBossEnemy[e]={}),n.GValue.DicBossEnemy[e][i]=t},removeDataDicBossEnemy:function(){var t=this.pdata.type,e=this.pdata.id;n.GValue.DicBossEnemy[t]&&delete n.GValue.DicBossEnemy[t][e]}}),cc._RF.pop()},{CommonAudio:"CommonAudio",CommonEnum:"CommonEnum",CommonValue:"CommonValue"}],CEntityFollowPlayer:[function(t,e,i){"use strict";cc._RF.push(e,"6ceb3nNRjVPxK5j18pjVXUm","CEntityFollowPlayer");var o=t("CEntityBase"),n=t("Tools"),s=t("CEntityKnife"),a=t("CommonConfig");cc.Class({extends:o,properties:{},ctor:function(){this.player=null,this.knivesCmp=null,this.knifeCollisionSoundCtrl=null,this.heroRotate=null},init:function(t,e){void 0===e&&(e=!0),this.player=t,n.DYTools.addScript(this.node,"CMoveWithOwnerNode").init(this.node.parent,this,this.player),this.knivesCmp=n.DYTools.addScript(this.node,"CPlayerKnivesComponent"),this.knivesCmp.init(t,e),this.heroRotate=n.DYTools.addScript(this.node,"CHRotate")},die:function(){this.node.active=!1;for(var t=0,e=this.knivesCmp.knives;t<e.length;t++)e[t].getComponent(s).shadow.active=!1},revive:function(){this.node.active=!0;for(var t=0,e=this.knivesCmp.knives;t<e.length;t++)e[t].getComponent(s).shadow.active=!0;this.node.scale=.6;var i=cc.scaleTo(4*a.GConfig.actionFrameTime,1.2),o=cc.scaleTo(9*a.GConfig.actionFrameTime,1);this.node.runAction(cc.sequence(i,o))},setShadowOpacity:function(t){for(var e=0,i=this.knivesCmp.knives;e<i.length;e++)i[e].getComponent(s).shadow.opacity=t},updateGameLogic:function(t){this.heroRotate.updateGameLogic(t)}}),cc._RF.pop()},{CEntityBase:"CEntityBase",CEntityKnife:"CEntityKnife",CommonConfig:"CommonConfig",Tools:"Tools"}],CEntityKnife:[function(t,e,i){"use strict";cc._RF.push(e,"2664a8OYHZJb6dfN9xI9O6t","CEntityKnife");var o=t("CEntityBase"),n=t("Tools"),s=t("Types"),a=t("CommonValue"),c=t("KnifeDropCollisionWallListener"),r=t("KnifeThrowCtrl"),l=t("CommonConfig");cc.Class({extends:o,properties:{attackNode:cc.Node,landNode:cc.Node,rivalNode:cc.Node,skinNode:cc.Node},ctor:function(){this.itemNode=null,this.nodeCollider=null,this.knifeColliderListener=null,this.knifeMoveCtrl=null,this.knifeParentCtrl=null,this.knifeColliderNodeCtrl=null,this.knifeSkinCtrl=null,this.knifePickCollider=null,this.knifeStateComp=null,this.shadow=null,this.bossDiscarded=!1,this._dropMoveFix=null,this._dropType=0},init:function(t,e,i){void 0===i&&(i=!0),this.itemNode=e,this.teamID=t,this.bossDiscarded=!1,i||(this.skinNode.scaleX=-1),this.nodeCollider=n.DYTools.addScript(this.attackNode,"CNodeCollider"),this.nodeCollider.init(this.node,!0,!0),n.DYTools.addScript(this.landNode,"CNodeCollider").init(this.node,!0),n.DYTools.addScript(this.rivalNode,"CNodeCollider").init(this.node,!0),this.node.on("changeTag",this.changeColliderTag,this),this.node.on("changeKnifeAttackGroup",this.changeKnifeAttackGroup,this),this.node.on("attackLight",this.playAttackLight,this),this.addComponent(),this.knifeColliderListener=n.DYTools.addScript(this.node,"CKnifeColliderListener"),this.knifeMoveCtrl=n.DYTools.addScript(this.node,"CKnifeMoveCtrl"),this.knifeMoveCtrl.init(this,i),this.knifeParentCtrl=n.DYTools.addScript(this.node,"CKnifeParentCtrl"),this.knifeParentCtrl.init(this,this.itemNode),this.knifeColliderNodeCtrl=n.DYTools.addScript(this.node,"CKnifeColliderNodeCtrl"),this.knifeColliderNodeCtrl.init(this.attackNode,this.rivalNode,i),this.knifeSkinCtrl=n.DYTools.addScript(this.skinNode,"CKnifeSkinCtrl"),this.knifeSkinCtrl.init(),this.changeColliderTag(t)},setShadow:function(t){this.shadow=t},changeShadowImage:function(t){this.shadow&&(this.shadow.addComponent(cc.Sprite).spriteFrame=a.GValue.Atlas_Shadow.getSpriteFrame(t))},addComponent:function(){n.DYTools.addScript(this.node,"CKnifeCountComponent"),this.knifeStateComp=n.DYTools.addScript(this.node,"CKnifeStateComponent"),n.DYTools.addScript(this.node,"CKnifeOwnerComponent")},changeSkin:function(t){this.skinNode.getComponent(cc.Sprite).spriteFrame=a.GValue.Atlas_Game.getSpriteFrame(t)},changeColliderTag:function(t){this.teamID=t;for(var e=0,i=this.node.getComponentsInChildren(cc.Collider);e<i.length;e++)i[e].tag=t},changeKnifeAttackGroup:function(t){this.nodeCollider.changeNodeGroup(t)},playAttackLight:function(){},updateGameLogic:function(t){this._dropMoveFix?this._dropMoveFix.updateGameLogic(t):(this.knifeParentCtrl.updateLogic(t),this.knifeMoveCtrl.updateLogic(t),this.knifeColliderNodeCtrl.updateLogic(t),this.knifeSkinCtrl.updateLogic(t),this.node.emit("resetDirty"))},initDrop:function(t,e,i,o){void 0===e&&(e=0),void 0===i&&(i=800),void 0===o&&(o=!0),this._dropType=e,o&&n.DYTools.addScript(this.landNode,"KnifeDropCollisionWallListener"),this._dropMoveFix=n.DYTools.addScript(this.node,"KnifeThrowCtrl"),this._dropMoveFix.init(this,i,t,o),this.initDropUI(),this.node.on("dropOver",this.dropOver,this)},dropOver:function(){if(this.teamID==-s.EntityTag.Player)this.addNewKnife();else if(this.teamID==-s.EntityTag.Enemy){if(0==this._dropType)this.addNewKnife();else if(1==this._dropType&&!this.bossDiscarded)for(var t=0,e=a.GValue.EntityWorld.addEntitySys.addDWKnife(1,s.DWType.Knife);t<e.length;t++){var i=e[t];i.node.position=this.node.position,i.node.angle=this.node.angle+90,a.GValue.EntityWorld.addKnife(i),i.node.parent=this.itemNode,a.GValue.EntityWorld.player.addKnifeIn(i.node)}}else this.addNewKnife();this.removeSelf()},addNewKnife:function(){for(var t=0,e=a.GValue.EntityWorld.addEntitySys.AddKnife(1,0);t<e.length;t++){var i=e[t];i.initDropUI(),a.GValue.EntityWorld.addKnife(i),a.GValue.EntityWorld.landKnifes.push(i),i.node.emit("changeKnifeAttackGroup","landKnife"),i.node.position=this.node.position,i.node.angle=this.node.angle,i.skinNode.emit("changeSkin",a.GValue.EntityWorld.player.knifeImage)}},removeSelf:function(){a.GValue.EntityWorld.removeKnife(this),this.node.removeFromParent(),this.shadow&&this.shadow.removeFromParent()},initDropUI:function(t){void 0===t&&(t=!0);var e=l.GConfig.getPropertyData_Main().imageId,i=new cc.Node;if(i.name="light",this.node.addChild(i,-1),i.addComponent(cc.Sprite).spriteFrame=a.GValue.Atlas_Game.getSpriteFrame("kl"+e),t){var o=l.GConfig.actionFrameTime,n=cc.fadeIn(2*o),s=cc.fadeOut(4*o),c=cc.scaleTo(4*o,1.2),r=cc.spawn(s,c),h=cc.delayTime(3*o),d=cc.sequence(n,r,h,cc.scaleTo(0,1));i.runAction(cc.repeatForever(d))}},removeDropUI:function(){var t=this.node.getChildByName("light");t&&t.removeFromParent(),this.landNode.removeComponent(c),this.node.removeComponent(r)}}),cc._RF.pop()},{CEntityBase:"CEntityBase",CommonConfig:"CommonConfig",CommonValue:"CommonValue",KnifeDropCollisionWallListener:"KnifeDropCollisionWallListener",KnifeThrowCtrl:"KnifeThrowCtrl",Tools:"Tools",Types:"Types"}],CEntityPlayer:[function(t,e,i){"use strict";cc._RF.push(e,"a7314Yi/D1Hrrk3IgD2XfpV","CEntityPlayer");var o=t("Tools"),n=t("CEntityBase"),s=t("GameData"),a=t("CommonConfig"),c=t("CommonValue"),r=t("Types"),l=t("CEntityKnife"),h=t("CommonEnum"),d=t("CommonAudio"),u=t("PlayerAnimComponent");cc.Class({extends:n,properties:{uiNode:cc.Node,skinSpr:cc.Sprite,colliderNode:cc.Node,touchNode:cc.Node,lightNode1:cc.Node,lightNode2:cc.Node,skel_die:sp.Skeleton,skel_revive:sp.Skeleton},ctor:function(){var t=this;this.mainWeaponSkinId=1,this.radius=0,this.radiusIn=0,this.firstDead=!1,this.waitToDie=!1,this.isDead=!1,this.initRSpeed=0,this.initRadius=0,this.initDWAtk=0,this.dwParam=[],this.knifeImage="",this.curAttack=1,this.curDWAtk=1,this.curRSpeed=0,this.invincible=!1,this.invincibleTime=0,this.shadow=null,this.CMoveFix=null,this.moveTouch=null,this.animCom=null,this.followPlayerOut=null,this.logicPlayer=null,this.stateCom=null,this.pickupCom=null,this.colEnemyCom=null,Object.defineProperty(this,"touchAble",{get:function(){return t.moveTouch.touchAble},set:function(e){t.moveTouch.touchAble=e},enumerable:!0,configurable:!0}),Object.defineProperty(this,"touching",{set:function(e){t.moveTouch.touching=e,t.moveTouch.touchFalseTime=0},enumerable:!0,configurable:!0})},onLoad:function(){var t=this;this.skel_die.setCompleteListener(function(e,i){t.node.active=!1,c.GValue.EntityWorld.isReviveAble()?c.GValue.EntityWorld.addPanelRevive(function(){c.GValue.EntityWorld.addPanelOver(!1)},function(){t.revive()}):c.GValue.EntityWorld.addPanelOver(!1)}),this.skel_revive.setCompleteListener(function(e,i){t.skel_revive.node.active=!1})},init:function(t,e,i,n){this.followPlayerOut=t,this.followPlayerIn=e,this.teamID=r.EntityTag.Player,this.shadow=n,this.skinSpr.spriteFrame=c.GValue.Atlas_Game.getSpriteFrame("h"+i),this.animCom=o.DYTools.addScript(this.node,u),this.animCom.init(this.uiNode),this.pickupCom=o.DYTools.addScript(this.node,"PlayerPickupComponent"),this.pickupCom.init(this),this.colEnemyCom=o.DYTools.addScript(this.node,"PlayerCollisionEnemyComponent"),this.colEnemyCom.init(this),o.DYTools.addScript(this.colliderNode,"CNodeCollider").init(this.node,!0),o.DYTools.addScript(this.colliderNode,"CHeroCollisionWallListener"),this.logicPlayer=o.DYTools.addScript(this.node,"CLogicPlayer"),this.logicPlayer.init(this),this.stateCom=o.DYTools.addScript(this.node,"PlayerStateComponent"),this.stateCom.init(this),this.CMoveFix=o.DYTools.addScript(this.node,"CHMoveFix"),this.initAnim(),this.resetAttr(),this.node.on("addKnife",this.addKnife,this),this.node.on("die",this.dieByEnemy,this),this.node.on("dieByKnife",this.dieByKnife,this),this.node.on("radiusChange",this.radiusChange,this),this.node.on("updateState",this.updateState,this)},resetAttr:function(){this.stateCom.init(this);var t=s.TData.getCurSubFun();this.initAttack=a.GConfig.getPropertyData_Main().atk,this.initRSpeed=s.TData.HeroRotateSpeed;var e;(e=c.GValue.ArmsSub_TryFinish>0&&t==c.GValue.ArmsSub_TryFinish?a.GConfig.getPropertyArmsSubData(t,c.GValue.EntityWorld.levelData.subTryLv):a.GConfig.getPropertyData_Sub(t))&&(this.initDWAtk=e.atk),this.curAttack=this.initAttack,this.curRSpeed=this.initRSpeed,this.curDWAtk=this.initDWAtk,this.mainWeaponSkinId=a.GConfig.getPropertyData_Main().imageId,this.knifeImage="k"+this.mainWeaponSkinId,this.radiusIn=s.TData.HeroRaduisIn,this.radiusChange(o.DYTools.getRadiusByKnifeCount(this.followPlayerOut.knivesCmp.knives.length));for(var i=0,n=this.node.getComponentsInChildren(cc.Collider);i<n.length;i++)n[i].tag=this.teamID;this.updateState(r.HeroState.Normal)},initAnim:function(){var t=a.GConfig.actionFrameTime;this.skinSpr.node.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(7*t,1.02,.96),cc.scaleTo(8*t,1))))},revive:function(){c.GValue.EntityWorld.reviveCount++,this.moveTouch.init(this),this.node.active=!0,this.uiNode.active=!0,this.skel_die.node.active=!1,this.shadow.active=!0,this.uiNode.active=!0,this.uiNode.position=cc.v2(0,0),this.uiNode.opacity=255,this.invincible=!0,this.invincibleTime=0;var t=a.GConfig.actionFrameTime;this.uiNode.scale=.7;var e=cc.scaleTo(4*t,1.4),i=cc.scaleTo(5*t,1);this.uiNode.runAction(cc.sequence(e,i));var o=this;this.scheduleOnce(function(){o.followPlayerOut.revive(),o.followPlayerIn.revive(),o.updateState(o.stateCom.state);var t=cc.repeatForever(cc.sequence(cc.fadeTo(.08,10),cc.fadeTo(.08,255)));t.setTag(1001),o.skinSpr.node.runAction(t)},15*a.GConfig.actionFrameTime),d.GAudio.playSound(d.Enum_Audio.revive),this.skel_revive.node.active=!0,this.skel_revive.setAnimation(0,"play",!1),this.scheduleOnce(function(){o.fickEnemys()},8*a.GConfig.actionFrameTime)},fickEnemys:function(){for(var t=this,e=0,i=this.radius+250,n=i*i,s=cc.v2(i,0),l=this.getPositionForMap(),d=Number(a.GConfig.getGbData(h.Enum_Gb.ReviveAtk))*this.initAttack,u=[],m=0,p=c.GValue.EntityWorld.Enemys;m<p.length;m++){var f=(S=p[m]).node.position;if(!S.isBoss&&o.DYTools.isNumberDiffRange(f.x,l.x,i)&&o.DYTools.isNumberDiffRange(f.y,l.y,i)&&l.sub(f).magSqr()<=n){if(!S.hasAttribution(r.EnemyAttr.Enter)){var _=f.sub(l).signAngle(s),y=s.rotate(-_),g=(y=y.add(l)).sub(S.node.position);S.node.runAction(cc.moveBy(.37,g))}e=.4,u.push(S)}}for(var v=0,C=u;v<C.length;v++){var S;(S=C[v]).bloodChange(-d)}this.scheduleOnce(function(){t.isDead=!1},e)},startGame:function(t){void 0===t&&(t=null),this.resetAttr(),this.followPlayerOut.node.emit("startGame"),this.followPlayerIn.node.emit("startGame"),this.moveTouch=o.DYTools.addScript(this.touchNode,"CMoveByTouch"),this.moveTouch.init(this,t),this.CMoveFix.init(this.colliderNode.getComponent(cc.Collider));var e=a.GConfig.getPropertyData_Sub(s.TData.getCurSubFun());if(e){var i=e.var;this.dwParam=o.DYTools.stringToNumber(i,a.GConfig.SeparatorII)}},updateGameLogic:function(t){this.logicPlayer.updateLogic(t),this.CMoveFix&&this.CMoveFix.updateGameLogic(t),this.isDead||this.followPlayerIn.updateGameLogic(t),this.followPlayerOut.updateGameLogic(t),this.pickupCom.updateGameLoginc(t),this.colEnemyCom.updateGameLogic(t),this.stateCom.updateGameLogic(t),this.invincible&&(this.invincibleTime+=t,this.invincibleTime>=5&&(this.invincible=!1,this.skinSpr.node.stopActionByTag(1001),this.skinSpr.node.opacity=255)),c.GValue.EntityWorld.m_gameOver&&c.GValue.PropMgr.clear()},addKnifeIn:function(t){this.followPlayerIn.addKnife(t)},addKnife:function(t){this.followPlayerOut.knivesCmp.addKnife(t);var e=c.GValue.EntityWorld.addEntitySys.createMainKnifeShadow(t,this.mainWeaponSkinId);t.getComponent(l).setShadow(e)},radiusChange:function(t){this.radius!=t&&(this.radius=t,this.followPlayerOut.heroRotate.setRotateSpeed(s.TData.HeroRaduis*this.curRSpeed/this.radius))},updateState:function(t){switch(t){case r.HeroState.Normal:case r.HeroState.StrongIII:t==r.HeroState.StrongIII?(this.curRSpeed=this.initRSpeed*c.GValue.StrongRT,this.curAttack=this.initAttack*Number(a.GConfig.getGbData(h.Enum_Gb.StrongAtk)),this.curDWAtk=this.initDWAtk*Number(a.GConfig.getGbData(h.Enum_Gb.StrongAtk)),this.followPlayerOut.node.emit("enterStrong",1),this.followPlayerIn.node.emit("enterStrong",1),c.GValue.EntityWorld.gameUI.showPropProgress(r.PropType.Strong)):(this.followPlayerOut.node.emit("enterStrong",0),this.followPlayerIn.node.emit("enterStrong",0),t==r.HeroState.Normal&&(this.curRSpeed=this.initRSpeed,this.curAttack=this.initAttack,this.curDWAtk=this.initDWAtk)),this.followPlayerOut.knivesCmp.emitAllKnivesChangeSkin(),this.followPlayerOut.heroRotate.setRotateSpeed(s.TData.HeroRaduis*this.curRSpeed/this.radius);break;case r.HeroState.Dead:this.followPlayerOut.node.emit("enterStrong",0),this.followPlayerIn.node.emit("enterStrong",0)}},dieByEnemy:function(t){t.isDead||t.stateCom.state==r.EnemyAction.Sleep||t.stateCom.state==r.EnemyAction.Awaking||this.die()},dieBySnake:function(){this.die()},dieByKnife:function(t){this.die()},die:function(){if(!this.invincible&&!c.GValue.EntityWorld.m_gameOver&&!this.isDead){this.isDead=!0,c.GValue.EntityWorld.dieCount++,this.moveTouch&&(this.moveTouch.touchEndEvent(),this.touchAble=!1),c.GValue.EntityWorld.setTouching(!0),d.GAudio.stopSoundByName(d.Enum_Audio.laserAtk),d.GAudio.stopSoundByName(d.Enum_Audio.hurt);var t=this,e=a.GConfig.actionFrameTime;t.followPlayerOut.die(),t.followPlayerIn.die();var i=cc.scaleTo(2*e,1.15,1.05),o=cc.moveTo(2*e,cc.v2(3,6)),n=cc.fadeTo(2*e,216),s=cc.spawn(i,o,n),r=cc.scaleTo(1*e,1.22,1.08),l=cc.moveTo(1*e,cc.v2(0,0)),h=cc.fadeTo(1*e,204),u=cc.spawn(r,l,h),m=cc.scaleTo(2*e,1.37,1.14),p=cc.moveTo(2*e,cc.v2(3,6)),f=cc.fadeTo(2*e,173),_=cc.spawn(m,p,f),y=cc.scaleTo(1*e,1.45,1.17),g=cc.moveTo(1*e,cc.v2(0,0)),v=cc.fadeTo(1*e,153),C=cc.spawn(y,g,v),S=cc.scaleTo(2*e,1.5,1.46),D=cc.moveTo(2*e,cc.v2(3,6)),T=cc.fadeTo(2*e,186),G=cc.spawn(S,D,T),A=cc.scaleTo(1*e,1.53,1.61),w=cc.moveTo(1*e,cc.v2(0,0)),b=cc.fadeTo(1*e,204),E=cc.spawn(A,w,b),P=cc.scaleTo(2*e,1.5,1.8),N=cc.moveTo(2*e,cc.v2(3,6)),k=cc.fadeTo(2*e,255),F=cc.spawn(P,N,k),V=cc.sequence(s,u,_,C,G,E,F,cc.callFunc(function(){t.skel_die.node.active=!0,t.skel_die.setAnimation(0,"idle",!1),t.uiNode.active=!1,t.shadow.active=!1}));this.uiNode.runAction(V)}},pickupAllKnives:function(){this.pickupCom.pickupAllKnives()},playerOutUI:function(t){var e=this,i=a.GConfig.actionFrameTime,o=cc.scaleTo(4*i,0);this.followPlayerOut&&this.followPlayerOut.node.runAction(o),this.followPlayerIn&&this.followPlayerIn.node.runAction(o.clone()),this.scheduleOnce(function(){var t=cc.moveBy(4*i,cc.v2(0,-35)),o=cc.moveTo(7*i,cc.v2(e.node.x,c.GValue.Size_View.height/c.GValue.MapScale+100)),n=cc.sequence(t,o);e.node.runAction(n)},4*i),this.scheduleOnce(function(){var o=new cc.Node;o.name="tail",o.anchorY=1,o.position=cc.v2(0,-30),e.uiNode.addChild(o,10),o.addComponent(cc.Sprite).spriteFrame=c.GValue.Atlas_Game.getSpriteFrame("pTail");var n=cc.scaleTo(4*i,1,4.2),s=cc.scaleTo(2*i,1,.7),a=cc.sequence(n,s,cc.fadeOut(i),cc.callFunc(function(){t&&t()}));o.runAction(a)},9*i),d.GAudio.playSound(d.Enum_Audio.playerFly_1)},playerEnterGameAct:function(t,e){var i=this,o=a.GConfig.actionFrameTime,n=cc.callFunc(function(){t&&t();var n=cc.scaleTo(4*o,1);i.followPlayerOut&&i.followPlayerOut.node.runAction(cc.sequence(n,cc.callFunc(function(){e&&e()}))),i.followPlayerIn&&i.followPlayerIn.node.runAction(n.clone())});if(c.GValue.EntityWorld.mapMgr.curDirTag<=2){i.node.y=-100;var s=c.GValue.PlayerPosV,r=cc.moveTo(18*o,s).easing(cc.easeOut(4)),l=cc.sequence(r,n);i.node.runAction(l)}else{s=null,3==c.GValue.EntityWorld.mapMgr.curDirTag?(i.node.angle=-90,i.node.x=c.GValue.Size_View.width/c.GValue.MapScale+100,s=cc.v2(c.GValue.Size_View.width/c.GValue.MapScale-c.GValue.PlayerPosH.x,c.GValue.PlayerPosH.y)):(i.node.angle=90,i.node.x=-100,s=c.GValue.PlayerPosH),i.node.y=c.GValue.Size_View.height/c.GValue.MapScale/2,r=cc.moveTo(18*o,s).easing(cc.easeOut(4));var h=cc.sequence(r,cc.rotateTo(6*o,0),n);i.node.runAction(h)}var u=i.uiNode.getChildByName("tail");u.scaleY=3.1,u.opacity=255;var m=cc.delayTime(5*o),p=cc.scaleTo(6*o,1,.5),f=cc.sequence(m,p,cc.fadeOut(o),cc.removeSelf());u.runAction(f),d.GAudio.playSound(d.Enum_Audio.playerFly)},playOutMapAct:function(t){void 0===t&&(t=null);var e=this,i=a.GConfig.actionFrameTime,o=cc.scaleTo(5*i,0);this.followPlayerOut&&this.followPlayerOut.node.runAction(o),this.followPlayerIn&&this.followPlayerIn.node.runAction(o.clone()),this.scheduleOnce(function(){var t=null,o=e.node.position,n=0,s=cc.v2(0,0);c.GValue.EntityWorld.mapMgr.curDirTag<=2?(t=cc.v2(0,-35),s=cc.v2(c.GValue.ViewCenter.x/c.GValue.MapScale,c.GValue.Size_View.height/c.GValue.MapScale+100),e.node.y>.75*c.GValue.Size_View.height/c.GValue.MapScale&&(o.y=.75*c.GValue.Size_View.height/c.GValue.MapScale),o.x=s.x):(3==c.GValue.EntityWorld.mapMgr.curDirTag?(n=-90,t=cc.v2(35,0),s=cc.v2(-100,c.GValue.ViewCenter.y/c.GValue.MapScale),e.node.x<.25*c.GValue.Size_View.width/c.GValue.MapScale&&(o.x=.25*c.GValue.Size_View.width/c.GValue.MapScale)):(n=90,t=cc.v2(-35,0),s=cc.v2(c.GValue.Size_View.width/c.GValue.MapScale+100,c.GValue.ViewCenter.y/c.GValue.MapScale),e.node.x>.75*c.GValue.Size_View.width/c.GValue.MapScale&&(o.x=.75*c.GValue.Size_View.width/c.GValue.MapScale)),o.y=s.y);var a=o.add(t),r=cc.moveTo(5*i,a),l=cc.rotateTo(5*i,n),h=cc.spawn(r,l),d=cc.moveTo(a.sub(s).mag()/3e3,s),u=cc.sequence(h,d);e.node.runAction(u)},5*i),this.scheduleOnce(function(){var o=new cc.Node;o.name="tail",o.anchorY=1,o.position=cc.v2(0,-30),e.uiNode.addChild(o,10),o.addComponent(cc.Sprite).spriteFrame=c.GValue.Atlas_Game.getSpriteFrame("pTail");var n=cc.scaleTo(5*i,1,4.2),s=cc.scaleTo(3*i,1,.7),a=cc.sequence(n,s,cc.fadeOut(i),cc.callFunc(function(){t&&t()}));o.runAction(a)},10*i),d.GAudio.playSound(d.Enum_Audio.playerFly_1)},playMoveAct:function(t,e,i){var o=this,n=a.GConfig.actionFrameTime,s=cc.callFunc(function(){var t=cc.scaleTo(4*n,1);o.followPlayerOut&&o.followPlayerOut.node.runAction(cc.sequence(t,cc.callFunc(function(){i&&i()}))),o.followPlayerIn&&o.followPlayerIn.node.runAction(t.clone())});o.node.position=t,o.node.angle=0;var c=cc.moveTo(10*n,e).easing(cc.easeOut(4)),r=cc.sequence(c,cc.rotateTo(6*n,0),s);o.node.runAction(r);var l=o.uiNode.getChildByName("tail");l.scaleY=3.1,l.opacity=255;var h=cc.delayTime(3*n),u=cc.scaleTo(5*n,1,.5),m=cc.sequence(h,u,cc.fadeOut(n),cc.removeSelf());l.runAction(m),d.GAudio.playSound(d.Enum_Audio.playerFly)},playEleAct:function(t){this.animCom.playXuliAnim(t)},changeMainWeaponSkin:function(){var t=a.GConfig.getPropertyData_Main().imageId;if(this.mainWeaponSkinId!=t){this.mainWeaponSkinId=t,this.knifeImage="k"+this.mainWeaponSkinId;for(var e="sw_"+this.mainWeaponSkinId,i=0,o=this.followPlayerOut.knivesCmp.knives;i<o.length;i++){var n=o[i].getComponent(l);n&&(n.skinNode.emit("changeSkin",this.knifeImage),n.changeShadowImage(e))}}},getKnivesCount:function(){return this.followPlayerOut.knivesCmp.knives.length},setDWRotateAble:function(t){this.followPlayerIn&&(this.followPlayerIn.rotateAble=t)},stopMove:function(){this.moveTouch.touchEndEvent()},getPositionForMap:function(){var t=this.node.convertToWorldSpaceAR(cc.v2(0,0));return c.GValue.EntityWorld.addEntitySys.enemyNode.convertToNodeSpaceAR(t)}}),cc._RF.pop()},{CEntityBase:"CEntityBase",CEntityKnife:"CEntityKnife",CommonAudio:"CommonAudio",CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonValue:"CommonValue",GameData:"GameData",PlayerAnimComponent:"PlayerAnimComponent",Tools:"Tools",Types:"Types"}],CEntitySnake:[function(t,e,i){"use strict";cc._RF.push(e,"2d1f0VL4xRP4I+umzUkcqap","CEntitySnake");var o=t("CommonValue"),n=t("CommonFunc"),s=t("Tools"),a=t("PfNum"),c=t("CommonEnum"),r=t("CommonConfig"),l=t("ConfigData"),h=t("CEnemyEffect"),d=t("CommonAudio"),u=t("Types"),m=t("GameData"),p=t("EnemyBase");cc.Class({extends:p,properties:{},init:function(t,e,i){this.maxlen_snake=0,this.list_snake=[],this.list_effect=[],this.dic_shadow={},this.dic_hp={},this.dic_gold={},this.dic_radius={},this.dic_diff_index={},this.dic_follow_min={},this.dic_follow_max={},this.dic_unfollow_min={},this.dic_unfollow_max={},this.dic_pos={},this.dic_rotate={},this.index_head=0,this.data=null,this.speed_move_in=300,this.speed_move=0,this.speed_rotate=0,this.cur_speed_rotate=0,this.rotate_diff=20,this.cur_time_follow=0,this.cur_time_unfollow=0,this.shadow_diffPos=cc.v2(20,-20),this.color_effect=cc.color(185,42,42),this.isMove=!0,this.willMove=!1,this.rotate_enter=0,this.minX=-100,this.maxX=100,this.minY=-200,this.maxY=200,this.pos_world=cc.v2(0,0),this.pos_node_min=cc.v2(0,0),this.pos_node_max=cc.v2(0,0),this.isDead=!1,this.radius=0,this.frameshare=10,this.timeshare=1/60/this.frameshare,this.type=u.EnemyType.Snake,this.enterCall=e,this.isDead=!1,this.aiType=t.ai,t.isIn&&(this.aiType=l.E_SnakeAI.Enter,this.rotate_enter=t.rotate_in),this.data=t,this.node_snake=new cc.Node,this.node.addChild(this.node_snake),this.maxlen_snake=t.list_hp.length;for(var n=0;n<this.maxlen_snake;n++)o.GValue.StageFailFinish?this.dic_hp[n]=t.list_hp[n]*o.GValue.FailRatio:this.dic_hp[n]=t.list_hp[n],this.dic_gold[n]=t.list_gold[n],this.dic_follow_min[n]=t.list_follow_min[n],this.dic_follow_max[n]=t.list_follow_max[n],this.dic_unfollow_min[n]=t.list_unfollow_min[n],this.dic_unfollow_max[n]=t.list_unfollow_max[n],0==n?this.dic_radius[n]=70:n==this.maxlen_snake-1?this.dic_radius[n]=30:this.dic_radius[n]=50;this.speed_move=t.speed_move>0?t.speed_move:1,this.speed_move_in=t.speed_move_in>0?t.speed_move_in:1,t.isIn?this.speed_rotate=this.data.speed_rotate_in:this.set_rotate_speed(),this.color_effect=this.data.color;var a=this.get_speedXY_by_rotate(t.rotate_in,t.distance_in),c=cc.v2(this.data.target_in.x-a.x,this.data.target_in.y-a.y);this.create_snake(this.maxlen_snake,t.rotate_in,c),i&&i(this),this.pos_world=this.node.convertToWorldSpaceAR(cc.v2(0,0)),this.pos_node_min=this.node.convertToNodeSpaceAR(cc.v2(this.minX,this.minY).add(this.pos_world)),this.pos_node_max=this.node.convertToNodeSpaceAR(cc.v2(this.maxX,this.maxY).add(this.pos_world)),this.buffCom=s.DYTools.addScript(this.node,"EnemyBuffComponent"),this.buffCom.init(this)},create_snake:function(t,e,i){if(!(t<=0)){var n;if(this.node_head=this.create_item(0,"snake_head",!1),this.node_head.setRotation(e),this.node_head.setPosition(i),this.node_snake.addChild(this.node_head),this.list_snake.push(this.node_head),1==t);else{for(n=1;n<t-1;n++){var s=this.create_item(n,"snake_body",!0);s.setPosition(i),s.name="snake_body",this.node_snake.addChild(s),this.list_snake.push(s)}var a=this.create_item(t-1,"snake_tail",!0);s.name="snake_tail",a.setPosition(i),this.node_snake.addChild(a),this.list_snake.push(a)}var r=0;for(n=0;n<this.list_snake.length;n++){var l=-5;0==n?l=0:n==this.list_snake.length-1&&(l=-0);var d=this.list_snake[n];d.zIndex=this.list_snake.length-n,d.group="enemy";var u=this.get_item_nodeSp(d).getContentSize();r=r+.5*u.height+l;var m=c.E_CTag.Boss_SnakeHead+n;if(this.addCircleCollider(d,this.dic_radius[n],m),n>0){var p=r/this.speed_move/this.timeshare;this.dic_diff_index[n]=Math.floor(p),r+=.5*u.height}var f=cc.instantiate(o.GValue.pf_enemy_effect);d.addChild(f);var _=f.getComponent(h);_.init(this),this.list_effect.push(_),n==this.list_snake.length-1?_.fireFrameAnim.node.y=20:_.fireFrameAnim.node.y=0==n?-30:10}this.setTail()}},create_item:function(t,e,i){var s=new cc.Node,a="_"+this.data.image,c=e+a,r=e+"_shadow",l=e+"_shine"+a,h="snake_line"+a,d=new cc.Node,u=d.addComponent(cc.Sprite);n.GFunc.changeAtlasSprite(o.GValue.Atlas_Shadow,u,r),d.setAnchorPoint(.5,.5),d.setPosition(s.position.add(this.shadow_diffPos)),this.node_snake.addChild(d),this.dic_shadow[t]=d,d.opacity=0,d.runAction(cc.sequence(cc.delayTime(.1),cc.fadeIn(.1)));var m=new cc.Node,p=m.addComponent(cc.Sprite);n.GFunc.changeAtlasSprite(o.GValue.Atlas_Enemy,p,c),m.setAnchorPoint(.5,.5),s.addChild(m),m.name="sp";var f=new cc.Node,_=f.addComponent(cc.Sprite);if(n.GFunc.changeAtlasSprite(o.GValue.Atlas_Enemy,_,l),f.setAnchorPoint(.5,.5),m.addChild(f),f.opacity=0,f.name="shine",i){var y=new cc.Node,g=y.addComponent(cc.Sprite);n.GFunc.changeAtlasSprite(o.GValue.Atlas_Enemy,g,h),y.setAnchorPoint(.5,1),y.setPosition(0,-5),s.addChild(y),y.name="line"}return s},remove_item_show:function(t){var e=this.get_item_nodeSp(t);e&&e.destroy();var i=this.get_item_nodeLine(t);i&&i.destroy()},get_item_nodeSp:function(t){return t.getChildByName("sp")},get_item_nodeShine:function(t){var e=null,i=this.get_item_nodeSp(t);return i&&(e=i.getChildByName("shine")),e},get_item_nodeLine:function(t){return t.getChildByName("line")},get_item_com_effect:function(t){return this.list_effect[t]},addCircleCollider:function(t,e,i){var o=t.addComponent(cc.CircleCollider);o.radius=e,o.tag=i,o.name=this.data.id.toString()},setTail:function(){var t=this.list_snake.length;if(t>0){this.node_tail=this.list_snake[t-1];var e=this.node_tail.getComponent(cc.CircleCollider);e&&(e.tag=c.E_CTag.Boss_SnakeTail,this.radius=e.radius),this.bloodNum&&this.bloodNum.destroy(),this.bloodNum=cc.instantiate(o.GValue.pf_num),this.bloodNum.scale=this.dic_radius[t-1]/50*.8,this.node_tail.addChild(this.bloodNum),this._bloodNum=this.bloodNum.getComponent(a),this._bloodNum.setParam(c.Enum_Num.Blood,cc.v2(.5,.5),0,o.GValue.Atlas_Enemy);var i=this.dic_hp[t-1];this._bloodNum.setString(n.GFunc.getNumK(Math.ceil(i))),1==t&&(this.bloodNum.scale*=.7);var s=this.get_item_nodeShine(this.node_tail);if(s){s.stopAllActions();var l=r.GConfig.actionFrameTime,h=cc.fadeTo(2*l,255),d=cc.delayTime(2*l),u=cc.fadeTo(0*l,0),m=cc.delayTime(2*l),p=cc.sequence(h,d,u,m),f=cc.repeatForever(p);s.runAction(f)}}},attackTail:function(t,e){if(d.GAudio.playEnemyHurtSound(),0==t)this.buffCom.addBuff(u.EnemyBuff.SlowDown);else if(1==t)switch(m.TData.getCurSubFun()){case u.DWType.Knife:case u.DWType.Laser:this.buffCom.addBuff(u.EnemyBuff.SlowDown);break;case u.DWType.Ice:this.buffCom.addBuff(u.EnemyBuff.Frozen);break;case u.DWType.Fire:this.buffCom.addBuff(u.EnemyBuff.Firing)}this.bloodChange(-e),d.GAudio.playEnemyHurtSound();var i=this.list_snake.length,o=this.get_item_com_effect(i-1);o&&o.hurt(cc.v2(0,0),this.color_effect)},bloodChange:function(t){var e=this.list_snake.length;if(e>0){var i=this.dic_hp[e-1];i+=t,this.dic_hp[e-1]=i,i>0?this._bloodNum&&this._bloodNum.setString(n.GFunc.getNumK(Math.ceil(i))):this.tail_die()}else this.tail_die()},laserAtkTail:function(t,e){var i=this.list_snake.length;if(i>0){var o=this.dic_hp[i-1];o-=t,this.dic_hp[i-1]=o,o>0?this._bloodNum&&this._bloodNum.setString(n.GFunc.getNumK(Math.ceil(o))):this.tail_die()}else this.tail_die();var s=this.get_item_com_effect(i-1);s&&s.laserHurt(cc.v2(0,0),360-this.node_tail.rotation+e,this.color_effect)},attackBody:function(t,e,i){var o=e-c.E_CTag.Boss_SnakeHead,n=this.get_item_com_effect(o);if(n){var s=cc.v2(0,0),a=1;if(i){var r=i.convertToWorldSpaceAR(cc.v2(0,0));s=n.node.convertToNodeSpaceAR(r),a=.8+.2*Math.random()}n.hit(s,0,a)}d.GAudio.playEnemyHurtSound()},tail_die:function(){var t=this.list_snake.length,e=t-1,i=this.list_effect[e];if(t>0){var o=this.node_tail;this.remove_item_show(o);var n=this.dic_shadow[e];n&&(n.destroy(),delete this.dic_shadow[e]);var s=this.get_item_com_effect(e);s&&s.die(this.dic_gold[e],this.color_effect,function(){o&&o.destroy()}),this.play_audio(),this.list_snake.splice(e,1),this.list_effect.splice(e,1)}this.list_snake.length<=0?this.die():this.setTail(),this.buffCom.reset(),i&&i.updateGameLogic(0)},die:function(){this.isDead||(this.isDead=!0,o.GValue.EntityWorld.bossDie(this.node),this.bloodNum.destroy(),delete o.GValue.EntityWorld.SnakeEnemys[this.data.id],this.data.gold>0&&o.GValue.EntityWorld.playGoldFlyEffect(1,this.data.gold,this.node_head.convertToWorldSpaceAR(cc.v2(0,0))))},setIsMove:function(t){this.isMove=t},setWillMove:function(t){this.willMove=t},updateShadow:function(){for(var t=0;t<this.list_snake.length;t++){var e=this.list_snake[t],i=this.dic_shadow[t];i&&(i.rotation=e.rotation,i.setPosition(e.position.add(this.shadow_diffPos)))}},updateGameLogic:function(t){t=.0167;var e=this.list_snake.length;if(!(e<=0)&&o.GValue.PlayerTouching&&this.isMove){this.buffCom.updateGameLogic(t);var i=this.list_effect[this.list_snake.length-1];i&&i.updateGameLogic(t);var n=this.speed_move;this.aiType==l.E_SnakeAI.Enter&&(n=this.speed_move_in),this.hasBuff(u.EnemyBuff.Frozen)&&(n*=o.GValue.EntityWorld.player.dwParam[1]);var a=this.node_head.rotation,c=this.node_head.position,r=this.get_speedXY_by_rotate(a,n),h=cc.v2(r.x*t,r.y*t),d=this.cur_speed_rotate*t,m=c.add(h),p=a+d;p=(p=p>=360?p-360:p)<0?p+360:p,this.node_head.setPosition(m),this.node_head.rotation=p;var f,_=t*n/this.speed_move/this.timeshare,y=1/_;for(f=1;f<_;f++){this.index_head++,this.dic_pos[this.index_head]=c.add(cc.v2(h.x*y*f,h.y*y*f));var g=d*y*f;g=(g=g>=360?g-360:g)<0?g+360:g,this.dic_rotate[this.index_head]=a+g}for(this.index_head++,this.dic_rotate[this.index_head]=this.node_head.rotation,this.dic_pos[this.index_head]=this.node_head.position,this.dic_rotate[this.index_head]=this.node_head.rotation,f=1;f<e;f++){var v=this.list_snake[f],C=this.index_head-this.dic_diff_index[f],S=this.dic_pos[C],D=this.dic_rotate[C];if(S){v.setPosition(S),v.setRotation(D);var T=this.get_item_nodeLine(v),G=this.list_snake[f-1];if(T&&G){var A=G.convertToWorldSpaceAR(cc.v2(0,0)),w=v.convertToNodeSpaceAR(A),b=this.get_rotate_by_xy(T.x-w.x,T.y-w.y);T.rotation=b+180}}if(f==e-1)for(var E=C;E<C+_;E++)delete this.dic_pos[E],delete this.dic_rotate[E]}if(this.updateShadow(),this.aiType==l.E_SnakeAI.Enter)c.x>this.pos_node_min.x&&m.x<=this.pos_node_min.x?(this.cur_speed_rotate=-this.speed_rotate,this.rotate_enter=360-this.rotate_enter):c.x<this.pos_node_max.x&&m.x>=this.pos_node_max.x?(this.cur_speed_rotate=this.speed_rotate,this.rotate_enter=360-this.rotate_enter):(Math.abs(p-this.rotate_enter)<10&&(this.cur_speed_rotate=0),this.node_head.y<=this.data.yIn&&(this.cur_speed_rotate=0,this.set_rotate_speed(),this.aiType=this.data.ai,this.willMove||(this.isMove=!1),this.play_audio(),this.enterCall&&this.enterCall(this)));else if(this.aiType==l.E_SnakeAI.Box)if(c.y>this.pos_node_min.y&&m.y<=this.pos_node_min.y){if(0==this.cur_speed_rotate){var P=1==s.DYTools.random_int(0,1)?1:-1;this.cur_speed_rotate=this.speed_rotate*P}}else if(c.y<this.pos_node_max.y&&m.y>=this.pos_node_max.y)0==this.cur_speed_rotate&&(P=1==s.DYTools.random_int(0,1)?1:-1,this.cur_speed_rotate=this.speed_rotate*P);else if(c.x>this.pos_node_min.x&&m.x<=this.pos_node_min.x)0==this.cur_speed_rotate&&(P=1==s.DYTools.random_int(0,1)?1:-1,this.cur_speed_rotate=this.speed_rotate*P);else if(c.x<this.pos_node_max.x&&m.x>=this.pos_node_max.x)0==this.cur_speed_rotate&&(P=1==s.DYTools.random_int(0,1)?1:-1,this.cur_speed_rotate=this.speed_rotate*P);else{var N=this.get_rotate_by_xy(0-m.x,0-m.y);Math.abs(N-p)<this.rotate_diff&&(this.cur_speed_rotate=0)}else if(this.aiType==l.E_SnakeAI.Player&&o.GValue.EntityWorld.player)if(this.cur_time_follow>=0){this.cur_time_follow-=t;var k=o.GValue.EntityWorld.player.node.convertToWorldSpaceAR(cc.v2(0,0)),F=(w=this.node.convertToNodeSpaceAR(k),N=this.get_rotate_by_xy(w.x-m.x,w.y-m.y),Math.abs(p-N));if(F<=180);else{var V=N+360,x=N-360;(F=Math.abs(p-V))<=180?N=V:(F=Math.abs(p-x))<=180&&(N=x)}this.cur_speed_rotate=F<=5?0:p<N?this.speed_rotate:p>N?-this.speed_rotate:0}else this.cur_time_unfollow-=t,this.cur_speed_rotate=0,this.cur_time_unfollow<=0&&(this.set_follow_time(),this.set_rotate_speed())}},set_follow_time:function(){var t=this.list_snake.length-1;if(!(t<0)){var e=this.dic_follow_max[t];e=e||0;var i=this.dic_follow_min[t];i=i||0,this.cur_time_follow=i+(e-i)*Math.random();var o=this.dic_unfollow_max[t];o=o||0;var n=this.dic_unfollow_min[t];n=n||0,this.cur_time_unfollow=n+(o-n)*Math.random()}},set_rotate_speed:function(){var t=this.data.speed_rotate_min,e=this.data.speed_rotate_max;this.speed_rotate=t+(e-t)*Math.random()},get_speedXY_by_rotate:function(t,e){var i=cc.v2(0,0);if(0==t||360==t)i=cc.v2(0,-e);else if(90==t)i=cc.v2(-e,0);else if(180==t)i=cc.v2(0,e);else if(270==t)i=cc.v2(e,0);else if(t>180&&t<270){var o=(t-180)/180*Math.PI;i=cc.v2(e*Math.sin(o),e*Math.cos(o))}else t>90&&t<180?(o=(t-90)/180*Math.PI,i=cc.v2(-e*Math.cos(o),e*Math.sin(o))):t>0&&t<90?(o=t/180*Math.PI,i=cc.v2(-e*Math.sin(o),-e*Math.cos(o))):t>270&&t<360&&(o=(t-270)/180*Math.PI,i=cc.v2(e*Math.cos(o),-e*Math.sin(o)));return i},get_rotate_by_xy:function(t,e){var i=0;if(0==t&&0==e)i=0;else if(0==t)i=e>0?270:90;else if(0==e)i=t>0?0:180;else if(t>0&&e>0){var o=Math.abs(t/e);i=270+Math.atan(o)/(2*Math.PI)*360}else t<0&&e>0?(o=Math.abs(e/t),i=180+Math.atan(o)/(2*Math.PI)*360):t<0&&e<0?(o=Math.abs(t/e),i=90+Math.atan(o)/(2*Math.PI)*360):t>0&&e<0&&(o=Math.abs(e/t),i=Math.atan(o)/(2*Math.PI)*360);return(i-=90)<0?i+360:i},play_audio:function(){var t="snake_"+s.DYTools.random_int(1,2);d.GAudio.playSound(t)},hasBuff:function(t){return this.buffCom.hasBuff(t)}}),cc._RF.pop()},{CEnemyEffect:"CEnemyEffect",CommonAudio:"CommonAudio",CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonValue:"CommonValue",ConfigData:"ConfigData",EnemyBase:"EnemyBase",GameData:"GameData",PfNum:"PfNum",Tools:"Tools",Types:"Types"}],CEntityWall:[function(t,e,i){"use strict";cc._RF.push(e,"d023aKWGopEU4czfvXISmG6","CEntityWall");var o=t("Tools"),n=t("CommonValue");cc.Class({extends:cc.Component,properties:{wallType:cc.Integer,sprWall:cc.Sprite,sprNode:cc.Node,wallCollider:cc.BoxCollider,wallCCollider:cc.CircleCollider},ctor:function(){this._data=null},init:function(t,e){this._data=t,this.node.position=cc.v2(t.x,t.y),this.node.angle=this._data.rt;var i=t.dr;t.dr<4&&(i=100*t.ty+1);for(var s=0;s<this.sprWall.length;s++)this.sprWall[s].spriteFrame=n.GValue.Atlas_Wall.getSpriteFrame("w"+e+"_"+i);if(4==t.dr)this.node.scaleY=this._data.sy,this.node.scaleX=this._data.sx,i=4;else if(5==t.dr){for(s=0;s<this._data.cL.length;s++){var a=this._data.cL[s];this.sprNode[s].active=!0,this.sprNode[s].x=a.x,this.sprNode[s].y=a.y,this.sprNode[s].scaleX=a.sx,this.sprNode[s].scaleY=a.sy,this.sprNode[s].width=a.wt,this.sprNode[s].height=a.ht}i=5}else 6==t.dr?(this.node.scaleY=this._data.sy,this.node.scaleX=this._data.sx,i=6):(this.node.scaleY=this._data.sy,this.node.scaleX=this._data.sx,this.sprNode[0].anchorX=this._data.ax,this.sprNode[0].anchorY=this._data.ay,this.sprNode[0].width=this._data.wt,this.sprNode[0].height=this._data.ht);4==this._data.dr?(this.wallCCollider.tag=t.dr,o.DYTools.addScript(this.wallCCollider.node,"CNodeCollider").init(this.node,!0)):5==this._data.dr?(this.wallCCollider.tag=t.dr,o.DYTools.addScript(this.wallCCollider.node,"CNodeCollider").init(this.node,!0),this.wallCCollider.radius=this._data.wt):6==this._data.dr?(this.wallCollider.tag=t.dr,o.DYTools.addScript(this.wallCollider.node,"CNodeCollider").init(this.node,!0)):(this.wallCollider.tag=t.dr,o.DYTools.addScript(this.wallCollider.node,"CNodeCollider").init(this.node,!0),t.ty<2&&(this.wallCollider.size.width=this.sprNode[0].width,this.wallCollider.node.position=cc.v2(this.wallCollider.node.x+(.5-this.sprNode[0].anchorX)*this.sprNode[0].width,this.wallCollider.node.y+(.5-this.sprNode[0].anchorY)*this.sprNode[0].height)))}}),cc._RF.pop()},{CommonValue:"CommonValue",Tools:"Tools"}],CEntityWorld:[function(t,e,i){"use strict";var o;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"43a79rAvnVCJpxVREEN1Kmf","CEntityWorld");var s=t("Tools"),a=t("CollisionEventManager"),c=t("EntityEnemy"),r=t("CommonValue"),l=t("GameData"),h=t("CommonAudio"),d=t("CommonConfig"),u=t("ConfigData"),m=t("CommonFunc"),p=t("HomeUI"),f=t("CommonEnum"),_=t("GuideUI"),y=t("Types"),g=(t("CommonSdk"),t("PropManager"));cc.Class({extends:cc.Component,properties:(o={canvas:cc.Node,gameNode:cc.Node,mapShield:cc.Node,touchShield:cc.Node,gameUINode:cc.Node,homeUINode:cc.Node,guideUINode:cc.Node,addEntityNode:cc.Node,poolMgr:cc.Node,mapMgrNode:cc.Node,ddSdkNode:cc.Node,shieldNode:cc.Node},n(o,"guideUINode",cc.Node),n(o,"pf_sdk",cc.Prefab),n(o,"pf_anim",cc.Prefab),n(o,"pf_num",cc.Prefab),n(o,"pf_enemy_effect",cc.Prefab),n(o,"pf_guideUI",cc.Prefab),n(o,"pf_homeUI",cc.Prefab),n(o,"pf_gameUI",cc.Prefab),n(o,"atlasGame",cc.SpriteAtlas),n(o,"atlasEnemy",cc.SpriteAtlas),n(o,"atlasShadow",cc.SpriteAtlas),n(o,"atlasBoss",cc.SpriteAtlas),n(o,"atlasGuide",cc.SpriteAtlas),n(o,"atlasTest",cc.SpriteAtlas),o),onLoad:function(){this.inBack=!1,this.backToFront=!1,this.inGuide=!1,this.m_gameStart=!1,this.m_gameOver=!1,this.isLoading=!0,this.gameNodePos=cc.Vec2.ZERO,this.touchAvaliable=!0,this.addEntitySys=null,this.mapMgr=null,this.heroColSys=null,this.knifeColSys=null,this.deputyWeaponColSys=null,this.gameRuleSystem=null,this.propMgr=null,this.player=null,this.knifes=[],this.landKnifes=[],this.enemyDropNumber=0,this.enemyDropPropNumber=0,this.Enemys=[],this.pauseEnemys=[],this.SnakeEnemys={},this.CircleEnemys={},this.FireEnemys={},this.Props=[],this.landRect=null,this.touchDirty=0,this.curDtRatio=1,this.levelData=null,this.curLevel=0,this.reviveCount=0,this.dieCount=0,this.enemyColorBlood=[],this.enemyColorParam={},this.gameUI=null,this.mapStop=!1,this._enemyWaveCount=0,this._conEnemyArr=[],this._mapPauseData=null,this._mapPauseAble=!1,this._mapPauseEnemyAble=!1,this._mapPauseCount=0,this._pauseEnemyIndex=[],this._pauseEnemyTime=[],this._bossData=null,this._bossPos=cc.Vec2.ZERO,this._bossCount=0,this._bossArr=[],this._bossConfigData=null,this._bossTimeAble=!1,this._bossTime=[],this.knifeColIndex=0,r.GValue.Root_Canvas=this.canvas,r.GValue.EntityWorld=this,r.GValue.PlayerSlowRatio=1,m.GFunc.adjustScreen(this.gameNode),r.GValue.MapScale=this.gameNode.scale,r.GValue.PlayerMainPos=r.GValue.ViewCenter.add(cc.v2(0,.02*-r.GValue.Size_View.height)).mul(1/r.GValue.MapScale),r.GValue.PlayerPosV=cc.v2(r.GValue.ViewCenter.x/r.GValue.MapScale,.6*r.GValue.ViewCenter.y/r.GValue.MapScale),r.GValue.PlayerPosH=cc.v2(.8*r.GValue.ViewCenter.x/r.GValue.MapScale,r.GValue.ViewCenter.y/r.GValue.MapScale),this.gameNode.position=cc.v2(.5*-r.GValue.Size_View.width,.5*-r.GValue.Size_View.height),this.mapShield.scale=1/r.GValue.MapScale,this.setTouching(!0),this.landRect=cc.rect(-200,-200,r.GValue.Size_View.width+400,r.GValue.Size_View.height+400),r.GValue.EnemyColorBloodPercent=parseInt(d.GConfig.getGbData(f.Enum_Gb.EnemyColor))/100,this.isLoading=!0,this.gameNodePos=this.gameNode.position,r.GValue.Atlas_Game=this.atlasGame,r.GValue.Atlas_Enemy=this.atlasEnemy,r.GValue.Atlas_Shadow=this.atlasShadow,r.GValue.Atlas_Boss=this.atlasBoss,r.GValue.Atlas_Guide=this.atlasGuide,r.GValue.Atlas_Test=this.atlasTest,r.GValue.pf_num=this.pf_num,r.GValue.pf_anim=this.pf_anim,r.GValue.pf_enemy_effect=this.pf_enemy_effect;var t=this.poolMgr.getComponent("CPoolMgr");t.init(),this.addEntitySys=s.DYTools.addScript(this.addEntityNode,"EntityAddSys"),this.addEntitySys.init(t),this.mapMgr=s.DYTools.addScript(this.mapMgrNode,"MapManager"),this.heroColSys=s.DYTools.addScript(this.node,"CHeroCollisionHandleSystem"),this.knifeColSys=s.DYTools.addScript(this.node,"CKnifeCollisionHandleSystem"),this.deputyWeaponColSys=s.DYTools.addScript(this.node,"DeputyWeaponCollisionHandleSys"),this.gameRuleSystem=s.DYTools.addScript(this.node,"CGameRuleSystem"),this.propMgr=s.DYTools.addScript(this.node,g),this.propMgr.init(),r.GValue.PropMgr=this.propMgr,this.nextLoad(),m.GFunc.initPowerRecover(),m.GFunc.initOfflineGoldRecover(),this.schedule(function(t){m.GFunc.checkPowerRecover(1),m.GFunc.checkGoldOffline(1),r.GValue.HomeUI&&(r.GValue.HomeUI.refreshPowerRecover(),r.GValue.HomeUI.refreshOfflineRecover(),r.GValue.HomeUI.refresh_sys_lvuptip(!0))},1,cc.macro.REPEAT_FOREVER,0);var e=this;cc.game.off(cc.game.EVENT_HIDE),cc.game.on(cc.game.EVENT_HIDE,function(t){e.inBack=!0,window.xmgame.closeVolume(),s.DYTools.error("\u8fdb\u5165\u540e\u53f0"),l.TData.saveLastData(),l.TData.saveSettingData()}),cc.game.off(cc.game.EVENT_SHOW),cc.game.on(cc.game.EVENT_SHOW,function(){e.inBack=!1,e.backToFront=!0,window.xmgame.openVolume(),s.DYTools.error("\u8fdb\u5165\u524d\u53f0"),m.GFunc.initPowerRecover(),m.GFunc.initOfflineGoldRecover(),h.GAudio.playBgm(h.GAudio.curBgm)}),this.node.on("knifeCol",this.playerKnifeColKniveEffect,this)},nextLoad:function(){this.player=this.addEntitySys.addPlayer(),this.player.node.position=r.GValue.PlayerMainPos;for(var t=l.TData.WeaponCount,e=0,i=this.addEntitySys.AddKnife(t);e<i.length;e++){var o=i[e];this.knifes.push(o),s.DYTools.addScript(o.node,"CKnifeInit").init(this.player)}var n=cc.instantiate(this.pf_gameUI);this.gameUINode.addChild(n),this.gameUI=n.getComponent("GameUI"),this.gameUINode.active=!1,r.GValue.GameUI=this.gameUI;var a=cc.instantiate(this.pf_guideUI);if(this.guideUINode.addChild(a),r.GValue.GuideUI=a.getComponent(_),r.GValue.GuideUI.init(),d.GConfig.isLocal);else{var c=cc.instantiate(this.pf_homeUI);this.homeUINode.addChild(c),r.GValue.HomeUI=c.getComponent(p),r.GValue.HomeUI.init()}m.GFunc.changePlayerSkin(l.TData.getCurSubFun()),h.GAudio.playBgm(h.Enum_Audio.bgm_main),!d.GConfig.isDevelop&&d.GConfig.isWx&&(r.GValue.DDSDK||(r.GValue.DDSDK=cc.instantiate(this.pf_sdk),r.GValue.DDSDKUI=r.GValue.DDSDK.getComponent("ddsdk_ui")),this.ddSdkNode.addChild(r.GValue.DDSDK))},start:function(){r.GValue.FirstMain&&(r.GValue.FirstMain=!1),this.isLoading=!1,r.GValue.DDSDKUI&&(r.GValue.DDSDKUI.adjustUI(),r.GValue.DDSDKUI.showMain(!0),r.GValue.DDSDKUI.showFavGame(!1))},resetGameNode:function(){this.addEntitySys.mapWall.removeAllChildren(),this.addEntitySys.enemyNode.removeAllChildren(),this.addEntitySys.itemNode.removeAllChildren(),this.addEntitySys.propNode.removeAllChildren()},clearMap:function(){this.addEntitySys.clear()},gameStart:function(t){if(r.GValue.DDSDKUI&&r.GValue.DDSDKUI.showMain(!1),this.resetGameNode(),this.curLevel=t,window.xmgame.sendEvents("level_begin",t+""),this.levelData=d.GConfig.getLevelData(this.curLevel),r.GValue.StageFailFinish=!1,r.GValue.StageFail==this.curLevel&&(m=this.levelData.failParam.split(d.GConfig.SeparatorI)).length>1){for(var e=s.DYTools.stringToNumber(m[0],d.GConfig.SeparatorII),i=-1,o=0;o<e.length&&r.GValue.StageFailCount>=e[o];o++)i=o;if(i>=0){var n=s.DYTools.stringToNumber(m[1],d.GConfig.SeparatorII);try{r.GValue.StageFailFinish=!0,r.GValue.FailRatio=n[i],s.DYTools.warn("\u96be\u5ea6\u964d\u4f4e:"+n[i])}catch(t){s.DYTools.error("\u96be\u5ea6\u7cfb\u6570\u9519\u8bef",t)}}}var c=this,u=d.GConfig.actionFrameTime;for(c.player.playerOutUI(function(){c.gameUINode.active=!0,c.gameUI.playGameStartAct(function(){c.addEntitySys.preLoadStart(function(){c.mapMgr.init(c.levelData,c.addEntitySys,function(){h.GAudio.playBgm(h.Enum_Audio.bgm),f.Enum_GuideStep.StageStart>l.TData.getGuideStep()&&l.TData.setGuideStep(f.Enum_GuideStep.StageStart),c.gameUI.startGame(c.mapMgr.pauseDis),c.gameUI.playBlackHideAct(),c.scheduleOnce(function(){c.gameUI.playProgressShowAct()},3*u),c.scheduleOnce(function(){c.player.playerEnterGameAct(function(){},function(){var t=function(){a.CollisionEventManager.getInstance().init(),c.mapMgr.startGame();for(var t=0,e=c.Enemys;t<e.length;t++)e[t].startGame();c.m_gameStart=!0,c.check_guide_level()};1==c.curLevel?(c.gameUI.showFingerGuide(t),l.TData.getGuideStep()<f.Enum_GuideStep.Finger&&l.TData.setGuideStep(f.Enum_GuideStep.Finger),c.player.startGame(function(){c.gameUI.hideFingerGuide(),t()})):(c.player.startGame(),t())})},4*u),c.scheduleOnce(function(){c.mapMgr.playEnterAct()},8*u)})})})}),this.enemyColorBlood.splice(0),this.enemyColorBlood=s.DYTools.stringToNumber(this.levelData.enemyColor,d.GConfig.SeparatorII),o=this.enemyColorBlood.length-1;o>0;o--){var m=[],p=this.enemyColorBlood[o],_=this.enemyColorBlood[o-1];p=(p-_)*r.GValue.EnemyColorBloodPercent+_;var y=d.GConfig.colorArr[o],g=d.GConfig.colorArr[o-1],v=(y.getR()-g.getR())/(p-_),C=y.getR()-p*v;m.push(Number(v.toFixed(3))),m.push(Number(C.toFixed(3))),v=(y.getG()-g.getG())/(p-_),C=y.getG()-p*v,m.push(Number(v.toFixed(3))),m.push(Number(C.toFixed(3))),v=(y.getB()-g.getB())/(p-_),C=y.getB()-p*v,m.push(Number(v.toFixed(3))),m.push(Number(C.toFixed(3))),this.enemyColorParam[o-1]=m}this._enemyWaveCount=0,this._conEnemyArr=[],this._mapPauseData=null,this._mapPauseAble=!1,this._mapPauseCount=0,this._pauseEnemyIndex=[],this._pauseEnemyTime=[],this._mapPauseCount=0},check_guide_level:function(){if(1==this.curLevel){var t=this;this.scheduleOnce(function(){t.inGuide=!0,r.GValue.GuideUI.set_shield_state(!1),t.player.stopMove(),r.GValue.GuideUI.popup_panelLevelGuide(function(){t.inGuide=!1}),t.setTouching(!0),l.TData.getGuideStep()<f.Enum_GuideStep.Flash&&l.TData.setGuideStep(f.Enum_GuideStep.Flash)},2)}},setTouching:function(t){this.touchAvaliable&&(!this.m_gameOver&&!this.inGuide||t)&&r.GValue.PlayerTouching!=t&&(this.touchDirty=t?1:-1,r.GValue.PlayerTouching=t,r.GValue.PauseSlowRatio=t?1:.02,this.touchShield.active=!t,cc.director.getScheduler().setTimeScale(r.GValue.PauseSlowRatio),t||(this.curDtRatio=1,this.touchShield.opacity=0))},update:function(t){if(!this.inBack&&(this.backToFront&&(t=1/60,this.backToFront=!1),r.GValue.OnlineTime+=t,r.GValue.OnlineTime>=30&&(r.GValue.OnlineTime=0),!this.inGuide)){if(m.GFunc.check_performance(t),this.player){this.player.updateGameLogic(t*r.GValue.PauseSlowRatio);for(var e=0,i=this.knifes;e<i.length;e++)i[e].updateGameLogic(t*r.GValue.PauseSlowRatio)}this.m_gameStart&&!this.m_gameOver&&(r.GValue.PlayerTouching||(t*=r.GValue.PauseSlowRatio,this.player.isDead?(this.touchShield.active=!1,this.setTouching(!0)):-1==this.touchDirty&&(this.curDtRatio-=.025,this.curDtRatio<=r.GValue.PauseSlowRatio&&(this.curDtRatio=r.GValue.PauseSlowRatio,this.touchDirty=0),this.touchShield.opacity=255*(1-(this.curDtRatio-.02)/.98))),this._updateMap(t),this._updateEnemys(t),this._updateGameLogic(t),this.checkGameOver())}},_updateGameLogic:function(t){if(!this.player.isDead){for(var e in this.SnakeEnemys){var i=this.SnakeEnemys[e];i&&i.updateGameLogic(t)}for(var e in this.CircleEnemys){var o=this.CircleEnemys[e];o&&o.updateGameLogic(t)}for(var e in this.FireEnemys){var n=this.FireEnemys[e];n&&n.updateGameLogic(t)}for(var a in r.GValue.DicBossEnemy){var c=r.GValue.DicBossEnemy[a];for(var e in c)c[e].updateGameLogic(t)}for(var l=0,h=this.Enemys;l<h.length;l++)h[l].updateGameLogic(t);for(var d=0,u=this.landKnifes;d<u.length;d++){var m=u[d];this.landRect.contains(m.node.convertToWorldSpaceAR(cc.v2(0,0)))||s.DYTools.arrRemove(this.landKnifes,m)}for(var p=0,f=this.Props;p<f.length;p++){var _=f[p];_.updateGameLogic(t),Math.abs(this.player.node.x-_.node.x)<90&&Math.abs(this.player.node.y-_.node.y)<90&&this.player.node.position.sub(_.node.position).magSqr()<8100&&this.player.node.emit("prop",_)}this.m_gameStart&&(this.heroColSys.updateGameLogic(t),this.knifeColSys.updateGameLogic(t),this.deputyWeaponColSys.updateGameLogic(t),this.propMgr.updateGameLogic(t))}},_updateMap:function(t){if(!this.player.isDead&&!this.mapStop){this.mapMgr.updateMap(t);var e=this.mapMgr.checkMapPause();if(e){var i=this;this._mapPauseEnemyAble=!1,this.mapMgr.setMapStop(!0),this._mapPauseData=e,this._pauseEnemyIndex=[],this._pauseEnemyTime=[];for(var o=0;o<this._mapPauseData.oId.length;o++)this._pauseEnemyIndex.push(0),this._pauseEnemyTime.push(0);return void(0==this.mapMgr.pauseArr.length?this.gameUI.showEnemyCome(function(){i._mapPauseEnemyAble=!0}):i._mapPauseEnemyAble=!0)}if(!this._bossData){var n=this.mapMgr.checkBoss();if(n&&(this._mapPauseEnemyAble=!1,this._bossData=n,this.mapMgr.setMapStop(!0),this._mapPauseData=this.mapMgr.bossPause,this._pauseEnemyIndex=[],this._pauseEnemyTime=[],this._mapPauseData))for(o=0;o<this._mapPauseData.oId.length;o++)this._pauseEnemyIndex.push(0),this._pauseEnemyTime.push(0)}this.checkBoss(t)}},checkBoss:function(t){var e=this,i=this;if(this._bossData&&0==this.Enemys.length&&0==this._bossCount&&this.player.touchAble){i._bossCount++;var o=d.GConfig.getMapBossData(i._bossData.oId);this._bossConfigData=o;var n=null,s=!1;o.pause?(i.shieldNode.active=!0,i.player.touchAble=!1,i.setTouching(!0),i.touchAvaliable=!1,a.CollisionEventManager.getInstance().setCollisionAble(!1),n=o.player,s=!0,this._bossTimeAble=!1):this._bossTimeAble=!0,i.gameUI.showBossCome(function(){var t=d.GConfig.getConfigBossData(o.type[0],o.bId[0]),c=o.tip,r=function(){for(var n=0;n<o.time.length;n++)i._bossTime.push(o.time[n]);i.addEntitySys.addBoss(o.type[0],o.bId[0],function(n){if(void 0===n&&(n=null),i.shieldNode.active=!1,n&&i._bossArr.push([n.node,t,n]),o.pause)for(var r=0;r<i._bossArr.length;r++){var l=i._bossArr[r][2];switch(t.type){case y.BossType.Knife:m.GFunc.changeKnifeEnemyParentToUI(l,i.gameUI.bossTipNode),l.node.zIndex=-1,l.followWeapon.node.zIndex=-2;break;case y.BossType.Snake:case y.BossType.Circle:m.GFunc.changeParent(l.node,i.gameUI.bossTipNode),l.node.zIndex=-1;break;case y.BossType.Fire:case y.BossType.Electr:}}var h=function(){if(o.pause){for(var t=0;t<i._bossArr.length;t++){var n=i._bossArr[t][2],s=i._bossArr[t][1];if(n)switch(s.type){case y.BossType.Knife:m.GFunc.changeKnifeEnemyParentToMap(n),n.node.zIndex=1e4,n.followWeapon.node.zIndex=9999,n.actionAble=!0;break;case y.BossType.Snake:m.GFunc.changeParent(n.node,e.addEntitySys.enemyNode),n.setIsMove(!0),n.setWillMove(!0),n.node.zIndex=1e4;break;case y.BossType.Circle:m.GFunc.changeParent(n.node,e.addEntitySys.enemyNode),n.setTargetIn(!0),n.node.zIndex=1e4;break;case y.BossType.Fire:n.setCanAttack(!0);break;case y.BossType.Electr:n.setBossBegin(!0)}}i.player.touchAble=!0,i.player.touching=!0,i._mapPauseEnemyAble=!0,i.setTouching(!0),i.touchAvaliable=!0,a.CollisionEventManager.getInstance().setCollisionAble(!0),i._bossTimeAble=!0}};s?i.gameUI.showBossTips(c,function(){h()}):h()}),i.bossShake(),h.GAudio.playBgm(h.Enum_Audio.bgm_boss)};n?i.player.node.runAction(cc.sequence(cc.moveTo(.8,n),cc.callFunc(function(){r()}))):r()})}this.checkOtherBoss(t)},checkOtherBoss:function(t){var e=this,i=this;if(this._bossData)for(var o,n=function(n){s._bossTimeAble&&(s._bossTime[n]-=t),s._bossTime[n]<=0&&(s.addEntitySys.addBoss(s._bossConfigData.type[n],s._bossConfigData.bId[n],null,function(t){void 0===t&&(t=null);var o=d.GConfig.getConfigBossData(e._bossConfigData.type[n],e._bossConfigData.bId[n]);t&&i._bossArr.push([t.node,o,t])}),s.bossShake(),i._bossTime.splice(n,1),n--),o=n},s=this,a=1;a<this._bossTime.length;a++)n(a),a=o},_updateEnemys:function(t){if(!this.player.isDead){this.mapMgr.checkAreaEnemy(),this.checkMapPauseEnemy(t);for(var e=0;e<this._conEnemyArr.length;e++){var i=this._conEnemyArr[e];if(i.time+=t,i.time>=i.duration){i.time=0;var o=i.enemy[0];i.enemy.splice(0,1),0==i.enemy.length&&(this._conEnemyArr.splice(e,1),e--);var n=this.addEntitySys.addContinueEnemys(o,i.rect);this.addEnemys(n)}}var a=this.mapMgr.checkContinuumEnemy();if(a){var c=d.GConfig.getEnemyConData(a.oId);if(c){var r=new u.ContinueEnemyData;r.id=c.id,r.duration=c.duration,r.enemy=c.enemy.split("#"),r.rect=cc.rect(-420,-350,840,1500),this._conEnemyArr.push(r)}else s.DYTools.error("\u602a\u7269\u8868\u5c11\u914d\u7f6e",a.id)}var l=this.mapMgr.checkEnemyOut();if(l){this._enemyWaveCount++,this._enemyWaveCount>1&&(this._enemyWaveCount=0);var h=cc.rect(l.x-l.wt*l.ax,l.y-l.ht*l.ay,l.wt,l.ht);l.ax-.05<0?(h.x+=100,h.width-=100):l.ax-.95>0&&(h.width-=100),l.ay-.05<0?(h.y+=100,h.height-=100):l.ay-.95>0&&(h.height-=100),this.createEnemys(d.GConfig.getEnemyOutData(l.oId),h)}}},checkMapPauseEnemy:function(t){if(this._mapPauseData){if(this._mapPauseEnemyAble){this._mapPauseAble=!1;for(var e=0;e<this._mapPauseData.dir.length;e++){this._pauseEnemyTime[e]+=t;var i=d.GConfig.getPauseData(this._mapPauseData.oId[e]);i.enemyArr.length>this._pauseEnemyIndex[e]&&(this._mapPauseAble=!0,i.duration[this._pauseEnemyIndex[e]]<=this._pauseEnemyTime[e]&&(this.createPauseEnemy(this._mapPauseData.dir[e],i.enemyArr[this._pauseEnemyIndex[e]],i.size),this._pauseEnemyIndex[e]++,this._pauseEnemyTime[e]=0))}}else this._mapPauseAble=!0;return!0}return!1},createPauseEnemy:function(t,e,i){for(var o=0;o<e.length;o++){var n=e[o],s=this.addEntitySys.addPauseEnemy(n.x,n.y,t,i);this.addEnemys(s);for(var a=0,c=s;a<c.length;a++){var r=c[a];this.pauseEnemys.push(r)}}},createEnemys:function(t,e){void 0===e&&(e=null);for(var i=t.param.split(d.GConfig.SeparatorI),o=0,n=0;n<i.length;n++){var a=s.DYTools.stringToPoint(i[n],d.GConfig.SeparatorII),c=d.GConfig.getEnemyData(a.x),r=this.addEntitySys.AddEnemy(c,a.y,e);this.addEnemys(r);for(var l=0,h=r;l<h.length;l++){var u=h[l];this.m_gameStart&&u.startGame(),o++}}return o},checkPauseEnemyEmpty:function(){!this._mapPauseAble&&this._mapPauseData&&0==this.pauseEnemys.length&&(this.mapMgr.setMapStop(!1),this._mapPauseData=null,this._mapPauseCount++,this.gameUI.pauseEnemyFinish(this._mapPauseCount))},addEnemys:function(t){for(var e=0,i=t;e<i.length;e++){var o=i[e];s.DYTools.arrContains(this.Enemys,o)||this.Enemys.push(o)}},addEnemy:function(t){s.DYTools.arrContains(this.Enemys,t)||this.Enemys.push(t)},removeEnemy:function(t,e){void 0===e&&(e=!1),s.DYTools.arrRemove(this.pauseEnemys,t),s.DYTools.arrRemove(this.Enemys,t),this.checkPauseEnemyEmpty(),e&&this.bossDie(t.node)},bossDie:function(t){var e=this;if(this._bossData){for(var i=null,o=0;o<this._bossArr.length;o++){var n=this._bossArr[o];if(n[0]===t){i=n[1],this._bossArr.splice(o,1),s.DYTools.warn("boss die",this._bossArr.length,this._bossTime);break}}0==this._bossArr.length&&1==this._bossTime.length&&(this.mapMgr.bossData=null,this._bossData=null,this._mapPauseData=null,this._mapPauseEnemyAble=!1,this._mapPauseCount++,this.gameUI.pauseEnemyFinish(this._mapPauseCount),this._bossPos=t.convertToWorldSpaceAR(cc.Vec2.ZERO)),i&&i.clear&&this.scheduleOnce(function(){for(var t=e.Enemys.length-1;t>=0;t--){var i=e.Enemys[t];i.die(!1),e.gameUI.addGoldCount(i.data.cData.dropGold)}},.5)}},addKnife:function(t){s.DYTools.arrContains(this.knifes,t)||this.knifes.push(t)},removeKnife:function(t){s.DYTools.arrRemove(this.knifes,t)},checkGameOver:function(){if(!this.m_gameOver&&this.mapMgr.mapOver&&!(this._conEnemyArr.length>0)){for(var t in this.SnakeEnemys)if(this.SnakeEnemys[t])return;for(var t in this.CircleEnemys)if(this.CircleEnemys[t])return;for(var t in this.FireEnemys)if(this.FireEnemys[t])return;for(var e in r.GValue.DicBossEnemy){var i=r.GValue.DicBossEnemy[e];for(var t in i)if(i[t])return}if(!(this.mapMgr.pauseArr.length>0||this._mapPauseData||this._bossData||this.Enemys.length>0)){this.player.moveTouch.touchAble=!1,this.m_gameOver=!0,this.setTouching(!0);var o=this;this.scheduleOnce(function(){var t=s.DYTools.arrContains(l.TData.getListSub(),o.levelData.fun);o.levelData.fun>0&&!t?o.addPanelNew(o.levelData.fun):o.addPanelOver(!0)},.5)}}},gamePass:function(t){var e=this;this.player.pickupAllKnives(),this.addEntitySys.propNode.removeAllChildren(),this.mapMgr.playMapEndStoneBlink(),this.shakeSlight(function(){e.mapMgr.playMapEndStoneAct(function(){e.player.playOutMapAct(),t&&t()}),e.gameUI.showStoneDrop(),e.stoneBombShake()})},addProp:function(t){var e=this.addEntitySys.addProp(t);return this.Props.push(e),e},removeProp:function(t){t.willRemove(),s.DYTools.arrRemove(this.Props,t),this.addEntitySys.removeProp(t.node)},shake:function(){if(r.GValue.PlayerTouching){this.gameNode.stopAllActions();var t=d.GConfig.actionFrameTime;this.gameNode.position=this.gameNodePos;var e=cc.moveTo(1*t,this.gameNodePos.add(cc.v2(0,-6))),i=cc.moveTo(2*t,this.gameNodePos.add(cc.v2(-1,4))),o=cc.moveTo(2*t,this.gameNodePos),n=cc.sequence(e,i,o);this.gameNode.runAction(n)}},bossShake:function(){this.gameNode.stopAllActions();var t=d.GConfig.actionFrameTime;this.gameNode.position=this.gameNodePos;var e=cc.moveTo(1*t,this.gameNodePos.add(cc.v2(0,2))),i=cc.moveTo(2*t,this.gameNodePos),o=cc.sequence(e,i);this.gameNode.runAction(o)},stoneBombShake:function(){this.gameNode.stopAllActions();var t=d.GConfig.actionFrameTime;this.gameNode.position=this.gameNodePos;var e=cc.moveTo(1*t,this.gameNodePos.add(cc.v2(0,-10))),i=cc.moveTo(2*t,this.gameNodePos.add(cc.v2(0,7))),o=cc.moveTo(1*t,this.gameNodePos.add(cc.v2(-8,-9))),n=cc.moveTo(1*t,this.gameNodePos.add(cc.v2(5,5))),s=cc.moveTo(1*t,this.gameNodePos.add(cc.v2(-4,-7))),a=cc.moveTo(2*t,this.gameNodePos.add(cc.v2(0,4))),c=cc.moveTo(2*t,this.gameNodePos),r=cc.sequence(e,i,o,n,s,a,c);this.gameNode.runAction(r)},shakeTimes:function(t){this.gameNode.stopAllActions();var e=d.GConfig.actionFrameTime;this.gameNode.position=this.gameNodePos;var i=cc.moveTo(1*e,this.gameNodePos.add(cc.v2(0,10))),o=cc.moveTo(2*e,this.gameNodePos),n=cc.sequence(i,o),s=cc.repeat(n,t);this.gameNode.runAction(s)},shakeSlight:function(t){this.gameNode.stopAllActions();var e=d.GConfig.actionFrameTime;this.gameNode.position=this.gameNodePos;var i=cc.moveTo(2*e,this.gameNodePos.add(cc.v2(0,-2))),o=cc.moveTo(1*e,this.gameNodePos),n=cc.repeat(cc.sequence(i,o),10),s=cc.callFunc(function(){t&&t()}),a=cc.sequence(n,s);this.gameNode.runAction(a)},isReviveAble:function(){var t=this.levelData.reviveCount>this.reviveCount;return t&&(l.TData.isFirstRevive()||(parseInt(d.GConfig.getGbData(f.Enum_Gb.ReviveFree)),r.GValue.EntityWorld.curLevel),t=!0),t},addKillCount:function(){this.gameUI.addKillCount()},addPanelRevive:function(t,e){void 0===e&&(e=null),m.GFunc.createPrefabByName("PanelRevive",this.gameUINode,function(i){i.create(l.TData.isFirstRevive(),t,e)})},addPanelNew:function(t){var e=this;m.GFunc.createPrefabByName("PanelNew",this.gameUINode,function(i){i.create(t,e._bossPos,function(){e.addPanelOver(!0)})})},addPanelOver:function(t){var e=this;m.GFunc.createPrefabByName("PanelOver",this.gameUINode,function(i){i.create(t,e.gameUI.goldCount,parseInt(d.GConfig.getGbData(f.Enum_Gb.StagePower))),l.TData.getGuideStep()<f.Enum_GuideStep.StageOver&&l.TData.setGuideStep(f.Enum_GuideStep.StageOver)});s.DYTools.stringToNumber(d.GConfig.getGbData(f.Enum_Gb.WeaponReport),d.GConfig.SeparatorII);t||(r.GValue.StageFail<=0?(r.GValue.StageFail=this.curLevel,r.GValue.StageFailCount=1):this.curLevel==r.GValue.StageFail?r.GValue.StageFailCount++:(r.GValue.StageFail=this.curLevel,r.GValue.StageFailCount=1))},onBtnBack:function(){r.GValue.DDSDK&&(r.GValue.DDSDK.parent=null),r.GValue.HomeUI=null,cc.director.loadScene("Game")},getRangeEnemys:function(t,e){for(var i=[],o=0,n=this.Enemys;o<n.length;o++){var a=(p=n[o]).node.convertToWorldSpaceAR(cc.v2(0,0)),l=e+(p.radius?p.radius:0);s.DYTools.isNumberDiffRange(t.x,a.x,l)&&s.DYTools.isNumberDiffRange(t.y,a.y,e)&&i.push(p)}for(var h in this.SnakeEnemys)a=(p=this.SnakeEnemys[h]).node_tail.convertToWorldSpaceAR(cc.v2(0,0)),s.DYTools.isNumberDiffRange(t.x,a.x,e)&&s.DYTools.isNumberDiffRange(t.y,a.y,e)&&i.push(p);for(var h in this.CircleEnemys){var d=(y=this.CircleEnemys[h]).dic_node;for(var u in d){var m=d[u],p=m.getComponent(c);m&&(l=e+(p.radius?p.radius:0),a=m.convertToWorldSpaceAR(cc.v2(0,0)),s.DYTools.isNumberDiffRange(t.x,a.x,l)&&s.DYTools.isNumberDiffRange(t.y,a.y,e)&&i.push(p))}}for(var h in this.FireEnemys)(p=this.FireEnemys[h]).isDead||(a=p.node_collider.convertToWorldSpaceAR(cc.v2(0,0)),l=e+(p.radius?p.radius:0),s.DYTools.isNumberDiffRange(t.x,a.x,l)&&s.DYTools.isNumberDiffRange(t.y,a.y,l)&&i.push(p));for(var f in r.GValue.DicBossEnemy){var _=r.GValue.DicBossEnemy[f];for(var h in _){var y=_[h];i.push(y.getListDWLasterTarget())}}return i},getNeareastEnemys:function(t,e,i){for(var o=[],n=[],s=0,a=t;s<a.length;s++){var c=a[s],r=cc.Vec2.ZERO,l=c.radius?c.radius:0;r=c.isSnake?c.node_tail.convertToWorldSpaceAR(cc.Vec2.ZERO):c.isFire?c.node_collider.convertToWorldSpaceAR(cc.Vec2.ZERO):c.node.convertToWorldSpaceAR(cc.Vec2.ZERO);var h=e.sub(r).mag()-l;c.isFire,o.length<i?(o.push(c),n.push(h),n.sort(function(t,e){return t-e})):h<n[0]&&(o[0]=c,n[0]=h,n.sort(function(t,e){return t-e}))}return o},getFarthestEnemys:function(t,e,i){for(var o=[],n=[],s=0,a=t;s<a.length;s++){var c=a[s],r=cc.Vec2.ZERO,l=c.radius?c.radius:0;r=c.isSnake?c.node_tail.convertToWorldSpaceAR(cc.Vec2.ZERO):c.isFire?c.node_collider.convertToWorldSpaceAR(cc.Vec2.ZERO):c.node.convertToWorldSpaceAR(cc.Vec2.ZERO);var h=e.sub(r).mag()-l;o.length<i?(o.push(c),n.push(h),n.sort(function(t,e){return e-t})):h>n[0]&&(o[0]=c,n[0]=h,n.sort(function(t,e){return e-t}))}return o},getRangeEnemysForMap:function(t,e){for(var i=[],o=0,n=this.Enemys;o<n.length;o++){var a=n[o],c=a.node.position;s.DYTools.isNumberDiffRange(t.x,c.x,e)&&s.DYTools.isNumberDiffRange(t.y,c.y,e)&&i.push(a)}return i},getNeareastEnemysForMap:function(t,e,i){for(var o=[],n=[],s=0,a=t;s<a.length;s++){var c=a[s],r=cc.Vec2.ZERO;if(c.isSnake)r=c.node_tail.position.add(c.node.position);else{if(c.isFullBlood())continue;r=c.node.convertToWorldSpaceAR(cc.Vec2.ZERO),r=this.addEntitySys.enemyNode.convertToNodeSpaceAR(r)}var l=e.sub(r).magSqr();o.length<i?(o.push(c),n.push(l),n.sort(function(t,e){return t-e})):l<n[0]&&(o[0]=c,n[0]=l,n.sort(function(t,e){return t-e}))}return o},getSkinColor:function(t){var e,i=this.enemyColorBlood,o=r.GValue.EnemyColorBloodPercent,n=d.GConfig.colorArr;if(t<=this.enemyColorBlood[0])return n[0];if(t<=this.enemyColorBlood[1]){if((i[1]-i[0])*o+i[0]<t)return n[1];var s=(e=this.enemyColorParam[0])[0]*t+e[1],a=e[2]*t+e[3],c=e[4]*t+e[5];return cc.color(s,a,c)}return t<=this.enemyColorBlood[2]?(i[2]-i[1])*o+i[1]<t?n[2]:(s=(e=this.enemyColorParam[1])[0]*t+e[1],a=e[2]*t+e[3],c=e[4]*t+e[5],cc.color(s,a,c)):t<=this.enemyColorBlood[3]?(i[3]-i[2])*o+i[2]<t?n[3]:(s=(e=this.enemyColorParam[2])[0]*t+e[1],a=e[2]*t+e[3],c=e[4]*t+e[5],cc.color(s,a,c)):t<=this.enemyColorBlood[4]?(i[4]-i[3])*o+i[3]<t?n[4]:(s=(e=this.enemyColorParam[3])[0]*t+e[1],a=e[2]*t+e[3],c=e[4]*t+e[5],cc.color(s,a,c)):(i[5]-i[4])*o+i[4]<t?n[5]:(s=(e=this.enemyColorParam[4])[0]*t+e[1],a=e[2]*t+e[3],c=e[4]*t+e[5],cc.color(s,a,c))},playGoldFlyEffect:function(t,e,i){this.gameUI.playGoldFlyEffect(t,e,i)},playerKnifeColKniveEffect:function(t){this.knifeColIndex++,this.knifeColIndex%2==1&&h.GAudio.playSound(h.Enum_Audio.rival+s.DYTools.random_int(1,8));var e=t[0].parent.convertToWorldSpaceAR(t[0].position),i=t[1].parent.convertToWorldSpaceAR(t[1].position),o=cc.v2((e.x+i.x)/2,(e.y+i.y)/2);this.addEntitySys.addCollisionEffect(o)},getContinueEnemyRect:function(t){var e=cc.rect();switch(this.mapMgr.curDirTag){case 1:e=cc.rect(t.x,r.GValue.Size_View.height+100,t.width,0);break;case 2:e=cc.rect(t.x,-100,t.width,0);break;case 3:e=cc.rect(-100,t.y,0,t.height);break;case 4:e=cc.rect(r.GValue.Size_View.width+100,t.y,0,t.height)}return e}}),cc._RF.pop()},{CollisionEventManager:"CollisionEventManager",CommonAudio:"CommonAudio",CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonSdk:"CommonSdk",CommonValue:"CommonValue",ConfigData:"ConfigData",EntityEnemy:"EntityEnemy",GameData:"GameData",GuideUI:"GuideUI",HomeUI:"HomeUI",PropManager:"PropManager",Tools:"Tools",Types:"Types"}],CGameRuleSystem:[function(t,e,i){"use strict";cc._RF.push(e,"0343fQCg/hPs71gEHTHfyCN","CGameRuleSystem"),cc.Class({extends:cc.Component,properties:{},ctor:function(){this._countDownTime=99,this.players=[],this._gameOverFunc=null,this._localPlayer=null,this._allDead=!1,this._reviveFunc=null,this.isGameOver=!1,this.isRevive=!1},init:function(t,e,i,o,n){this._gameOverFunc=t,this._localPlayer=e;for(var s=0,a=i;s<a.length;s++){var c=a[s];this.players.push(c)}this._countDownTime=o,this._allDead=!1,this._reviveFunc=n},updateGameLogic:function(t){if(!this.isGameOver)if(this._countDownTime-=t,this._countDownTime<=0)this.onGameOver();else if(!this._localPlayer.firstDead||this.isRevive)if(this._localPlayer.isDead)this.onGameOver();else{this._allDead=!0;for(var e=0,i=this.players;e<i.length;e++){var o=i[e];if(!o.isLocal&&!o.isDead){this._allDead=!1;break}}this._allDead&&this.onGameOver()}else this.onRevive()},onGameOver:function(){this._gameOverFunc&&(this._gameOverFunc(),this._gameOverFunc=null,this.isGameOver=!0)},onRevive:function(){this._reviveFunc&&(this._reviveFunc(),this.isRevive=!0)},onContinue:function(){this.isRevive=!1}}),cc._RF.pop()},{}],CHMoveFix:[function(t,e,i){"use strict";cc._RF.push(e,"98e86jEdVND6o/ukHanEV3G","CHMoveFix");var o=t("Tools"),n=t("CommonValue");cc.Class({extends:cc.Component,properties:{},ctor:function(){this._collider=null,this._collisionBlocks=[],this._fixDir=null,this._minX=null,this._maxX=null,this._minY=null,this._maxY=null,this._collisionFix=[],this._offset=4,this._curCollisionWall=[],this._minViewX=0,this._maxViewX=0,this._minViewY=0,this._maxViewY=0,this._radius=0},onLoad:function(){this.node.on("fixByBlock",this.fixByBlock,this),this.node.on("wallCollision",this.collisionWall,this),this.node.on("wallLeave",this.leaveWall,this)},init:function(t){this._collider=t,this._radius=this._collider.radius*this._collider.node.parent.scale,this._minViewX=this._radius,this._maxViewX=n.GValue.Size_View.width-this._radius,this._minViewY=this._radius,this._maxViewY=n.GValue.Size_View.height-this._radius},updateGameLogic:function(t){!n.GValue.EntityWorld.m_gameOver&&this._collider&&(this.fixPositionByWall(),this.fixPositionByScreen(),this.reset())},fixByBlock:function(t){o.DYTools.arrContains(this._collisionBlocks,t)||this._collisionBlocks.push(t)},fixPositionByScreen:function(){var t=this.node.position.mul(n.GValue.MapScale),e=0,i=0,o=!1,s=!1;t.x<this._minViewX?(e=this._minViewX-t.x,o=!0):t.x>this._maxViewX&&(e=this._maxViewX-t.x,o=!0),t.y<this._minViewY?(i=this._minViewY-t.y,s=!0):t.y>this._maxViewY&&(i=this._maxViewY-t.y,s=!0),(o||s)&&(this.node.position=t.add(cc.v2(e,i)).mul(1/n.GValue.MapScale))},fixPositionByWall:function(){if(0!=this._curCollisionWall.length)for(var t=0;t<this._curCollisionWall.length;t++){var e=this._curCollisionWall[t],i=this._collider,s=e.node.parent,a=this.node.parent,c=s.position.add(n.GValue.EntityWorld.mapMgr.mapTop.position);switch(e.tag){case 0:var r=e.size.height;this._maxY=c.y-e.offset.y-.5*r-i.radius*i.node.parent.scale+this._offset,this.node.y>this._maxY&&(this.node.y=this._maxY);break;case 1:r=e.size.height,this._minY=c.y+e.offset.y+.5*r+i.radius*i.node.parent.scale-this._offset,this.node.y<this._minY&&(this.node.y=this._minY);break;case 2:r=e.size.height,this._minX=c.x+e.offset.y+.5*r+i.radius*i.node.parent.scale-this._offset,this.node.x<this._minX&&(this.node.x=this._minX);break;case 3:r=e.size.height,this._maxX=c.x-e.offset.y-.5*r-i.radius*i.node.parent.scale+this._offset,this.node.x>this._maxX&&(this.node.x=this._maxX);break;case 4:if(c=c.add(e.node.position),(m=(u=this.node.position.sub(c)).mag())<(p=this._radius+e.radius-this._offset)){var l=u.x/m,h=u.y/m,d=c.add(cc.v2(p*l,p*h));this.node.position=d}break;case 5:c.addSelf(e.node.position),(m=(u=this.node.position.sub(c)).mag())<(p=this._radius+e.radius-this._offset)&&(l=u.x/m,h=u.y/m,d=c.add(cc.v2(p*l,p*h)),this.node.position=d);break;case 6:var u,m;c=e.node.convertToWorldSpaceAR(cc.v2(0,0)),c=a.convertToNodeSpaceAR(c),(m=(u=this.node.position.sub(c)).mag())<(p=this._radius+.5*e.size.width-this._offset)&&(l=u.x/m,h=u.y/m,d=c.add(cc.v2(p*l,p*h)),this.node.position=d);break;case 101:var p=e.size.width,f=e.size.height,_=Math.abs(s.angle);if((_>80&&_<100||_>260&&_<280)&&(p=e.size.height,f=e.size.width),c=e.node.convertToWorldSpaceAR(cc.v2(0,0)),c=this.node.parent.convertToNodeSpaceAR(c),o.DYTools.isNumberDiffRange(this.node.y,c.y,f/2))this.node.x<c.x?(G=c.x-p/2-this._radius+this._offset)<this.node.x&&(this.node.x=G):(D=c.x+p/2+this._radius-this._offset)>this.node.x&&(this.node.x=D);else if(o.DYTools.isNumberDiffRange(this.node.x,c.x,p/2))this.node.y<c.y?(T=c.y-f/2-this._radius+this._offset)<this.node.y&&(this.node.y=T):(A=c.y+f/2+this._radius-this._offset)>this.node.y&&(this.node.y=A);else{var y=!1,g=!1,v=Math.abs(p/2+this._radius)-Math.abs(this.node.x-c.x),C=Math.abs(f/2+this._radius)-Math.abs(this.node.y-c.y);o.DYTools.isNumberDiffRange(v,C,this._offset)?(y=!0,g=!0):v<C?y=!0:v>C&&(g=!0);var S=this.node.position.sub(c);if(S.x>0&&S.y>0)y&&(D=c.x+p/2+this._radius-this._offset)>this.node.x&&(this.node.x=D),g&&(A=c.y+f/2+this._radius-this._offset)>this.node.y&&(this.node.y=A);else if(S.x>0&&S.y<0){var D;if(y)(D=c.x+p/2+this._radius-this._offset)>this.node.x&&(this.node.x=D);g&&(T=c.y-f/2-this._radius+this._offset)<this.node.y&&(this.node.y=T)}else if(S.x<0&&S.y<0){var T;if(y&&(G=c.x-p/2-this._radius+this._offset)<this.node.x&&(this.node.x=G),g)(T=c.y-f/2-this._radius+this._offset)<this.node.y&&(this.node.y=T)}else{var G,A;if(y)(G=c.x-p/2-this._radius+this._offset)<this.node.x&&(this.node.x=G);if(g)(A=c.y+f/2+this._radius-this._offset)>this.node.y&&(this.node.y=A)}}}}},collisionWall:function(t){o.DYTools.arrContains(this._curCollisionWall,t)||(this._curCollisionWall.push(t),101==t.tag&&this._collisionBlocks.push(t))},leaveWall:function(t){o.DYTools.arrRemove(this._curCollisionWall,t),101==t.tag&&o.DYTools.arrRemove(this._collisionBlocks,t)},reset:function(){this._collisionBlocks=[],this._collisionFix=[],this._minX=null,this._maxX=null,this._minY=null,this._maxY=null}}),cc._RF.pop()},{CommonValue:"CommonValue",Tools:"Tools"}],CHMove:[function(t,e,i){"use strict";cc._RF.push(e,"082c76TU+BBP4zaOTAZ7EwQ","CHMove"),cc.Class({extends:cc.Component,properties:{},ctor:function(){this.moveSpeed=300,this.moveSpeedRate=1,this._moveByPos=null},onLoad:function(){this.node.on("onMoveBy",this.onMoveByKeyboard,this),this.node.on("onStopMoving",this.onStopMovingByKeyboard,this),this.node.on("changeSpeedRate",this.changeSpeedRate,this)},set_speed:function(t){this.moveSpeed=t},onMoveByKeyboard:function(t){this.onMoveBy(t.dPos)},changeSpeedRate:function(t){this.moveSpeedRate=t},onStopMovingByKeyboard:function(){this._moveByPos=null},onMoveBy:function(t){this._moveByPos=t},updateGameLogic:function(t){this.onNodeMoveBy(t)},onNodeMoveBy:function(t){if(this._moveByPos){var e=this._moveByPos.normalize();this.node.x+=this.moveSpeed*this.moveSpeedRate*e.x*t,this.node.y+=this.moveSpeed*this.moveSpeedRate*e.y*t}}}),cc._RF.pop()},{}],CHRotate:[function(t,e,i){"use strict";cc._RF.push(e,"6196bQplX1LK46feHnNB0te","CHRotate"),cc.Class({extends:cc.Component,properties:{},ctor:function(){this.rotateSpeed=150,this.isStop=!1,this.stopKeepTime=.1,this._stopTime=0},onLoad:function(){this.node.on("stopParentRotate",this.stopRotate,this)},stopRotate:function(){this.isStop=!0,this._stopTime=0},setRotateSpeed:function(t){this.rotateSpeed=t},updateGameLogic:function(t){if(this.isStop){if(this._stopTime<this.stopKeepTime)return void(this._stopTime+=t);this.isStop=!1}this.node.angle+=this.rotateSpeed*t}}),cc._RF.pop()},{}],CHeroCollisionHandleSystem:[function(t,e,i){"use strict";cc._RF.push(e,"64babaGnm5HiqktaHkNIM1m","CHeroCollisionHandleSystem");var o=t("CBaseCollisionHandleSystem");cc.Class({extends:o,properties:{},ctor:function(){this._eventListName="_heroCollisionEvent"},handelCollisionEvent:function(t){var e=t[0],i=t[1];if(e&&e.node)switch(e.node.group){case"otherKnife":if(e.tag===i.tag||0===e.tag)return;i.node.emit("emitEvent",["dieByKnife",e]);break;case"block":break;case"enemy":var o=e.node.parent.getComponent("EntityEnemy");i.node.emit("emitEvent",["die",o]);break;case"prop":i.node.emit("emitEvent",["prop",e])}},updateGameLogic:function(t){o.prototype.updateGameLogic.call(this,t),this._collisionEventMgr.clearHeroEvent()}}),cc._RF.pop()},{CBaseCollisionHandleSystem:"CBaseCollisionHandleSystem"}],CHeroCollisionWallListener:[function(t,e,i){"use strict";cc._RF.push(e,"5b318bCPX9LL7MLlm+4kQAm","CHeroCollisionWallListener"),cc.Class({extends:cc.Component,properties:{},ctor:function(){this._wallCollisionCount=0},onLoad:function(){},radiusChange:function(t){},onCollisionExit:function(t,e){4!=t.node.groupIndex&&10!=t.node.groupIndex||(this._wallCollisionCount--,this.noticeWallLeave(t))},onCollisionEnter:function(t,e){4!=t.node.groupIndex&&10!=t.node.groupIndex||(this.noticeWallCollision(t),this._wallCollisionCount++)},noticeWallCollision:function(t){this.node.parent.emit("wallCollision",t)},noticeWallLeave:function(t){this.node.parent.emit("wallLeave",t)}}),cc._RF.pop()},{}],CHeroKnifeCollisionWallListener:[function(t,e,i){"use strict";cc._RF.push(e,"4ccd3hXjJZII60GCIMzLC3+","CHeroKnifeCollisionWallListener"),cc.Class({extends:cc.Component,properties:{},ctor:function(){this.collider=null,this._wallCollisionCount=0},onLoad:function(){this.collider=this.node.getComponent(cc.CircleCollider),this.node.on("radiusChange",this.radiusChange,this)},radiusChange:function(t){this.collider&&(this.collider.radius=t)},onCollisionExit:function(){this._wallCollisionCount--,0===this._wallCollisionCount&&this.noticeWallCollision(!1)},onCollisionEnter:function(){0===this._wallCollisionCount&&this.noticeWallCollision(!0),this._wallCollisionCount++},noticeWallCollision:function(t){this.node.emit("wallCollision",t)}}),cc._RF.pop()},{}],CKnifeColliderListener:[function(t,e,i){"use strict";cc._RF.push(e,"a820612P/FEWITaDjrYO1g4","CKnifeColliderListener");var o=t("Types");cc.Class({extends:cc.Component,properties:{},ctor:function(){},onLoad:function(){this.node.on("onPickUpKnife",this.onPickUpKnife,this),this.node.on("throwKnife",this.throwKnife,this)},throwKnife:function(t){this.node.emit("changeTag",t),this.node.emit("noticeOwnerLeave"),this.node.emit("updateState",o.KnifeState.Release),this.node.emit("stopResetPos")},onPickUpKnife:function(t){this.node.emit("changeTag",t.tag),this.node.emit("updateState",o.KnifeState.Capture),this.node.emit("stopResetPos"),this.node.emit("changeKnifeAttackGroup","knife"),t.node.emit("emitEvent",["addKnife",this.node])}}),cc._RF.pop()},{Types:"Types"}],CKnifeColliderNodeCtrl:[function(t,e,i){"use strict";cc._RF.push(e,"0789dvC569Nr7Pb5b3AFpoE","CKnifeColliderNodeCtrl");var o=t("Types");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.attackNode=null,this.rivalNode=null,this.knifeStateComp=null,this.isOut=!0},init:function(t,e,i){void 0===i&&(i=!0),this.attackNode=t,this.rivalNode=e,this.knifeStateComp=this.node.getComponent("CKnifeStateComponent"),this.isOut=i,this.isOut||(this.rivalNode.active=!1)},throwKnifeStart:function(){this.attackNode.active=!1,this.rivalNode.active=!1},pickKnife:function(){this.attackNode.active=!0,this.isOut&&(this.rivalNode.active=!0)},updateLogic:function(t){if(this.knifeStateComp||(this.knifeStateComp=this.node.getComponent("CKnifeStateComponent")),this.knifeStateComp.isDirty)switch(this.knifeStateComp.state){case o.KnifeState.Capture:case o.KnifeState.Init:this.pickKnife();break;case o.KnifeState.Release:this.throwKnifeStart();break;case o.KnifeState.Normal:this.throwKnifeFinish()}},throwKnifeFinish:function(){this.attackNode.active=!1,this.rivalNode.active=!1}}),cc._RF.pop()},{Types:"Types"}],CKnifeCollisionHandleSystem:[function(t,e,i){"use strict";cc._RF.push(e,"90db5cdN7ZGT4XZToskvI4j","CKnifeCollisionHandleSystem");var o=t("CBaseCollisionHandleSystem"),n=t("Types"),s=t("CommonValue"),a=t("CommonEnum"),c=t("CommonFunc");cc.Class({extends:o,properties:{},ctor:function(){this._eventListName="_knifeCollisionEvent"},handelCollisionEvent:function(t){var e=t[0],i=t[1];if(e&&e.node)switch(e.node.group){case"enemy":if(i.tag<=0)return;if(e.tag==a.E_CTag.Boss_SnakeTail){var o=e.name;(r=s.GValue.EntityWorld.SnakeEnemys[o])&&r.attackTail(0,s.GValue.EntityWorld.player.curAttack)}else if(e.tag>=a.E_CTag.Boss_SnakeHead&&e.tag<a.E_CTag.Boss_SnakeTail){var r;o=e.name,(r=s.GValue.EntityWorld.SnakeEnemys[o])&&r.attackBody(0,e.tag,i.node)}else if(e.tag==a.E_CTag.Boss_Fire){o=e.name;var l=s.GValue.EntityWorld.FireEnemys[o];l&&l.attack(0,s.GValue.EntityWorld.player.curAttack)}else if(e.tag>=a.E_CTag.Boss_ElectrHead&&e.tag<a.E_CTag.Boss_ElectrLine){o=e.name;var h=c.GFunc.getBossCom(n.BossType.Electr,o);h&&h.attack(0,s.GValue.EntityWorld.player.curAttack,e.tag)}this.attackEnemy(e,i);break;case"wall":if(i.tag>=0)return;var d=0;switch(e.tag){case 0:d=180;break;case 1:d=0;break;case 2:d=90;break;case 3:d=270}i.node.emit("emitEvent",["fixByWall",[e,d,i.size.height]]);break;case"otherKnife":if(i.tag<0||e.tag<0||i.tag===e.tag)return;this.node.emit("knifeCol",[i.node,e.node])}},updateGameLogic:function(t){o.prototype.updateGameLogic.call(this,t),this._collisionEventMgr.clearKnifeEvent()},attackEnemy:function(t,e){t.node.emit("emitEvent",["hurt",0,s.GValue.EntityWorld.player.curAttack]),e.node.parent.emit("attackLight")},throwKnife:function(t,e,i){t.node.emit("emitEvent",["stopParentRotate"]),t.node.emit("emitEvent",["throwKnife",i])}}),cc._RF.pop()},{CBaseCollisionHandleSystem:"CBaseCollisionHandleSystem",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonValue:"CommonValue",Types:"Types"}],CKnifeCountComponent:[function(t,e,i){"use strict";cc._RF.push(e,"0e8daAO3ZlM6rV800Je0EOy","CKnifeCountComponent");t("Types");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.index=0,this.maxCount=0,this.isDirty=!1,this.isMore=!1},onLoad:function(){this.node.on("updateCount",this.updateCount,this),this.node.on("resetDirty",this.resetDirty,this)},updateCount:function(t){this.index=t[0],this.isMore=this.maxCount<t[1],this.maxCount=t[1],this.isDirty=!0},resetDirty:function(){this.isDirty=!1}}),cc._RF.pop()},{Types:"Types"}],CKnifeFixByWallCtrl:[function(t,e,i){"use strict";cc._RF.push(e,"92aa6TZwVpIjopIUiUXhlgj","CKnifeFixByWallCtrl");t("Types");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.resetTime=.25,this._curResetTime=0,this._waitResetTime=0,this.allWaitTime=.1,this.knifeOwnerComp=null,this.targetPos=null,this.targetRollRotation=null,this.maxRadius=null,this.finalPos=null,this.finalRotation=null,this._startReset=null,this._firstStart=null},onLoad:function(){this.node.on("fixByWall",this.fixByWall,this),this.node.on("stopResetPos",this.stopResetPos,this),this.node.on("logicTargetPos",this.logicTargetPos,this),this.knifeOwnerComp||(this.knifeOwnerComp=this.node.getComponent("CKnifeOwnerComponent"))},logicTargetPos:function(t){this.targetPos=t[0].clone(),this.targetRollRotation=t[1],this.maxRadius=t[2]},stopResetPos:function(){this._startReset=!1},fixByWall:function(t){var e=t[0],i=t[1],o=t[2];this.knifeOwnerComp||(this.knifeOwnerComp=this.node.getComponent("CKnifeOwnerComponent"));var n=this.knifeOwnerComp.owner.angle+this.targetRollRotation,s=Math.cos(n*Math.PI/180),a=Math.sin(n*Math.PI/180),c=0;c=e.tag<2?(e.node.parent.y+(0===e.tag?-1:1)*(e.size.height/2+o/2)-this.knifeOwnerComp.owner.y)/a:(e.node.parent.x+(2===e.tag?1:-1)*(e.size.width/2+o/2)-this.knifeOwnerComp.owner.x)/s,c=Math.min(this.maxRadius,Math.max(50,Math.abs(c))),this.finalPos=this.node.position.normalize().mul(c);var r=(i-this.node.parent.angle-(270-this.targetRollRotation))%360;r<-180?r+=360:r>180&&(r-=360),this.finalRotation=r+(270-this.targetRollRotation),this.node.position=this.finalPos,this.node.angle=this.finalRotation,this._curResetTime=0,this._firstStart=!0,this._startReset=!0}}),cc._RF.pop()},{Types:"Types"}],CKnifeInit:[function(t,e,i){"use strict";cc._RF.push(e,"b3366s1mlhOIIl7c1NWQ7T3","CKnifeInit");var o=t("Types"),n=t("CEntityKnife");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.entityPlayer=null},init:function(t,e){void 0===e&&(e=!0),this.entityPlayer=t,e?(this.entityPlayer.addKnife(this.node),this.node.emit("changeKnifeAttackGroup","knife")):(this.entityPlayer.addKnifeIn(this.node),this.node.emit("changeKnifeAttackGroup","deputyWeapon")),this.node.emit("changeTag",this.entityPlayer.teamID),this.node.emit("updateState",o.KnifeState.Init),this.node.getComponent(n).skinNode.emit("changeSkin",this.entityPlayer.knifeImage)}}),cc._RF.pop()},{CEntityKnife:"CEntityKnife",Types:"Types"}],CKnifeMoveCtrl:[function(t,e,i){"use strict";cc._RF.push(e,"5c5d84laBhGPL636pDjDBU3","CKnifeMoveCtrl");var o=t("Types"),n=t("Tools"),s=t("CommonValue"),a=t("CommonFunc"),c=t("CommonConfig"),r=t("CommonAudio");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.knifeEntity=null,this.changeTime=.05,this.changeSpeed=500,this.adjustMoreSpeed=500,this.adjustLessSpeed=700,this.captureSpeed=300,this.releaseSpeed=1500,this.releaseRotation=1200,this.rollRotation=0,this.danceRoll=5,this.isOut=!0,this.knifeCountComp=null,this.knifeStateComp=null,this.danceIndex=0,this.startDance=!1,this.danceTime=0,this.danceRollAdd=0,this.acceleration=0,this.isDefence=!1,this.raduis=0,this.finalPosition=null,this.lastRotation=null,this.isRotating=!1,this.isCapture=!1,this.isRelease=!1,this.isAdjust=!1,this.isMore=!1,this.moveDistance=0},onLoad:function(){this.knifeCountComp=this.node.getComponent("CKnifeCountComponent"),this.knifeStateComp=this.node.getComponent("CKnifeStateComponent"),this.node.on("dance",this.dance,this),this.node.on("releasePosition",this.releasePosition,this),this.node.on("startChangeToAttack",this.startChangeToAttack,this),this.node.on("startChangeToDefence",this.startChangeToDefence,this)},init:function(t,e){void 0===e&&(e=!0),this.knifeEntity=t,this.isOut=e},update:function(t){if(!this.isRelease&&(t*=s.GValue.PauseSlowRatio,this.finalPosition&&(this.finalPosition.x!==this.node.position.x||this.finalPosition.y!==this.node.position.y))){var e=this.finalPosition.sub(this.node.position),i=e.mag();if(this.moveDistance=this.changeSpeed*t,this.isAdjust&&(this.isMore?this.moveDistance=this.adjustMoreSpeed*t:this.moveDistance=this.adjustLessSpeed*t),this.isCapture&&(this.moveDistance=(s.GValue.EntityWorld.m_gameOver?800:this.captureSpeed)*t),this.acceleration+=50*t,this.moveDistance+=this.acceleration,this.moveDistance<i)this.node.position=this.node.position.add(e.mul(this.moveDistance/i));else if(this.node.position=this.finalPosition,this.isAdjust&&(this.isAdjust=!1),this.isCapture){r.GAudio.playSound(r.Enum_Audio.pick_knife),this.isCapture=!1;var o=new cc.Node,n=o.addComponent(cc.Sprite);a.GFunc.changeAtlasSprite(s.GValue.Atlas_Test,n,"k_p_shine"),this.node.addChild(o);var l=c.GConfig.actionFrameTime,h=cc.scaleTo(4*l,1.8),d=cc.scaleTo(10*l,2.9),u=cc.fadeTo(10*l,0),m=cc.spawn(d,u),p=cc.sequence(h,m,cc.removeSelf());o.runAction(p)}}},dance:function(t){this.danceIndex=0,this.startDance=!0,this.danceTime=t,this.danceRoll=10,this.danceRollAdd=.5;for(var e=40,i=[],o=5;o>0;o--){var n=o/15*t/4;e-=2;var s=cc.sequence(cc.rotateBy(n,e),cc.rotateBy(n,-e),cc.rotateBy(n,-e),cc.rotateBy(n,e));i.push(s)}var a=cc.sequence(i);this.node.runAction(a)},getFinalPosition:function(){this.acceleration=0;var t=this.knifeCountComp.maxCount,e=this.knifeCountComp.index,i=this.knifeEntity.teamID==o.EntityTag.Enemy?90:this.isOut?n.DYTools.getRadiusByKnifeCount(t):n.DYTools.getRadiusByKnifeInCount(t);this.rollRotation=360/t*e;var s=Math.sin(this.rollRotation*Math.PI/180)*i,a=Math.cos(this.rollRotation*Math.PI/180)*i;return this.raduis=i,cc.v2(a,s)},releasePosition:function(t){this.releasePosition=t},getRadiusChangePosition:function(){var t=this.knifeCountComp.maxCount,e=this.knifeEntity.teamID==o.EntityTag.Enemy?90:this.isOut?n.DYTools.getRadiusByKnifeCount(t):n.DYTools.getRadiusByKnifeInCount(t),i=Math.sin(this.rollRotation*Math.PI/180)*e,s=Math.cos(this.rollRotation*Math.PI/180)*e;return this.raduis=e,cc.v2(s,i)},startChangeToDefence:function(){var t=this;this.isDefence=!0,this.finalPosition=this.getFinalPosition(),setTimeout(function(){var e=t.isDefence?o.KnifeState.Defence:o.KnifeState.Attack;t.node&&t.node.emit("updateState",e)},1e3*this.changeTime),this.rotateKnife()},startChangeToAttack:function(){this.finalPosition=this.getFinalPosition(),this.node.emit("updateState",o.KnifeState.Attack),this.rotateKnife()},getThrowPosition:function(){return this.acceleration=0,this.releasePosition},rotateKnife:function(){var t=this;if(this.node){var e=this.knifeEntity.teamID==o.EntityTag.Enemy?-this.rollRotation:90-this.rollRotation;if(this.lastRotation!==e){this.isRotating=!0,this.lastRotation=e;var i=cc.rotateTo(this.changeTime,e),n=cc.callFunc(function(){t.isRotating=!1});this.node.stopAllActions(),this.node.runAction(cc.sequence(i,n))}else this.isRotating||this.node.angle!==e&&(this.node.angle=-e)}},updateLogic:function(t){if(this.knifeStateComp||(this.knifeStateComp=this.node.getComponent("CKnifeStateComponent")),this.knifeCountComp||(this.knifeCountComp=this.node.getComponent("CKnifeCountComponent")),this.knifeStateComp.isDirty)switch(this.knifeStateComp.state){case o.KnifeState.Init:this.finalPosition=this.getFinalPosition(),this.node.position=this.finalPosition,this.logicTargetInfo();break;case o.KnifeState.Capture:this.isCapture=!0,this.finalPosition=this.getFinalPosition(),this.logicTargetInfo();break;case o.KnifeState.Attack:this.startDance=!1;break;case o.KnifeState.Defence:break;case o.KnifeState.Release:this.isRelease=!0}this.knifeCountComp.isDirty&&(this.isAdjust=!0,this.isMore=this.knifeCountComp.isMore,this.isCapture||this.isMore||(this.node.position=this.getRadiusChangePosition()),this.finalPosition=this.getFinalPosition(),this.rotateKnife(),this.logicTargetInfo(),this.setScale())},logicTargetInfo:function(){this.node.emit("logicTargetPos",[this.finalPosition,this.rollRotation,this.raduis])},updateDance:function(t){this.node.parent.children.length<3&&(this.startDance=!1),this.startDance&&(this.danceIndex%4==0?this.node.angle+=this.danceRoll:this.danceIndex%4==1?this.node.angle-=this.danceRoll:this.danceIndex%4==2?this.node.angle-=this.danceRoll:this.danceIndex%4==3&&(this.node.angle+=this.danceRoll,this.danceRoll+=this.danceRollAdd),this.danceIndex++)},setScale:function(){var t=.01*this.knifeCountComp.index+1;t=t>1.01?1.01:t,this.node.scale!==t&&(this.node.scale=t)}}),cc._RF.pop()},{CommonAudio:"CommonAudio",CommonConfig:"CommonConfig",CommonFunc:"CommonFunc",CommonValue:"CommonValue",Tools:"Tools",Types:"Types"}],CKnifeOwnerComponent:[function(t,e,i){"use strict";cc._RF.push(e,"701530XuwlJCIYu+6wNqqLw","CKnifeOwnerComponent"),cc.Class({extends:cc.Component,properties:{},ctor:function(){this.owner=null,this.player=null},onLoad:function(){this.node.on("updateOwner",this.updateOwner,this),this.node.on("noticeOwnerLeave",this.noticeOwnerLeave,this),this.node.on("addKnife",this.addKnife,this),this.node.on("stopParentRotate",this.stopParentRotate,this),this.node.on("localHeroCollision",this.localHeroCollision,this)},updateOwner:function(t){this.owner=t.node,this.player=t.player},stopParentRotate:function(){this.owner&&this.owner.emit("stopParentRotate")},noticeOwnerLeave:function(){this.owner&&(this.owner.emit("reduceKnife",this.node),this.owner=null)},localHeroCollision:function(){this.owner.emit("localHeroCollision")},addKnife:function(t){this.owner&&this.owner.emit("addKnife",t)}}),cc._RF.pop()},{}],CKnifeParentCtrl:[function(t,e,i){"use strict";cc._RF.push(e,"3ca41+W735MV5OMXy3BEcfT","CKnifeParentCtrl");var o=t("Types"),n=t("CEntityKnife");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.entity=null,this.itemNode=null,this.knifeStateComp=null,this.knifeOwnerComp=null},init:function(t,e){this.entity=t,this.itemNode=e,this.knifeStateComp=this.node.getComponent("CKnifeStateComponent"),this.knifeOwnerComp=this.node.getComponent("CKnifeOwnerComponent")},updateLogic:function(t){if(this.knifeStateComp||(this.knifeStateComp=this.node.getComponent("CKnifeStateComponent")),this.knifeOwnerComp||(this.knifeOwnerComp=this.node.getComponent("CKnifeOwnerComponent")),this.knifeStateComp.isDirty)switch(this.knifeStateComp.state){case o.KnifeState.Capture:case o.KnifeState.Init:this.knifeOwnerComp.owner&&this.changeParent(this.knifeOwnerComp.owner);break;case o.KnifeState.Release:var e=this.node.parent.convertToWorldSpaceAR(this.node.position),i=this.itemNode.convertToNodeSpaceAR(e),s=this.node.parent.parent.convertToWorldSpaceAR(this.node.parent.position),a=this.itemNode.convertToNodeSpaceAR(s),c=i.sub(a),r=[Math.PI/2,-Math.PI/2],l=Math.floor(2*Math.random()),h=Math.PI/36-Math.random()*(Math.PI/18),d=r[l]+h,u=c.rotate(d);this.changeParent(this.itemNode),this.entity.bossDiscarded?(this.node.emit("changeKnifeAttackGroup","landKnife"),this.node.getComponent(n).initDrop(u,1,1200,!1)):(this.node.emit("changeKnifeAttackGroup","landKnife"),this.node.getComponent(n).initDrop(u,1,1200))}},changeParent:function(t){var e=this.node.parent.convertToWorldSpaceAR(this.node.position),i=t.convertToNodeSpaceAR(e);this.node.parent=t,this.node.position=i}}),cc._RF.pop()},{CEntityKnife:"CEntityKnife",Types:"Types"}],CKnifeSkinCtrl:[function(t,e,i){"use strict";cc._RF.push(e,"dec3bC7fZJPwoE601SMPgf0","CKnifeSkinCtrl");var o=t("CommonFunc"),n=t("Types"),s=t("CommonValue");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.knifeStateComp=null,this.knifeOwnerComp=null},init:function(){this.knifeStateComp=this.node.parent.getComponent("CKnifeStateComponent"),this.knifeOwnerComp=this.node.parent.getComponent("CKnifeOwnerComponent"),this.node.on("changeSkin",this.changeSkin,this)},changeSkin:function(t){var e=this.node.getComponent(cc.Sprite);o.GFunc.changeAtlasSprite(s.GValue.Atlas_Game,e,t)},updateLogic:function(t){if(this.knifeStateComp||(this.knifeStateComp=this.node.parent.getComponent("CKnifeStateComponent")),this.knifeOwnerComp||(this.knifeOwnerComp=this.node.parent.getComponent("CKnifeOwnerComponent")),this.knifeStateComp.isDirty)switch(this.knifeStateComp.state){case n.KnifeState.Init:case n.KnifeState.Capture:}}}),cc._RF.pop()},{CommonFunc:"CommonFunc",CommonValue:"CommonValue",Types:"Types"}],CKnifeStateComponent:[function(t,e,i){"use strict";cc._RF.push(e,"b1866SEE5FPZ6ID4UpkRhjl","CKnifeStateComponent");var o=t("Types");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.state=o.KnifeState.Attack,this.isDirty=!1},onLoad:function(){this.node.on("updateState",this.updateState,this),this.node.on("resetDirty",this.resetDirty,this)},resetDirty:function(){this.isDirty=!1},updateState:function(t){this.state!==t&&(t!==o.KnifeState.Attack&&t!==o.KnifeState.Defence||this.state!==o.KnifeState.Capture&&this.state!==o.KnifeState.Release||!this.isDirty)&&(this.state=t,this.isDirty=!0)}}),cc._RF.pop()},{Types:"Types"}],CLogicPlayer:[function(t,e,i){"use strict";cc._RF.push(e,"37635a1125M6YWgZsaOPX9R","CLogicPlayer");var o=t("Tools");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.entityPlayer=null,this.knivesCmp=null,this.knivesCmpIn=null},init:function(t){this.entityPlayer=t,this.knivesCmp=this.entityPlayer.followPlayerOut.knivesCmp},updateLogic:function(t){if(this.knivesCmp.isDirty){var e=this.knivesCmp.emitAllKnivesCountChange(),i=o.DYTools.getRadiusByKnifeCount(e);this.knivesCmp.node.emit("radiusChange",i),this.entityPlayer.node.emit("radiusChange",i),this.knivesCmp.resetDirty()}}}),cc._RF.pop()},{Tools:"Tools"}],CLoginEnemy:[function(t,e,i){"use strict";cc._RF.push(e,"ce4f1QuY2pBDa6FM1CzqdWa","CLoginEnemy");var o=t("Tools");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.knivesCmp=null},init:function(t){this.entityEnemy=t,this.knivesCmp=this.entityEnemy.followCtrl.followEnemy.knivesCmp},updateLogic:function(t){if(this.knivesCmp.isDirty){var e=this.knivesCmp.emitAllKnivesCountChange(),i=o.DYTools.getRadiusByKnifeCount(e);this.knivesCmp.node.emit("radiusChange",i),this.entityEnemy.node.emit("radiusChange",i),this.knivesCmp.resetDirty()}}}),cc._RF.pop()},{Tools:"Tools"}],CMoveByTouch:[function(t,e,i){"use strict";cc._RF.push(e,"6796dtRwYlMpLSzVZMRalAn","CMoveByTouch");var o=t("Tools"),n=t("CommonValue");cc.Class({extends:cc.Component,properties:{},ctor:function(){this._target=null,this.startPos=null,this.curDir=null,this.player=null,this.touchAble=!1,this.touching=!0,this.touchFalseTime=0,this.firstTouchId=-1,this.touchCall=null},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._touchStartEvent,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._touchMoveEvent,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEndEvent,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEndEvent,this)},init:function(t,e){void 0===e&&(e=null),this.player=t,this.touchCall=e,this._target=t.node,this.touchAble=!0,this.touching=!0,n.GValue.EntityWorld.setTouching(!0)},update:function(t){this.touching||this.player.isDead||(this.touchFalseTime+=t,this.touchFalseTime>.5&&n.GValue.EntityWorld.setTouching(!1))},_touchMoveEvent:function(t){if(t&&this.firstTouchId==t.getID()&&this.touchAble){n.GValue.EntityWorld.setTouching(!0);var e=t.getDelta();n.GValue.MapScale<.95&&e.mulSelf(1/n.GValue.MapScale);var i=this._target.position,s=i.add(e);if(e.mag()>25)for(var a=0,c=n.GValue.EntityWorld.Enemys;a<c.length;a++){var r=c[a],l=r.node.position.add(n.GValue.EntityWorld.mapMgr.mapTop.position),h=cc.Intersection.pointLineDistance(l,i,s,!0);if(r.radius&&h<=r.radius){this.player.dieByEnemy(r);break}}for(var d=n.GValue.EntityWorld.mapMgr.blockArr,u=0;u<d.length;u++){var m=d[u],p=m.width,f=m.height;if(l=m.colCollider.node.convertToWorldSpaceAR(cc.v2(0,0)),o.DYTools.isInSreen(l,-p)){l=this._target.parent.convertToNodeSpaceAR(l);var _=cc.rect(l.x-.5*p,l.y-.5*f,p,f);if(cc.Intersection.lineRect(i,s,_)){for(var y=s.sub(i).normalize(),g=(h=s.sub(i).mag(),i),v=1;v<h;v+=1){var C=i.add(y.mul(v));if(_.contains(C))break;g=i}s=g}}}this._target.position=s}},_touchStartEvent:function(t){t&&this.touchAble&&(this.firstTouchId<0&&(this.firstTouchId=t.getID(),this.startPos=t.getLocation(),this._target.emit("heroMoveStart"),n.GValue.EntityWorld.setTouching(!0),this.touching=!0),this.touchCall&&(this.touchCall(),this.touchCall=null))},touchEndEvent:function(t){void 0===t&&(t=null),t?this.firstTouchId==t.getID()&&(this.firstTouchId=-1,this._target.emit("onStopMoving"),this.curDir=null,this.touching=!1,this.touchFalseTime=0):(this.firstTouchId=-1,n.GValue.EntityWorld.setTouching(!1))}}),cc._RF.pop()},{CommonValue:"CommonValue",Tools:"Tools"}],CMoveWithOwnerNode:[function(t,e,i){"use strict";cc._RF.push(e,"e1dcb72YI1MtoV1KFX48q9v","CMoveWithOwnerNode"),cc.Class({extends:cc.Component,properties:{},ctor:function(){this._owner=null,this._entity=null,this._isSyncCulling=!1,this._followNode=null,this.offset=cc.Vec2.ZERO,this.isMoving=!1},init:function(t,e,i,o){void 0===o&&(o=cc.Vec2.ZERO),this._owner=t,this._entity=e,this._followNode=i?i.node:null,this.offset=o,this.updatePos(!0)},lateUpdate:function(){this._owner&&this.updatePos(!1)},getOwnerPos:function(){var t=null;if(this._followNode){var e=this._followNode.parent.convertToWorldSpaceAR(this._followNode);t=(this._entity.node.parent?this._entity.node.parent:this._entity.node).convertToNodeSpaceAR(e)}else t=this._owner?cc.v2(this._owner.position):cc.Vec2.ZERO;return t},updatePos:function(t){if(this._owner){var e=this.getOwnerPos(),i=this._entity.node.position;t||e.x!==i.x||e.y!==i.y?(this._entity.node.position=e.add(this.offset),this.isMoving=!0):!0===this.isMoving&&(this.isMoving=!1)}}}),cc._RF.pop()},{}],CNodeCollider:[function(t,e,i){"use strict";cc._RF.push(e,"46c57uf1hpMMYtQpBQPAoRl","CNodeCollider");var o=t("CollisionEventManager");cc.Class({extends:cc.Component,properties:{},ctor:function(){this._collider=null,this.parent=null,this.needCheckCollision=null,this.needCheckStay=null},onLoad:function(){this._collider=this.node.getComponent(cc.Collider),this.node.on("changeColliderTag",this.changeColliderTag,this),this.node.on("changeNodeGroup",this.changeNodeGroup,this),this.node.on("emitEvent",this.emitEvent,this)},init:function(t,e,i){void 0===i&&(i=!1),this.parent=t,this.needCheckCollision=e,this.needCheckStay=i},onCollisionEnter:function(t,e){this.needCheckCollision&&o.CollisionEventManager.getInstance().addCollisionEvent(t,e)},changeColliderTag:function(t){this._collider?this._collider.tag=t:cc.error("no Collider To Change Tag")},onCollisionStay:function(t,e){this.needCheckCollision&&this.needCheckStay&&o.CollisionEventManager.getInstance().addCollisionStayEvent(t,e)},onCollisionExit:function(t,e){this.needCheckCollision&&this.needCheckStay&&o.CollisionEventManager.getInstance().removeCollisionEvent(t,e)},emitEvent:function(t){this.parent&&this.parent.emit(t[0],t[1],t[2])},changeNodeGroup:function(t){this.node.group=t}}),cc._RF.pop()},{CollisionEventManager:"CollisionEventManager"}],CPickKnifeCollisionHandleSystem:[function(t,e,i){"use strict";cc._RF.push(e,"55ab9lXMpNC3opwr1n3sEWM","CPickKnifeCollisionHandleSystem");var o=t("CBaseCollisionHandleSystem");cc.Class({extends:o,properties:{},ctor:function(){this._eventListName="_pickKnifeCollisionEvent"},handelCollisionEvent:function(t){var e=t[0],i=t[1];1===e.tag&&0===i.tag&&i.node.emit("emitEvent",["onPickUpKnife",e])},updateGameLogic:function(t){this._collisionEventMgr.clearPickKnifeEvent()}}),cc._RF.pop()},{CBaseCollisionHandleSystem:"CBaseCollisionHandleSystem"}],CPlayerKnivesComponent:[function(t,e,i){"use strict";cc._RF.push(e,"cab3cIFP/BMN6LZLuEPeD/X","CPlayerKnivesComponent");var o=t("Tools"),n=t("CommonValue"),s=t("CEntityKnife"),a=t("CommonAudio");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.knives=[],this.lights=[],this.strongNode=null,this.isDirty=!1,this.player=null,this.startGame=!1,this.isCollisionWall=null,this.isMove=!1,this.interval=0,this.stopMoveTime=0,this.flitIndex=0,this.limitTime=0,this.danceTime=0,this.danceKnifeArr=[]},init:function(t,e){var i=this;void 0===e&&(e=!0),this.player=t,this.node.on("startGame",function(){i.startGame=!0,i.knives=i.knives.concat()},this),e&&(this.node.on("addKnife",this.addKnife,this),this.node.on("reduceKnife",this.reduceKnife,this),this.node.on("resetDirty",this.resetDirty,this)),this.node.on("wallCollision",this.wallCollision,this),this.node.on("enterStrong",this.enterStrong,this)},wallCollision:function(t){this.isCollisionWall=t},update:function(t){for(var e=0;e<this.knives.length;e++){var i=this.knives[e];i&&i.emit("startChangeToAttack")}},reduceKnife:function(t){o.DYTools.arrRemove(this.knives,t),this.isDirty=!0,this.strongNode&&(this.strongNode.scale=this.player.radius/130)},addKnife:function(t){o.DYTools.arrContains(this.knives,t)||(this.knives.push(t),t.emit("updateOwner",this),t.getComponent(s).skinNode.emit("changeSkin",this.player.knifeImage),this.checkNewKnifeStrong(t),this.isDirty=!0),this.strongNode&&(this.strongNode.scale=this.player.radius/130)},emitAllKnivesCountChange:function(){for(var t=this.knives.length,e=0;e<t;e++)this.knives[e].emit("updateCount",[e,t]);return t},resetDirty:function(){this.isDirty=!1},checkNewKnifeStrong:function(t){},enterStrong:function(t){0==t?(this.strongNode&&(this.strongNode.removeFromParent(),this.strongNode=null),a.GAudio.stopSoundByName(a.Enum_Audio.strong)):(this.strongNode?a.GAudio.stopSoundByName(a.Enum_Audio.strong):(this.strongNode=new cc.Node,this.node.addChild(this.strongNode,1),this.strongNode.scale=this.player.radius/130,this.strongNode.addComponent(cc.Sprite).spriteFrame=n.GValue.Atlas_Game.getSpriteFrame("strong")),a.GAudio.playSound(a.Enum_Audio.strong))},addStrongLight:function(t,e){var i=new cc.Node;this.node.addChild(i,-1),i.position=t.add(cc.v2(0,-4)),i.angle=-e,i.addComponent(cc.Sprite).spriteFrame=n.GValue.Atlas_Game.getSpriteFrame("kl"),this.lights.push(i)},getKnifeNum:function(){return this.knives.length},emitAllKnivesChangeSkin:function(){for(var t=this.knives.length,e=0;e<t;e++)this.knives[e]&&this.knives[e].getComponent("CEntityKnife").skinNode.emit("changeSkin",this.player.knifeImage)},emitAllKnivesRelease:function(){for(var t=this.knives.length,e=0;e<t;e++)this.knives[e]&&this.knives[e].emit("throwKnife");this.knives=[]},removeSelf:function(){for(var t=0;t<this.knives.length;t++){var e=this.knives[t];e&&e.getComponent(s).removeSelf()}}}),cc._RF.pop()},{CEntityKnife:"CEntityKnife",CommonAudio:"CommonAudio",CommonValue:"CommonValue",Tools:"Tools"}],CPoolMgr:[function(t,e,i){"use strict";cc._RF.push(e,"3cc45+AgApO+K57+80yNNCV","CPoolMgr");var o=t("Types");cc.Class({extends:cc.Component,properties:{prefabArray:[cc.Prefab]},init:function(){this.poolArray=[];for(var t=0;t<o.PoolType.COUNT;t++){var e=new cc.NodePool,i=this.prefabArray[t],n=0;switch(t){case o.PoolType.PLAYER:case o.PoolType.PLAYER_MAIN_FOLLOW:case o.PoolType.PLAYER_DW_FOLLOW:n=1;break;case o.PoolType.ENEMY:n=60;break;case o.PoolType.KNIFE:n=100;break;case o.PoolType.PROP:n=10;break;case o.PoolType.FOLLOW_ENEMY:n=1;break;case o.PoolType.DW_KNIFE:n=6}for(var s=0;s<n&&i;){var a=cc.instantiate(i);e.put(a),s++}this.poolArray[t]=e}},getPlayer:function(t){return void 0===t&&(t="CEntityPlayer"),this.get(o.PoolType.PLAYER,t)},getPlayerMainFollow:function(t){return void 0===t&&(t="CEntityFollowPlayer"),this.get(o.PoolType.PLAYER_MAIN_FOLLOW,t)},getPlayerDWFollow:function(t){return void 0===t&&(t="CEntityFollowPlayer"),this.get(o.PoolType.PLAYER_DW_FOLLOW,t)},getDWKnife:function(){return this.get(o.PoolType.DW_KNIFE)},getKnife:function(t){return void 0===t&&(t="CEntityKnife"),this.get(o.PoolType.KNIFE,t)},getEnemy:function(t){return void 0===t&&(t="EntityEnemy"),this.get(o.PoolType.ENEMY,t)},putEnemy:function(t){this.put(o.PoolType.ENEMY,t)},getWall:function(t){return void 0===t&&(t="CEntityWall"),this.get(o.PoolType.WALL,t)},getProp:function(){return this.get(o.PoolType.PROP)},putProp:function(t){this.put(o.PoolType.PROP,t)},getFollowEnemy:function(){return this.get(o.PoolType.FOLLOW_ENEMY)},getCollEffect:function(){return this.get(o.PoolType.EFFECT)},get:function(t,e){void 0===e&&(e="");var i=this.poolArray[t];if(i){var o=i.get();if(!o){var n=this.prefabArray[t];o=cc.instantiate(n)}return o}return cc.error("can't get pool of type:"+t),null},put:function(t,e){var i=this.poolArray[t];if(!i||!e)return cc.error("can't get pool of type:"+t),null;i.put(e)}}),cc._RF.pop()},{Types:"Types"}],CollisionEventManager:[function(t,e,i){"use strict";cc._RF.push(e,"2e1a25hXA1P6LvFsrwgqYzu","CollisionEventManager");var o=e.exports;Object.defineProperty(o,"__esModule",{value:!0});var n=t("Tools"),s=function(){function t(){this._heroCollisionEvent=[],this._knifeCollisionEvent=[],this._rivalKnifeCollisionEvent=[],this._deputyWeaponCollisionEvent=[]}return t.getInstance=function(){return null===t.instance&&(t.instance=new t,t.instance.init()),t.instance},t.cleanUp=function(){t.instance&&n.DYTools.cleanUp(t.instance),t.instance=null},t.prototype.init=function(){this.clear(),cc.director.getCollisionManager().enabled=!0},t.prototype.addCollisionEvent=function(t,e){1===e.node.groupIndex?this._heroCollisionEvent.push([t,e]):2===e.node.groupIndex?this._knifeCollisionEvent.push([t,e]):6===e.node.groupIndex?this._rivalKnifeCollisionEvent.push([t,e]):9===e.node.groupIndex&&this._deputyWeaponCollisionEvent.push([t,e])},t.prototype.addCollisionStayEvent=function(t,e){2!==e.node.groupIndex&&7!==e.node.groupIndex||5!==t.node.groupIndex&&3!==t.node.groupIndex?4===e.node.groupIndex&&this._heroCollisionEvent.push([t,e]):this._knifeCollisionEvent.push([t,e])},t.prototype.removeCollisionEvent=function(t,e){e.node.groupIndex},t.prototype.clearKnifeEvent=function(){this._knifeCollisionEvent=[]},t.prototype.clearHeroEvent=function(){this._heroCollisionEvent=[]},t.prototype.clearDeputyWeaponEvent=function(){this._deputyWeaponCollisionEvent=[]},t.prototype.clear=function(){this._heroCollisionEvent=[],this._knifeCollisionEvent=[],this._rivalKnifeCollisionEvent=[],this._deputyWeaponCollisionEvent=[]},t.prototype.clearRivalKnifeEvent=function(){this._rivalKnifeCollisionEvent=[]},t.prototype.setCollisionAble=function(t){cc.director.getCollisionManager().enabled=t},t.instance=null,t}();o.CollisionEventManager=s,cc._RF.pop()},{Tools:"Tools"}],CommonAudio:[function(t,e,i){"use strict";cc._RF.push(e,"4d498XoBn5Ok5Bx39HXKowN","CommonAudio");var o=e.exports,n=t("Tools"),s=t("GameData");o.Enum_Audio=cc.Enum({bgm:"bgm",bgm_main:"bgm_main",bgm_boss:"bgm_boss",goldLess:"goldLess",enemyDie:"eDie",hurt:"hurt",lvup_arms:"lvup_arms",lvup_gold:"lvup_gold",lvup_open_close:"lvup_open_close",pick_knife:"pick_knife",fly_gold:"fly_gold",stoneBomb:"stoneBomb",strong:"strong",BossDropKnife:"BossDropKnife",warning:"warning",playerFly:"playerFly",playerFly_1:"playerFly_1",laserAtk:"laserAtk",rival:"rival_",newDW:"newDW",revive:"revive",overSuccess:"overSuccess",overFailed:"overFailed",overWGold:"overWGold",overLevelChange:"overLevelChange",overGoldChange:"overGoldChange",bossFireIn:"bossFireIn",bossFireCharge:"bossFireCharge",bossFireAttack:"bossFireAttack",bossFireStep:"bossFireStep",bossFireDie:"bossFireDie",bossFireBomb:"bossFireBomb",bossElectrIn:"bossElectrIn",bossElectrLaunch:"bossElectrLaunch",bossElectrGun:"bossElectrGun",bossElectrDie:"bossElectrDie"});var a=function(){function t(){this.curGuideAudioId=-1,this._isSoundOn=!0,this._isMusicOn=!0,this.curBgm=o.Enum_Audio.bgm_main,this.enemyHurt=null,this.willPlayHurt=!1,this.enemyHurting=!1,this.dict={},this.clipDict={},this.soundIdDict={},this.hasPlayBgm=!1}return t.prototype.init=function(){var t=this,e=s.TData.SettingData.sound;this._isSoundOn=!!e,e=s.TData.SettingData.music,this._isMusicOn=!!e;var i=function(e){if("rival"==e)for(var i=function(i){var s=o.Enum_Audio[e]+i,a="audio/"+s;cc.loader.loadRes(a,function(e,i){e?n.DYTools.error(e):t.clipDict[s]=i})},s=1;s<=8;s++)i(s);else{var a=o.Enum_Audio[e],c="audio/"+o.Enum_Audio[e];cc.loader.loadRes(c,function(e,i){e?n.DYTools.error(e):t.clipDict[a]=i})}};for(var a in o.Enum_Audio)i(a)},t.prototype.checkBgm=function(){cc.sys.os==cc.sys.OS_IOS&&this.hasPlayBgm&&(cc.audioEngine.isMusicPlaying()||this.curBgm&&this.playBgm(this.curBgm))},t.prototype.playBgm=function(t){if(this.curBgm=t,this._isMusicOn)if(this.clipDict[t])cc.audioEngine.playMusic(this.clipDict[t],!0),this.hasPlayBgm=!0;else{var e="audio/"+t;cc.loader.loadRes(e,function(t,e){t?n.DYTools.error(t):(cc.audioEngine.playMusic(e,!0),this.hasPlayBgm=!0)})}},t.prototype.playSound=function(t,e){if(void 0===e&&(e=!1),this._isSoundOn)if(this.clipDict[t])this.soundIdDict[t]=this.playSoundWithClip(this.clipDict[t],e);else{var i=this,o="audio/"+t;cc.loader.loadRes(o,function(o,s){if(o)n.DYTools.error(o);else{i.clipDict[t]=s;var a=i.playSoundWithClip(s,e);i.soundIdDict[t]=a}})}},t.prototype.playSoundWithClip=function(t,e){return void 0===e&&(e=!1),this._isSoundOn?cc.audioEngine.playEffect(t,e):-1},Object.defineProperty(t.prototype,"musicOn",{get:function(){return this._isMusicOn},set:function(t){this._isMusicOn=t,s.TData.setSettingMusic(t?1:0),this._isMusicOn?this.playBgm(this.curBgm):cc.audioEngine.stopAll()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"soundOn",{get:function(){return this._isSoundOn},set:function(t){this._isSoundOn=t,s.TData.setSettingSound(t?1:0)},enumerable:!0,configurable:!0}),t.prototype.stopSoundByName=function(t){this.soundIdDict[t]&&(cc.audioEngine.stopEffect(this.soundIdDict[t]),this.soundIdDict[t]=-1)},t.prototype.stopSound=function(t){this._isSoundOn&&cc.audioEngine.stopEffect(t)},t.prototype.stopAllSound=function(){this._isSoundOn&&cc.audioEngine.stopAllEffects()},t.prototype.playEnemyHurtSound=function(){if(this._isSoundOn)if(this.willPlayHurt=!0,this.enemyHurt)this.checkEnemyHurtSound();else{var t=this,e="audio/"+o.Enum_Audio.hurt;cc.loader.loadRes(e,function(e,i){e?n.DYTools.error(e):(t.enemyHurt=i,t.checkEnemyHurtSound())})}},t.prototype.checkEnemyHurtSound=function(){var t=this.getSoundNum(o.Enum_Audio.hurt);if(t<5){var e=this;this.dict[o.Enum_Audio.hurt]=t+1;var i=cc.audioEngine.playEffect(this.enemyHurt,!1);cc.audioEngine.setFinishCallback(i,function(){e.dict[o.Enum_Audio.hurt]=e.getSoundNum(o.Enum_Audio.hurt)-1,e.soundIdDict[o.Enum_Audio.hurt]=i})}},t.prototype.getSoundNum=function(t){var e=this.dict[t];return e||(e=0),e},t.instance=new t,t}();o.GAudio=a.instance,window.GAudio=o.GAudio,cc._RF.pop()},{GameData:"GameData",Tools:"Tools"}],CommonConfig:[function(t,e,i){"use strict";cc._RF.push(e,"36400VwPKBN1KtXaITWwcdd","CommonConfig");var o=e.exports,n=t("CommonEnum"),s=t("CommonEnum"),a=t("GameData"),c=t("Types"),r=function(){function t(){this.Server_Local="http://192.168.1.92:8080/bladeX",this.Server_Test="http://62.234.166.105:80/bladeX",this.Server_Publish_WeiXin="https://popstar.gameley02.cn/popStar12",this.Version_Num="0.1.9",this.VersionCode=109,this.Url_Login=this.Server_Local,this.environment=n.Enum_EnvironmentType.Publish,this.channel=s.Enum_Channel.Local,this.BiReport=!0,this.hasLog=!1,this.isCheat=!1,this.isLocal=!1,this.DeviceList_TopBar=["IPHONE X","Y85A","PAAM00","PACM00"],this.actionFrameTime=.0333,this.SeparatorI="#",this.SeparatorII="*",this.SeparatorIII=",",this.MaxLevel=19,this.MapDict={},this.LevelDict={},this.EnemyDict={},this.AttrDict={},this.EnemyOutDict={},this.PauseDict={},this.EnemyConDict={},this.MapAreaEnemyDict={},this.MapBossDict={},this.BossKnifeDict={},this.MapBossSnakeDict={},this.MapBossCircleDict={},this.MapBossFireDict={},this.MapBossElectrDict={},this.PropertyArmsMainDict={},this.PropertyArmsSubDict={},this.PropertyGoldKillDict={},this.PropertyGoldOfflineDict={},this.GbData={},this.GuideDict={},this.colorArr=[cc.color(255,255,0),cc.color(0,255,0),cc.color(0,190,255),cc.color(190,0,255),cc.color(255,0,180),cc.color(255,0,0)],this.enemyFirePos={1:cc.v2(0,0),2:cc.v2(0,6),3:cc.v2(0,10),4:cc.v2(0,-6),5:cc.v2(0,-14),6:cc.v2(0,0),9:cc.v2(0,-10),10:cc.v2(0,0),11:cc.v2(0,10),101:cc.v2(0,0),104:cc.v2(0,-20),106:cc.v2(0,0),200:cc.v2(0,-6),201:cc.v2(0,10),202:cc.v2(0,20),203:cc.v2(0,20),1001:cc.v2(0,-20),1002:cc.v2(0,-10)},this.enemyFireScale={4:1.8,6:1.8},this.enemyGoldEyePos={1:cc.v2(26,-42),2:cc.v2(28,-26),3:cc.v2(38,-38),4:cc.v2(38,-38),5:cc.v2(0,-14),6:cc.v2(0,0),9:cc.v2(0,-10),10:cc.v2(0,0),11:cc.v2(0,10),101:cc.v2(0,0),104:cc.v2(0,-20),106:cc.v2(0,0),200:cc.v2(0,-6),201:cc.v2(0,10),202:cc.v2(0,20),203:cc.v2(0,20),1001:cc.v2(0,-20),1002:cc.v2(0,-10)},this.enemyGoldEyeScale={1:1,2:1,3:1,4:1,5:1,6:1}}return Object.defineProperty(t.prototype,"isDevelop",{get:function(){return this.environment==n.Enum_EnvironmentType.Develop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isWx",{get:function(){return this.channel==s.Enum_Channel.WeiXin},enumerable:!0,configurable:!0}),t.prototype.addLevelData=function(t){this.LevelDict[t.level]=t},t.prototype.getLevelData=function(t){return this.LevelDict[t]},t.prototype.addEnemyData=function(t){this.EnemyDict[t.id]=t},t.prototype.getEnemyData=function(t){return this.EnemyDict[t]},t.prototype.addAttrData=function(t){this.AttrDict[t.id]=t},t.prototype.getAttrData=function(t){return this.AttrDict[t]},t.prototype.addEnemyOutData=function(t){this.EnemyOutDict[t.id]=t},t.prototype.getEnemyOutData=function(t){return this.EnemyOutDict[t]},t.prototype.addPauseData=function(t){this.PauseDict[t.id]=t},t.prototype.getPauseData=function(t){return this.PauseDict[t]},t.prototype.addEnemyConData=function(t){this.EnemyConDict[t.id]=t},t.prototype.getEnemyConData=function(t){return this.EnemyConDict[t]},t.prototype.addMapAreaEnemyData=function(t){this.MapAreaEnemyDict[t.id]=t},t.prototype.getMapAreaEnemyData=function(t){return this.MapAreaEnemyDict[t]},t.prototype.addMapBossData=function(t){this.MapBossDict[t.id]=t},t.prototype.getMapBossData=function(t){return this.MapBossDict[t]},t.prototype.getConfigBossDatas=function(t){for(var e=[],i=0;i<t.type.length;i++)e.push(this.getConfigBossData(t.type[i],t.bId[i]));return e},t.prototype.getConfigBossData=function(t,e){var i=null;switch(t){case c.BossType.Knife:i=o.GConfig.getKnifeBossData(e);break;case c.BossType.Snake:i=o.GConfig.getMapBossSnakeData(e);break;case c.BossType.Circle:i=o.GConfig.getMapBossCircleData(e);break;case c.BossType.Fire:i=o.GConfig.getMapBossFireData(e);break;case c.BossType.Electr:i=o.GConfig.getMapBossElectrData(e)}return i},t.prototype.addKnifeBossData=function(t){this.BossKnifeDict[t.id]=t},t.prototype.getKnifeBossData=function(t){return this.BossKnifeDict[t]},t.prototype.addMapBossSnakeData=function(t){this.MapBossSnakeDict[t.id]=t},t.prototype.getMapBossSnakeData=function(t){return this.MapBossSnakeDict[t]},t.prototype.addMapBossCircleData=function(t){this.MapBossCircleDict[t.id]=t},t.prototype.getMapBossCircleData=function(t){return this.MapBossCircleDict[t]},t.prototype.addMapBossFireData=function(t){this.MapBossFireDict[t.id]=t},t.prototype.getMapBossFireData=function(t){return this.MapBossFireDict[t]},t.prototype.addMapBossElectrData=function(t){this.MapBossElectrDict[t.id]=t},t.prototype.getMapBossElectrData=function(t){return this.MapBossElectrDict[t]},t.prototype.addPropertyArmsMainData=function(t){this.PropertyArmsMainDict[t.lv]=t},t.prototype.getPropertyArmsMainData=function(t){return this.PropertyArmsMainDict[t]},t.prototype.getPropertyData_Main=function(){var t=a.TData.getPropertyLv(n.Enum_PropertyId.ArmsMain);return o.GConfig.getPropertyArmsMainData(t)},t.prototype.addPropertyArmsSubData=function(t){this.PropertyArmsSubDict[t.fun]||(this.PropertyArmsSubDict[t.fun]={}),this.PropertyArmsSubDict[t.fun][t.lv]=t},t.prototype.getPropertyArmsSubData=function(t,e){return this.PropertyArmsSubDict[t]?this.PropertyArmsSubDict[t][e]:null},t.prototype.getPropertyData_Sub=function(t){var e=a.TData.getPropertyLv_Sub(t);return o.GConfig.getPropertyArmsSubData(t,e)},t.prototype.addPropertyGoldKillData=function(t){this.PropertyGoldKillDict[t.lv]=t},t.prototype.getPropertyGoldKillData=function(t){return this.PropertyGoldKillDict[t]},t.prototype.getPropertyData_GoldKill=function(){var t=a.TData.getPropertyLv(n.Enum_PropertyId.GoldKill);return o.GConfig.getPropertyGoldKillData(t)},t.prototype.addPropertyGoldOfflineData=function(t){this.PropertyGoldOfflineDict[t.lv]=t},t.prototype.getPropertyGoldOfflineData=function(t){return this.PropertyGoldOfflineDict[t]},t.prototype.getPropertyData_GoldOffline=function(){var t=a.TData.getPropertyLv(n.Enum_PropertyId.GoldOffline);return o.GConfig.getPropertyGoldOfflineData(t)},t.prototype.addGbData=function(t,e){this.GbData[t]=e},t.prototype.getGbData=function(t){var e=this.GbData[t];return void 0==e&&(e=""),e},t.prototype.addGuideData=function(t,e){this.GuideDict[t]=e},t.prototype.getGuideData=function(t){return this.GuideDict[t]},t.instance=new t,t}();o.GConfig=r.instance,cc._RF.pop()},{CommonEnum:"CommonEnum",GameData:"GameData",Types:"Types"}],CommonEnum:[function(t,e,i){"use strict";cc._RF.push(e,"dd71b0rrYVFv4uGPSaPXa4O","CommonEnum");var o=e.exports;o.Enum_EnvironmentType=cc.Enum({Develop:-1,Publish:1}),o.Enum_Channel=cc.Enum({Local:-1,WeiXin:1,Google:2}),o.Enum_Sex=cc.Enum({Sex_Boy:1,Sex_Girl:2}),o.Enum_Reward=cc.Enum({Gold:1,Power:2}),o.Enum_Num=cc.Enum({Blood:1,Level:2,Property:11,SubLv:12}),o.Enum_PropertySys=cc.Enum({None:0,ArmsMain:1,ArmsSub:2,Gold:3}),o.Enum_PropertyId=cc.Enum({None:0,ArmsMain:1,ArmsSub:2,GoldKill:3,GoldOffline:4}),o.E_CTag=cc.Enum({Boss_SnakeHead:1e3,Boss_SnakeTail:1100,Boss_ElectrHead:1200,Boss_ElectrLine:1300,Boss_Circle:2e3,Boss_Fire:3e3,Boss_FireHand:3001,Boss_Parent:1e4}),o.Enum_Gb=cc.Enum({PowerMax:1,PowerUse:2,PowerRecoverTime:3,EnemyColor:4,PropStrong:5,PropSlow:6,StagePower:7,MaxLevel:8,StrongAtk:9,ReviveAtk:10,WeaponReport:11,ReviveFree:12,StageFail:13,PropGold:14,adShareSwitch:1e3,shareCount:1001,shareTime:1002,shareProb:1003,addMyProgram:1004,GiftPowerFallDown:1005,GiftPowerRecover:1006,GiftGoldStage:1007,OfflineTimes:1008,SubTryStage:1009,SubTryDie:1010,SubTryMaxCount:1011,officialEnter:1012,lingjingSwitch:1013,lingjingArea:1014}),o.Enum_Switch=cc.Enum({}),o.Enum_Banner=cc.Enum({Banner_Main:1,Banner_Outline:2,Banner_Rank:3,Banner_CheckIn:4,Banner_CIExtra:5,Banner_Shop:6,Banner_FreeLvUp:10,Banner_Invite:11,Banner_Daily:12,Banner_Goods:13}),o.Enum_ADShare=cc.Enum({AS_Menu:0,AS_Revive:1,AS_Over:2,AS_Offline:3,AS_Power:4,AS_Gold:5,AS_TrySub:6,AS_FreeLU:7}),o.Enum_AdShareType=cc.Enum({None:0,Ad:1,Share:2,Free:3}),o.Enum_Loading=cc.Enum({Start:1,WXLogin:2,WXLoginSuc:3,Json:4,JsonEnd:5,Main:6}),o.Enum_GuideStep=cc.Enum({StageStart:1,Finger:2,Flash:3,StageOver:4,MainUp:5,SubUp:6}),o.Enum_ReportErr=cc.Enum({MainSceneLoad:1}),o.Enum_AfType=cc.Enum({load:1,guide:2,stageWin:3,video_finish:4,mainLvup:5,subLvup:6}),cc._RF.pop()},{}],CommonFunc:[function(t,e,i){"use strict";cc._RF.push(e,"0101744DgVDm7OR7EYttilr","CommonFunc");var o=e.exports,n=t("aes"),s=t("CommonValue"),a=t("CommonSdk"),c=t("CommonConfig"),r=t("CommonEnum"),l=t("Tools"),h=t("LoadingData"),d=t("GameData"),u=t("ConfigData"),m=function(){function t(){this.m_gameScale=-1,this.panelLoading=null,this.EnemySkinDict={},this.performance_level=50,this.performance_count=0,this.performance_dt=0,this.performance_time=5}return t.prototype.adjustScreen=function(t){if(this.m_gameScale<0){var e=s.GValue.Size_View,i=cc.size(720,1280),o=e.height/i.height*i.width;this.m_gameScale=e.width/o}this.m_gameScale<1&&(t.scale=this.m_gameScale)},t.prototype.isIPhoneX=function(){return t},t.prototype.f_check_topbar=function(t){c.GConfig.channel!=r.Enum_Channel.WeiXin||(s.GValue.Has_TopBar=a.GSDK.getGameScreenTopOffsetY>0,l.DYTools.error("GValue.Has_TopBar = "+s.GValue.Has_TopBar))},t.prototype.close_keyBoard=function(){c.GConfig.isDevelop||a.GSDK.close_keyboard()},t.prototype.showFloatTips=function(t,e,i,o){void 0===e&&(e=null),void 0===i&&(i=null),void 0===o&&(o=null),cc.loader.loadRes("prefab/common/PfTip",function(n,a){n?l.DYTools.error(n.message||n):l.DYTools.createPrefabCom(s.GValue.Root_Canvas,a,"PfTip").show(t,e,i,o)})},t.prototype.showModal=function(t,e,i,o){this.createPrefabByName("PanelModal",s.GValue.EntityWorld.node,function(n){n.node.name="PanelModal",n.create(t,e,i,o)})},t.prototype.showLoading=function(){this.createPrefabByName("PanelLoading",s.GValue.Root_Canvas,function(t){o.GFunc.panelLoading=t.node})},t.prototype.hideLoading=function(){this.panelLoading&&(this.panelLoading.removeFromParent(),this.panelLoading=null)},t.prototype.createPrefabByName=function(t,e,i,o,n,s){void 0===i&&(i=null),void 0===o&&(o=!0),void 0===n&&(n=cc.v2(0,0)),void 0===s&&(s=!0);var a=l.DYTools.getConstructor(t),c=null;if(a)if(a.prefabPath){var r=new h;r.addListResPf(a.prefabPath),r.loadRes(function(){r=null,cc.loader.loadRes(a.prefabPath,cc.Prefab,function(r,h){if(r)l.DYTools.error("error during creating layer:"+t+" error:"+r);else{if(h){var d=null;if(s)for(var u=a.prefabPath.substr(a.prefabPath.lastIndexOf("/")+1),m=0;m<e.children.length;m++)e.children[m].name==u&&(d=e.children[m]);null==d&&(d=cc.instantiate(h)),d.parent=e,d.positon=n,c=d.getComponent(t)}null===c?l.DYTools.error("Can not get component of "+t):(c.onEnter(),!1===o&&(c.node.active=!1))}c&&i&&i(c)})},null)}else l.DYTools.error("please assign "+t+"'s static var prefabPath"),i&&i(null);else l.DYTools.error("Can not get constructor of "+t),i&&i(null)},t.prototype.changeAtlasSprite=function(t,e,i){t&&e&&(e.spriteFrame=t.getSpriteFrame(i))},t.prototype.resetCommonData=function(){},t.prototype.preloadMaps=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null);for(var o=0;o<t.length;o++)this.preLoadMap(t[o],e),o==t.length-1&&i&&i()},t.prototype.preLoadMap=function(t,e){void 0===e&&(e=null);var i="map/map_"+t;cc.loader.loadRes(i,function(i,n){if(i)l.DYTools.error(i),o.GFunc.preLoadMap(t,e);else{var s=n.json,a=new u.MapData;a.bgW=parseInt(s.bgW),a.bgH=parseInt(s.bgH);for(var r=s.vL,h=0;h<r.length;h++){var d=cc.v2(Number(r[h].x),Number(r[h].y));a.vL.push(d)}for(r=s.wL,h=0;h<r.length;h++){var m=r[h],p=new u.MapWallData;if(m.hasOwnProperty("ax")&&(p.ax=Number(m.ax)),m.hasOwnProperty("ay")&&(p.ay=Number(m.ay)),m.hasOwnProperty("x")&&(p.x=Number(m.x)),m.hasOwnProperty("y")&&(p.y=Number(m.y)),m.hasOwnProperty("sx")&&(p.sx=Number(m.sx)),m.hasOwnProperty("sy")&&(p.sy=Number(m.sy)),m.hasOwnProperty("rt")&&(p.rt=Number(m.rt)),m.hasOwnProperty("wt")&&(p.wt=Number(m.wt)),m.hasOwnProperty("ht")&&(p.ht=Number(m.ht)),m.hasOwnProperty("dr")&&(p.dr=Number(m.dr)),m.hasOwnProperty("ty")&&(p.ty=Number(m.ty)),m.hasOwnProperty("cL"))for(var f=m.cL,_=0;_<f.length;_++){var y=f[_],g=new u.MapCircleWallData;y.hasOwnProperty("x")&&(g.x=Number(y.x)),y.hasOwnProperty("y")&&(g.y=Number(y.y)),y.hasOwnProperty("sx")&&(g.sx=Number(y.sx)),y.hasOwnProperty("sy")&&(g.sy=Number(y.sy)),y.hasOwnProperty("wt")&&(g.wt=Number(y.wt)),y.hasOwnProperty("ht")&&(g.ht=Number(y.ht)),p.cL.push(g)}a.wL.push(p)}for(r=s.bL,h=0;r&&h<r.length;h++)m=r[h],p=new u.MapBlockData,m.hasOwnProperty("id")&&(p.id=parseInt(m.id)),m.hasOwnProperty("x")&&(p.x=Number(m.x)),m.hasOwnProperty("y")&&(p.y=Number(m.y)),m.hasOwnProperty("sx")&&(p.sx=Number(m.sx)),m.hasOwnProperty("sy")&&(p.sy=Number(m.sy)),m.hasOwnProperty("rt")&&(p.rt=Number(m.rt)),a.bL.push(p);for(r=s.eL,h=0;h<r.length;h++)(T=new u.MapEnemyOutData).id=parseInt(r[h].id),T.oId=parseInt(r[h].oId),T.x=Number(r[h].x),T.y=Number(r[h].y),T.wt=Number(r[h].wt),T.ht=Number(r[h].ht),r[h].hasOwnProperty("ax")&&(T.ax=Number(r[h].ax)),r[h].hasOwnProperty("ay")&&(T.ay=Number(r[h].ay)),a.eL.push(T);for(r=s.cL,h=0;h<r.length;h++)(T=new u.MapEnemyOutData).id=parseInt(r[h].id),T.oId=parseInt(r[h].oId),T.x=Number(r[h].x),T.y=Number(r[h].y),T.wt=Number(r[h].wt),T.ht=Number(r[h].ht),r[h].hasOwnProperty("ax")&&(T.ax=Number(r[h].ax)),r[h].hasOwnProperty("ay")&&(T.ay=Number(r[h].ay)),a.cL.push(T);for(r=s.pL,h=0;h<r.length;h++){y=r[h],(T=new u.MapPauseData).id=parseInt(y.id),T.x=Number(y.x),T.y=Number(y.y);for(var v=y.dir,C=0;C<v.length;C++)T.dir.push(parseInt(v[C])),T.oId.push(parseInt(y.oId[C]));a.pL.push(T)}for(r=s.aL,h=0;h<r.length;h++)y=r[h],(T=new u.MapAreaEnemyData).id=parseInt(y.id),T.x=Number(y.x),T.y=Number(y.y),T.oId=parseInt(y.oId),a.aL.push(T);if(s.hasOwnProperty("boss")){var S=s.boss;(T=new u.MapBossData).x=Number(S.x),T.y=Number(S.y),T.oId=Number(S.oId),a.boss=T}if(s.hasOwnProperty("bP")){var D=s.bP,T=new u.MapPauseData;for(v=D.dir,h=0;h<v.length;h++)T.dir.push(parseInt(v[h])),T.oId.push(parseInt(D.oId[h]));a.bP=T}c.GConfig.MapDict[t]=a,e&&e(a)}})},t.prototype.setPlayerVisible=function(t){var e=t?255:0;s.GValue.EntityWorld.player.node.opacity=e,s.GValue.EntityWorld.player.followPlayerOut.node.opacity=e,s.GValue.EntityWorld.player.followPlayerIn.node.opacity=e,s.GValue.EntityWorld.player.shadow.opacity=e,s.GValue.EntityWorld.player.followPlayerOut.setShadowOpacity(e),s.GValue.EntityWorld.player.followPlayerIn.setShadowOpacity(e)},t.prototype.changePlayerParentToUI=function(t){this.changeParent(s.GValue.EntityWorld.player.followPlayerOut.node,t),this.changeParent(s.GValue.EntityWorld.player.followPlayerIn.node,t),this.changeParent(s.GValue.EntityWorld.player.node,t)},t.prototype.changePlayerParentToMap=function(){var t=s.GValue.EntityWorld.addEntitySys;this.changeParent(s.GValue.EntityWorld.player.node,t.playerNode),this.changeParent(s.GValue.EntityWorld.player.followPlayerOut.node,t.weaponNode),this.changeParent(s.GValue.EntityWorld.player.followPlayerIn.node,t.weaponNode)},t.prototype.changeKnifeEnemyParentToUI=function(t,e){t&&e&&(this.changeParent(t.node,e),this.changeParent(t.followWeapon.node,e))},t.prototype.changeKnifeEnemyParentToMap=function(t){if(t){var e=s.GValue.EntityWorld.addEntitySys;this.changeParent(t.node,e.enemyNode),this.changeParent(t.followWeapon.node,e.enemyNode)}},t.prototype.changeParent=function(t,e){var i=t.convertToWorldSpaceAR(cc.v2(0,0));i=e.convertToNodeSpaceAR(i),t.parent=e,t.position=i},t.prototype.changePlayerTheme=function(t){this.changePlayerSkin(t),this.changePlayerSubWeapon(t)},t.prototype.changePlayerSkin=function(t){if(s.GValue.EntityWorld.player){s.GValue.EntityWorld.player.skinSpr.spriteFrame=s.GValue.Atlas_Game.getSpriteFrame("h"+t);var e=s.GValue.EntityWorld.player.shadow;if(e){var i=e.getComponent(cc.Sprite);i&&(i.spriteFrame=s.GValue.Atlas_Shadow.getSpriteFrame("sh_"+t))}}},t.prototype.changePlayerSubWeapon=function(t){s.GValue.EntityWorld.player&&s.GValue.EntityWorld.player.followPlayerIn.setWeapon(t)},t.prototype.changePlayerMainWeapon=function(){s.GValue.EntityWorld.player&&s.GValue.EntityWorld.player.changeMainWeaponSkin()},t.prototype.getEnemyRandomDir=function(t){var e;e=s.GValue.EntityWorld.mapMgr.curDirTag<=2?s.GValue.EntityWorld.mapMgr.mapStop?cc.rect(.2*s.GValue.ViewCenter.x,.2*s.GValue.ViewCenter.y,1.6*s.GValue.ViewCenter.x,1.6*s.GValue.ViewCenter.y):cc.rect(.8*s.GValue.ViewCenter.x,s.GValue.ViewCenter.y,.4*s.GValue.ViewCenter.x,.8*s.GValue.ViewCenter.y):cc.rect(.2*s.GValue.ViewCenter.x,.2*s.GValue.ViewCenter.y,1.6*s.GValue.ViewCenter.x,1.6*s.GValue.ViewCenter.y);var i=cc.v2(l.DYTools.random_int(e.xMin,e.xMax),l.DYTools.random_int(e.yMin,e.yMax)),o=t.convertToWorldSpaceAR(cc.Vec2.ZERO);return i.sub(o).normalize()},t.prototype.initEnemySkinDict=function(){for(var t=1;t<100;t++)this.EnemySkinDict[t]="e_"+t;for(t=100;t<110;t++)this.EnemySkinDict[t]="e_"+t;for(t=1e3;t<1010;t++)this.EnemySkinDict[t]="e_"+t},t.prototype.getEnemySkinImage=function(t){return s.GValue.Atlas_Enemy.getSpriteFrame(this.EnemySkinDict[t])},t.prototype.encode=function(t){var e=n.CryptoJS.enc.Latin1.parse("mdy8155zs2619lfm"),i=n.CryptoJS.enc.Latin1.parse("s9mnbdk1giu2e3wn");return n.CryptoJS.AES.encrypt(t,e,{iv:i,mode:n.CryptoJS.mode.CBC,padding:n.CryptoJS.pad.ZeroPadding}).toString()},t.prototype.decode=function(t){var e=n.CryptoJS.enc.Latin1.parse("mdy8155zs2619lfm"),i=n.CryptoJS.enc.Latin1.parse("s9mnbdk1giu2e3wn"),o=n.CryptoJS.AES.decrypt(t,e,{iv:i,mode:n.CryptoJS.mode.CBC,padding:n.CryptoJS.pad.ZeroPadding});return n.CryptoJS.enc.Utf8.stringify(o)},t.prototype.set_click=function(t,e,i){this.clear_click(t),t.on(cc.Node.EventType.TOUCH_START,function(t){e&&e()}.bind(i),i)},t.prototype.clear_click=function(t){t.off(cc.Node.EventType.TOUCH_START)},t.prototype.getNumK=function(t){if(t<1e3)return t.toString();var e=t/1e3;return t%1e3==0||(e=Math.floor(10*e)/10),e.toString()+"k"},t.prototype.getNumString=function(t){var e="",i="";if(t<1e3)e=t.toString();else{var o=0,n=0,s=0;t>=1e6?(o=Math.floor(t/1e6),n=Math.floor(t%1e6/1e5),s=Math.floor(t%1e5/1e4),i="m"):t>=1e3&&(o=Math.floor(t/1e3),n=Math.floor(t%1e3/100),s=Math.floor(t%100/10),i="k"),e=o+"."+n+s}return e+i},t.prototype.getTimeSecondStr=function(t){var e="00:00";if(t<60)e="00:"+this.getTimestrDouble(t);else if(t<3600){var i=Math.floor(t/60),o=Math.floor(t%60);e=this.getTimestrDouble(i)+":"+this.getTimestrDouble(o)}else if(t<216e3){var n=Math.floor(t/3600),s=Math.floor(t%3600);i=Math.floor(s/60),o=Math.floor(s%60),e=this.getTimestrDouble(n)+":"+this.getTimestrDouble(i)+":"+this.getTimestrDouble(o)}return e},t.prototype.getTimestrDouble=function(t){var e="00";return t<10?e="0"+t.toFixed(0):t<60&&(e=t.toFixed(0)),e},t.prototype.getCurTime=function(){return Math.floor((new Date).getTime()/1e3)},t.prototype.initPowerRecover=function(){var t=d.TData.getPower(),e=parseInt(c.GConfig.getGbData(r.Enum_Gb.PowerMax));if(t<e){var i=o.GFunc.getCurTime()-d.TData.getTimePower();if(i>0){var n=parseInt(c.GConfig.getGbData(r.Enum_Gb.PowerRecoverTime)),a=Math.floor(i/n),l=t+a;l=l>e?e:l,d.TData.setPower(l),a>0&&d.TData.setTimePower(o.GFunc.getCurTime(),!0);var h=i%n;s.GValue.PowerTime=n-h}}s.GValue.HomeUI&&s.GValue.HomeUI.refreshPower()},t.prototype.checkPowerRecover=function(t){var e=d.TData.getPower();e<parseInt(c.GConfig.getGbData(r.Enum_Gb.PowerMax))&&(s.GValue.PowerTime-=t,s.GValue.PowerTime<=0&&(s.GValue.PowerTime=parseInt(c.GConfig.getGbData(r.Enum_Gb.PowerRecoverTime)),d.TData.setPower(e+1),d.TData.setTimePower(o.GFunc.getCurTime(),!0),s.GValue.HomeUI&&s.GValue.HomeUI.refreshPower()))},t.prototype.initOfflineGoldRecover=function(){var t=d.TData.getOfflineGold(),e=d.TData.getStage(),i=c.GConfig.getLevelData(e),n=0,a=0;if(i&&(n=i.offlineGoldMax,a=i.offlineGoldPre),t<n){var r=o.GFunc.getCurTime(),l=d.TData.getTimeOfflineGold();l=0==l?r:l,d.TData.setTimeOfflineGold(l,!0);var h=r-l;if(h>=0){var u=s.GValue.OfflineGoldOnceRecoverTime,m=t+Math.floor(h/u)*a;m=m>n?n:m,d.TData.setOfflineGold(m),d.TData.setTimeOfflineGold(o.GFunc.getCurTime(),!0);var p=h%u;s.GValue.OfflineGoldTime=u-p}}s.GValue.HomeUI&&s.GValue.HomeUI.refreshOffline()},t.prototype.checkGoldOffline=function(t){var e=d.TData.getOfflineGold(),i=d.TData.getStage(),n=c.GConfig.getLevelData(i),a=0,r=0;if(n&&(a=n.offlineGoldMax,r=n.offlineGoldPre),e<a&&(s.GValue.OfflineGoldTime-=t,s.GValue.OfflineGoldTime<=0)){s.GValue.OfflineGoldTime=s.GValue.OfflineGoldOnceRecoverTime;var l=e+r;l=l>a?a:l,d.TData.setOfflineGold(l),d.TData.setTimeOfflineGold(o.GFunc.getCurTime(),!0),s.GValue.HomeUI&&s.GValue.HomeUI.refreshOffline()}},t.prototype.getGoldOfflineCurTime=function(){var t=o.GFunc.getCurTime(),e=d.TData.getTimeOfflineGoldGet();return e=0==e?t:e,d.TData.setTimeOfflineGoldGet(e,!0),t-e},t.prototype.randomTrySub=function(t){for(var e=0,i=!0,o=d.TData.getListSub(),n=0;n<o.length;n++){var a=o[n];if(d.TData.getPropertyLv_Sub(a)>=t){i=!1;break}}i&&o.length>0&&(e=o[l.DYTools.random_int(0,o.length-1)]),s.GValue.ArmsSub_TryWill=e},t.prototype.canPropertyLvup=function(t,e){void 0===e&&(e=0);var i=!1,o=d.TData.getGold();if(t==r.Enum_PropertyId.ArmsMain)(n=c.GConfig.getPropertyData_Main())&&o>=n.gd&&c.GConfig.getPropertyArmsMainData(n.lv+1)&&(i=!0);else if(t==r.Enum_PropertyId.ArmsSub)(n=c.GConfig.getPropertyData_Sub(e))&&o>=n.gd&&c.GConfig.getPropertyArmsSubData(e,n.lv+1)&&(i=!0);else if(t==r.Enum_PropertyId.GoldKill)(n=c.GConfig.getPropertyData_GoldKill())&&o>=n.gd&&c.GConfig.getPropertyGoldKillData(n.lv+1)&&(i=!0);else if(t==r.Enum_PropertyId.GoldOffline){var n;(n=c.GConfig.getPropertyData_GoldOffline())&&o>=n.gd&&c.GConfig.getPropertyGoldOfflineData(n.lv+1)&&(i=!0)}return i},t.prototype.getCanPropertyArmsSubLvupFun=function(){for(var t=0,e=d.TData.getListSub(),i=0;i<e.length;i++)if(this.canPropertyLvup(r.Enum_PropertyId.ArmsSub,e[i])){t=e[i];break}return t},t.prototype.isCanPropertyArmsSubLvupCurFun=function(){var t=d.TData.getCurSubFun();return this.canPropertyLvup(r.Enum_PropertyId.ArmsSub,t)},t.prototype.getUnGetArmsSubList=function(){var t=[],e=d.TData.getListSub();for(var i in c.GConfig.PropertyArmsSubDict){var o=parseInt(i);l.DYTools.arrContain(e,o)||t.push(o)}return t},t.prototype.getArmsMainChange=function(){s.GValue.List_Main_Change=[];var t=[];for(var e in c.GConfig.PropertyArmsMainDict){var i=(r=c.GConfig.PropertyArmsMainDict[e]).imageId;l.DYTools.arrContain(t,i)||t.push(i)}for(var o=0;o<t.length;o++){var n=t[o],a=null;for(var e in c.GConfig.PropertyArmsMainDict){var r;n==(i=(r=c.GConfig.PropertyArmsMainDict[e]).imageId)&&(a?r.lv<a.lv&&(a=r):a=r)}a&&s.GValue.List_Main_Change.push(a)}return s.GValue.List_Main_Change=s.GValue.List_Main_Change.sort(function(t,e){return t.lv>e.lv?1:-1}),s.GValue.List_Main_Change},t.prototype.getCurMainChange=function(){for(var t=null,e=d.TData.getPropertyLv(r.Enum_PropertyId.ArmsMain),i=0;i<s.GValue.List_Main_Change.length;i++){var o=s.GValue.List_Main_Change[i];if(!(e>=o.lv))break;t=o}return t},t.prototype.getBossCom=function(t,e){var i=null,o=s.GValue.DicBossEnemy[t];return o&&(i=o[e]),i},t.prototype.flyGold=function(t,e,i,o,n,s,a){for(var r=1*c.GConfig.actionFrameTime,h=function(c){var h=c%6,d=Math.floor(c/6),u=new cc.Node;t.addChild(u);var m=new cc.Node;u.addChild(m),m.addComponent(cc.Sprite).spriteFrame=e;var p=cc.scaleTo(2*r,.45,1),f=cc.scaleTo(2*r,1,1),_=cc.scaleTo(2*r,.42,1),y=cc.delayTime(1*r),g=cc.scaleTo(2*r,1,1),v=cc.sequence(p,f,_,y,g),C=cc.repeatForever(v);m.runAction(C),u.opacity=0;var S=[];switch(h){case 0:W=(W=i.add(cc.v2(100*(Math.random()-.5),100*(Math.random()-.5)))).add(cc.v2(30*d,-30*d)),u.setPosition(W),u.scale=1.4;var D=cc.delayTime(r*l.DYTools.random_int(0,3)),T=cc.fadeIn(0),G=cc.moveTo(2*r,W.add(cc.v2(-94,70))),A=cc.scaleTo(2*r,1.4),w=cc.spawn(G,A),b=cc.moveTo(4*r,W.add(cc.v2(-165,71))),E=cc.scaleTo(4*r,1.3),P=cc.spawn(b,E),N=cc.moveTo(7*r,o),k=cc.scaleTo(7*r,1),F=cc.spawn(N,k),V=cc.sequence(D,T,w,P,F);S.push(V);break;case 1:W=(W=i.add(cc.v2(100*(Math.random()-.5),100*(Math.random()-.5)))).add(cc.v2(30*d,-30*d)),u.setPosition(W),u.scale=1.4,D=cc.delayTime(r*l.DYTools.random_int(0,3)),T=cc.fadeIn(0),G=cc.moveTo(2*r,W.add(cc.v2(94,70))),A=cc.scaleTo(2*r,1.4),w=cc.spawn(G,A),b=cc.moveTo(4*r,W.add(cc.v2(165,71))),E=cc.scaleTo(4*r,1.3),P=cc.spawn(b,E),N=cc.moveTo(7*r,o),k=cc.scaleTo(7*r,1),F=cc.spawn(N,k);var x=cc.sequence(D,T,w,P,F);S.push(x);break;case 2:W=(W=i.add(cc.v2(100*(Math.random()-.5),100*(Math.random()-.5)))).add(cc.v2(30*d,-30*d)),u.setPosition(W),u.scale=1.5,D=cc.delayTime(r*l.DYTools.random_int(0,3)),T=cc.fadeIn(0),G=cc.moveTo(3*r,W.add(cc.v2(-94,-100))),A=cc.scaleTo(3*r,1.7),w=cc.spawn(G,A),b=cc.moveTo(4*r,W.add(cc.v2(-98,-115))),E=cc.scaleTo(4*r,1.3),P=cc.spawn(b,E),N=cc.moveTo(6*r,W.add(cc.v2(-95,-64))),k=cc.scaleTo(6*r,1.3),F=cc.spawn(N,k);var I=cc.moveTo(5*r,o),R=cc.scaleTo(5*r,1),B=cc.spawn(I,R),M=cc.sequence(D,T,w,P,F,B);S.push(M);break;case 3:W=(W=i.add(cc.v2(100*(Math.random()-.5),100*(Math.random()-.5)))).add(cc.v2(30*d,-30*d)),u.setPosition(W),u.scale=1.5,D=cc.delayTime(r*l.DYTools.random_int(0,3)),T=cc.fadeIn(0),G=cc.moveTo(3*r,W.add(cc.v2(94,-100))),A=cc.scaleTo(3*r,1.7),w=cc.spawn(G,A),b=cc.moveTo(4*r,W.add(cc.v2(98,-115))),E=cc.scaleTo(4*r,1.3),P=cc.spawn(b,E),N=cc.moveTo(6*r,W.add(cc.v2(95,-64))),k=cc.scaleTo(6*r,1.3),F=cc.spawn(N,k),I=cc.moveTo(5*r,o),R=cc.scaleTo(5*r,1),B=cc.spawn(I,R);var L=cc.sequence(D,T,w,P,F,B);S.push(L);break;case 4:W=(W=i.add(cc.v2(100*(Math.random()-.5),100*(Math.random()-.5)))).add(cc.v2(30*d,-30*d)),u.setPosition(W),u.scale=1.3,D=cc.delayTime(r*l.DYTools.random_int(0,3)),T=cc.fadeIn(0),G=cc.moveTo(3*r,W.add(cc.v2(-44,90))),A=cc.scaleTo(3*r,1.5),w=cc.spawn(G,A),b=cc.moveTo(3*r,W.add(cc.v2(-55,110))),E=cc.scaleTo(3*r,1.2),P=cc.spawn(b,E),N=cc.moveTo(6*r,W.add(cc.v2(-60,140))),k=cc.scaleTo(6*r,1.2),F=cc.spawn(N,k),I=cc.moveTo(5*r,o),R=cc.scaleTo(5*r,1),B=cc.spawn(I,R);var O=cc.sequence(D,T,w,P,F,B);S.push(O);break;case 5:var W;W=(W=i.add(cc.v2(100*(Math.random()-.5),100*(Math.random()-.5)))).add(cc.v2(30*d,-30*d)),u.setPosition(W),u.scale=1.3,D=cc.delayTime(r*l.DYTools.random_int(0,3)),T=cc.fadeIn(0),G=cc.moveTo(3*r,W.add(cc.v2(44,90))),A=cc.scaleTo(3*r,1.5),w=cc.spawn(G,A),b=cc.moveTo(3*r,W.add(cc.v2(55,110))),E=cc.scaleTo(3*r,1.2),P=cc.spawn(b,E),N=cc.moveTo(6*r,W.add(cc.v2(60,140))),k=cc.scaleTo(6*r,1.2),F=cc.spawn(N,k),I=cc.moveTo(5*r,o),R=cc.scaleTo(5*r,1),B=cc.spawn(I,R);var Y=cc.sequence(D,T,w,P,F,B);S.push(Y)}var K=cc.callFunc(function(){s&&s(),c==n-1&&a&&a()});S.push(K),S.push(cc.removeSelf());var H=cc.sequence(S);u.runAction(H)},d=0;d<n;d++)h(d)},t.prototype.set_action_btn=function(t,e){var i=c.GConfig.actionFrameTime,o=cc.scaleTo(3*i,1.15),n=cc.scaleTo(3*i,.9),s=cc.callFunc(function(){e&&e.setAnimation(0,"play",!1)}),a=cc.scaleTo(4*i,1.05),r=cc.scaleTo(4*i,1),l=cc.delayTime(15*i),h=cc.sequence(o,n,s,a,r,l),d=cc.repeatForever(h);t.runAction(d)},t.prototype.check_performance=function(t){this.performance_level<=0||(this.performance_count++,this.performance_dt+=t,this.performance_dt>=this.performance_time&&(this.performance_count/this.performance_dt<35&&(this.performance_level=0),this.performance_count=0,this.performance_dt=0))},t.instance=new t,t}();o.GFunc=m.instance,cc._RF.pop()},{CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonSdk:"CommonSdk",CommonValue:"CommonValue",ConfigData:"ConfigData",GameData:"GameData",LoadingData:"LoadingData",Tools:"Tools",aes:"aes"}],CommonSdk:[function(t,e,i){"use strict";cc._RF.push(e,"08c6aY1vmRDi5MSsBRzVg21","CommonSdk");var o=e.exports,n=t("CommonConfig"),s=t("CommonEnum"),a=t("Hawkeye"),c=t("AndroidManager"),r=t("GameData"),l=function(){function t(){this.sdkType=0,this._showCall=null,this._hideCall=null,this._isAdverReady=!1}return t.prototype.sendMainLvup=function(t){if(n.GConfig.BiReport)switch(this.sdkType){case s.Enum_Channel.WeiXin:break;case s.Enum_Channel.Google:c.AndroidMgr.sendInfor(s.Enum_AfType.mainLvup,t.toString())}},t.prototype.sendSubLvup=function(t,e){if(n.GConfig.BiReport)switch(this.sdkType){case s.Enum_Channel.WeiXin:break;case s.Enum_Channel.Google:c.AndroidMgr.sendInfor(s.Enum_AfType.subLvup,t.toString(),e.toString())}},t.prototype.sendAdverCount=function(t){if(n.GConfig.BiReport)switch(this.sdkType){case s.Enum_Channel.WeiXin:a.HKReport.sendAdverCount(t);break;case s.Enum_Channel.Google:}},t.prototype.sendVideoShow=function(t){if(n.GConfig.BiReport)switch(this.sdkType){case s.Enum_Channel.WeiXin:a.HKReport.sendVideoShow(t);break;case s.Enum_Channel.Google:}},t.prototype.sendVideoPlay=function(t){if(n.GConfig.BiReport)switch(this.sdkType){case s.Enum_Channel.WeiXin:a.HKReport.sendVideoPlay(t);break;case s.Enum_Channel.Google:}},t.prototype.sendVideoFinish=function(t){if(n.GConfig.BiReport)switch(this.sdkType){case s.Enum_Channel.WeiXin:a.HKReport.sendVideoFinish(t);break;case s.Enum_Channel.Google:c.AndroidMgr.sendInfor(s.Enum_AfType.video_finish,t.toString())}},t.prototype.sendShareOut=function(t,e){if(n.GConfig.BiReport)switch(this.sdkType){case s.Enum_Channel.WeiXin:a.HKReport.sendShareOut(t,e);break;case s.Enum_Channel.Google:}},t.prototype.sendShareIn=function(t,e,i){if(n.GConfig.BiReport)switch(this.sdkType){case s.Enum_Channel.WeiXin:a.HKReport.sendShareIn(t,e,i);break;case s.Enum_Channel.Google:}},t.prototype.sendSaveDataErr=function(t){if(n.GConfig.BiReport)switch(this.sdkType){case s.Enum_Channel.WeiXin:a.HKReport.sendSaveDataErr(t);break;case s.Enum_Channel.Google:}},t.prototype.sendGameErr=function(t){if(n.GConfig.BiReport)switch(this.sdkType){case s.Enum_Channel.WeiXin:a.HKReport.sendGameErr(t);break;case s.Enum_Channel.Google:}},t.prototype.show_model=function(t,e,i,o,a,c){if(void 0===a&&(a="\u53d6\u6d88"),void 0===c&&(c=!0),!n.GConfig.isDevelop&&this.gameSdk)switch(this.sdkType){case s.Enum_Channel.WeiXin:this.gameSdk.show_model(t,e,i,o,a,c)}},t.prototype.OpenCustomerServices=function(){if(!n.GConfig.isDevelop&&this.gameSdk)switch(this.sdkType){case s.Enum_Channel.WeiXin:this.gameSdk.OpenCustomerServices()}},t.prototype.showFeedBack=function(t){if(!n.GConfig.isDevelop&&this.gameSdk)switch(this.sdkType){case s.Enum_Channel.WeiXin:this.gameSdk.showFeedBackBtn(t)}},t.prototype.saveData=function(t,e){if(!n.GConfig.isDevelop&&this.gameSdk)switch(this.sdkType){case s.Enum_Channel.WeiXin:this.gameSdk.saveData(t,e)}},t.prototype.close_keyboard=function(){if(!n.GConfig.isDevelop&&this.gameSdk)switch(this.sdkType){case s.Enum_Channel.WeiXin:this.gameSdk.close_keyboard()}},t.prototype.virbrate=function(t){if(!n.GConfig.isDevelop&&1==r.TData.SettingData.shake)switch(this.sdkType){case s.Enum_Channel.WeiXin:this.gameSdk.virbrate(t);break;case s.Enum_Channel.Google:c.AndroidMgr.virbrate(t)}},t.prototype.openUrl=function(t){cc.sys.openURL(t)},t.instance=new t,t}();o.GSDK=l.instance,cc._RF.pop()},{AndroidManager:"AndroidManager",CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",GameData:"GameData",Hawkeye:"Hawkeye"}],CommonUI:[function(t,e,i){"use strict";cc._RF.push(e,"e6ef5Eos+hCv69dkrg9skzn","CommonUI");var o=e.exports,n=function(){function t(){}return t.instance=new t,t}();o.GUI=n.instance,cc._RF.pop()},{}],CommonValue:[function(t,e,i){"use strict";cc._RF.push(e,"e1236Nm8NtJKIViO7vZ7TXQ","CommonValue");var o=e.exports,n=t("CommonConfig"),s=t("CommonEnum"),a=t("Tools"),c=function(){function t(){this.Size_View={height:1280},this.ViewCenter=cc.Vec2.ZERO,this.WorldRect=null,this.Has_TopBar=!1,this.Device_Model_Ready=!1,this.Root_Canvas=null,this.FirstMain=!0,this.OnlineTime=0,this.AdShareSwitch=!1,this.StrongRT=0,this.StrongTime=0,this.SlowTime=0,this.SlowRatio=0,this.GoldTime=0,this.GoldCount=0,this.Atlas_Game=null,this.Atlas_Wall=null,this.Atlas_Guide=null,this.Atlas_Enemy=null,this.Atlas_Shadow=null,this.Atlas_Boss=null,this.pf_num=null,this.pf_anim=null,this.pf_enemy_effect=null,this.Atlas_Test=null,this.EntityWorld=null,this.MapScale=0,this.PropMgr=null,this.PlayerTouching=!0,this.PauseSlowRatio=1,this.PlayerSlowRatio=1,this.EnemyColorBloodPercent=0,this.DDSDK=null,this.DDSDKUI=null,this.GuideUI=null,this.HomeUI=null,this.GameUI=null,this.PlayerMainPos=cc.Vec2.ZERO,this.PlayerPosV=cc.Vec2.ZERO,this.PlayerPosH=cc.Vec2.ZERO,this.PowerTime=0,this.OfflineGoldTime=0,this.OfflineGoldOnceRecoverTime=60,this.GameOverGold=-1,this.StageFail=0,this.StageFailCount=0,this.StageFailFinish=!1,this.FailRatio=0,this.ChangeStage=!1,this.FirstGetSub=!1,this.Dic_Sub_Level={},this.List_Main_Change=[],this.ArmsSub_TryWill=0,this.ArmsSub_TryFinish=0,this.Level_FailCount=0,this.DicBossEnemy={},this.officialOn=!1,this.moreGame=!1,this.tryGamme=!1,this.adImage=!1,this.favGame=!1,this.curCity="",this.areaArr=[],this.shareSwitch=!1}return t.prototype.initCommonValue=function(){n.GConfig.MaxLevel=parseInt(n.GConfig.getGbData(s.Enum_Gb.MaxLevel)),o.GValue.AdShareSwitch=1==parseInt(n.GConfig.getGbData(s.Enum_Gb.adShareSwitch));var t=a.DYTools.stringToNumber(n.GConfig.getGbData(s.Enum_Gb.PropStrong),n.GConfig.SeparatorII);o.GValue.StrongRT=t[0],o.GValue.StrongTime=t[1],t=a.DYTools.stringToNumber(n.GConfig.getGbData(s.Enum_Gb.PropSlow),n.GConfig.SeparatorII),o.GValue.SlowTime=t[0],o.GValue.SlowRatio=t[1],t=a.DYTools.stringToNumber(n.GConfig.getGbData(s.Enum_Gb.PropGold),n.GConfig.SeparatorII),o.GValue.GoldTime=t[0],o.GValue.GoldCount=t[1],t=a.DYTools.stringToNumber(n.GConfig.getGbData(s.Enum_Gb.lingjingSwitch),n.GConfig.SeparatorII);try{o.GValue.officialOn=1==t[0],o.GValue.moreGame=1==t[1],o.GValue.tryGamme=1==t[2],o.GValue.adImage=1==t[3],o.GValue.favGame=1==t[4]}catch(t){a.DYTools.error("lingjing error")}o.GValue.areaArr=n.GConfig.getGbData(s.Enum_Gb.lingjingArea).split(n.GConfig.SeparatorII),a.DYTools.log("lingjing show1"),this.checkCity(),o.GValue.DDSDKUI&&(a.DYTools.log("lingjing show"),o.GValue.DDSDKUI.refreshSDKShow())},t.prototype.checkCity=function(){""!=this.curCity&&(this.shareSwitch=this.areaArr.indexOf(this.curCity)<0,a.DYTools.log("\u533a\u57df--",this.shareSwitch))},t.instance=new t,t}();o.GValue=c.instance,cc._RF.pop()},{CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",Tools:"Tools"}],ConfigData:[function(t,e,i){"use strict";cc._RF.push(e,"8a30eI5sopIVJsKZ8QRw+Kp","ConfigData");var o=e.exports;Object.defineProperty(o,"__esModule",{value:!0});var n=t("Tools"),s=t("CommonConfig"),a=t("CommonValue"),c=function(){this.bgS="",this.bgW=0,this.bgH=0,this.vL=[],this.wL=[],this.bL=[],this.iL=[],this.eL=[],this.cL=[],this.pL=[],this.aL=[],this.boss=null,this.bP=null};o.MapData=c;var r=function(){this.id=0,this.x=0,this.y=0,this.sp=cc.Vec2.ZERO,this.ep=cc.Vec2.ZERO,this.wL=[]};o.MapWayData=r;var l=function(){this.ax=.5,this.ay=.5,this.x=0,this.y=0,this.sx=1,this.sy=1,this.rt=0,this.src="",this.wt=0,this.ht=0,this.dr=0,this.ty=0,this.cL=[]};o.MapWallData=l;var h=function(){this.id=0,this.x=0,this.y=0,this.sx=1,this.sy=1,this.rt=0};o.MapBlockData=h;var d=function(){this.x=0,this.y=0,this.sx=1,this.sy=1,this.wt=0,this.ht=0};o.MapCircleWallData=d;var u=function(){this.id=0,this.oId=0,this.x=0,this.y=0,this.ax=.5,this.ay=.5,this.wt=0,this.ht=0};o.MapEnemyOutData=u;var m=function(){this.id=0,this.x=0,this.y=0,this.dir=[],this.oId=[]};o.E_GuideId=cc.Enum({ClickBtnSysMain:1,ClickBtnLvupMain:2,ClickBtnSysSub:3,ClickBtnLvupSub:4}),o.E_GuideUIType=cc.Enum({None:0,Circle:1,Rect:2,Screen:3}),o.Enum_BFState=cc.Enum({None:0,In:1,Normal:2,Charge:3,Attack:4}),o.E_SnakeAI=cc.Enum({Box:1,Player:2,Enter:3}),o.GuideData=function(){function t(){this.id=0,this.finishIdList=[],this.uiType=0,this.uiScale=1,this.uiDelay=0,this.uiClickDelay=0,this.uiEnd=cc.v2(0,0),this.handShow=0,this.handDelay=0,this.handMoveTime=0,this.handStart=cc.v2(0,0),this.handEnd=cc.v2(0,0)}return t.prototype.loadData=function(t){var e;(t.hasOwnProperty("id")&&(this.id=parseInt(t.id)),t.hasOwnProperty("fin")&&(this.finishIdList=n.DYTools.stringToNumber(t.fin,"*")),t.hasOwnProperty("utp")&&(this.uiType=parseInt(t.utp)),t.hasOwnProperty("usc")&&(this.uiScale=parseFloat(t.usc)),t.hasOwnProperty("utm")&&(this.uiDelay=parseFloat(t.utm)),t.hasOwnProperty("utd")&&(this.uiClickDelay=parseFloat(t.utd)),t.hasOwnProperty("uep")&&(this.uiEnd=cc.v2(0,0),2==(e=t.uep.split("*")).length&&(this.uiEnd=cc.v2(parseFloat(e[0]),parseFloat(e[1])))),t.hasOwnProperty("hs")&&(this.handShow=parseInt(t.hs)),t.hasOwnProperty("htm")&&(this.handDelay=parseFloat(t.htm)),t.hasOwnProperty("hmtm")&&(this.handMoveTime=parseFloat(t.hmtm)),t.hasOwnProperty("hsp")&&(this.handStart=cc.v2(0,0),2==(e=t.hsp.split("*")).length&&(this.handStart=cc.v2(parseFloat(e[0]),parseFloat(e[1])))),t.hasOwnProperty("hep"))&&(this.handEnd=cc.v2(0,0),2==(e=t.hep.split("*")).length&&(this.handEnd=cc.v2(parseFloat(e[0]),parseFloat(e[1]))))},t}(),o.MapPauseData=m;var p=function(){this.id=0,this.x=0,this.y=0,this.oId=0};o.MapAreaEnemyData=p;var f=function(){this.oId=0,this.x=0,this.y=0};o.MapBossData=f;var _=function(){this.id=0,this.nx=.5,this.ny=.5,this.pos=cc.Vec2.ZERO,this.rt=0,this.oId=0,this.x=0,this.y=0,this.ax=.5,this.ay=.5,this.wt=0,this.ht=0};o.MapPipeData=_;var y=function(){this.x=0,this.y=0,this.rt=0,this.sx=1,this.sy=1,this.wt=0,this.ht=0,this.src=""};o.MapImageData=y;var g=function(){function t(){this.level=0,this.dropKCount=0,this.mapSpeedV=0,this.mapSpeedH=0,this.enemyColor="",this.bgId=1,this.reviveCount=0,this.knifeGold=0,this.boss=0,this.offlineGoldPre=0,this.offlineGoldMax=0,this.fun=0,this.giftGold=0,this.subTryLv=0,this.failParam=""}return t.prototype.loadData=function(t){t.hasOwnProperty("id")&&(this.level=parseInt(t.id)),t.hasOwnProperty("bId")&&(this.bgId=parseInt(t.bId)),t.hasOwnProperty("drn")&&(this.dropKCount=parseInt(t.drn)),t.hasOwnProperty("spv")&&(this.mapSpeedV=parseInt(t.spv)),t.hasOwnProperty("sph")&&(this.mapSpeedH=parseInt(t.sph)),t.hasOwnProperty("col")&&(this.enemyColor=t.col),t.hasOwnProperty("reb")&&(this.reviveCount=parseInt(t.reb)),t.hasOwnProperty("kgd")&&(this.knifeGold=parseInt(t.kgd)),t.hasOwnProperty("boss")&&(this.boss=parseInt(t.boss)),t.hasOwnProperty("mpr")&&(this.offlineGoldPre=parseInt(t.mpr)),t.hasOwnProperty("prm")&&(this.offlineGoldMax=parseInt(t.prm)),t.hasOwnProperty("sud")&&(this.fun=parseInt(t.sud)),t.hasOwnProperty("gbd")&&(this.giftGold=parseInt(t.gbd)),t.hasOwnProperty("mas")&&(this.subTryLv=parseInt(t.mas)),t.hasOwnProperty("dit")&&(this.failParam=t.dit)},t}();o.ConfigLevelData=g;var v=function(){function t(){this.id=0,this.size=cc.Vec2.ZERO,this.speed=cc.Vec2.ZERO,this.blood=cc.Vec2.ZERO,this.hurtSpeed=0,this.playerInSpeed=0,this.dropKParam="",this.dropGold=0,this.attr=[],this.moveType=0,this.imageId=0,this.dieEff=0,this.radiusReduce=0,this.adjustDuration=cc.Vec2.ZERO}return t.prototype.loadData=function(t){t.hasOwnProperty("id")&&(this.id=parseInt(t.id)),t.hasOwnProperty("sz")&&(this.size=n.DYTools.stringToPoint(t.sz,s.GConfig.SeparatorII)),t.hasOwnProperty("spd")&&(this.speed=n.DYTools.stringToPoint(t.spd,s.GConfig.SeparatorII)),t.hasOwnProperty("asp")&&(this.hurtSpeed=Number(t.asp)),t.hasOwnProperty("isp")&&(this.playerInSpeed=Number(t.isp)),t.hasOwnProperty("bld")&&(this.blood=n.DYTools.stringToPoint(t.bld,s.GConfig.SeparatorII)),t.hasOwnProperty("dro")&&(this.dropKParam=t.dro),t.hasOwnProperty("mon")&&(this.dropGold=parseInt(t.mon)),t.hasOwnProperty("fun")&&(this.attr=n.DYTools.stringToNumber(t.fun,s.GConfig.SeparatorII)),t.hasOwnProperty("mov")&&(this.moveType=parseInt(t.mov)),t.hasOwnProperty("img")&&(this.imageId=parseInt(t.img)),t.hasOwnProperty("rat")&&(this.radiusReduce=Number(t.rat)),t.hasOwnProperty("tre")&&(this.adjustDuration=n.DYTools.stringToPoint(t.tre,s.GConfig.SeparatorII))},t}();o.ConfigEnemyData=v;var C=function(){function t(){this.id=0,this.attr=0,this.param=""}return t.prototype.loadData=function(t){t.hasOwnProperty("id")&&(this.id=parseInt(t.id)),t.hasOwnProperty("fun")&&(this.attr=parseInt(t.fun)),t.hasOwnProperty("ver")&&(this.param=t.ver)},t}();o.ConfigAttrData=C;var S=function(){function t(){this.id=0,this.type=0,this.param="",this.refreshDuration=0,this.refreshCount=0}return t.prototype.loadData=function(t){t.hasOwnProperty("id")&&(this.id=parseInt(t.id)),t.hasOwnProperty("typ")&&(this.type=parseInt(t.typ)),t.hasOwnProperty("com")&&(this.param=t.com),t.hasOwnProperty("tim")&&(this.refreshDuration=Number(t.tim)),t.hasOwnProperty("rep")&&(this.refreshCount=parseInt(t.rep))},t}();o.ConfigEnemyOutData=S;var D=function(){function t(){this.id=0,this.enemyArr=[],this.duration=[],this.size=[]}return t.prototype.loadData=function(t){if(t.hasOwnProperty("id")&&(this.id=parseInt(t.id)),t.hasOwnProperty("mo"))for(var e=t.mo.split("#"),i=0;i<e.length;i++){for(var o=e[i].split("*"),a=[],c=0;c<o.length;c++){var r=n.DYTools.stringToPoint(o[c],",");a.push(r)}this.enemyArr.push(a)}if(t.hasOwnProperty("in")&&(this.duration=n.DYTools.stringToNumber(t.in,"*")),t.hasOwnProperty("are"))for(e=t.are.split(s.GConfig.SeparatorI),i=0;i<e.length;i++)this.size.push(n.DYTools.stringToPoint(e[i],s.GConfig.SeparatorII))},t}();o.ConfigPauseData=D;var T=function(){function t(){this.id=0,this.duration=0,this.enemy=""}return t.prototype.loadData=function(t){t.hasOwnProperty("id")&&(this.id=parseInt(t.id)),t.hasOwnProperty("itv")&&(this.duration=Number(t.itv)),t.hasOwnProperty("com")&&(this.enemy=t.com)},t}();o.ConfigEnemyConData=T;var G=function(){function t(){this.id=0,this.enemys=[]}return t.prototype.loadData=function(t){t.hasOwnProperty("id")&&(this.id=parseInt(t.id));for(var e=n.DYTools.stringToNumber(t.mon,s.GConfig.SeparatorII),i=n.DYTools.stringToNumber(t.ang,s.GConfig.SeparatorII),o=t.pos.split(s.GConfig.SeparatorI),a=t.wpo.split(s.GConfig.SeparatorI),c=0;c<e.length;c++){var r=new A;r.id=e[c];var l=i[c],h=o[c],d=a[c];void 0!=l&&void 0!=h&&void 0!=d?(r.rotate=l,r.pos=n.DYTools.stringToPoint(h,s.GConfig.SeparatorII),r.awakePos=n.DYTools.stringToPoint(d,s.GConfig.SeparatorII)):n.DYTools.error("\u5730\u56fe\u533a\u57df\u602a\u8868\u9519\u8bef:"+r.id),this.enemys.push(r)}},t}();o.ConfigMapEnemyAreaData=G;var A=function(){this.id=0,this.rotate=0,this.pos=cc.Vec2.ZERO,this.awakePos=cc.Vec2.ZERO};o.ConfigMapEnemyData=A;var w=function(){function t(){this.id=0,this.type=0,this.ai=2,this.list_hp=[],this.list_gold=[],this.list_follow_min=[],this.list_follow_max=[],this.list_unfollow_min=[],this.list_unfollow_max=[],this.speed_move=300,this.speed_rotate_min=45,this.speed_rotate_max=45,this.rotate_in=0,this.distance_in=800,this.target_in=cc.v2(0,0),this.isIn=0,this.yIn=0,this.speed_rotate_in=45,this.speed_move_in=300,this.image=1,this.color=cc.color(185,42,42),this.gold=0,this.player=cc.Vec2.ZERO,this.pause=!1,this.clear=!1,this.tip=""}return t.prototype.loadData=function(t){if(t.hasOwnProperty("id")&&(this.id=parseInt(t.id)),t.hasOwnProperty("tpe")&&(this.type=parseInt(t.tpe)),t.hasOwnProperty("ai")&&(this.ai=parseInt(t.ai)),t.hasOwnProperty("hp")&&(this.list_hp=n.DYTools.stringToNumber(t.hp,"*")),t.hasOwnProperty("gd")&&(this.list_gold=n.DYTools.stringToNumber(t.gd,"*")),t.hasOwnProperty("fl"))for(var e=t.fl.split("#"),i=0;i<e.length;i++)2==(c=n.DYTools.stringToNumber(e[i],"*")).length&&(this.list_follow_min.push(c[0]),this.list_follow_max.push(c[1]));if(t.hasOwnProperty("ufl"))for(e=t.ufl.split("#"),i=0;i<e.length;i++)2==(c=n.DYTools.stringToNumber(e[i],"*")).length&&(this.list_unfollow_min.push(c[0]),this.list_unfollow_max.push(c[1]));if(t.hasOwnProperty("sp")&&(this.speed_move=parseFloat(t.sp)),t.hasOwnProperty("rp")&&2==(c=n.DYTools.stringToNumber(t.rp,"*")).length&&(this.speed_rotate_min=c[0],this.speed_rotate_max=c[1]),t.hasOwnProperty("er")&&(this.rotate_in=parseFloat(t.er)),t.hasOwnProperty("ed")&&(this.distance_in=parseFloat(t.ed)),t.hasOwnProperty("et")&&(this.target_in=n.DYTools.stringToPoint(t.et,"*")),t.hasOwnProperty("isIn")&&(this.isIn=parseInt(t.isIn)),t.hasOwnProperty("yIn")&&(this.yIn=parseFloat(t.yIn)),t.hasOwnProperty("pp")){var o=n.DYTools.stringToPoint(t.pp,s.GConfig.SeparatorII);this.player=cc.v2(o.x*a.GValue.Size_View.width,o.y*a.GValue.Size_View.height)}var c;(t.hasOwnProperty("st")&&(this.pause=1==parseInt(t.st)),t.hasOwnProperty("kil")&&(this.clear=1==parseInt(t.kil)),t.hasOwnProperty("tip")&&(this.tip=t.tip),t.hasOwnProperty("irp")&&(this.speed_rotate_in=parseFloat(t.irp)),t.hasOwnProperty("isp")&&(this.speed_move_in=parseFloat(t.isp)),t.hasOwnProperty("sh")&&(this.image=parseInt(t.sh)),t.hasOwnProperty("col"))&&(3==(c=n.DYTools.stringToNumber(t.col,"*")).length&&(this.color=cc.color(c[0],c[1],c[2])));t.hasOwnProperty("gold")&&(this.gold=parseFloat(t.gold))},t}();o.ConfigMapBossSnakeData=w;var b=function(){function t(){this.id=0,this.type=0,this.move_speed=0,this.rotate_speed=0,this.start_radius=0,this.start_pos=cc.v2(0,0),this.start_dir=cc.v2(0,-1),this.targetIn_time=0,this.targetIn_pos=cc.v2(0,0),this.list_time=[],this.list_radius=[],this.list_enemy=[],this.list_angle=[],this.list_dline=[],this.dic_line={},this.lineId=0,this.isIn=0,this.rv=cc.v2(-2,-1),this.as_list_time=[],this.as_list_acc=[],this.ar_list_time=[],this.ar_list_acc=[],this.gold=0,this.player=cc.Vec2.ZERO,this.pause=!1,this.clear=!1,this.tip=""}return t.prototype.loadData=function(t){if(t.hasOwnProperty("id")&&(this.id=parseInt(t.id)),t.hasOwnProperty("tpe")&&(this.type=parseInt(t.tpe)),t.hasOwnProperty("ms")&&(this.move_speed=parseFloat(t.ms)),t.hasOwnProperty("rs")&&(this.rotate_speed=parseFloat(t.rs)),t.hasOwnProperty("sr")&&(this.start_radius=parseFloat(t.sr)),t.hasOwnProperty("sp")&&(this.start_pos=n.DYTools.stringToPoint(t.sp,"*")),t.hasOwnProperty("sd")&&(this.start_dir=n.DYTools.stringToPoint(t.sd,"*")),t.hasOwnProperty("tt")&&(this.targetIn_time=parseFloat(t.tt)),t.hasOwnProperty("tp")&&(this.targetIn_pos=n.DYTools.stringToPoint(t.tp,"*")),t.hasOwnProperty("tr"))for(var e=t.tr.split("#"),i=0;i<e.length;i++)2==(c=n.DYTools.stringToNumber(e[i],"*")).length&&(this.list_time.push(c[0]),this.list_radius.push(c[1]));if(t.hasOwnProperty("en"))for(e=t.en.split("#"),i=0;i<e.length;i++)if(3==(c=e[i].split("*")).length){this.list_enemy.push(parseInt(c[0])),this.list_angle.push(parseFloat(c[1]));var o=n.DYTools.stringToNumber(c[2],"-");this.list_dline.push(o)}if(t.hasOwnProperty("dl"))for(e=t.dl.split("#"),i=0;i<e.length;i++)2==(c=n.DYTools.stringToNumber(e[i],"*")).length&&(this.dic_line[c[0]]=c[1]);if(t.hasOwnProperty("li")&&(this.lineId=parseInt(t.li)),t.hasOwnProperty("isIn")&&(this.isIn=parseInt(t.isIn)),t.hasOwnProperty("rv")&&(this.rv=n.DYTools.stringToPoint(t.rv,"*")),t.hasOwnProperty("as"))for(e=t.as.split("#"),i=0;i<e.length;i++)2==(c=n.DYTools.stringToNumber(e[i],"*")).length&&(this.as_list_time.push(c[0]),this.as_list_acc.push(c[1]));if(t.hasOwnProperty("ar"))for(e=t.ar.split("#"),i=0;i<e.length;i++){var c;2==(c=n.DYTools.stringToNumber(e[i],"*")).length&&(this.ar_list_time.push(c[0]),this.ar_list_acc.push(c[1]))}if(t.hasOwnProperty("gold")&&(this.gold=parseFloat(t.gold)),t.hasOwnProperty("pp")){var r=n.DYTools.stringToPoint(t.pp,s.GConfig.SeparatorII);this.player=cc.v2(r.x*a.GValue.Size_View.width,r.y*a.GValue.Size_View.height)}t.hasOwnProperty("st")&&(this.pause=1==parseInt(t.st)),t.hasOwnProperty("kil")&&(this.clear=1==parseInt(t.kil)),t.hasOwnProperty("tip")&&(this.tip=t.tip)},t}();o.ConfigMapBossCircleData=b;var E=function(){function t(){this.id=0,this.type=0,this.hp=1e4,this.end_pos=cc.v2(0,0),this.il=0,this.ir=1,this.ih=2,this.enemys=[],this.lhands=[],this.rhands=[],this.gold=0,this.player=cc.Vec2.ZERO,this.pause=!1,this.clear=!1,this.tip="",this.image=1}return t.prototype.loadData=function(t){if(t.hasOwnProperty("id")&&(this.id=parseInt(t.id)),t.hasOwnProperty("tpe")&&(this.type=parseInt(t.tpe)),t.hasOwnProperty("hp")&&(this.hp=parseInt(t.hp)),t.hasOwnProperty("il")&&(this.il=parseFloat(t.il)),t.hasOwnProperty("ir")&&(this.ir=parseFloat(t.ir)),t.hasOwnProperty("ih")&&(this.ih=parseFloat(t.ih)),t.hasOwnProperty("ep")&&(this.end_pos=n.DYTools.stringToPoint(t.ep,s.GConfig.SeparatorII)),t.hasOwnProperty("enemys")&&(this.enemys=t.enemys.split("#")),t.hasOwnProperty("lh")&&(this.lhands=t.lh.split("#")),t.hasOwnProperty("rh")&&(this.rhands=t.rh.split("#")),t.hasOwnProperty("gold")&&(this.gold=parseFloat(t.gold)),t.hasOwnProperty("pp")){var e=n.DYTools.stringToPoint(t.pp,s.GConfig.SeparatorII);this.player=cc.v2(e.x*a.GValue.Size_View.width,e.y*a.GValue.Size_View.height)}t.hasOwnProperty("st")&&(this.pause=1==parseInt(t.st)),t.hasOwnProperty("kil")&&(this.clear=1==parseInt(t.kil)),t.hasOwnProperty("tip")&&(this.tip=t.tip),t.hasOwnProperty("sh")&&(this.image=parseInt(t.sh))},t}();o.ConfigMapBossFireData=E;var P=function(){function t(){this.id=0,this.type=0,this.hp=1e4,this.target_pos=cc.v2(0,0),this.in_pos=cc.v2(0,0),this.in_time=0,this.speed_move=0,this.speed_rotate=0,this.enemys=[],this.attack=[],this.gold=0,this.player=cc.Vec2.ZERO,this.pause=!1,this.clear=!1,this.tip=""}return t.prototype.loadData=function(t){if(t.hasOwnProperty("id")&&(this.id=parseInt(t.id)),t.hasOwnProperty("tpe")&&(this.type=parseInt(t.tpe)),t.hasOwnProperty("hp")&&(this.hp=parseInt(t.hp)),t.hasOwnProperty("tp")&&(this.target_pos=n.DYTools.stringToPoint(t.tp,s.GConfig.SeparatorII)),t.hasOwnProperty("ip")&&(this.in_pos=n.DYTools.stringToPoint(t.ip,s.GConfig.SeparatorII)),t.hasOwnProperty("it")&&(this.in_time=parseFloat(t.it)),t.hasOwnProperty("sm")&&(this.speed_move=parseFloat(t.sm)),t.hasOwnProperty("sr")&&(this.speed_rotate=parseFloat(t.sr)),t.hasOwnProperty("enemys")&&(this.enemys=t.enemys.split("#")),t.hasOwnProperty("attack")&&(this.attack=t.attack.split("#")),t.hasOwnProperty("gold")&&(this.gold=parseFloat(t.gold)),t.hasOwnProperty("pp")){var e=n.DYTools.stringToPoint(t.pp,s.GConfig.SeparatorII);this.player=cc.v2(e.x*a.GValue.Size_View.width,e.y*a.GValue.Size_View.height)}t.hasOwnProperty("st")&&(this.pause=1==parseInt(t.st)),t.hasOwnProperty("kil")&&(this.clear=1==parseInt(t.kil)),t.hasOwnProperty("tip")&&(this.tip=t.tip)},t}();o.ConfigMapBossElectrData=P;var N=function(){function t(){this.id=0,this.type=[],this.bId=[],this.time=[],this.player=cc.Vec2.ZERO,this.pause=!1,this.tip=""}return t.prototype.loadData=function(t){if(t.hasOwnProperty("id")&&(this.id=parseInt(t.id)),t.hasOwnProperty("tpe")&&(this.type=n.DYTools.stringToNumber(t.tpe,s.GConfig.SeparatorII)),t.hasOwnProperty("bId")&&(this.bId=n.DYTools.stringToNumber(t.bId,s.GConfig.SeparatorII)),t.hasOwnProperty("per")&&(this.time=n.DYTools.stringToNumber(t.per,s.GConfig.SeparatorII)),t.hasOwnProperty("pp")){var e=n.DYTools.stringToPoint(t.pp,s.GConfig.SeparatorII);this.player=cc.v2(720*e.x,1280*e.y)}t.hasOwnProperty("st")&&(this.pause=1==parseInt(t.st)),t.hasOwnProperty("tip")&&(this.tip=t.tip)},t}();o.ConfigMapBossData=N;var k=function(){function t(){this.id=0,this.type=0,this.enemyId=0,this.radius=0,this.knifeCount=0,this.dropParam1="",this.dropParam2="",this.start=cc.Vec2.ZERO,this.end=cc.Vec2.ZERO,this.clear=!1}return t.prototype.loadData=function(t){if(t.hasOwnProperty("id")&&(this.id=parseInt(t.id)),t.hasOwnProperty("tpe")&&(this.type=parseInt(t.tpe)),t.hasOwnProperty("mid")&&(this.enemyId=parseInt(t.mid)),t.hasOwnProperty("ra")&&(this.radius=parseInt(t.ra)),t.hasOwnProperty("nu")&&(this.knifeCount=parseInt(t.nu)),t.hasOwnProperty("par1")&&(this.dropParam1=t.par1),t.hasOwnProperty("par2")&&(this.dropParam2=t.par2),t.hasOwnProperty("sp")){var e=n.DYTools.stringToPoint(t.sp,s.GConfig.SeparatorII);this.start=cc.v2(e.x*a.GValue.Size_View.width,e.y*a.GValue.Size_View.height)}t.hasOwnProperty("ep")&&(e=n.DYTools.stringToPoint(t.ep,s.GConfig.SeparatorII),this.end=cc.v2(e.x*a.GValue.Size_View.width,e.y*a.GValue.Size_View.height)),t.hasOwnProperty("kil")&&(this.clear=1==parseInt(t.kil))},t}();o.ConfigKnifeBossData=k;var F=function(){this.id=0,this.blood=0,this.moveSpeed=0,this.scale=0,this.adjustDuration=0,this.cData=null,this.kData=null};o.EnemyData=F;var V=function(){this.id=0,this.enemy=[],this.duration=0,this.time=0,this.rect=cc.rect()};o.ContinueEnemyData=V;var x=function(){function t(){this.lv=0,this.atk=0,this.gd=0,this.imageId=1}return t.prototype.loadData=function(t){t.hasOwnProperty("id")&&(this.lv=parseInt(t.id)),t.hasOwnProperty("atk")&&(this.atk=parseInt(t.atk)),t.hasOwnProperty("gd")&&(this.gd=parseInt(t.gd)),t.hasOwnProperty("ima")&&(this.imageId=parseInt(t.ima))},t}();o.ConfigPropertyArmsMainData=x;var I=function(){function t(){this.fun=0,this.lv=0,this.atk=0,this.gd=0,this.var=""}return t.prototype.loadData=function(t){t.hasOwnProperty("fun")&&(this.fun=parseInt(t.fun)),t.hasOwnProperty("lv")&&(this.lv=parseInt(t.lv)),t.hasOwnProperty("atk")&&(this.atk=parseInt(t.atk)),t.hasOwnProperty("gd")&&(this.gd=parseInt(t.gd)),t.hasOwnProperty("var")&&(this.var=t.var)},t}();o.ConfigPropertyArmsSubData=I;var R=function(){function t(){this.lv=0,this.val=0,this.gd=0}return t.prototype.loadData=function(t){t.hasOwnProperty("id")&&(this.lv=parseInt(t.id)),t.hasOwnProperty("val")&&(this.val=parseInt(t.val)),t.hasOwnProperty("gd")&&(this.gd=parseInt(t.gd))},t}();o.ConfigPropertyGoldKillData=R;var B=function(){function t(){this.lv=0,this.out=0,this.gd=0,this.lmt=0}return t.prototype.loadData=function(t){t.hasOwnProperty("id")&&(this.lv=parseInt(t.id)),t.hasOwnProperty("out")&&(this.out=parseInt(t.out)),t.hasOwnProperty("gd")&&(this.gd=parseInt(t.gd)),t.hasOwnProperty("lmt")&&(this.lmt=parseInt(t.lmt))},t}();o.ConfigPropertyGoldOfflineData=B;var M=function(){function t(){this.id=-1,this.title="",this.imageUrl="",this.userId=-1}return t.prototype.loadData=function(t){t.hasOwnProperty("id")&&(this.id=Number(t.id)),t.hasOwnProperty("url")&&(this.imageUrl=t.url),t.hasOwnProperty("text")&&(this.title=t.text)},t}();o.ShareData=M;var L=function(){function t(){this.id=0,this.type=0,this.value=[],this.shareId=[]}return t.prototype.loadData=function(t){t.hasOwnProperty("id")&&(this.id=Number(t.id)),t.hasOwnProperty("type")&&(this.type=Number(t.type)),t.hasOwnProperty("vars")&&(this.value=n.DYTools.stringToNumber(t.vars,s.GConfig.SeparatorII)),t.hasOwnProperty("shareid")&&(this.shareId=n.DYTools.stringToNumber(t.shareid,s.GConfig.SeparatorII))},t}();o.ADShareData=L,cc._RF.pop()},{CommonConfig:"CommonConfig",CommonValue:"CommonValue",Tools:"Tools"}],DWK:[function(t,e,i){"use strict";cc._RF.push(e,"bfae2hinClCjbgItBf35d0r","DWK"),cc.Class({extends:cc.Component,properties:{label:cc.Label},ctor:function(){this.label=null,this.text="hello"},start:function(){}}),cc._RF.pop()},{}],DeputyWeaponCollisionHandleSys:[function(t,e,i){"use strict";cc._RF.push(e,"87b69BbcOJHWrmv2PBeY5F5","DeputyWeaponCollisionHandleSys");var o=t("CBaseCollisionHandleSystem"),n=t("CommonValue"),s=t("CommonEnum");cc.Class({extends:o,properties:{},ctor:function(){this._eventListName="_deputyWeaponCollisionEvent"},handelCollisionEvent:function(t){var e=t[0],i=t[1];if(e&&e.node)switch(e.node.group){case"enemy":if(e.tag==s.E_CTag.Boss_SnakeTail){var o=e.name;(a=n.GValue.EntityWorld.SnakeEnemys[o])&&a.attackTail(1,n.GValue.EntityWorld.player.curDWAtk)}else if(e.tag>=s.E_CTag.Boss_SnakeHead&&e.tag<s.E_CTag.Boss_SnakeTail){var a;o=e.name,(a=n.GValue.EntityWorld.SnakeEnemys[o])&&a.attackBody(0,e.tag,null)}else if(e.tag==s.E_CTag.Boss_Fire){o=e.name;var c=n.GValue.EntityWorld.FireEnemys[o];c&&c.attack(1,n.GValue.EntityWorld.player.curDWAtk)}this.attackEnemy(e,i)}},updateGameLogic:function(t){o.prototype.updateGameLogic.call(this,t),this._collisionEventMgr.clearDeputyWeaponEvent()},attackEnemy:function(t,e){t.node.emit("emitEvent",["hurt",1,n.GValue.EntityWorld.player.curDWAtk]),e.node.parent.emit("attackLight")}}),cc._RF.pop()},{CBaseCollisionHandleSystem:"CBaseCollisionHandleSystem",CommonEnum:"CommonEnum",CommonValue:"CommonValue"}],EnemyActionMoveComponent:[function(t,e,i){"use strict";cc._RF.push(e,"67b47b46eNLl7U+/+a1h6pM","EnemyActionMoveComponent");var o=t("EnemyMoveBaseComponent"),n=t("Tools"),s=t("Types"),a=t("CommonValue");cc.Class({extends:o,properties:{},ctor:function(){this.moveDistance=0,this.curRatir=0,this.distance=0,this.targetRotate=0,this.destFindMaxCount=10,this.destFindCount=0},updateGameLogic:function(t){if(this.enemy)switch(this.enemy.stateCom.state){case s.EnemyAction.Action:if(o.prototype.updateGameLogic.call(this,t),!this.firstInScreen){var e=this.node.convertToWorldSpaceAR(cc.v2(0,0));n.DYTools.isInSreen(e,40)&&(this.firstInScreen=!0)}0!=this.moveType&&this.player&&!this.player.isDead&&(this.updateRotation(t),this.updatePosition(t))}},updateRotation:function(t){switch(this.moveType){case s.EnemyMoveType.Follow:case s.EnemyMoveType.SpeedUp:this.canChangeDir&&(this.rotateTime+=t,this.rotateTime>this.adjustDuration&&this.adjustDir());break;case s.EnemyMoveType.Elastic:if(this.canChangeDir)if(this.firstInScreen){if(this.enemy.hasAttribution(s.EnemyAttr.SplitMin)&&(this.rotateTime+=t,this.rotateTime>this.adjustDuration)){var e=n.DYTools.random_int(52,105)/100+n.DYTools.random_int(1,3)*Math.PI/2,i=cc.v2(0,-1).rotate(e);this.setCurDir(i),this.rotateTime=0}}else if(this.enemy.hasAttribution(s.EnemyAttr.RanDir)){if(!this.enemy.moveFixCom.colWallAble){var o=this.player.getPositionForMap().sub(this.node.position);this.setCurDir(o.normalize()),this.rotateTime=0,this.distance=this.curDir.mag()}}else this.enemy.hasAttribution(s.EnemyAttr.SplitMin)?(o=this.player.getPositionForMap().sub(this.node.position),this.setCurDir(o.normalize())):(this.rotateTime+=t,this.rotateTime>this.adjustDuration&&(o=this.player.getPositionForMap().sub(this.node.position),this.setCurDir(o.normalize()),this.rotateTime=0,this.distance=this.curDir.mag()))}},adjustDir:function(){if(!(this.rotateTime<.2)){var t=this.getWayDir();this.setCurDir(t.normalize()),this.rotateTime=0,this.distance=this.curDir.mag()}},getWayDir:function(){var t=cc.Vec2.ZERO,e=this.node.position,i=this.getIntersectBlocks(e);if(0==i.length)t=this.player.getPositionForMap().sub(this.node.position);else{var o=cc.Vec2.ZERO;if(i.length>22){var s=this.player.getPositionForMap();this.destFindCount=0;var a=this.getNextDest(e,i,!0);this.destFindCount=0;var c=this.getNextDest(e,i,!1);o=(r=a.sub(s).mag())<(d=c.sub(s).mag())?a:c}else{var r=0,l=[];for(this.destFindCount=0;i.length>0;){var h=this.getNextDest(e,i,!0);if(r+=e.sub(h).mag(),this.arrContainPos(l,h))break;l.push(h),e=h,i=this.getIntersectBlocks(h),l.length>20&&(i.splice(0),n.DYTools.error("way0:error"))}var d=0,u=[];for(e=this.node.position,i=this.getIntersectBlocks(e),this.destFindCount=0;i.length>0&&(h=this.getNextDest(e,i,!1),d+=e.sub(h).mag(),!this.arrContainPos(u,h));)u.push(h),e=h,i=this.getIntersectBlocks(h),u.length>20&&(i.splice(0),n.DYTools.error("way1:error"));r>d&&d>0?o=u[0]:r>0&&(o=l[0])}t=o.sub(this.node.position)}return t},getIntersectBlocks:function(t){for(var e=this.player.getPositionForMap(),i=this.enemy.radius,o=t.y+.75*i,n=t.y-.75*i,s=t.x-.75*i,c=t.x+.75*i,r=e.y+20-6,l=e.y-20+6,h=e.x-20+6,d=e.x+20-6,u=[],m=a.GValue.EntityWorld.mapMgr.blockArr,p=a.GValue.EntityWorld.mapMgr.blockRectArr,f=0;f<m.length;f++){var _=m[f],y=p[f],g=y.yMax,v=y.yMin,C=y.xMin,S=y.xMax;if(o<=v&&r<=v);else if(n>=g&&l>=g);else if(s>=S&&h>=S);else if(c<=C&&d<=C);else{var D=y.x-.5*i,T=y.y-.5*i,G=y.width+1*i,A=y.height+1*i,w=cc.rect(D,T,G,A);cc.Intersection.lineRect(t,e,w)&&u.push(_)}}return u},getNextDest:function(t,e,i){this.destFindCount++;for(var o=cc.Vec2.ZERO,s=1111110,c=this.enemy.radius-5,r=0,l=e;r<l.length;r++){var h=l[r],d=h.node.position.add(h.colCollider.node.position),u=h.width,m=h.height,p=d.add(cc.v2(-u/2-c,-m/2-c)),f=d.add(cc.v2(-u/2-c,m/2+c)),_=d.add(cc.v2(u/2+c,m/2+c)),y=d.add(cc.v2(u/2+c,-m/2-c)),g=this.getBlockVertex(t,i,d,p,f,_,y,u/2+c-2,m/2+c-2),v=this.getLineBlocks(t,g,a.GValue.EntityWorld.mapMgr.blockArr);this.destFindCount<this.destFindMaxCount&&(n.DYTools.arrRemove(v,h),v.length>0&&(g=this.getNextDest(t,v,i)));var C=g.sub(t).mag();s>C&&(s=C,o=g)}return o},getLineBlocks:function(t,e,i){for(var o=[],n=0,s=i;n<s.length;n++){var a=s[n];this.isLineBlock(t,e,a)&&o.push(a)}return o},isLineBlock:function(t,e,i){var o=i.node.position.add(i.colCollider.node.position),n=i.width,s=i.height,a=cc.rect(o.x-n/2-10,o.y-s/2-10,n+20,s+20),c=cc.v2(a.xMin,a.yMin),r=cc.v2(a.xMin,a.yMax),l=cc.v2(a.xMax,a.yMax);if(t.y<c.y&&e.y<c.y);else if(t.y>r.y&&e.y>r.y);else if(t.x<c.x&&e.x<c.x);else if(t.x>l.x&&e.x>l.x);else if(cc.Intersection.lineRect(t,e,a))return!0;return!1},getBlockVertex:function(t,e,i,o,s,a,c,r,l){var h=[];h.push(o),h.push(s),h.push(a),h.push(c);var d=0;return t.x>i.x+r&&t.y>c.y&&t.y<a.y?d=e?3:2:t.x<i.x-r&&t.y>o.y&&t.y<s.y?d=e?1:0:t.y>i.y+l&&t.x>s.x&&t.x<a.x?d=e?2:1:t.y<i.y-l&&t.x>o.x&&t.x<c.x?d=e?0:3:t.x<=i.x&&t.y<=i.y?d=e?1:3:t.x<=i.x&&t.y>=i.y?d=e?2:0:t.x>=i.x&&t.y>=i.y?d=e?3:1:t.x>=i.x&&t.y<=i.y?d=e?0:2:n.DYTools.error("\u6ca1\u6709\u65b9\u5411"),h[d]},setRotate:function(t){var e=cc.v2(0,-1),i=t.signAngle(e),o=cc.misc.radiansToDegrees(i);this.adjustDuration-.1<0?this.node.angle=o:(this.node.stopAllActions(),this.node.runAction(cc.rotateTo(n.DYTools.random_int(5,10)/100,o))),this.targetRotate=o},arrContainPos:function(t,e){for(var i=0;i<t.length;i++)if(t[i].equals(e))return!0}}),cc._RF.pop()},{CommonValue:"CommonValue",EnemyMoveBaseComponent:"EnemyMoveBaseComponent",Tools:"Tools",Types:"Types"}],EnemyAnimComponent:[function(t,e,i){"use strict";cc._RF.push(e,"9a6903aJsBIP5llj0AIsrzV","EnemyAnimComponent");var o=t("CommonConfig"),n=t("Types"),s=t("CommonValue"),a=t("Tools"),c=t("PfFrameAnim");cc.Class({extends:cc.Component,properties:{backNode:cc.Node,bodyNode:cc.Node,dbNode:cc.Node,pf_db:cc.Prefab,animNode:cc.Node},ctor:function(){this.backNode=null,this.bodyNode=null,this.dbNode=null,this.pf_db=null,this.animNode=null,this._data=null,this._entityEnemy=null,this._bloodNode=null,this._hurtLightNode=null,this._knifeLightNode=null,this._animDieCom=null,this._knifeLightCom=null,this.hpFrameAnim=null,this.hpCFrameAnim=null,this.hlpFrameAnim=null,this.dpFrameAnim=null,this.iceFrameAnim=null,this.fireFrameAnim=null,this.doctorFrameAnim=null,this.doctorEffectNode=null,this.eleFrameAnim=null,this.eleLineFrameAnim=null,this.eleCallback=null,this.goldPropFrameAnim=null,this.goldPropState=!1,this._lightDWNode=null,this._lightDWCom=null,this._bodyPos=cc.Vec2.ZERO,this._bloodPos=cc.Vec2.ZERO,this._curActTag=-1,this._animList=[],this.hpPlaying=!1,this.hpCPlaying=!1,this.hlpPlaying=!1,this.scaleY=1,this.isHurted=!1,this.hurtDuration=0,this.posHNormal=cc.Vec2.ZERO,this.rtHNormal=0,this.posHLaser=cc.Vec2.ZERO,this.rtHLaser=0,this.dieCall=null},preLoad:function(){var t=this;(e=cc.instantiate(s.GValue.pf_anim)).scale=1.8,this.hpFrameAnim=e.getComponent(c),this.hpFrameAnim.init(s.GValue.Atlas_Enemy,"ah_",5,.02,function(){t.onHpAnimFinished()}),this.dbNode.addChild(e),(e=cc.instantiate(s.GValue.pf_anim)).scale=1.8,this.hpCFrameAnim=e.getComponent(c),this.hpCFrameAnim.init(s.GValue.Atlas_Enemy,"ahh_",9,.02,function(){t.onHpCAnimFinished()}),this.dbNode.addChild(e),(e=cc.instantiate(s.GValue.pf_anim)).scale=3,e.anchorY=1,this.hlpFrameAnim=e.getComponent(c),this.hlpFrameAnim.init(s.GValue.Atlas_Enemy,"ahl_",9,.02,function(){t.onHlpCAnimFinished()}),this.dbNode.addChild(e),(e=cc.instantiate(s.GValue.pf_anim)).scale=2,this.dpFrameAnim=e.getComponent(c),this.dpFrameAnim.init(s.GValue.Atlas_Enemy,"aed_",23,.025,function(){t.onDpAnimFinished()}),this.dbNode.addChild(e),(e=cc.instantiate(s.GValue.pf_anim)).scale=2.5,this.iceFrameAnim=e.getComponent(c),this.iceFrameAnim.init(s.GValue.Atlas_Enemy,"aei_",8,1.5*o.GConfig.actionFrameTime,null,function(){t.onIceAnimStop()}),this.animNode.addChild(e),(e=cc.instantiate(s.GValue.pf_anim)).scale=2,this.fireFrameAnim=e.getComponent(c),this.fireFrameAnim.init(s.GValue.Atlas_Enemy,"aef_",7,1.8*o.GConfig.actionFrameTime,null,function(){t.onFireAnimStop()}),this.animNode.addChild(e),(e=cc.instantiate(s.GValue.pf_anim)).scale=2,this.eleFrameAnim=e.getComponent(c),this.eleFrameAnim.init(s.GValue.Atlas_Enemy,"aeh_",5,1.8*o.GConfig.actionFrameTime,null,function(){t.onEleAnimFinished()}),this.animNode.addChild(e);var e,i=cc.instantiate(s.GValue.pf_anim);i.scale=2,this.eleLineFrameAnim=i.getComponent(c),this.eleLineFrameAnim.init(s.GValue.Atlas_Enemy,"aec_",2,1.8*o.GConfig.actionFrameTime,null,function(){t.onFireAnimStop()}),this.animNode.addChild(i),(e=cc.instantiate(s.GValue.pf_anim)).scale=2,this.doctorFrameAnim=e.getComponent(c),this.doctorFrameAnim.init(s.GValue.Atlas_Enemy,"aedoc_",8,2*o.GConfig.actionFrameTime,null,function(){t.onDocAnimStop()}),this.animNode.addChild(e),this.doctorEffectNode=new cc.Node,this.bodyNode.parent.addChild(this.doctorEffectNode,-10),this.doctorEffectNode.addComponent(cc.Sprite).spriteFrame=s.GValue.Atlas_Enemy.getSpriteFrame("treatLight"),this.doctorEffectNode.opacity=0,(e=cc.instantiate(s.GValue.pf_anim)).scale=2,this.goldPropFrameAnim=e.getComponent(c),this.goldPropFrameAnim.init(s.GValue.Atlas_Enemy,"aepg_",4,2*o.GConfig.actionFrameTime,function(){t.goldPropFrameAnim.stop()}),this.animNode.addChild(e)},init:function(t,e,i,a,c,r,l){this._entityEnemy=t,this._data=e,this.bodyNode=i,this._bloodNode=a,this._hurtLightNode=c,this._knifeLightNode=r,this._animDieCom=l.getComponent(cc.Animation),this._knifeLightCom=r.getComponent(cc.Animation),this._lightDWNode=c.parent.getChildByName("hurt1"),this._lightDWCom=c.parent.getChildByName("cross1").getComponent(cc.Animation),this._bodyPos=this.bodyNode.position,this._bloodPos=this._bloodNode.position,this._animList.splice(0);var h=e.cData.imageId;this.animNode.scale=4==h||6==h?.5:1,this._entityEnemy.stateCom.state==n.EnemyAction.Action&&this.addAnimAct(n.EnemyAnim.Idle),this.fireFrameAnim.node.y=o.GConfig.enemyFirePos[this._data.cData.imageId].y,o.GConfig.enemyFireScale[this._data.cData.imageId]&&(this.fireFrameAnim.node.scale=o.GConfig.enemyFireScale[this._data.cData.imageId]),4==this._data.cData.imageId||6==this._data.cData.imageId?(this.doctorFrameAnim.node.scale=1.5,this.doctorEffectNode.scale=.6):(this.doctorFrameAnim.node.scale=2,this.doctorEffectNode.scale=1),this.goldPropFrameAnim.node.y=o.GConfig.enemyGoldEyePos[this._data.cData.imageId].y,this.goldPropState=s.GValue.PropMgr.hasProp(n.PropType.Gold),this._entityEnemy.uiCom.setGoldEyeShow(this.goldPropState),4==this._data.cData.imageId||6==this._data.cData.imageId?(this.doctorFrameAnim.node.scale=1.5,this.doctorEffectNode.scale=.6):(this.doctorFrameAnim.node.scale=2,this.doctorEffectNode.scale=1)},setThronShow:function(t){},onAnimCompleted:function(t){t==n.EnemyAnim.HurtNormal&&(this._curActTag=0,this.bodyNode.stopAllActions())},addAnimAct:function(t,e,i,o){switch(void 0===e&&(e=cc.Vec2.ZERO),void 0===i&&(i=0),void 0===o&&(o=null),t){case n.EnemyAnim.Idle:break;case n.EnemyAnim.HurtNormal:this.posHNormal=e,this.rtHNormal=i;break;case n.EnemyAnim.HurtLaser:this.posHLaser=e,this.rtHLaser=i;break;case n.EnemyAnim.Die:this.dieCall=o}a.DYTools.arrContain(this._animList,t)||(this._animList.push(t),this.refreshAnim())},removeAnimAct:function(t){var e=this._animList.indexOf(t);switch(e>=0&&this._animList.splice(e,1),t){case n.EnemyAnim.Idle:case n.EnemyAnim.HurtNormal:break;case n.EnemyAnim.HurtLaser:this.onHlpCAnimFinished()}this.refreshAnim()},refreshAnim:function(){if(a.DYTools.arrContain(this._animList,n.EnemyAnim.Die))this.initAnim(),this.iceFrameAnim.stop(),this.fireFrameAnim.stop(),this.doctorFrameAnim.stop(),this.goldPropFrameAnim.stop(),this.playDieAnim(this.dieCall);else if(a.DYTools.arrContain(this._animList,n.EnemyAnim.HurtNormal)){var t=0;this.isHurted&&(t=1),this.isHurted=!0,this.hurtDuration=0,this._curActTag!=n.EnemyAnim.HurtNormal&&(this._curActTag=n.EnemyAnim.HurtNormal,this.initAnim(),this.playHurtAnim(),this.playHurtLightAnim(this.posHNormal),this.playHurtParticle(t,this.posHNormal)),a.DYTools.arrContain(this._animList,n.EnemyAnim.HurtLaser)&&this.playLaserHurtParticle(this.posHLaser)}else a.DYTools.arrContain(this._animList,n.EnemyAnim.HurtLaser)?(this._curActTag=n.EnemyAnim.HurtLaser,this.isHurted=!0,this.hurtDuration=0,this.initAnim(),this.playLaserHurtParticle(this.posHLaser),this.playLaserHurtAct()):this._curActTag!=n.EnemyAnim.Idle&&(this._curActTag=n.EnemyAnim.Idle,this.initAnim(),this.playIdleAnim())},playDeputyHurtAnim:function(t){var e=this,i=.7*o.GConfig.actionFrameTime;this._lightDWNode.active=!0,this._lightDWNode.opacity=255,this._lightDWNode.scale=1;var n=a.DYTools.random_int(0,40)-20;this._lightDWNode.position=t.add(cc.v2(n,.5*Math.abs(n)));var s=cc.fadeTo(3*i,178),c=cc.scaleTo(3*i,1.46);this._lightDWNode.runAction(cc.sequence(cc.spawn(s,c),cc.callFunc(function(){e._lightDWNode.opacity=0}))),this._lightDWCom.node.active=!0,this._lightDWCom.node.opacity=255,this._lightDWCom.node.position=t.add(cc.v2(a.DYTools.random_int(0,60)-30,a.DYTools.random_int(0,20)-10)),this._lightDWCom.play(),this.playHurtParticle(1,t)},initAnim:function(){this.bodyNode.stopAllActions(),this.bodyNode.scale=1,this.bodyNode.position=this._bodyPos,this._bloodNode.stopAllActions(),this._bloodNode.scale=1,this._bloodNode.position=this._bloodPos},updateGameLogic:function(t){this.isHurted&&(this.hurtDuration+=t,this.hurtDuration>=.2&&(this.hurtDuration=0,this.isHurted=!1)),this.isHurted?(this.scaleY-=.02,this.scaleY<.75&&(this.scaleY=.75)):(this.scaleY+=.05,this.scaleY>=1&&(this.scaleY=1)),this.bodyNode.parent.scaleY=this.scaleY,!this._entityEnemy.isDead&&this._entityEnemy.buffCom.isDirty&&(this._entityEnemy.hasBuff(n.EnemyBuff.Frozen)?this.iceFrameAnim.isPlaying()||this.iceFrameAnim.reset():this._entityEnemy.hasBuff(n.EnemyBuff.Firing)?this.fireFrameAnim.isPlaying()||this.fireFrameAnim.reset():(this.iceFrameAnim.isPlaying()&&this.iceFrameAnim.stop(),this.fireFrameAnim.isPlaying()&&this.fireFrameAnim.stop(!0)),this._entityEnemy.hasBuff(n.EnemyBuff.Treat)?this.doctorFrameAnim.isPlaying()||(this.doctorFrameAnim.reset(),this.doctorEffectNode.opacity=255):this.doctorFrameAnim.isPlaying()&&this.doctorFrameAnim.stop(),this._entityEnemy.buffCom.isDirty=!1),this.checkGoldPropAnim()},playIdleAnim:function(){var t=1.2*o.GConfig.actionFrameTime,e=cc.scaleTo(4*t,1.02,.93),i=cc.scaleTo(3*t,.98,1.01),n=cc.scaleTo(2*t,1,1),s=cc.repeatForever(cc.sequence(e,i,n));this.bodyNode.runAction(s);var a=cc.moveBy(4*t,cc.v2(0,3)),c=cc.moveBy(3*t,cc.v2(0,-2)),r=cc.moveBy(3*t,cc.v2(0,-1)),l=cc.spawn(e.clone(),a),h=cc.spawn(i.clone(),c),d=cc.spawn(n.clone(),r);this._bloodNode.runAction(cc.repeatForever(cc.sequence(l,h,d)))},playHurtAnim:function(){var t=this,e=.7*o.GConfig.actionFrameTime,i=cc.scaleTo(0,1),s=cc.scaleTo(2*e,1.14),a=cc.scaleTo(e,1.14),c=cc.callFunc(function(){t.removeAnimAct(n.EnemyAnim.HurtNormal)});this.bodyNode.runAction(cc.sequence(i,s,a,c));var r=cc.scaleTo(0,1),l=cc.scaleTo(2*e,1.14),h=cc.moveBy(2*e,cc.v2(0,2)),d=cc.spawn(l,h),u=cc.scaleTo(e,1.14),m=cc.moveBy(e,cc.v2(0,-2)),p=cc.spawn(u,m);this._bloodNode.runAction(cc.sequence(r,d,p))},playHurtLightAnim:function(t){var e=this,i=.7*o.GConfig.actionFrameTime;this._hurtLightNode.active=!0,this._hurtLightNode.opacity=255,this._hurtLightNode.scale=1;var n=a.DYTools.random_int(0,40)-20;this._hurtLightNode.position=t.add(cc.v2(n,.5*Math.abs(n)));var s=cc.fadeTo(3*i,178),c=cc.scaleTo(3*i,1.46);this._hurtLightNode.runAction(cc.sequence(cc.spawn(s,c),cc.callFunc(function(){e._hurtLightNode.opacity=0}))),this._knifeLightNode.active=!0,this._knifeLightNode.opacity=255,this._knifeLightNode.angle=-this.rtHNormal,this._knifeLightNode.position=t.add(cc.v2(a.DYTools.random_int(0,60)-30,a.DYTools.random_int(0,20)-10)),this._knifeLightCom.play()},playHurtParticle:function(t,e){0==t?this.hpPlaying||(this.hpPlaying=!0,this.hpFrameAnim.reset(),this.hpFrameAnim.node.position=e,this.hpFrameAnim.node.angle=-this.rtHNormal,this.hpFrameAnim.node.color=this.getParticleColor()):1!=t||this.hpCPlaying||(this.hpCPlaying=!0,this.hpCFrameAnim.reset(),this.hpCFrameAnim.node.position=e,this.hpCFrameAnim.node.angle=-this.rtHNormal,this.hpCFrameAnim.node.color=this.getParticleColor())},playLaserHurtAct:function(){var t=.7*o.GConfig.actionFrameTime,e=cc.scaleTo(0,1,.9),i=cc.scaleTo(2*t,1.3,1),n=cc.scaleTo(t,1),s=cc.sequence(e,i,n);this.bodyNode.runAction(cc.repeatForever(s));var a=cc.scaleTo(0,1,.9),c=cc.scaleTo(2*t,1.3,1.18),r=cc.scaleTo(t,1);this._bloodNode.runAction(cc.repeatForever(cc.sequence(a,c,r)))},playLaserHurtParticle:function(t){this.hlpPlaying||(this.hlpFrameAnim.reset(),this.hlpFrameAnim.node.position=t,this.hlpFrameAnim.node.angle=-this.rtHLaser,this.hlpFrameAnim.node.color=this.getParticleColor())},playElectricityAct:function(t){this.eleCallback=t,this.eleFrameAnim.reset()},onEleAnimFinished:function(){this.eleCallback&&this.eleCallback(this),this.eleFrameAnim.stop()},onHpAnimFinished:function(){this.hpPlaying=!1,this.hpFrameAnim.stop()},onHpCAnimFinished:function(){this.hpCPlaying=!1,this.hpCFrameAnim.stop()},onHlpCAnimFinished:function(){if(this.hlpPlaying=!1,this.hlpFrameAnim.stop(),this._entityEnemy.player.isDead){this.bodyNode.stopAllActions(),this._bloodNode.stopAllActions();var t=this._animList.indexOf(n.EnemyAnim.HurtLaser);t>=0&&this._animList.splice(t,1),(t=this._animList.indexOf(n.EnemyAnim.HurtNormal))>=0&&this._animList.splice(t,1),this.refreshAnim()}else a.DYTools.arrContain(this._animList,n.EnemyAnim.HurtLaser)&&!a.DYTools.arrContain(this._animList,n.EnemyAnim.Die)&&this.refreshAnim()},onIceAnimStop:function(){},onFireAnimStop:function(){},onDocAnimStop:function(){this.doctorEffectNode.opacity=0},onDpAnimFinished:function(){this._animDieCom.node.opacity=0,this.dpFrameAnim.stop(),this.hpFrameAnim.stop(),this.hlpFrameAnim.stop(),this.iceFrameAnim.stop(),this.fireFrameAnim.stop(),this.hpPlaying=!1,this.hpCPlaying=!1,this.hlpPlaying=!1,this.dieCall&&this.dieCall()},playDieAnim:function(t){var e=this;this._animDieCom.node.opacity=255,this._animDieCom.play("die"),this._entityEnemy.hasAttribution(n.EnemyAttr.Gold)&&s.GValue.EntityWorld.gameUI.playGoldEnemyDie(this.node.convertToWorldSpaceAR(cc.v2(0,0)),this._data.cData.dropGold),this.dpFrameAnim.reset(),this.dpFrameAnim.node.color=this.getParticleColor();var i=o.GConfig.actionFrameTime;this.scheduleOnce(function(){var t=e.dbNode.getChildByName("dieLight");t?t.opacity=255:((t=new cc.Node).name="dieLight",e.dbNode.addChild(t),t.addComponent(cc.Sprite).spriteFrame=s.GValue.Atlas_Enemy.getSpriteFrame("edl")),t.scale=1.55,t.runAction(cc.sequence(cc.scaleTo(3*i,.56),cc.callFunc(function(){t.opacity=0})))},i)},checkGoldPropAnim:function(){this.goldPropState?s.GValue.PropMgr.hasProp(n.PropType.Gold)||(this.goldPropState=!1,this._entityEnemy.uiCom.setGoldEyeShow(!1)):s.GValue.PropMgr.hasProp(n.PropType.Gold)&&(this.goldPropState=!0,this.goldPropFrameAnim.reset(),this._entityEnemy.uiCom.setGoldEyeShow(!0))},getParticleColor:function(){return 1001==this._data.cData.imageId?cc.Color.BLACK:this._entityEnemy.skinColor}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonValue:"CommonValue",PfFrameAnim:"PfFrameAnim",Tools:"Tools",Types:"Types"}],EnemyAttrBaseCom:[function(t,e,i){"use strict";cc._RF.push(e,"751d19ad+pCmagfNRGT+4GK","EnemyAttrBaseCom");var o=t("EnemyBaseComponent");cc.Class({extends:o,properties:{},ctor:function(){this.enemyEntity=null,this.attrData=null,this.attrMgr=null},updateGameLogic:function(t){},die:function(){}}),cc._RF.pop()},{EnemyBaseComponent:"EnemyBaseComponent"}],EnemyAttrComponent:[function(t,e,i){"use strict";cc._RF.push(e,"d6303H9DhNEb4vu2nQ7MneH","EnemyAttrComponent");var o=t("Types"),n=t("CommonConfig"),s=t("Tools"),a=t("CommonValue"),c=t("EnemyAttrThronCom"),r=t("EnemyAttrDoctorCom"),l=t("EnemyAttrSplitCom"),h=t("EnemyAttrVomitCom"),d=t("EnemyAttrEnterCom"),u=t("EnemyAttrTrackCom");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.entity=null,this.attr=[],this.param={},this.attrData={},this.awakeRect=cc.rect(),this.comArr=[],this.comDict={}},init:function(t){this.entity=t,this.attr=[],this.param={},this.attrData={};for(var e=this.entity.data.cData.attr,i=0;i<e.length;i++){var m=n.GConfig.getAttrData(e[i]);this.attr.push(m.attr),this.param[m.attr]=m.param,this.attrData[m.attr]=m}if(this.hasAttribution(o.EnemyAttr.Sleep)){this.node.emit("updateState",o.EnemyAction.Sleep);var p=s.DYTools.stringToPoint(this.param[o.EnemyAttr.Sleep],n.GConfig.SeparatorII),f=a.GValue.Size_View.width*p.x,_=a.GValue.Size_View.height*p.y;this.awakeRect=cc.rect(f,_,a.GValue.Size_View.width-2*f,a.GValue.Size_View.height-2*_)}else this.node.emit("updateState",o.EnemyAction.Action);var y=[];if(this.hasAttribution(o.EnemyAttr.Thron)){var g=s.DYTools.addScript(this.node,c);g.init(this.entity,this.attrData[o.EnemyAttr.Thron]),y.push(g)}if(this.hasAttribution(o.EnemyAttr.Doctor)){var v=s.DYTools.addScript(this.node,r);v.init(this.attrData[o.EnemyAttr.Doctor]),y.push(v)}if(this.hasAttribution(o.EnemyAttr.Split)){var C=s.DYTools.addScript(this.node,l);C.init(this.entity,this.attrData[o.EnemyAttr.Split]),y.push(C)}if(this.hasAttribution(o.EnemyAttr.Vomit)){var S=s.DYTools.addScript(this.node,h);S.init(this.entity,this.attrData[o.EnemyAttr.Vomit],this),y.push(S)}if(this.hasAttribution(o.EnemyAttr.Enter)){var D=s.DYTools.addScript(this.node,d);D.init(this.entity,this.attrData[o.EnemyAttr.Enter]),y.push(D)}if(this.hasAttribution(o.EnemyAttr.Track)){var T=s.DYTools.addScript(this.node,u);T.init(this.entity,this.attrData[o.EnemyAttr.Track]),y.push(T)}for(i=0;i<this.comArr.length;i++){var G=this.comArr[i];s.DYTools.arrContain(y,G)||(G.destroy(),this.comArr.splice(i,1),this.comDict[G.attrData.attr]=null,i--)}for(i=0;i<y.length;i++)G=y[i],s.DYTools.arrContain(this.comArr,G)||(this.comArr.push(G),this.comDict[G.attrData.attr]=G)},updateGameLogic:function(t){if(this.entity.stateCom.state==o.EnemyAction.Sleep){var e=this.node.convertToWorldSpaceAR(cc.v2(0,0));switch(a.GValue.EntityWorld.mapMgr.curDirTag){case 1:this.awakeRect.y+this.awakeRect.height>=e.y&&this.entity.awake();break;case 2:this.awakeRect.y<=e.y&&this.entity.awake();break;case 3:this.awakeRect.x<=e.x&&this.entity.awake();break;case 4:this.awakeRect.x+this.awakeRect.width>=e.x&&this.entity.awake()}}for(var i=0,n=this.comArr;i<n.length;i++)n[i].updateGameLogic(t)},hasAttribution:function(t){return s.DYTools.arrContain(this.attr,t)},die:function(){for(var t=0,e=this.comArr;t<e.length;t++)e[t].die()}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonValue:"CommonValue",EnemyAttrDoctorCom:"EnemyAttrDoctorCom",EnemyAttrEnterCom:"EnemyAttrEnterCom",EnemyAttrSplitCom:"EnemyAttrSplitCom",EnemyAttrThronCom:"EnemyAttrThronCom",EnemyAttrTrackCom:"EnemyAttrTrackCom",EnemyAttrVomitCom:"EnemyAttrVomitCom",Tools:"Tools",Types:"Types"}],EnemyAttrDoctorCom:[function(t,e,i){"use strict";cc._RF.push(e,"0e40f/2R8ZJxKQhtV/FxVST","EnemyAttrDoctorCom");var o=t("EnemyAttrBaseCom"),n=t("CommonValue"),s=t("Tools"),a=t("CommonConfig"),c=t("Types"),r=t("PfFrameAnim");cc.Class({extends:o,properties:{},ctor:function(){this.radius=0,this.count=0,this.bloodTime=0,this.freeTime=0,this.blood=0,this.time=0,this.state=0,this.enemyArr=[],this.lightPool=null,this.lightList=[],this.actLightList=[]},init:function(t){this.attrData=t;var e=s.DYTools.stringToNumber(t.param,a.GConfig.SeparatorII);this.radius=e[0],this.count=e[1],this.bloodTime=e[2],this.freeTime=e[3],this.blood=e[4]/100,this.reset(),this.initUI()},reset:function(){this.lightPool&&this.lightPool.clear(),this.lightList=[],this.actLightList=[],this.enemyArr.splice(0),this.setState(0)},rescueOver:function(){this.setState(0)},setState:function(t){this.state=t,this.time=0},updateGameLogic:function(t){switch(this.state){case 0:this.time+=t,this.time>this.freeTime&&this.setState(2);break;case 1:this.time+=t;for(var e=0;e<this.enemyArr.length;e++){var i=(a=this.enemyArr[e]).node.position,o=this.node.position;if(i=i.sub(o),Math.abs(i.x)>this.radius||Math.abs(i.y)>this.radius){a.removeBuff(c.EnemyBuff.Treat),this.enemyArr.splice(e,1);var n=this.lightList[e];s.DYTools.arrRemove(this.actLightList,n),this.lightPool.put(n),this.lightList.splice(e,1),e--}else(a.isDead||a.isFullBlood())&&(a.removeBuff(c.EnemyBuff.Treat),this.enemyArr.splice(e,1),n=this.lightList[e],s.DYTools.arrRemove(this.actLightList,n),this.lightPool.put(n),this.lightList.splice(e,1),e--)}for(this.enemyArr.length<this.count&&this.checkEnemy(),e=0;e<this.enemyArr.length;e++){var a=this.enemyArr[e];if(n=this.lightList[e]){n.position=this.node.position,n.opacity=255;var r=a.node.position.sub(this.node.position),l=cc.misc.radiansToDegrees(r.signAngle(cc.v2(0,1))),h=r.mag();n.angle=l;var d=h/n.height;s.DYTools.arrContain(this.actLightList,n)?(n.scaleY+=.4,n.scaleY>d&&(n.scaleY=d,s.DYTools.arrRemove(this.actLightList,n))):(n.scaleY=d,a.bloodChange(t*this.blood*a.data.blood))}}if(this.time>this.bloodTime){for(var u=0,m=this.enemyArr;u<m.length;u++)(a=m[u]).removeBuff(c.EnemyBuff.Treat);this.enemyArr.splice(0);for(var p=0,f=this.lightList;p<f.length;p++)n=f[p],this.lightPool.put(n);this.actLightList.splice(0),this.lightList.splice(0),this.setState(0)}break;case 2:this.checkEnemy(),this.enemyArr.length>0&&this.setState(1)}},checkEnemy:function(){for(var t=n.GValue.EntityWorld.getRangeEnemysForMap(this.node.position,this.radius),e=0,i=t=n.GValue.EntityWorld.getNeareastEnemysForMap(t,this.node.position,this.count+2);e<i.length;e++){var o=i[e];if(o.node!==this.node&&this.enemyArr.length<this.count&&!s.DYTools.arrContain(this.enemyArr,o)){o.addBuff(c.EnemyBuff.Treat),this.enemyArr.push(o);var a=this.lightPool.get();a.getComponent(r).reset(),a.opacity=0,a.scaleY=0,n.GValue.EntityWorld.addEntitySys.shadowNode.addChild(a),this.lightList.push(a),this.actLightList.push(a)}}},die:function(){for(var t=0,e=this.lightList;t<e.length;t++)e[t].removeFromParent();this.lightPool.clear();for(var i=0,o=this.enemyArr;i<o.length;i++)o[i].removeBuff(c.EnemyBuff.Treat)},initUI:function(){this.lightPool=new cc.NodePool;for(var t=0;t<this.count;t++){var e=cc.instantiate(n.GValue.pf_anim);e.anchorY=0,e.getComponent(r).init(n.GValue.Atlas_Enemy,"ael_9_",2,2*a.GConfig.actionFrameTime,function(){}),this.lightPool.put(e)}}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonValue:"CommonValue",EnemyAttrBaseCom:"EnemyAttrBaseCom",PfFrameAnim:"PfFrameAnim",Tools:"Tools",Types:"Types"}],EnemyAttrEnterCom:[function(t,e,i){"use strict";cc._RF.push(e,"e3432xeHY1OmqGbLwryiMQg","EnemyAttrEnterCom");var o=t("EnemyAttrBaseCom"),n=t("CommonConfig"),s=t("Tools"),a=t("CommonValue");cc.Class({extends:o,properties:{},ctor:function(){this.speed=0,this.startPos=cc.Vec2.ZERO,this.endPos=cc.Vec2.ZERO,this.curDir=cc.Vec2.ZERO,this.moveAble=!0},init:function(t,e){this.enemyEntity=t,this.attrData=e,this.speed=this.enemyEntity.data.moveSpeed;var i=this.attrData.param.split(n.GConfig.SeparatorI);i.length>1?(this.startPos=s.DYTools.stringToPoint(i[0],n.GConfig.SeparatorII),this.endPos=s.DYTools.stringToPoint(i[1],n.GConfig.SeparatorII),this.startPos=cc.v2(this.startPos.x*a.GValue.Size_View.width,this.startPos.y*a.GValue.Size_View.height),this.endPos=cc.v2(this.endPos.x*a.GValue.Size_View.width,this.endPos.y*a.GValue.Size_View.height),this.startPos=this.node.parent.convertToNodeSpaceAR(this.startPos),this.endPos=this.node.parent.convertToNodeSpaceAR(this.endPos)):s.DYTools.error("\u5165\u573a\u5c5e\u6027\u9519\u8bef",this.attrData.param),this.node.position=this.startPos,this.curDir=this.endPos.sub(this.startPos).normalize(),this.enemyEntity.moveCom.setCurDir(this.curDir),this.moveAble=!0;var o=cc.v2(0,-1),c=this.curDir.signAngle(o),r=cc.misc.radiansToDegrees(c);this.node.angle=r},updateGameLogic:function(t){if(this.enemyEntity.moveAble&&this.moveAble){var e=this.speed*this.curDir.x,i=this.speed*this.curDir.y,o=cc.v2(e*t,i*t),n=this.endPos.sub(this.node.position);o.magSqr()<n.magSqr()?this.node.position=this.node.position.add(o):(this.node.position=this.endPos,this.moveAble=!1)}}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonValue:"CommonValue",EnemyAttrBaseCom:"EnemyAttrBaseCom",Tools:"Tools"}],EnemyAttrSplitCom:[function(t,e,i){"use strict";cc._RF.push(e,"033afruUTpCb4Ub3bnsH0XE","EnemyAttrSplitCom");var o=t("EnemyAttrBaseCom"),n=t("ConfigData"),s=t("CommonConfig"),a=t("Tools"),c=t("CommonValue"),r=t("Types");cc.Class({extends:o,properties:{},ctor:function(){this.count=0,this.ratio=0,this.configData=null},init:function(t,e){this.enemyEntity=t,this.attrData=e;var i=a.DYTools.stringToNumber(e.param,s.GConfig.SeparatorII);try{var o=this.enemyEntity.data.cData;this.count=i[0],this.ratio=i[1];var c=i[2];this.configData=new n.ConfigEnemyData,this.configData.size=o.size.mul(c),this.configData.blood=o.blood.mul(this.ratio),this.configData.speed=o.speed,this.configData.hurtSpeed=o.hurtSpeed,this.configData.playerInSpeed=o.playerInSpeed,this.configData.dropGold=Math.floor(o.dropGold*this.ratio),this.configData.attr=[0],this.configData.moveType=o.moveType,this.configData.imageId=4,this.configData.adjustDuration=1==o.moveType?o.adjustDuration:cc.v2(99999,99999)}catch(t){a.DYTools.error("\u5c5e\u6027\u9519\u8bef",t)}},die:function(){var t=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),e=this.enemyEntity.player.node.convertToWorldSpaceAR(cc.Vec2.ZERO),i=t.sub(e).normalize(),o=c.GValue.EntityWorld.addEntitySys.AddEnemy(this.configData,this.count,cc.rect(this.node.position.x,this.node.position.y,0,0));c.GValue.EntityWorld.addEnemys(o);for(var n=function(t){var e=t.node;t.changeGroup("default"),t.actionAble=!1,e.emit("updateState",r.EnemyAction.None);var o=a.DYTools.random_int(-100,100),n=i.mul(a.DYTools.random_int(100,200));n=n.rotate(cc.misc.degreesToRadians(o));var c=s.node.position.add(n),l=e.scale;e.scaleX=.82,e.scaleY=.58;var h=cc.moveTo(.3,c),d=cc.scaleTo(.3,l),u=cc.spawn(h,d);e.runAction(cc.sequence(u,cc.callFunc(function(){t.startGame(),t.actionAble=!0,e.emit("updateState",r.EnemyAction.Action),t.changeGroup("enemy")})))},s=this,l=0,h=o;l<h.length;l++)n(h[l])}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonValue:"CommonValue",ConfigData:"ConfigData",EnemyAttrBaseCom:"EnemyAttrBaseCom",Tools:"Tools",Types:"Types"}],EnemyAttrThronCom:[function(t,e,i){"use strict";cc._RF.push(e,"91e32+TSPFLJaDp+tZFynAo","EnemyAttrThronCom");var o=t("EnemyAttrBaseCom"),n=t("Types"),s=t("Tools"),a=t("CommonConfig"),c=t("CommonValue");cc.Class({extends:o,properties:{},ctor:function(){this.thronShow=!1,this.normalFrame=null,this.thronFrame=null,this.normalShadow=null,this.thronShadow=null,this.thronTime=0,this.thronDuration=0,this.normalTime=0,this.normalDuration=0,this.thronRadius=0,this.normalRadius=0},init:function(t,e){this.enemyEntity=t,this.attrData=e;var i=s.DYTools.stringToNumber(this.attrData.param,a.GConfig.SeparatorII);this.normalDuration=i[0],this.normalRadius=i[2],this.thronDuration=i[1],this.thronRadius=i[3],this.normalFrame=c.GValue.Atlas_Enemy.getSpriteFrame("e_"+t.data.cData.imageId+"_0"),this.thronFrame=c.GValue.Atlas_Enemy.getSpriteFrame("e_"+t.data.cData.imageId+"_1"),this.normalShadow=c.GValue.Atlas_Shadow.getSpriteFrame("se_"+t.data.cData.imageId+"_0"),this.thronShadow=c.GValue.Atlas_Shadow.getSpriteFrame("se_"+t.data.cData.imageId+"_1"),this.setThronShow(!1)},setThronShow:function(t){this.thronShow=t,this.thronShow?this.playShowThronAct():this.playHideThronAct()},updateGameLogic:function(t){this.enemyEntity.stateCom.state==n.EnemyAction.Action&&(this.thronShow?(this.thronTime+=t,this.thronTime>this.thronDuration&&(this.thronTime=0,this.setThronShow(!1))):(this.normalTime+=t,this.normalTime>this.normalDuration&&(this.normalTime=0,this.setThronShow(!0))))},playShowThronAct:function(){var t=this,e=this,i=a.GConfig.actionFrameTime,o=this.enemyEntity.uiNode.position,n=cc.place(o),s=cc.place(o.add(cc.v2(6,-3))),c=cc.repeat(cc.sequence(cc.delayTime(2*i),s,cc.delayTime(2*i),n),8),r=cc.scaleTo(3*i,.75),l=cc.scaleTo(4*i,1.05),h=cc.scaleTo(2*i,.6),d=cc.delayTime(i),u=cc.callFunc(function(){e.enemyEntity.uiCom.refreshSkinSprFrame(t.thronFrame),e.enemyEntity.shadow.getComponent(cc.Sprite).spriteFrame=t.thronShadow,e.enemyEntity.thronShow(!0)}),m=cc.scaleTo(3*i,1.2),p=cc.scaleTo(4*i,1),f=cc.callFunc(function(){e.enemyEntity.setRadius(t.thronRadius)}),_=cc.sequence(c,r,l,h,d,u,m,p,f);this.enemyEntity.uiNode.runAction(_)},playHideThronAct:function(){var t=this,e=this,i=a.GConfig.actionFrameTime,o=cc.scaleTo(4*i,1.2),n=cc.scaleTo(3*i,.7),s=cc.delayTime(i),c=cc.callFunc(function(){e.enemyEntity.uiCom.refreshSkinSprFrame(t.normalFrame),e.enemyEntity.shadow.getComponent(cc.Sprite).spriteFrame=t.normalShadow,e.enemyEntity.thronShow(!1)}),r=cc.scaleTo(2*i,1.05),l=cc.scaleTo(3*i,1),h=cc.callFunc(function(){e.enemyEntity.setRadius(t.normalRadius)}),d=cc.sequence(o,n,s,c,r,l,h);this.enemyEntity.uiNode.runAction(d)}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonValue:"CommonValue",EnemyAttrBaseCom:"EnemyAttrBaseCom",Tools:"Tools",Types:"Types"}],EnemyAttrTrackCom:[function(t,e,i){"use strict";cc._RF.push(e,"b3953GW4DlAXYdAuF6YFa44","EnemyAttrTrackCom");var o=t("EnemyAttrBaseCom"),n=t("Tools"),s=t("CommonConfig"),a=t("CommonValue");cc.Class({extends:o,properties:{},ctor:function(){this.speed=0,this.trackArr=[],this.moveStart=!1,this.moveAble=!1,this.startVec2=cc.Vec2.ZERO,this.endVec2=cc.Vec2.ZERO,this.startIndex=0,this.endIndex=0,this.curDir=cc.Vec2.ZERO,this.curRotation=0,this.lastPosition=cc.Vec2.ZERO},init:function(t,e){this.enemyEntity=t,this.attrData=e,this.trackArr.splice(0),this.moveStart=!1,this.moveAble=!1,this.speed=this.enemyEntity.data.moveSpeed;for(var i=this.attrData.param.split(s.GConfig.SeparatorI),o=0;o<i.length;o++){var c=n.DYTools.stringToPoint(i[o],s.GConfig.SeparatorII);c=cc.v2(c.x*a.GValue.Size_View.width,c.y*a.GValue.Size_View.height),this.trackArr.push(this.node.parent.convertToNodeSpaceAR(c))}this.trackArr.length<2&&n.DYTools.error("\u8f68\u8ff9\u79fb\u52a8\u70b9\u7f3a\u5c11",JSON.stringify(this.trackArr))},updateGameLogic:function(t){if(this.enemyEntity.moveAble)if(this.moveStart){if(this.moveAble){if(this.trackArr.length<2)return;this.node.angle=this.curRotation;var e=this.speed*this.curDir.x,i=this.speed*this.curDir.y,o=cc.v2(e*t,i*t),s=this.node.position.add(o),a=!1;this.curDir.x>0?s.x>=this.endVec2.x&&(a=!0):this.curDir.x<0&&s.x<=this.endVec2.x&&(a=!0),this.curDir.y>0?s.y>=this.endVec2.y&&(a=!0):this.curDir.y<0&&s.y<=this.endVec2.y&&(a=!0),a?(this.node.position=this.endVec2,this.endIndex++,this.startIndex++,this.startIndex>=this.trackArr.length&&(this.startIndex=0),this.endIndex>=this.trackArr.length&&(this.endIndex=0),this.refreshDir()):this.node.position=this.node.position.add(o)}}else n.DYTools.isVec2DiffRange(this.node.position,this.trackArr[0],5)?(this.moveStart=!0,this.moveAble=!0,this.node.position=this.trackArr[0],this.startIndex=0,this.endIndex=1,this.refreshDir()):(n.DYTools.isVec2DiffRange(this.node.position,this.lastPosition,1)&&(this.moveStart=!0,this.moveAble=!0,this.node.position=this.trackArr[0],this.startIndex=0,this.endIndex=1,this.refreshDir()),this.lastPosition=this.node.position)},refreshDir:function(){if(!(this.trackArr.length<2)){this.startVec2=this.trackArr[this.startIndex],this.endVec2=this.trackArr[this.endIndex],this.curDir=this.endVec2.sub(this.startVec2).normalize(),this.enemyEntity.moveCom.setCurDir(this.curDir);var t=cc.v2(0,-1),e=this.curDir.signAngle(t);this.curRotation=cc.misc.radiansToDegrees(e),this.node.angle=this.curRotation}}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonValue:"CommonValue",EnemyAttrBaseCom:"EnemyAttrBaseCom",Tools:"Tools"}],EnemyAttrVomitCom:[function(t,e,i){"use strict";cc._RF.push(e,"e7d4aqdEYlHXqLmypR3DjQ5","EnemyAttrVomitCom");var o=t("EnemyAttrBaseCom"),n=t("ConfigData"),s=t("Tools"),a=t("CommonConfig"),c=t("CommonValue"),r=t("Types"),h=t("EnemyAttrTrackCom");cc.Class({extends:o,properties:{},ctor:function(){this.count=0,this.time=0,this.duration=0,this.state=0,this.configData=null,this.endCall=null,this.vomitTime=0,this.vomitDuration=.25,this.vomitCount=0,this.shadowNormal=null,this.shadowVomit=null},init:function(t,e,i){this.enemyEntity=t,this.attrData=e,this.attrMgr=i;var o=s.DYTools.stringToNumber(e.param,a.GConfig.SeparatorII);try{var l=this.enemyEntity.data.cData;this.count=o[0],this.duration=o[1];var h=o[2],d=o[3],u=o[4];this.configData=new n.ConfigEnemyData,this.configData.size=l.size.mul(d),this.configData.blood=l.blood.mul(h),this.configData.speed=cc.v2(u,u),this.configData.hurtSpeed=l.hurtSpeed,this.configData.playerInSpeed=l.playerInSpeed,this.configData.dropGold=0,this.configData.attr=[100],this.configData.moveType=r.EnemyMoveType.Elastic,this.configData.imageId=6,this.configData.adjustDuration=cc.v2(999990,999990)}catch(t){s.DYTools.error("\u5c5e\u6027\u9519\u8bef",t)}this.shadowNormal=c.GValue.Atlas_Shadow.getSpriteFrame("se_5_1"),this.shadowVomit=c.GValue.Atlas_Shadow.getSpriteFrame("se_5_2"),this.enemyEntity.shadow.getComponent(cc.Sprite).spriteFrame=this.shadowNormal},updateGameLogic:function(t){if(0==this.state){if(this.time+=t,this.time>this.duration){this.enemyEntity.moveAble=!1,this.time=0;var e=this.node.getComponent(h);e&&(e.moveAble=!1),this.state=1;var i=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),o=this.enemyEntity.player.node.convertToWorldSpaceAR(cc.Vec2.ZERO);this.node.angle=cc.misc.radiansToDegrees(o.sub(i).signAngle(cc.v2(0,-1))),this.playXuliAnim()}}else 2==this.state&&(this.vomitTime+=t,this.vomitTime>=this.vomitDuration&&this.vomitCount<this.count&&(this.vomitTime=0,this.vomitEnemys(),this.vomitCount++,this.vomitCount>=this.count&&this.endCall&&this.endCall()))},playXuliAnim:function(){var t=this,e=a.GConfig.actionFrameTime,i=this.node.getChildByName("ui"),o=i.getChildByName("mouth"),n=o.getChildByName("light"),s=i.getChildByName("line"),r=i.getChildByName("skel"),h=r.getComponent(sp.Skeleton);h&&(r.opacity=255,h.setAnimation(0,"vomit",!1));var d=i.getChildByName("eye");d.opacity=255,d.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(6*e,128),cc.fadeTo(6*e,255))));var u=cc.moveBy(2*e,cc.v2(-8,-8)),m=cc.moveBy(2*e,cc.v2(8,8)),p=cc.sequence(u,m),f=cc.repeat(p,4);i.runAction(cc.sequence(f,cc.callFunc(function(){i.stopAllActions();var a=i.getChildByName("mandible"),r=a.getComponent(cc.Sprite),h=cc.scaleTo(4*e,1.25,.8),u=cc.scaleTo(2*e,1,1.5),m=cc.callFunc(function(){r.spriteFrame=c.GValue.Atlas_Enemy.getSpriteFrame("e_5_2"),t.enemyEntity.shadow.getComponent(cc.Sprite).spriteFrame=t.shadowVomit,o.scale=1,o.opacity=255,s.runAction(cc.fadeOut(12*e))}),p=cc.scaleTo(7*e,1,1);i.runAction(cc.sequence(h,u,m,cc.callFunc(function(){a.stopAllActions();var i=cc.scaleTo(2*e,1,1.15),s=cc.scaleTo(3*e,1,1),h=cc.scaleTo(5*e,1,1.08),u=cc.scaleTo(7*e,1,1);a.runAction(cc.repeatForever(cc.sequence(i,s,h,u))),n.scale=1.1;var m=cc.scaleTo(5*e,1),p=cc.fadeTo(5*e,102),f=cc.spawn(m,p),_=cc.scaleTo(5*e,1.1),y=cc.fadeTo(5*e,204),g=cc.spawn(_,y);n.runAction(cc.repeatForever(cc.sequence(f,g))),t.state=2,t.vomitCount=0,t.vomitTime=0,t.endCall=function(){a.stopAllActions();var i=cc.scaleTo(3*e,1,.4),s=cc.callFunc(function(){a.scale=1,r.spriteFrame=c.GValue.Atlas_Enemy.getSpriteFrame("e_5_1"),t.enemyEntity.shadow.getComponent(cc.Sprite).spriteFrame=t.shadowNormal}),h=cc.sequence(i,s,cc.delayTime(.2),cc.callFunc(function(){t.state=0,t.enemyEntity.moveAble=!0,n.stopAllActions();var e=t.node.getComponent(l.default);e&&(e.moveAble=!0)}));a.runAction(h),o.runAction(cc.sequence(i.clone(),cc.fadeOut(0))),d.stopAllActions(),d.opacity=0}}),p))}))),s.runAction(cc.fadeIn(4*e))},vomitEnemys:function(){a.GConfig.actionFrameTime;var t=c.GValue.EntityWorld.addEntitySys.AddEnemy(this.configData,1,cc.rect(this.node.position.x,this.node.position.y,0,0));c.GValue.EntityWorld.addEnemys(t);for(var e=cc.v2(0,-1).rotate(cc.misc.degreesToRadians(-this.node.angle)),i=this.node.position.add(e.mul(30)),o=function(o){var a=t[o],c=a.node;c.position=i.add(s.DYTools.getRandomVec2(cc.v2(-10,10),cc.v2(-10,10))),c.opacity=0,c.zIndex=2,a.actionAble=!1,a.changeGroup("default"),c.emit("updateState",r.EnemyAction.None),a.setCurDir(e),n.scheduleOnce(function(){c.opacity=255}),a.startGame(),a.setCurDir(e),a.actionAble=!0,c.emit("updateState",r.EnemyAction.Action),a.changeGroup("enemy")},n=this,l=0;l<t.length;l++)o(l)}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonValue:"CommonValue",ConfigData:"ConfigData",EnemyAttrBaseCom:"EnemyAttrBaseCom",EnemyAttrTrackCom:"EnemyAttrTrackCom",Tools:"Tools",Types:"Types"}],EnemyBaseComponent:[function(t,e,i){"use strict";cc._RF.push(e,"cebd78+sVxCr7xXywebUU97","EnemyBaseComponent"),cc.Class({extends:cc.Component,properties:{},ctor:function(){},preLoad:function(){}}),cc._RF.pop()},{}],EnemyBase:[function(t,e,i){"use strict";cc._RF.push(e,"eb1d5aBkBRAmrBJg9D5I7Vs","EnemyBase");var o=t("CEntityBase"),n=t("Types");cc.Class({extends:o,properties:{},ctor:function(){this.type=n.EnemyType.Normal,Object.defineProperty(this,"isSnake",{get:function(){return this.type===n.EnemyType.Snake},enumerable:!0,configurable:!0}),Object.defineProperty(this,"isCircle",{get:function(){return this.type===n.EnemyType.Circle},enumerable:!0,configurable:!0}),Object.defineProperty(this,"isFire",{get:function(){return this.type===n.EnemyType.Fire},enumerable:!0,configurable:!0})},isFullBlood:function(){return!1}}),cc._RF.pop()},{CEntityBase:"CEntityBase",Types:"Types"}],EnemyBuffComponent:[function(t,e,i){"use strict";cc._RF.push(e,"2db2dus7VdMRZWlgtK2OUJ1","EnemyBuffComponent");var o=t("Tools"),n=t("Types"),s=t("CommonConfig"),a=t("GameData");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.entity=null,this.isSlowDown=!1,this.slowDownTime=0,this.slowDownDuration=.2,this.isFrozen=!1,this.frozenTime=0,this.frozenDuration=0,this.isFiring=!1,this.firingTime=0,this.firingDuration=2,this.firingHurt=2,this.firingHurtTime=0,this.firingHurtDuration=.1,this.treatCount=0,this.frozenAnim=null,this.isDirty=!1},init:function(t){this.entity=t,this.reset();var e=s.GConfig.getPropertyData_Sub(a.TData.getCurSubFun());if(e){try{var i=e.var;this.frozenDuration=o.DYTools.stringToNumber(i,s.GConfig.SeparatorII)[0],this.firingDuration=o.DYTools.stringToNumber(i,s.GConfig.SeparatorII)[0]}catch(t){o.DYTools.error("\u526f\u6b66\u5668\u53c2\u6570\u9519\u8bef",t),this.frozenDuration=2,this.firingDuration=2}if(e.fun==n.DWType.Fire)try{i=e.var,this.firingHurt=o.DYTools.stringToNumber(i,s.GConfig.SeparatorII)[1]*this.firingHurtDuration}catch(t){o.DYTools.error("\u706b\u6b66\u5668\u53c2\u6570\u9519\u8bef",t),this.firingHurt=2}}},reset:function(){this.isSlowDown=!1,this.slowDownTime=-1,this.isFrozen=!1,this.frozenTime=-1,this.isFiring=!1,this.firingTime=-1,this.treatCount=0,this.isDirty=!0},updateGameLogic:function(t){this.slowDownTime>=0&&(this.slowDownTime+=t,this.slowDownTime>=this.slowDownDuration&&this.removeBuff(n.EnemyBuff.SlowDown)),this.frozenTime>=0&&(this.frozenTime+=t,this.frozenTime>=this.frozenDuration&&this.removeBuff(n.EnemyBuff.Frozen)),this.firingTime>=0&&(this.firingTime+=t,this.firingHurtTime+=t,this.firingHurtTime>this.firingHurtDuration&&(this.firingHurtTime=0,this.entity&&this.entity.bloodChange(-this.firingHurt)),this.firingTime>=this.firingDuration&&this.removeBuff(n.EnemyBuff.Firing))},addBuff:function(t){switch(t){case n.EnemyBuff.SlowDown:this.isSlowDown||(this.isSlowDown=!0,this.isDirty=!0),this.slowDownTime=0;break;case n.EnemyBuff.Frozen:this.isFrozen||(this.isFrozen=!0,this.isDirty=!0),this.frozenTime=0;break;case n.EnemyBuff.Firing:this.isFiring||(this.firingHurtTime=0,this.isFiring=!0,this.isDirty=!0),this.firingTime=0;break;case n.EnemyBuff.Treat:this.treatCount++,this.isDirty=!0}},removeBuff:function(t){switch(t){case n.EnemyBuff.SlowDown:this.isSlowDown&&(this.isSlowDown=!1,this.slowDownTime=-1,this.isDirty=!0);break;case n.EnemyBuff.Frozen:this.isFrozen&&(this.isFrozen=!1,this.frozenTime=-1,this.isDirty=!0);break;case n.EnemyBuff.Firing:this.isFiring&&(this.isFiring=!1,this.firingTime=-1,this.isDirty=!0);break;case n.EnemyBuff.Treat:this.treatCount--,this.isDirty=!0}},hasBuff:function(t){switch(t){case n.EnemyBuff.SlowDown:return this.isSlowDown;case n.EnemyBuff.Frozen:return this.isFrozen;case n.EnemyBuff.Firing:return this.isFiring;case n.EnemyBuff.Treat:return this.treatCount>0}return!1}}),cc._RF.pop()},{CommonConfig:"CommonConfig",GameData:"GameData",Tools:"Tools",Types:"Types"}],EnemyCollisionBlockListener:[function(t,e,i){"use strict";cc._RF.push(e,"ebb5eN+fX1I/KPc+6WbuJwZ","EnemyCollisionBlockListener"),cc.Class({extends:cc.Component,properties:{},onCollisionExit:function(t,e){10==t.node.groupIndex&&this.noticeBlockLeave(t)},onCollisionEnter:function(t,e){10==t.node.groupIndex&&this.noticeBlockCollision(t)},noticeBlockCollision:function(t){this.node.parent.emit("blockCollision",t)},noticeBlockLeave:function(t){this.node.parent.emit("blockLeave",t)}}),cc._RF.pop()},{}],EnemyCollisionWallListener:[function(t,e,i){"use strict";cc._RF.push(e,"b78dbE/KJ5Kj6f2O5Zk4z/f","EnemyCollisionWallListener"),cc.Class({extends:cc.Component,properties:{},onCollisionExit:function(t,e){4==t.node.groupIndex&&this.noticeWallLeave(t)},onCollisionEnter:function(t,e){4==t.node.groupIndex&&this.noticeWallCollision(t)},noticeWallCollision:function(t){this.node.parent.emit("wallCollision",t)},noticeWallLeave:function(t){this.node.parent.emit("wallLeave",t)}}),cc._RF.pop()},{}],EnemyDropComponent:[function(t,e,i){"use strict";cc._RF.push(e,"88228/4UKxA6pBu/TgmC6A1","EnemyDropComponent");var o=t("Tools"),n=t("CommonValue"),s=t("CommonConfig"),a=t("Types");cc.Class({extends:cc.Component,properties:{},ctor:function(){this._data=null,this._player=null},init:function(t,e){this._data=t,this._player=e},die:function(){for(var t=this._data.cData.dropKParam.split(s.GConfig.SeparatorI),e=0;e<t.length;e++){var i=o.DYTools.stringToNumber(t[e],s.GConfig.SeparatorII);switch(i[0]){case a.DropType.Weapon:if(o.DYTools.getEnemyDropAble()&&(u=i[2])>o.DYTools.random_int(0,99)){for(var c=this._player.node.position.sub(n.GValue.EntityWorld.mapMgr.mapTop.position),r=this.node.position.sub(c),l=0,h=n.GValue.EntityWorld.addEntitySys.addDropKnife(1,this.node.position,r);l<h.length;l++){var d=h[l];d.changeSkin(this._player.knifeImage),n.GValue.EntityWorld.addKnife(d)}n.GValue.EntityWorld.enemyDropNumber+=1}break;case a.DropType.Prop:var u=i[2];if(o.DYTools.random_int(0,99)<u){var m=n.GValue.EntityWorld.addProp(i[1]);m.node.position=this.node.position.add(n.GValue.EntityWorld.mapMgr.mapTop.position),m.node.opacity=255,n.GValue.EntityWorld.enemyDropPropNumber+=1}}}}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonValue:"CommonValue",Tools:"Tools",Types:"Types"}],EnemyMoveBaseComponent:[function(t,e,i){"use strict";cc._RF.push(e,"411aa3RdH5M+r1AF5qxLrw5","EnemyMoveBaseComponent");var o=t("Types"),n=t("GameData"),s=t("CommonValue"),a=t("Tools"),c=t("CommonConfig"),r=t("CommonFunc");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.actState=o.EnemyAction.None,this.moveType=o.EnemyMoveType.Follow,this.initMoveSpeed=100,this.curMoveSpeed=0,this.speedSlowParam=.8,this.playerInSpeed=1,this.rotateTime=0,this.adjustDuration=0,this.curDir=cc.Vec2.ZERO,this.posDelta=cc.Vec2.ZERO,this.curSpeedRatio=1,this.hurtType=-1,this.firstInScreen=!1,this.canChangeDir=!0,this.randomDirTime=0},init:function(t,e,i){if(this.player=t,this.enemy=e,this.initMoveSpeed=i.moveSpeed,this.curMoveSpeed=this.initMoveSpeed,this.adjustDuration=i.adjustDuration,this.rotateTime=1e5,this.moveType=i.cData.moveType,this.curDir=cc.Vec2.ZERO,this.posDelta=cc.Vec2.ZERO,this.curSpeedRatio=1,this.hurtType=-1,this.speedSlowParam=i.cData.hurtSpeed,this.playerInSpeed=i.cData.playerInSpeed,this.firstInScreen=!1,this.canChangeDir=!0,this.checkInitDir()){this.canChangeDir=!1;var n=this.enemy.getAttrParam(o.EnemyAttr.RanDir);n&&n.param||a.DYTools.error("1111");var s=a.DYTools.stringToNumber(n.param,c.GConfig.SeparatorII);this.randomDirTime=a.DYTools.random_int(100*s[0],100*s[1])/100}this.node.on("changeDir",this.setCurDir,this)},updateGameLogic:function(t){if(this.randomDirTime>0&&(this.randomDirTime-=t,this.randomDirTime<=0&&(this.canChangeDir=!0)),this.enemy.hasBuff(o.EnemyBuff.Frozen))try{this.curMoveSpeed=this.initMoveSpeed*this.enemy.player.dwParam[1]}catch(t){this.curMoveSpeed=this.initMoveSpeed}else if(this.enemy.hasBuff(o.EnemyBuff.SlowDown))this.curMoveSpeed=this.initMoveSpeed*this.speedSlowParam;else{var e=this.player.getPositionForMap(),i=this.node.position.sub(e),n=this.player.radius;Math.abs(i.x)<n&&Math.abs(i.y)<n&&i.magSqr()<n*n?this.curMoveSpeed=this.initMoveSpeed*this.playerInSpeed:this.curMoveSpeed=this.initMoveSpeed}},checkInitDir:function(){return!!this.enemy.hasAttribution(o.EnemyAttr.RanDir)&&(this.setCurDir(r.GFunc.getEnemyRandomDir(this.node)),!0)},adjustDirToPlayer:function(){var t=this.player.getPositionForMap().sub(this.node.position);this.setCurDir(t.normalize())},setCurDir:function(t){this.curDir=t,this.setRotate(this.curDir)},setRotate:function(t){var e=cc.v2(0,-1),i=t.signAngle(e),o=cc.misc.radiansToDegrees(i);this.node.angle=o},updatePosition:function(t){s.GValue.PropMgr.hasProp(o.PropType.Slow)&&(t*=s.GValue.SlowRatio);var e=this.curDir,i=this.curMoveSpeed*e.x,n=this.curMoveSpeed*e.y;switch(this.moveType){case o.EnemyMoveType.Follow:case o.EnemyMoveType.Elastic:case o.EnemyMoveType.SpeedUp:this.posDelta=cc.v2(i*t,n*t)}var a=this.checkHurtDelta();this.posDelta=this.posDelta.add(a),this.node.position=this.node.position.add(this.posDelta),this.hurtType=-1,this.posDelta=cc.v2(0,0)},checkHurtDelta:function(){var t=cc.Vec2.ZERO;if(s.GValue.PlayerTouching&&!this.enemy.isBoss&&0!=this.moveType)switch(this.hurtType){case o.EnemyHurtState.Normal:t=this.node.position.sub(this.player.getPositionForMap()).normalize().rotate(-cc.misc.degreesToRadians(90+n.TData.EnemyOffsetDegree)).mul(n.TData.EnemyOffset);break;case o.EnemyHurtState.Knife:case o.EnemyHurtState.Laser:case o.EnemyHurtState.Frozen:case o.EnemyHurtState.Fire:t=this.node.position.sub(this.player.getPositionForMap()).normalize().rotate(cc.misc.degreesToRadians(90+n.TData.EnemyOffsetDegree)).mul(n.TData.EnemyOffset)}return t},hurt:function(t){switch(this.hurtType=t,t){case o.EnemyHurtState.Normal:case o.EnemyHurtState.Knife:case o.EnemyHurtState.Laser:case o.EnemyHurtState.Ele:this.enemy.buffCom.addBuff(o.EnemyBuff.SlowDown);break;case o.EnemyHurtState.Frozen:this.enemy.buffCom.addBuff(o.EnemyBuff.Frozen);break;case o.EnemyHurtState.Fire:this.enemy.buffCom.addBuff(o.EnemyBuff.Firing)}}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonFunc:"CommonFunc",CommonValue:"CommonValue",GameData:"GameData",Tools:"Tools",Types:"Types"}],EnemyMoveFix:[function(t,e,i){"use strict";cc._RF.push(e,"d45ddCbLd9LepNMKYljTzNp","EnemyMoveFix");var o=t("Tools"),n=t("CommonValue"),s=t("Types");cc.Class({extends:cc.Component,properties:{},ctor:function(){this._entity=null,this._moveType=0,this._collider=null,this._actionCom=null,this._moveCom=null,this._stateCom=null,this._radius=0,this._offset=6,this._hasCollision=!1,this.collisionWalls=[],this.collisionBlocks=[],this.colWallAble=!1,this._minX=null,this._maxX=null,this._minY=null,this._maxY=null,this.colingWalls=[],this._minViewX=0,this._maxViewX=0,this._minViewY=0,this._maxViewY=0,this._screenOutRect=null,this._dxDirty=!1,this._dyDirty=!1,this.curDir=cc.Vec2.ZERO,this.initialCol=!1,this.changeDirTimes=0,this.colTotalCount=0},init:function(t){this._entity=t,this._entity&&(this._collider=this._entity.colliderNode.getComponent(cc.CircleCollider),this._actionCom=this._entity.node.getComponent("EnemyActionMoveComponent"),this._moveCom=this._entity.moveCom,this._stateCom=this._entity.stateCom),this.initProperty()},initByMoveType:function(t,e){this._moveCom=null,this._moveType=t,this._collider=e.getComponent(cc.CircleCollider),this._actionCom=e.getComponent("EnemyActionMoveComponent"),this._stateCom=e.getComponent("EnemyStateComponent"),this.initProperty()},initProperty:function(){if(this.colWallAble=!1,this._hasCollision=!1,this._dxDirty=!1,this._dyDirty=!1,this.initialCol=!0,this.changeDirTimes=0,this.collisionWalls.splice(0),this.collisionBlocks.splice(0),this.colingWalls.splice(0),this.resetRadius(),this._entity&&this._entity.hasAttribution(s.EnemyAttr.bulScreen)){var t=this._entity.getAttrParam(s.EnemyAttr.bulScreen);this.colTotalCount=parseInt(t.param)}this.node.on("wallCollision",this.collisionWall,this),this.node.on("wallLeave",this.leaveWall,this),this.node.on("blockCollision",this.collisionBlock,this),this.node.on("blockLeave",this.leaveBlock,this)},resetRadius:function(){this._radius=this._collider.radius*this.node.scale,this._minViewX=this._radius,this._maxViewX=n.GValue.Size_View.width-this._radius,this._minViewY=this._radius,this._maxViewY=n.GValue.Size_View.height-this._radius,this._screenOutRect=cc.rect(-this._radius,-this._radius,n.GValue.Size_View.width+2*this._radius,n.GValue.Size_View.height+2*this._radius)},updateGameLogic:function(t){if(this._collider){this._moveCom&&(this.curDir=this._moveCom.curDir);var e=this._moveType;switch(this._entity&&(e=this._entity.data.cData.moveType),e){case s.EnemyMoveType.Follow:this.fixPositionByBlock();break;case s.EnemyMoveType.Elastic:if(!this._moveCom.firstInScreen)return void(this.initialCol&&this.collisionWalls.length>0&&(this.initialCol=!1));if(0==this.collisionWalls.length&&(this.initialCol=!0),this._stateCom.state==s.EnemyAction.Action)if(this._entity&&this._entity.hasAttribution(s.EnemyAttr.bulScreen)&&this.isCollideWallTimesEnd()){if(this.node){var i=!1,a=this.node.position.add(n.GValue.EntityWorld.mapMgr.mapTop.position).mul(n.GValue.MapScale);this._screenOutRect.contains(a)||(i=!0),i&&this._entity.removeSelf()}}else{var c=!1;if(this.initialCol&&(c=this.fixPositionByWall()),c||this.fixPositionByScreen(),(this._dxDirty||this._dyDirty)&&this.changeDirTimes++,this._hasCollision||!this._dxDirty&&!this._dyDirty)this._dxDirty&&(this.curDir=cc.v2(-this.curDir.x,this.curDir.y),this._moveCom.setCurDir(this.curDir),this._dxDirty=!1),this._dyDirty&&(this.curDir=cc.v2(this.curDir.x,-this.curDir.y),this._moveCom.setCurDir(this.curDir),this._dyDirty=!1);else{this._hasCollision=!0;var r=o.DYTools.random_int(52,105)/100,l=cc.v2(0,-1).rotate(r),h=this.curDir;this._dyDirty&&this._dxDirty?(l.x=h.x<0?l.x:-l.x,l.y=h.y<0?-l.y:l.y):this._dxDirty?(l.x=h.x<0?l.x:-l.x,l.y=h.y<0?l.y:-l.y):this._dyDirty&&(l.x=h.x<0?-l.x:l.x,l.y=h.y<0?-l.y:l.y),this.node.emit("changeDir",l),this._dxDirty=!1,this._dyDirty=!1}}break;case s.EnemyMoveType.SpeedUp:}}},isCollideWallTimesEnd:function(){return this.changeDirTimes>=this.colTotalCount},fixPositionByScreen:function(){var t=this.node.position.add(n.GValue.EntityWorld.mapMgr.mapTop.position).mul(n.GValue.MapScale);t.x<this._minViewX?(this.node.x=this.node.parent.convertToNodeSpaceAR(cc.v2(this._minViewX,0)).x,this.curDir.x<0&&(this._dxDirty=!0)):t.x>this._maxViewX&&(this.node.x=this.node.parent.convertToNodeSpaceAR(cc.v2(this._maxViewX,0)).x,this.curDir.x>0&&(this._dxDirty=!0)),t.y<this._minViewY?(this.node.y=this.node.parent.convertToNodeSpaceAR(cc.v2(0,this._minViewY)).y,this.curDir.y<0&&(this._dyDirty=!0)):t.y>this._maxViewY&&(this.node.y=this.node.parent.convertToNodeSpaceAR(cc.v2(0,this._maxViewY)).y,this.curDir.y>0&&(this._dyDirty=!0))},fixPositionByWall:function(){if(0==this.collisionWalls.length&&0==this.collisionBlocks.length)return!1;for(var t=0;t<this.collisionWalls.length;t++){var e=this.collisionWalls[t],i=(this._collider,e.node.parent),n=this.node.parent,s=i.position;switch(e.tag){case 0:var a=e.size.height;this._maxY=s.y-e.offset.y-.5*a-this._radius,this.node.y>this._maxY&&(this.node.y=this._maxY,this._dyDirty=!0);break;case 1:a=e.size.height,this._minY=s.y+e.offset.y+.5*a+this._radius,this.node.y<this._minY&&(this.node.y=this._minY,this._dyDirty=!0);break;case 2:a=e.size.height,this._minX=s.x+e.offset.y+.5*a+this._radius,this.node.x<this._minX&&(this.node.x=this._minX,this._dxDirty=!0);break;case 3:a=e.size.height,this._maxX=s.x-e.offset.y-.5*a-this._radius,this.node.x>this._maxX&&(this.node.x=this._maxX,this._dxDirty=!0);break;case 4:if(s=s.add(e.node.position),(d=(h=this.node.position.sub(s)).mag())<(u=this._radius+e.radius)){var c=h.x/d,r=h.y/d,l=s.add(cc.v2(u*c,u*r));this.node.position=l,this._dyDirty=!0,this._dxDirty=!0}break;case 5:s.addSelf(e.node.position),(d=(h=this.node.position.sub(s)).mag())<(u=this._radius+e.radius)&&(c=h.x/d,r=h.y/d,l=s.add(cc.v2(u*c,u*r)),this.node.position=l,this._dyDirty=!0,this._dxDirty=!0);break;case 6:var h,d;s=e.node.convertToWorldSpaceAR(cc.v2(0,0)),s=n.convertToNodeSpaceAR(s),(d=(h=this.node.position.sub(s)).mag())<(u=this._radius+.5*e.size.width)&&(c=h.x/d,r=h.y/d,l=s.add(cc.v2(u*c,u*r)),this.node.position=l,this._dyDirty=!0,this._dxDirty=!0)}}for(t=0;t<this.collisionBlocks.length;t++)switch(s=(i=(e=this.collisionBlocks[t]).node.parent).position,e.tag){case 101:if(o.DYTools.arrContain(this.colingWalls,e))break;this.colingWalls.push(e);var u=e.size.width,m=e.size.height,p=Math.abs(i.angle);(p>80&&p<100||p>260&&p<280)&&(u=e.size.height,m=e.size.width),s.addSelf(e.node.position),o.DYTools.isNumberDiffRange(this.node.y,s.y,m/2)?this.curDir.x>0?this.node.x<s.x&&(this._dxDirty=!0):this.node.x>s.x&&(this._dxDirty=!0):o.DYTools.isNumberDiffRange(this.node.x,s.x,u/2)?this.curDir.y>0?this.node.y<s.y&&(this._dyDirty=!0):this.node.y>s.y&&(this._dyDirty=!0):this.node.x>s.x&&this.node.y>s.y?this.curDir.x<0&&this.curDir.y<0?(this._dyDirty=!0,this._dxDirty=!0):this.curDir.x<0?this._dxDirty=!0:this.curDir.y<0&&(this._dyDirty=!0):this.node.x>s.x&&this.node.y<s.y?this.curDir.x<0&&this.curDir.y>0?(this._dyDirty=!0,this._dxDirty=!0):this.curDir.x<0?this._dxDirty=!0:this.curDir.y>0&&(this._dyDirty=!0):this.node.x<s.x&&this.node.y<s.y?this.curDir.x>0&&this.curDir.y>0?(this._dyDirty=!0,this._dxDirty=!0):this.curDir.x>0?this._dxDirty=!0:this.curDir.y>0&&(this._dyDirty=!0):this.curDir.x>0&&this.curDir.y<0?(this._dyDirty=!0,this._dxDirty=!0):this.curDir.x>0?this._dxDirty=!0:this.curDir.y<0&&(this._dyDirty=!0)}return!0},fixPositionByBlock:function(){if(0==this.collisionBlocks.length)return!1;for(var t=0;t<this.collisionBlocks.length;t++){var e=this.collisionBlocks[t],i=e.node.parent,n=i.position;switch(e.tag){case 101:o.DYTools.arrContain(this.colingWalls,e)?this._moveCom.adjustDir():this.colingWalls.push(e);var s=e.size.width,a=e.size.height,c=Math.abs(i.angle);(c>80&&c<100||c>260&&c<280)&&(s=e.size.height,a=e.size.width),n.addSelf(e.node.position);var r=n.x-s/2-this._radius+this._offset,l=n.x+s/2+this._radius-this._offset,h=n.y-a/2-this._radius+this._offset,d=n.y+a/2+this._radius-this._offset;if(o.DYTools.isNumberDiffRange(this.node.x,n.x,s/2-.5*a))this.node.y<n.y-a/2?this.node.y>h&&(this.node.y=h):this.node.y>n.y+a/2?this.node.y<d&&(this.node.y=d):this.node.x<n.x?this.node.x>r&&(this.node.x=r):this.node.x<l&&(this.node.x=l);else{var u=this.node.position.sub(n),m=cc.Vec2.ZERO,p=0;if(s>a?o.DYTools.isNumberDiffRange(this.node.x,n.x,s/2-.5*a)?this.node.y<n.y-a/2?this.node.y>h&&(this.node.y=h):this.node.y>n.y+a/2?this.node.y<d&&(this.node.y=d):this.node.x<n.x?this.node.x>r&&(this.node.x=r):this.node.x<l&&(this.node.x=l):(p=a/2,u.x<0?m=n.add(cc.v2(.5*-s+.5*a,0)):u.x>0&&(m=n.add(cc.v2(.5*s-.5*a,0)))):o.DYTools.isNumberDiffRange(this.node.y,n.y,a/2-.5*s)?this.node.x<n.x-s/2?this.node.x>r&&(this.node.x=r):this.node.x>n.x+s/2?this.node.x<l&&(this.node.x=l):this.node.y<n.y?this.node.y>h&&(this.node.y=h):this.node.y<d&&(this.node.y=d):(p=s/2,u.y<0?m=n.add(cc.v2(0,.5*-a+.5*s)):u.y>0&&(m=n.add(cc.v2(0,.5*a-.5*s)))),p>0){var f=this.node.position.sub(m),_=f.mag(),y=this._radius+p-this._offset;if(_<y){var g=f.x/_,v=f.y/_,C=m.add(cc.v2(y*g,y*v));this.node.position=C}}}}}},collisionWall:function(t){o.DYTools.arrContains(this.collisionWalls,t)||this.collisionWalls.push(t)},leaveWall:function(t){o.DYTools.arrRemove(this.collisionWalls,t),o.DYTools.arrRemove(this.colingWalls,t)},collisionBlock:function(t){o.DYTools.arrContains(this.collisionBlocks,t)||this.collisionBlocks.push(t)},leaveBlock:function(t){o.DYTools.arrRemove(this.collisionBlocks,t),o.DYTools.arrRemove(this.colingWalls,t)}}),cc._RF.pop()},{CommonValue:"CommonValue",Tools:"Tools",Types:"Types"}],EnemySpeedUpMoveComponent:[function(t,e,i){"use strict";cc._RF.push(e,"d289eNVq2ZG05YmefwXRT3d","EnemySpeedUpMoveComponent");var o=t("EnemyMoveBaseComponent");cc.Class({extends:o,properties:{},ctor:function(){this.acceleration=10,this.moveState=0,this.maxSpeed=200,this.destPos=cc.Vec2.ZERO,this.destDis=0},updateGameLogic:function(t){switch(this.moveState){case 0:this.updateMoveState(1);break;case 1:break;case 2:this.curMoveSpeed+=this.acceleration,this.curMoveSpeed>=this.maxSpeed&&(this.curMoveSpeed=this.maxSpeed,this.updateMoveState(3));break;case 3:break;case 4:this.curMoveSpeed-=this.acceleration,this.curMoveSpeed<=0&&(this.curMoveSpeed=0,this.updateMoveState(0))}if(this.curMoveSpeed*=this.curSpeedRatio,this.updatePosition(t),2==this.moveState||3==this.moveState){var e=this.player.getPositionForMap().sub(this.node.position);(e.x*this.curDir.x<0||e.y*this.curDir.y<0)&&this.updateMoveState(4)}},setRotate:function(t){var e=cc.v2(0,-1),i=t.signAngle(e),o=cc.misc.radiansToDegrees(i),n=this,s=cc.rotateTo(.1,o),a=cc.sequence(s,cc.callFunc(function(){n.updateMoveState(2)}));this.node.runAction(a)},updateMoveState:function(t){this.moveState=t},hurt:function(t){}}),cc._RF.pop()},{EnemyMoveBaseComponent:"EnemyMoveBaseComponent"}],EnemyStateComponent:[function(t,e,i){"use strict";cc._RF.push(e,"f19cfKdPxdNZZNDqiIu/Z9M","EnemyStateComponent");var o=t("Types");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.enemyEntity=null,this.state=o.EnemyAction.None},init:function(t){this.enemyEntity=t,this.node.on("updateState",this.updateState,this)},initState:function(){},updateState:function(t){this.state=t,this.refreshDisplay()},refreshDisplay:function(){switch(this.state){case o.EnemyAction.Action:break;case o.EnemyAction.Sleep:this.enemyEntity.uiNode.opacity=100;break;case o.EnemyAction.Awaking:if(!this.enemyEntity.hasAttribution(o.EnemyAttr.Gold)){var t=this,e=cc.sequence(cc.fadeIn(.5),cc.callFunc(function(){t.updateState(o.EnemyAction.Action)}));this.enemyEntity.uiNode.runAction(e)}}},updateGameLogic:function(t){}}),cc._RF.pop()},{Types:"Types"}],EnemyUIComponent:[function(t,e,i){"use strict";cc._RF.push(e,"febc9albJxHpKGeWceWoX3+","EnemyUIComponent");var o=t("EnemyBaseComponent"),n=t("Tools"),s=t("CommonValue"),a=t("CommonEnum"),c=t("Types"),r=t("CommonConfig");cc.Class({extends:o,properties:{},ctor:function(){this.entity=null,this.skinId=0,this._uiNode=null,this._bloodNode=null,this._skinSpr=null,this.bloodNum=null,this.goldEyeArr=[],this.goldEyeNum=2},preLoad:function(){for(var t=0;t<2;t++){var e=new cc.Node;e.addComponent(cc.Sprite).spriteFrame=s.GValue.Atlas_Enemy.getSpriteFrame("goldEye"),this.goldEyeArr.push(e),e.opacity=0}},init:function(t,e,i,o,l){switch(this.entity=t,this.skinId=e,this._uiNode=i,this._bloodNode=o,this._skinSpr=l,this.bloodNum||(this.bloodNum=n.DYTools.createPrefabCom(this._bloodNode,s.GValue.pf_num,"PfNum"),this.bloodNum.setParam(a.Enum_Num.Blood,cc.v2(.5,.5),0,s.GValue.Atlas_Enemy),this.bloodNum.setString("11111")),this._uiNode.y=0,this._bloodNode.opacity=255,this.refreshSkinSpr("e_"+e),this.setSkinColor(cc.color(255,255,255)),this.skinId){case 1:this._bloodNode.y=2,this.bloodNum.node.scale=.8;break;case 2:this._bloodNode.y=-20,this._uiNode.y=24,this.bloodNum.node.scale=.7;var h=new cc.Node;h.name="tail",h.zIndex=-1,this._uiNode.addChild(h),h.addComponent(cc.Sprite).spriteFrame=s.GValue.Atlas_Enemy.getSpriteFrame("tail_"+this.skinId),h.position=cc.v2(2,102);break;case 3:this._bloodNode.y=-10,this._uiNode.y=12,this.bloodNum.node.scale=.8;break;case 4:this._bloodNode.y=0,this.bloodNum.node.scale=.4;break;case 5:this._uiNode.y=24,this.initVomitUI(),this._bloodNode.y=0,this.bloodNum.node.scale=.8;break;case 6:this._uiNode.y=10,this._bloodNode.y=0,this.bloodNum.node.scale=.5;break;case 8:this.goldEyeNum=1,this._uiNode.y=10,this._bloodNode.y=0,this.bloodNum.node.scale=.5;break;case 9:this.goldEyeNum=1,this._bloodNode.y=-12,this.bloodNum.node.scale=.7;break;case 10:this._bloodNode.y=12,this.bloodNum.node.scale=.7;break;case 11:this._bloodNode.y=10,this.bloodNum.node.scale=.7;break;case 104:this._uiNode.y=24,this._bloodNode.y=-16,this.bloodNum.node.scale=.75;break;case 106:this._bloodNode.y=6,this.bloodNum.node.scale=.75;break;case 200:this._bloodNode.y=-16,this.bloodNum.node.scale=.65,this._uiNode.y=8;break;case 201:this._bloodNode.y=-10,this.bloodNum.node.scale=.56,this._uiNode.y=8;break;case 202:case 203:this._bloodNode.y=-24,this.bloodNum.node.scale=.5,this._uiNode.y=10;break;case 1001:this._bloodNode.y=-22,this.bloodNum.node.scale=.65;break;case 1002:this._bloodNode.y=-4,this.bloodNum.node.scale=.8}this.entity.hasAttribution(c.EnemyAttr.bulScreen)&&(this._bloodNode.opacity=0);for(var d=r.GConfig.enemyGoldEyePos[this.skinId].x,u=r.GConfig.enemyGoldEyePos[this.skinId].y,m=0;m<this.goldEyeNum;m++){var p=this.goldEyeArr[m];p.parent||(p.parent=l.node),p.x=0==m?d:-d,p.y=u,p.scale=r.GConfig.enemyGoldEyeScale[this.skinId]}},initVomitUI:function(){var t=new cc.Node;t.opacity=0,t.y=-70,t.name="mouth",this._uiNode.addChild(t,-2),t.addComponent(cc.Sprite).spriteFrame=s.GValue.Atlas_Enemy.getSpriteFrame("e_5_0");var e=new cc.Node;e.y=20,e.name="light",t.addChild(e),e.addComponent(cc.Sprite).spriteFrame=s.GValue.Atlas_Enemy.getSpriteFrame("e_5_light");var i=new cc.Node;i.anchorY=1,i.y=-12,i.name="mandible",this._uiNode.addChild(i),i.addComponent(cc.Sprite).spriteFrame=s.GValue.Atlas_Enemy.getSpriteFrame("e_5_1");var o=new cc.Node;o.opacity=0,o.y=-32,o.name="eye",this._uiNode.addChild(o,3);var n=new cc.Node;n.x=-35,n.scale=1.2,o.addChild(n),n.addComponent(cc.Sprite).spriteFrame=s.GValue.Atlas_Enemy.getSpriteFrame("eye_5");var a=new cc.Node;o.addChild(a),a.scaleX=-1.1,a.scaleY=1.2,a.x=35,a.addComponent(cc.Sprite).spriteFrame=s.GValue.Atlas_Enemy.getSpriteFrame("eye_5");var c=new cc.Node;c.anchorY=1,c.scaleY=30,c.name="line",c.y=-30,c.opacity=0,this._uiNode.addChild(c,-3),c.addComponent(cc.Sprite).spriteFrame=s.GValue.Atlas_Enemy.getSpriteFrame("e_5_line");var r=this;(function(){var t=new cc.Node;t.opacity=0,t.y=-20,t.name="skel",r._uiNode.addChild(t,5);var e=t.addComponent(sp.Skeleton);cc.loader.loadRes("skel/skel_boss_fire_effect/skel_boss_fire_effect",sp.SkeletonData,function(t,i){t||(e.skeletonData=i,e.premultipliedAlpha=!1)})})()},refreshBloodDisplay:function(t){t=Math.ceil(t),this.bloodNum.setString(n.DYTools.numberToString(t))},refreshSkinSpr:function(t){this._skinSpr.spriteFrame=s.GValue.Atlas_Enemy.getSpriteFrame(t)},refreshSkinSprFrame:function(t){this._skinSpr.spriteFrame=t},setSkinColor:function(t){if(this._skinSpr.node.color=t,5==this.skinId){var e=this._uiNode.getChildByName("mouth");e&&(e.color=t);var i=this._uiNode.getChildByName("mandible");i&&(i.color=t)}},setGoldEyeShow:function(t){for(var e=0;e<this.goldEyeNum;e++)this.goldEyeArr[e].opacity=t?255:0},die:function(){n.DYTools.removeChildByName(this._uiNode,"mouth"),n.DYTools.removeChildByName(this._uiNode,"mandible"),n.DYTools.removeChildByName(this._uiNode,"line"),n.DYTools.removeChildByName(this._uiNode,"eye"),n.DYTools.removeChildByName(this._uiNode,"skel")}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonValue:"CommonValue",EnemyBaseComponent:"EnemyBaseComponent",Tools:"Tools",Types:"Types"}],EntityAddSys:[function(t,e,i){"use strict";cc._RF.push(e,"a59a0oY7N5AlYR2LC+JxEGt","EntityAddSys");var o=t("Tools"),n=t("EntityEnemy"),s=t("CommonValue"),a=t("ConfigData"),c=t("CommonConfig"),r=t("Types"),l=t("CEntitySnake"),h=t("GameData"),d=t("EntityPlayerDeputyFollow"),u=t("EntityDWKnife"),m=t("CEntityBossCircle"),p=t("CEntityBossFire"),f=t("CEntityBossElectr");cc.Class({extends:cc.Component,properties:{mapNode:cc.Node,mapBg:cc.Node,shieldNode:cc.Node,mapWall:cc.Node,shadowNode:cc.Node,itemNode:cc.Node,propNode:cc.Node,enemyNode:cc.Node,effectNode:cc.Node,playerNode:cc.Node,weaponNode:cc.Node,heroPrefab:cc.Prefab,heroFollowPrefab:cc.Prefab,knifePrefab:cc.Prefab},onLoad:function(){},init:function(t){this.poolMgr=t,this.player=null,this.enemyPool=[],this.knifePool=[],this.preLoadCall=null,this.preLoadOver=!0,this.preLoadEnemyCount=0,this.preLoadDropKnifeCount=0},clear:function(){this.mapNode.removeAllChildren(),this.mapWall.removeAllChildren(),this.shadowNode.removeAllChildren(),this.itemNode.removeAllChildren(),this.propNode.removeAllChildren(),this.enemyNode.removeAllChildren(),this.weaponNode.removeAllChildren()},update:function(t){if(!this.preLoadOver)if(this.preLoadEnemyCount>0){for(var e=0;e<10;e++)(i=this.poolMgr.getEnemy()).getComponent("EntityEnemy").preLoad(),this.enemyPool.push(i),i.parent=this.enemyNode,i.position=cc.v2(-1e4,-1e4),i.active=!1;this.preLoadEnemyCount-=10}else if(this.preLoadDropKnifeCount>0){for(e=0;e<10;e++){var i;(i=this.poolMgr.getKnife()).parent=this.itemNode,i.position=cc.v2(-1e4,-1e4),this.knifePool.push(i)}this.preLoadDropKnifeCount-=10}else this.preLoadOver=!0,this.preLoadCall&&this.preLoadCall()},preLoadStart:function(t){this.preLoadCall=t,this.preLoadEnemyCount=60,this.preLoadDropKnifeCount=30,this.preLoadOver=!1},_addEntityPlayer:function(t,e){var i=h.TData.getCurSubFun(),n=this.poolMgr.getPlayer(),a=n.getComponent("CEntityPlayer");n.parent=this.playerNode,n.position=cc.v2(t,e);var c=new cc.Node;c.parent=this.shadowNode,c.addComponent(cc.Sprite).spriteFrame=s.GValue.Atlas_Shadow.getSpriteFrame("sh_"+i),o.DYTools.addScript(c,"ShadowOwnerComponent").init(a.node,c,0);var r=this.poolMgr.getPlayerMainFollow();r.parent=this.weaponNode,r.zIndex=1;var l=r.getComponent("CEntityFollowPlayer");l.init(a);var u=this.poolMgr.getPlayerDWFollow();u.parent=this.weaponNode;var m=u.getComponent(d);return a.init(l,m,i,c),m.init(a),a},addPlayer:function(){var t=this._addEntityPlayer(.5*s.GValue.Size_View.width,.33*s.GValue.Size_View.height);return this.player=t,t},addDWKnife:function(t,e){for(var i=[],o=0;o<t;o++){var n=this.poolMgr.getDWKnife(),s=n.getComponent(u),a=this.createDWShadow(n,e);s.init(e,a),i.push(s)}return i},createDWShadow:function(t,e){var i=new cc.Node;return i.parent=this.shadowNode,i.addComponent(cc.Sprite).spriteFrame=s.GValue.Atlas_Shadow.getSpriteFrame("sdw_"+e),o.DYTools.addScript(i,"ShadowOwnerComponent").init(t,i,2),i},_addEntityKnife:function(t,e){void 0===e&&(e=!1);var i=this.knifePool.pop();void 0!=i&&null!=i||((i=this.poolMgr.getKnife()).parent=this.itemNode);var o=i.getComponent("CEntityKnife");return o.init(t,this.itemNode,e),o},removeKnife:function(t){t.position=cc.v2(-1e4,-1e4),this.knifePool.push(t)},AddKnife:function(t,e,i){void 0===e&&(e=-1),void 0===i&&(i=!0);for(var n=[],s=0;s<t;s++){var a=this._addEntityKnife(e,i);a.node.position=cc.v2(o.DYTools.random_int(0,720)-360,o.DYTools.random_int(0,1280)-640),a.node.angle=-o.DYTools.random_int(0,360),n[s]=a}return n},_createDropKnife:function(t){var e=this.knifePool.pop();void 0!=e&&null!=e||((e=this.poolMgr.getKnife()).parent=this.itemNode);var i=e.getComponent("CEntityKnife");return i.initDrop(t),i},addDropKnife:function(t,e,i){for(var n=[],s=0;s<t;s++){var a=this._createDropKnife(i);a.node.position=e,a.node.angle=-o.DYTools.random_int(0,360),n[s]=a}return n},createMainKnifeShadow:function(t,e){var i=new cc.Node;return i.parent=this.shadowNode,i.addComponent(cc.Sprite).spriteFrame=s.GValue.Atlas_Shadow.getSpriteFrame("sw_"+e),o.DYTools.addScript(i,"ShadowOwnerComponent").init(t,i,1),i},_addEntityEnemy:function(t,e,i){void 0===e&&(e=cc.Vec2.ZERO),void 0===i&&(i=3),s.GValue.StageFailFinish&&(t.blood*=s.GValue.FailRatio);var a=null;switch(this.getEnemyType(t)){case r.EnemyType.Normal:var c=this.enemyPool.pop();if(void 0!=c&&null!=c||((a=(c=this.poolMgr.getEnemy()).getComponent(n)).preLoad(),o.DYTools.error("\u7f13\u5b58\u602a\u4e0d\u8db3")),c.active=!0,a=c.getComponent(n),c.parent=this.enemyNode,c.zIndex=0,c.position=e,a.uiNode){var l=a.uiNode.getChildByName("role_shine");l&&l.destroyAllChildren()}var h=a.shadow;if(h){h.active=!0,h.position=cc.v2(-1e3,-1e3);var d=h.getComponent(cc.Sprite);d||(d=h.addComponent(cc.Sprite)),d.spriteFrame=s.GValue.Atlas_Shadow.getSpriteFrame("se_"+t.cData.imageId)}else h=this.createEnemyShadow(c,t.cData.imageId,i);a.init(t,this.player,h);break;case r.EnemyType.Connect:}return a},_removeEntityEnemy:function(t){t.position=cc.v2(-1e4,-1e4),this.enemyPool.push(t)},createEnemyShadow:function(t,e,i){void 0===i&&(i=3);var n=new cc.Node;return n.parent=this.shadowNode,n.addComponent(cc.Sprite).spriteFrame=s.GValue.Atlas_Shadow.getSpriteFrame("se_"+e),o.DYTools.addScript(n,"ShadowOwnerComponent").init(t,n,i),n},createEnemy:function(t){var e=new a.EnemyData;return e.id=t.id,e.blood=o.DYTools.random_int(t.blood.x,t.blood.y),e.moveSpeed=o.DYTools.random_int(t.speed.x,t.speed.y),e.scale=o.DYTools.random_int(t.size.x,t.size.y)/100,e.adjustDuration=o.DYTools.random_int(t.adjustDuration.x,t.adjustDuration.y)/10,e.cData=t,this._addEntityEnemy(e)},AddEnemy:function(t,e,i){void 0===i&&(i=null);for(var n=[],s=0;s<e;s++){var c=new a.EnemyData;c.id=t.id,c.blood=o.DYTools.random_int(t.blood.x,t.blood.y),c.moveSpeed=o.DYTools.random_int(t.speed.x,t.speed.y),c.scale=o.DYTools.random_int(t.size.x,t.size.y)/100,c.adjustDuration=o.DYTools.random_int(t.adjustDuration.x,t.adjustDuration.y)/10,c.cData=t;var r=cc.Vec2.ZERO;if(i)r=cc.v2(o.DYTools.random_int(i.xMin,i.xMax),o.DYTools.random_int(i.yMin,i.yMax));else{var l=o.DYTools.random_int(1,3);r=1==l?cc.v2(o.DYTools.random_int(-80,720),o.DYTools.random_int(1480,1950)):2==l?cc.v2(o.DYTools.random_int(-500,-200),o.DYTools.random_int(640,1280)):cc.v2(o.DYTools.random_int(840,1140),o.DYTools.random_int(640,1280))}var h=this._addEntityEnemy(c,r);h.node.angle=-o.DYTools.random_int(0,360),n[s]=h}return n},removeEnemy:function(t){this._removeEntityEnemy(t)},addBossFireEnemys:function(t,e,i){var n=[],r=c.GConfig.getEnemyData(t),l=new a.EnemyData;l.id=r.id,l.blood=o.DYTools.random_int(r.blood.x,r.blood.y),l.moveSpeed=o.DYTools.random_int(r.speed.x,r.speed.y),l.scale=o.DYTools.random_int(r.size.x,r.size.y)/100,l.adjustDuration=o.DYTools.random_int(r.adjustDuration.x,r.adjustDuration.y)/10,l.cData=r;var h=this._addEntityEnemy(l,i);h.startGame(),h.setCurDir(e),n.push(h),s.GValue.EntityWorld.addEnemys(n)},addContinueEnemys:function(t,e){for(var i=[],n=t.split("*"),s=0;s<n.length;s++){var a=o.DYTools.stringToPoint(n[s],","),r=c.GConfig.getEnemyData(a.x);if(r)for(var l=0,h=this._addContinueEnemys(r,a.y,e);l<h.length;l++){var d=h[l];i.push(d)}}return i},_addContinueEnemys:function(t,e,i){for(var n=[],c=0;c<e;c++){var r=new a.EnemyData;r.id=t.id,r.blood=o.DYTools.random_int(t.blood.x,t.blood.y),r.moveSpeed=o.DYTools.random_int(t.speed.x,t.speed.y),r.scale=o.DYTools.random_int(t.size.x,t.size.y)/100,r.adjustDuration=o.DYTools.random_int(t.adjustDuration.x,t.adjustDuration.y)/10,r.cData=t;var l=cc.v2(o.DYTools.random_int(i.xMin,i.xMax),o.DYTools.random_int(i.yMin,i.yMax));switch(s.GValue.EntityWorld.mapMgr.curDirTag){case 1:l=this.enemyNode.convertToNodeSpaceAR(cc.v2(s.GValue.ViewCenter.x+o.DYTools.random_int(i.xMin,i.xMax),s.GValue.Size_View.height+150+o.DYTools.random_int(5,30)));break;case 2:l=this.enemyNode.convertToNodeSpaceAR(cc.v2(s.GValue.ViewCenter.x+o.DYTools.random_int(i.xMin,i.xMax),-150-o.DYTools.random_int(5,30)));break;case 3:l=this.enemyNode.convertToNodeSpaceAR(cc.v2(-150-o.DYTools.random_int(5,30),s.GValue.ViewCenter.y+o.DYTools.random_int(i.yMin,i.yMax)));break;case 4:l=this.enemyNode.convertToNodeSpaceAR(cc.v2(s.GValue.Size_View.width+150+o.DYTools.random_int(5,30),s.GValue.ViewCenter.y+o.DYTools.random_int(i.yMin,i.yMax)))}var h=this._addEntityEnemy(r,l);h.node.angle=-o.DYTools.random_int(0,360),h.startGame(),n.push(h)}return n},addSleepEnemys:function(t,e,i){var n=c.GConfig.getEnemyData(t),s=new a.EnemyData;s.id=n.id,s.blood=o.DYTools.random_int(n.blood.x,n.blood.y),s.moveSpeed=o.DYTools.random_int(n.speed.x,n.speed.y),s.scale=o.DYTools.random_int(n.size.x,n.size.y)/100,s.adjustDuration=o.DYTools.random_int(n.adjustDuration.x,n.adjustDuration.y)/10,s.cData=n;var r=this._addEntityEnemy(s,e);return r.node.angle=-i,r},addPauseEnemy:function(t,e,i,n){for(var r=[],l=c.GConfig.getEnemyData(t),h=0;h<e;h++){var d=new a.EnemyData;d.id=l.id,d.blood=o.DYTools.random_int(l.blood.x,l.blood.y),d.moveSpeed=o.DYTools.random_int(l.speed.x,l.speed.y),d.scale=o.DYTools.random_int(l.size.x,l.size.y)/100,d.adjustDuration=o.DYTools.random_int(l.adjustDuration.x,l.adjustDuration.y)/10,d.cData=l;var u=cc.v2(0,0);switch(i){case 1:u=this.enemyNode.convertToNodeSpaceAR(cc.v2(s.GValue.ViewCenter.x+o.DYTools.random_int(n[0].x,n[0].y),s.GValue.Size_View.height+150+o.DYTools.random_int(n[1].x,n[1].y)));break;case 2:u=this.enemyNode.convertToNodeSpaceAR(cc.v2(s.GValue.ViewCenter.x+o.DYTools.random_int(n[0].x,n[0].y),-150-o.DYTools.random_int(n[1].x,n[1].y)));break;case 3:u=this.enemyNode.convertToNodeSpaceAR(cc.v2(-150-o.DYTools.random_int(n[0].x,n[0].y),s.GValue.ViewCenter.y+o.DYTools.random_int(n[1].x,n[1].y)));break;case 4:u=this.enemyNode.convertToNodeSpaceAR(cc.v2(s.GValue.Size_View.width+150+o.DYTools.random_int(n[0].x,n[0].y),s.GValue.ViewCenter.y+o.DYTools.random_int(n[1].x,n[1].y)))}var m=this._addEntityEnemy(d,u);r.push(m),m.startGame()}return r},addBoss:function(t,e,i,o){switch(t){case r.BossType.Knife:this.addBossKnife(e,i);break;case r.BossType.Snake:this.addBossSnake(e,i,o);break;case r.BossType.Circle:this.addBossCircle(e,i);break;case r.BossType.Fire:this.addBossFire(e,i);break;case r.BossType.Electr:this.addBossElectr(e,i)}},addBossKnife:function(t,e){void 0===e&&(e=null);var i=c.GConfig.getKnifeBossData(t),n=c.GConfig.getEnemyData(i.enemyId),l=new a.EnemyData;l.id=n.id,l.blood=o.DYTools.random_int(n.blood.x,n.blood.y),l.moveSpeed=o.DYTools.random_int(n.speed.x,n.speed.y),l.scale=o.DYTools.random_int(n.size.x,n.size.y)/100,l.adjustDuration=o.DYTools.random_int(n.adjustDuration.x,n.adjustDuration.y)/10,l.cData=n,l.kData=i,s.GValue.StageFailFinish&&(l.blood*=s.GValue.FailRatio);var h=this.poolMgr.getEnemy(),d=h.getComponent("EntityEnemy");d.preLoad(),h.parent=this.enemyNode,h.zIndex=1e4;var u=this.createEnemyShadow(h,n.imageId);d.init(l,this.player,u);var m=this.poolMgr.getFollowEnemy();m.parent=this.enemyNode,m.zIndex=9999;var p=m.getComponent("EntityFollowEnemy");p.init(d),d.actionAble=!1,d.isBoss=!0,d.node.angle=0,d.setFollow(p),d.node.position=this.enemyNode.convertToNodeSpaceAR(i.start),d.startGame(),s.GValue.EntityWorld.addEnemy(d);for(var f=i.knifeCount,_=0,y=this.AddKnife(f,r.EntityTag.Enemy);_<y.length;_++){var g=y[_],v=new cc.Node;v.name="tail",v.position=cc.v2(5,-60),v.angle=-90,v.addComponent(cc.Sprite).spriteFrame=s.GValue.Atlas_Enemy.getSpriteFrame("ektail_1001"),g.node.addChild(v,-1),s.GValue.EntityWorld.addKnife(g),g.changeSkin("ew1"),g.node.emit("changeKnifeAttackGroup","otherKnife"),g.node.emit("changeTag",r.EntityTag.Enemy),g.node.emit("updateState",r.KnifeState.Init),d.followCtrl.addKnife(g.node)}var C=this.enemyNode.convertToNodeSpaceAR(i.end),S=cc.moveTo(1,C).easing(cc.easeIn(1)),D=cc.callFunc(function(){e&&e(d)}),T=cc.sequence(S,D);d.node.runAction(T)},addBossSnake:function(t,e,i){var o=c.GConfig.getMapBossSnakeData(t);if(o){var n=new cc.Node,a=n.addComponent(l);s.GValue.EntityWorld.SnakeEnemys[t]=a,n.parent=this.enemyNode,n.zIndex=9999,a.node.position=this.enemyNode.convertToNodeSpaceAR(cc.v2(.5*s.GValue.Size_View.width,.5*s.GValue.Size_View.height)),a.init(o,e,i)}},addBossCircle:function(t,e){void 0===e&&(e=null);var i=c.GConfig.getMapBossCircleData(t);if(i){var o=new cc.Node,n=o.addComponent(m);s.GValue.EntityWorld.CircleEnemys[t]=n,o.parent=this.enemyNode,n.init(i,e);var a=cc.v2(.5*s.GValue.Size_View.width,.5*s.GValue.Size_View.height);n.node.position=this.enemyNode.convertToNodeSpaceAR(a.add(i.start_pos))}else e&&e()},addBossFire:function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null);var o=c.GConfig.getMapBossFireData(t);if(o){var n=new cc.Node,a=n.addComponent(p);s.GValue.EntityWorld.FireEnemys[t]=a,n.parent=this.mapWall,n.zIndex=999,a.node.position=this.enemyNode.convertToNodeSpaceAR(cc.v2(.5*s.GValue.Size_View.width,.5*s.GValue.Size_View.height)),a.init(o,e,i);var r=cc.v2(.5*s.GValue.Size_View.width,.5*s.GValue.Size_View.height);a.node.position=this.enemyNode.convertToNodeSpaceAR(r.add(o.end_pos))}else e&&e()},addBossElectr:function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null);var o=c.GConfig.getMapBossElectrData(t);if(o){var n=new cc.Node,a=n.addComponent(f);n.parent=this.enemyNode,n.zIndex=999,a.node.position=this.enemyNode.convertToNodeSpaceAR(cc.v2(.5*s.GValue.Size_View.width,.5*s.GValue.Size_View.height)),a.init(o,e);var r=cc.v2(.5*s.GValue.Size_View.width,.5*s.GValue.Size_View.height);a.node.position=this.enemyNode.convertToNodeSpaceAR(r.add(o.target_pos))}else e&&e()},addProp:function(t){var e=this.poolMgr.getProp(),i=e.getComponent("EntityProp");return e.parent=this.propNode,i.create(t),i},removeProp:function(t){this.poolMgr.putProp(t)},_addEntityCollisionEffect:function(t){var e=this.poolMgr.getCollEffect();e.parent=this.effectNode;var i=this.effectNode.convertToNodeSpaceAR(t);return e.position=i,e},addCollisionEffect:function(t){return this._addEntityCollisionEffect(t)},getEnemyType:function(t){for(var e=[],i=t.cData.attr,n=0;n<i.length;n++){var s=i[n],a=c.GConfig.getAttrData(s);a&&e.push(a.attr)}return o.DYTools.arrContain(e,r.EnemyAttr.Connect)?r.EnemyType.Connect:r.EnemyType.Normal}}),cc._RF.pop()},{CEntityBossCircle:"CEntityBossCircle",CEntityBossElectr:"CEntityBossElectr",CEntityBossFire:"CEntityBossFire",CEntitySnake:"CEntitySnake",CommonConfig:"CommonConfig",CommonValue:"CommonValue",ConfigData:"ConfigData",EntityDWKnife:"EntityDWKnife",EntityEnemy:"EntityEnemy",EntityPlayerDeputyFollow:"EntityPlayerDeputyFollow",GameData:"GameData",Tools:"Tools",Types:"Types"}],EntityBlock:[function(t,e,i){"use strict";cc._RF.push(e,"7d6a1ye7/dObYpxCQJ7IL+S","EntityBlock");var o=t("CEntityBase"),n=t("CommonValue");cc.Class({extends:o,properties:{skinSpr:cc.Sprite,colNode:cc.Node,colCollider:cc.BoxCollider},ctor:function(){this.width=0,this.height=0},init:function(t,e){this.colCollider.tag=101,this.node.scaleX=t.sx,this.node.scaleY=t.sy,this.node.angle=t.rt,this.skinSpr.spriteFrame=n.GValue.Atlas_Wall.getSpriteFrame("b"+e+"_"+t.id);var i=cc.Vec2.ZERO;switch(t.id){case 1:this.width=386,this.height=106,i=cc.v2(-7,7);break;case 2:this.width=256,this.height=106,i=cc.v2(-7,7);break;case 3:this.width=126,this.height=106,i=cc.v2(-7,7);break;case 4:this.width=63,this.height=436,i=cc.v2(-8,10);break;case 5:this.width=63,this.height=302,i=cc.v2(-8,10);break;case 6:this.width=63,this.height=172,i=cc.v2(-8,10)}this.colCollider.node.position=i,this.colCollider.size.width=this.width,this.colCollider.size.height=this.height}}),cc._RF.pop()},{CEntityBase:"CEntityBase",CommonValue:"CommonValue"}],EntityDWBase:[function(t,e,i){"use strict";cc._RF.push(e,"d395fhLhd9LCquOkgxWxKnL","EntityDWBase");var o=t("CEntityBase");cc.Class({extends:o}),cc._RF.pop()},{CEntityBase:"CEntityBase"}],EntityDWKnife:[function(t,e,i){"use strict";cc._RF.push(e,"955b2fpZBdOoId49j0bd/yx","EntityDWKnife");var o=t("EntityDWBase"),n=t("CNodeCollider"),s=t("Tools"),a=t("CommonValue"),c=t("Types");cc.Class({extends:o,properties:{spr_knife:cc.Sprite,node_collision:cc.Node},ctor:function(){this.shadow=null},init:function(t,e){switch(this.shadow=e,this.colliderCom=s.DYTools.addScript(this.node_collision,n),this.colliderCom.init(this.node,!0),this.spr_knife.spriteFrame=a.GValue.Atlas_Game.getSpriteFrame("dw"+t),t){case c.DWType.Knife:this.node_collision.angle=-70,this.spr_knife.node.angle=-70;break;case c.DWType.Laser:this.spr_knife.node.anchorX=1,this.node_collision.y=50,this.node_collision.angle=90,this.spr_knife.node.angle=90;break;case c.DWType.Ice:case c.DWType.Fire:case c.DWType.Electricity:this.node_collision.angle=-90,this.spr_knife.node.angle=-90}}}),cc._RF.pop()},{CNodeCollider:"CNodeCollider",CommonValue:"CommonValue",EntityDWBase:"EntityDWBase",Tools:"Tools",Types:"Types"}],EntityEnemy:[function(t,e,i){"use strict";cc._RF.push(e,"6c74feV+mpMnZzilID2YtAH","EntityEnemy");var o=t("Tools"),n=t("CommonValue"),s=t("Types"),a=t("CommonConfig"),c=t("CommonAudio"),r=t("GameData"),l=t("CommonSdk"),h=(t("EnemyUIComponent"),t("EnemyBase")),d=t("EnemyCollisionWallListener");cc.Class({extends:h,properties:{uiNode:cc.Node,animNode:cc.Node,colliderNode:cc.Node,roleSpr:cc.Sprite,bloodNum:cc.Node,hurtLightNode:cc.Node,knifeLightNode:cc.Node,dieSprArr:cc.Sprite,pf_num:cc.Prefab},ctor:function(){this.radius=0,this.isDead=!1,this.isDieOver=!0,this.skinColor=cc.color(),this._curBlood=10,this.actionAble=!0,this.moveAble=!0,this.isBoss=!1,this.isItem=!1},onLoad:function(){this.type=s.EnemyType.Normal},preLoad:function(){this._animCom=o.DYTools.addScript(this.node,"EnemyAnimComponent"),this._animCom.preLoad(),this.uiCom=o.DYTools.addScript(this.node,"EnemyUIComponent"),this.uiCom.preLoad(),o.DYTools.addScript(this.colliderNode,"CNodeCollider").init(this.node,!0,!1),o.DYTools.addScript(this.node,"EnemyStateComponent"),o.DYTools.addScript(this.node,"EnemyAttrComponent"),o.DYTools.addScript(this.node,"EnemyMoveFix"),o.DYTools.addScript(this.node,"EnemyAnimComponent"),o.DYTools.addScript(this.node,"EnemyDropComponent"),o.DYTools.addScript(this.node,"EnemyBuffComponent")},resetAttr:function(){switch(this.skinColor=cc.color(255,255,255),this.isDead=!1,this.actionAble=!0,this.moveAble=!0,this.isBoss=!1,this.uiNode.active=!0,this.uiNode.scale=1,this.data.cData.imageId){case 104:this.skinColor=cc.color(195,52,52);break;case 106:this.skinColor=cc.color(255,214,39);break;case 200:case 201:case 202:case 203:this.skinColor=cc.color(15,148,255);break;case 1001:this.skinColor=cc.color(245,135,14);break;case 1002:this.skinColor=cc.color(255,82,131)}},init:function(t,e,i){this.data=t,this.resetAttr(),this.player=e,this.shadow=i,this._curBlood=this.data.blood,this.node.scale=this.data.scale;var a=this.getColRadiusForImage(this.data.cData.imageId);this.setRadius(a),this.colliderNode.getComponent(cc.CircleCollider).radius=a;for(var c=0,r=this.dieSprArr;c<r.length;c++)r[c].spriteFrame=n.GValue.Atlas_Enemy.getSpriteFrame("die3");this.data.cData.moveType==s.EnemyMoveType.SpeedUp?this.moveCom=o.DYTools.addScript(this.node,"EnemySpeedUpMoveComponent"):this.moveCom=o.DYTools.addScript(this.node,"EnemyActionMoveComponent"),this.attrCom=o.DYTools.addScript(this.node,"EnemyAttrComponent"),this.attrCom.init(this),this.uiCom.init(this,this.data.cData.imageId,this.uiNode,this.bloodNum,this.roleSpr),o.DYTools.addScript(this.colliderNode,"CNodeCollider").init(this.node,!0,!1),this.stateCom=o.DYTools.addScript(this.node,"EnemyStateComponent"),this.stateCom.init(this),this.moveFixCom=o.DYTools.addScript(this.node,"EnemyMoveFix"),this.moveFixCom.init(this),this.data.cData.moveType==s.EnemyMoveType.Elastic?o.DYTools.addScript(this.colliderNode,"EnemyCollisionWallListener"):this.colliderNode.removeComponent(d),o.DYTools.addScript(this.colliderNode,"EnemyCollisionBlockListener"),this._animCom=o.DYTools.addScript(this.node,"EnemyAnimComponent"),this._animCom.init(this,this.data,this.roleSpr.node,this.bloodNum,this.hurtLightNode,this.knifeLightNode,this.node.getChildByName("anim").getChildByName("die")),this._dropCom=o.DYTools.addScript(this.node,"EnemyDropComponent"),this._dropCom.init(this.data,this.player),this.buffCom=o.DYTools.addScript(this.node,"EnemyBuffComponent"),this.buffCom.init(this),this.initRole(),this.uiCom.refreshBloodDisplay(this._curBlood),this.refreshSkinColor(),this.node.on("hurt",this.hurt,this)},setFollow:function(t){this.followWeapon=t,this.followCtrl=o.DYTools.addScript(this.node,"BossKnivesCtrl"),this.followCtrl.init(this,t),this.logicEnemy=o.DYTools.addScript(this.node,"CLoginEnemy"),this.logicEnemy.init(this),this.knifeDropCtrl=o.DYTools.addScript(this.node,"BossKnivesDropCtrl"),this.knifeDropCtrl.init(this)},setRadius:function(t){this.radius=t*this.node.scale,this.colliderNode.getComponent(cc.CircleCollider).radius=t},initRole:function(){if(this.hasAttribution(s.EnemyAttr.Gold)){var t=.0417,e=new cc.Node;e.y=this.roleSpr.node.y,e.name="gold",this.uiNode.addChild(e);var i=new cc.Node;e.addChild(i),i.y=70,i.addComponent(cc.Sprite).spriteFrame=n.GValue.Atlas_Enemy.getSpriteFrame("e_101_0");var o=new cc.Node;e.addChild(o),o.y=-44,o.addComponent(cc.Sprite).spriteFrame=n.GValue.Atlas_Enemy.getSpriteFrame("eye_101"),e.active=!1;var a=cc.v2(58,80).add(this.roleSpr.node.position),c=new cc.Node;c.position=a,c.name="sleep1",this.node.addChild(c),c.addComponent(cc.Sprite).spriteFrame=n.GValue.Atlas_Enemy.getSpriteFrame("fz");var r=cc.scaleTo(.7089,1.65),l=cc.fadeOut(.7089),h=cc.moveBy(.7089,cc.v2(46,31)),d=cc.spawn(r,l,h),u=cc.delayTime(3*t),m=cc.fadeIn(0),p=cc.scaleTo(0,1),f=cc.place(a),_=cc.spawn(p,m,f),y=cc.sequence(_,d,u);c.runAction(cc.repeatForever(y));var g=this;(function(){var e=cc.v2(58,80).add(g.roleSpr.node.position),i=new cc.Node;i.position=cc.v2(58,78).add(g.roleSpr.node.position),i.name="sleep2",i.opacity=255,g.node.addChild(i),i.addComponent(cc.Sprite).spriteFrame=n.GValue.Atlas_Enemy.getSpriteFrame("fz");var o=cc.scaleTo(.7089,1.65),s=cc.fadeOut(.7089),a=cc.moveBy(.7089,cc.v2(46,31)),c=cc.spawn(o,s,a),r=cc.fadeIn(0),l=cc.place(e),h=cc.scaleTo(0,1),d=cc.spawn(h,r,l),u=cc.sequence(d,c,cc.delayTime(3*t));i.runAction(cc.sequence(cc.delayTime(10*t),cc.callFunc(function(){i.stopAllActions(),i.runAction(cc.repeatForever(u))})))})()}},onAnimCompleted:function(t){this._animCom.onAnimCompleted(t)},startGame:function(){this.moveCom.init(this.player,this,this.data),this.followCtrl&&this.followCtrl.node.emit("startGame")},changeGroup:function(t){this.colliderNode.group=t},awake:function(t){if(void 0===t&&(t=null),t&&(this.player=t),this._dropCom.init(this.data,this.player),this.moveCom.init(this.player,this,this.data),this.node.emit("updateState",s.EnemyAction.Awaking),this.hasAttribution(s.EnemyAttr.Gold)){var e=this,i=.0417,o=cc.scaleTo(2*i,1.1),a=cc.moveTo(2*i,cc.v2(1,-10)),c=cc.spawn(o,a),r=cc.scaleTo(2*i,1),l=cc.moveTo(2*i,cc.v2(-16,17)),h=cc.spawn(r,l),d=cc.moveTo(2*i,cc.v2(1,-5)),u=cc.moveTo(3*i,cc.v2(0,0)),m=cc.delayTime(2*i),p=cc.callFunc(function(){var t=e.uiNode.getChildByName("gold");t&&(t.active=!0);var i=e.node.getChildByName("black");i&&i.removeFromParent();var o=e.node.getChildByName("sleep1");o&&o.removeFromParent();var n=e.node.getChildByName("sleep2");n&&n.removeFromParent(),e.uiNode.scale=.75,e.uiNode.opacity=255}),f=cc.scaleTo(3*i,1.15),_=cc.scaleTo(3*i,1),y=cc.callFunc(function(){e.node.emit("updateState",s.EnemyAction.Action),e._animCom.addAnimAct(s.EnemyAnim.Idle)}),g=cc.sequence(c,h,d,u,m,p,f,_,cc.delayTime(7*i),y);this.uiNode.runAction(g);var v=cc.v2(-60,88),C=new cc.Node;this.node.addChild(C),C.position=v.add(cc.v2(-1,-26)),C.addComponent(cc.Sprite).spriteFrame=n.GValue.Atlas_Enemy.getSpriteFrame("icon_101"),C.scale=.4,C.opacity=0,o=cc.scaleTo(3*i,1.7),a=cc.moveTo(3*i,v.add(cc.v2(2,19))),c=cc.spawn(o,a),r=cc.scaleTo(5*i,1),l=cc.moveTo(5*i,v),h=cc.spawn(r,l);var S=cc.scaleTo(5*i,1.5),D=(d=cc.moveTo(5*i,v.add(cc.v2(1,16))),cc.spawn(S,d));g=cc.sequence(cc.delayTime(2*i),cc.fadeIn(0),c,h,D,h.clone(),cc.removeSelf()),C.runAction(g)}},updateGameLogic:function(t){this.isDieOver||this._animCom.updateGameLogic(t),this.isDead||(this.actionAble&&(this.moveCom.updateGameLogic(t),this.stateCom.updateGameLogic(t),this.attrCom.updateGameLogic(t),this._animCom.updateGameLogic(t),this.moveFixCom.updateGameLogic(t),this.buffCom.updateGameLogic(t)),this.logicEnemy&&this.logicEnemy.updateLogic(t),this.followWeapon&&this.followWeapon.updateGameLogic(t))},refreshSkinColor:function(){this.data.cData.imageId<100&&(this.skinColor=n.GValue.EntityWorld.getSkinColor(this._curBlood),this.uiCom.setSkinColor(this.skinColor))},hurt:function(t,e,i){if(void 0===i&&(i=null),!this.player.isDead&&!this.isDead&&!this.hasAttribution(s.EnemyAttr.bulScreen)&&this.stateCom.state==s.EnemyAction.Action){var o=s.EnemyHurtState.Normal,a=this.moveCom.curDir;if(0==t){var l=this.player.radius,h=this.node.position,d=this.player.node.position.sub(n.GValue.EntityWorld.mapMgr.mapTop.position);this.isItem&&(d=this.node.parent.convertToNodeSpaceAR(this.player.node.convertToWorldSpaceAR(cc.v2(0,0))));var u=(f=h.sub(d)).normalize().mul(l),m=d.add(u).sub(this.node.position);m=m.rotate(cc.misc.degreesToRadians(this.node.angle));var p=a.signAngle(d.sub(h));this._animCom.addAnimAct(s.EnemyAnim.HurtNormal,m,cc.misc.radiansToDegrees(p)),c.GAudio.playEnemyHurtSound(),this.isItem||this.moveCom.hurt(o)}else if(1==t){switch(c.GAudio.playEnemyHurtSound(),this._animCom.playDeputyHurtAnim(cc.v2(0,0)),r.TData.getCurSubFun()){case s.DWType.Knife:o=s.EnemyHurtState.Knife;break;case s.DWType.Laser:o=s.EnemyHurtState.Laser;break;case s.DWType.Ice:o=s.EnemyHurtState.Frozen;break;case s.DWType.Fire:o=s.EnemyHurtState.Fire}this.isItem||this.moveCom.hurt(o)}else if(2==t){switch(r.TData.getCurSubFun()){case s.DWType.Laser:h=this.node.position,d=this.player.node.position.sub(n.GValue.EntityWorld.mapMgr.mapTop.position),this.isItem&&(d=this.node.convertToNodeSpaceAR(this.player.node.convertToWorldSpaceAR(cc.v2(0,0)))),p=this.moveCom.curDir.signAngle(d.sub(h));var f=this.player.getPositionForMap().sub(this.node.position).normalize();this._animCom.addAnimAct(s.EnemyAnim.HurtLaser,f,cc.misc.radiansToDegrees(p));break;case s.DWType.Electricity:this._animCom.playElectricityAct(i)}this.buffCom.addBuff(s.EnemyBuff.SlowDown),this.buffCom.addBuff(s.EnemyBuff.SlowDown)}this.checkHurtAffect(e),this.bloodChange(-e)}},bloodChange:function(t){this.hasAttribution(s.EnemyAttr.bulScreen)||(this._curBlood+=t,this.refreshSkinColor(),this.uiCom.refreshBloodDisplay(this._curBlood),this.knifeDropCtrl&&this.knifeDropCtrl.bloodChange(this._curBlood),this._curBlood<=0&&(this.die(),this._curBlood=0))},checkHurtAffect:function(t){if(this.hasAttribution(s.EnemyAttr.Gold)){var e=this.attrCom.attrData[s.EnemyAttr.Gold],i=this.node.convertToWorldSpaceAR(cc.v2(0,0));n.GValue.EntityWorld.playGoldFlyEffect(1,parseInt(e.param),i)}if(n.GValue.PropMgr.hasProp(s.PropType.Gold)){var o=Math.floor(t*n.GValue.GoldCount);o>0&&(i=this.node.convertToWorldSpaceAR(cc.v2(0,0)),n.GValue.EntityWorld.playGoldFlyEffect(1,o,i))}},die:function(t){if(void 0===t&&(t=!0),!this.isDead){this.isDead=!0,this.isDieOver=!1,this.node.stopAllActions(),n.GValue.EntityWorld.addKillCount(),n.GValue.EntityWorld.removeEnemy(this,this.isBoss),this.moveCom.player=null,this.shadow.active=!1,this.attrCom.die();var e=this;this.uiNode.runAction(cc.sequence(cc.scaleTo(3*a.GConfig.actionFrameTime,.4),cc.callFunc(function(){var t=e.uiNode.getChildByName("tail");t&&t.removeFromParent();var i=e.node.position.add(n.GValue.EntityWorld.mapMgr.mapTop.position);i=i.mul(n.GValue.MapScale),!e.hasAttribution(s.EnemyAttr.Gold)&&e.data.cData.dropGold>0&&n.GValue.EntityWorld.playGoldFlyEffect(3,e.data.cData.dropGold,i),e.uiNode.stopAllActions(),e.uiNode.active=!1,e.uiCom.die()}))),this._animCom.addAnimAct(s.EnemyAnim.Die,cc.Vec2.ZERO,0,function(){e.isDieOver=!0,e.followWeapon&&e.followWeapon.node.removeFromParent(),n.GValue.EntityWorld.addEntitySys.removeEnemy(e.node)}),n.GValue.EntityWorld.shake(),l.GSDK.virbrate(!1),c.GAudio.playSound(c.Enum_Audio.enemyDie),t&&this._dropCom.die();var i=this.uiNode.getChildByName("gold");i&&i.removeFromParent(),this.callback_bossDie&&this.callback_bossDie()}},removeSelf:function(){this.isDead=!0,this.node.stopAllActions(),n.GValue.EntityWorld.addKillCount(),n.GValue.EntityWorld.removeEnemy(this,this.isBoss),this.moveCom.player=null,this.shadow.active=!1,this.uiNode.active=!1;var t=this.uiNode.getChildByName("gold");t&&t.removeFromParent();var e=this.uiNode.getChildByName("tail");e&&e.removeFromParent(),this.followWeapon&&this.followWeapon.node.removeFromParent(),n.GValue.EntityWorld.addEntitySys.removeEnemy(this.node)},getColRadiusForImage:function(t){var e=66;switch(t){case 5:e=90;break;case 6:e=38;break;case 200:e=76;break;case 201:e=58;break;case 202:case 203:e=50;break;case 1001:e=100}return e},isFullBlood:function(){return this._curBlood>=this.data.blood},thronShow:function(t){this._animCom.setThronShow(t)},isSleep:function(){return this.stateCom.state==s.EnemyAction.Sleep},removeAnim:function(t){this._animCom.removeAnimAct(t)},addAnim:function(t){this._animCom.addAnimAct(t)},hasAttribution:function(t){return!!this.attrCom&&o.DYTools.arrContain(this.attrCom.attr,t)},getAttrParam:function(t){return this.attrCom?this.attrCom.attrData[t]:null},hasBuff:function(t){return this.buffCom.hasBuff(t)},addBuff:function(t){this.buffCom.addBuff(t)},removeBuff:function(t){this.buffCom.removeBuff(t)},setCurDir:function(t){this.moveCom&&this.moveCom.setCurDir(t.normalize())}}),cc._RF.pop()},{CommonAudio:"CommonAudio",CommonConfig:"CommonConfig",CommonSdk:"CommonSdk",CommonValue:"CommonValue",EnemyBase:"EnemyBase",EnemyCollisionWallListener:"EnemyCollisionWallListener",EnemyUIComponent:"EnemyUIComponent",GameData:"GameData",Tools:"Tools",Types:"Types"}],EntityFollowEnemy:[function(t,e,i){"use strict";cc._RF.push(e,"87190XkaThPTrgCStEmIQXY","EntityFollowEnemy");var o=t("CEntityBase"),n=t("Tools"),s=t("CEntityKnife");cc.Class({extends:o,properties:{},ctor:function(){this.enemy=null,this.knivesCmp=null,this.heroRotate=null},init:function(t){this.enemy=t,n.DYTools.addScript(this.node,"CMoveWithOwnerNode").init(this.node.parent,this,this.enemy,cc.v2(0,-6)),this.knivesCmp=n.DYTools.addScript(this.node,"BossKnivesComponent"),this.knivesCmp.init(t),this.heroRotate=n.DYTools.addScript(this.node,"CHRotate"),this.heroRotate.setRotateSpeed(-300)},die:function(){this.node.active=!1;for(var t=0,e=this.knivesCmp.knives;t<e.length;t++)e[t].getComponent(s.CEntityKnife).shadow.active=!1},updateGameLogic:function(t){this.heroRotate.updateGameLogic(t)}}),cc._RF.pop()},{CEntityBase:"CEntityBase",CEntityKnife:"CEntityKnife",Tools:"Tools"}],EntityPlayerDeputyFollow:[function(t,e,i){"use strict";cc._RF.push(e,"f2fe65HvD5EZKnPLQak7TzD","EntityPlayerDeputyFollow");var o=t("CEntityBase"),n=t("GameData"),s=t("Tools"),a=t("CommonConfig"),c=t("Types");cc.Class({extends:o,properties:{},ctor:function(){},init:function(t){this.dwId=0,this.rotateAble=!0,this.player=t,s.DYTools.addScript(this.node,"CMoveWithOwnerNode").init(this.node.parent,this,this.player),this.setWeapon(n.TData.getCurSubFun()),this.node.on("enterStrong",this.enterStrong,this)},setWeapon:function(t){if(this.dwId!=t){this.dwId=t;var e=!1;this.dwCom&&(this.dwCom.removeSelf(),this.dwCom=null,e=!0);var i=this,o=function(){switch(i.dwId){case c.DWType.Knife:i.dwCom=s.DYTools.addScript(i.node,"PlayerDWKnifeComponent"),i.dwCom.init(i,i.dwId);break;case c.DWType.Laser:console.log("Laser"),i.dwCom=s.DYTools.addScript(i.node,"PlayerDWLaserComponent"),i.dwCom.init(i);break;case c.DWType.Ice:console.log("Ice"),i.dwCom=s.DYTools.addScript(i.node,"PlayerDWIceComponent"),i.dwCom.init(i,i.dwId);break;case c.DWType.Fire:console.log("Fire"),i.dwCom=s.DYTools.addScript(i.node,"PlayerDWFireComponent"),i.dwCom.init(i,i.dwId);break;case c.DWType.Electricity:i.dwCom=s.DYTools.addScript(i.node,"PlayerDWElectricityComponent"),i.dwCom.init(i)}i.setRotateSpeed(-n.TData.HRotateSpeedIn)};e?this.scheduleOnce(o,.1):o()}},updateGameLogic:function(t){this.dwCom&&this.rotateAble&&this.dwCom.updateGameLogic&&this.dwCom.updateGameLogic(t)},enterStrong:function(t){this.dwCom&&this.dwCom.enterStrong&&this.dwCom.enterStrong(t)},die:function(){this.node.active=!1,this.dwCom&&this.dwCom.die&&this.dwCom.die()},revive:function(){this.node.active=!0,this.dwCom&&this.dwCom.die&&this.dwCom.die(),this.node.scale=.7,this.node.runAction(cc.scaleTo(4*a.GConfig.actionFrameTime,1))},setRotateSpeed:function(t){this.dwCom&&this.dwCom.setRotateSpeed&&this.dwCom.setRotateSpeed(t)},setHurtRatio:function(t){this.dwCom&&this.dwCom.setHurtRatio&&this.dwCom.setHurtRatio(t)},addKnife:function(t){this.dwCom||(this.dwCom=s.DYTools.addScript(this.node,"PlayerDWKnifeComponent"),this.dwCom.init(this,this.dwId,!0),this.setRotateSpeed(-n.TData.HRotateSpeedIn)),this.dwCom&&this.dwCom.addKnife&&this.dwCom.addKnife(t)},getKnives:function(){return this.dwCom&&this.dwCom.getKnives?this.dwCom.getKnives():[]},setShadowOpacity:function(t){this.dwCom&&this.dwCom.setShadowOpacity&&this.dwCom.setShadowOpacity(t)}}),cc._RF.pop()},{CEntityBase:"CEntityBase",CommonConfig:"CommonConfig",GameData:"GameData",Tools:"Tools",Types:"Types"}],EntityProp:[function(t,e,i){"use strict";cc._RF.push(e,"7b64aFT0CZD77qSgyBBysC2","EntityProp");var o=t("CommonValue"),n=t("CEntityBase"),s=t("Tools");cc.Class({extends:n,properties:{propSpr:cc.Sprite},ctor:function(){this.propSpr=null,this.propId=0,this._moveFixCom=null},create:function(t){this.propId=t,this.propSpr.spriteFrame=o.GValue.Atlas_Game.getSpriteFrame("prop"+t),s.DYTools.addScript(this.node,"PropCollisionWallListener"),this._moveFixCom=s.DYTools.addScript(this.node,"PropMoveFix"),this._moveFixCom.init(this,400,cc.v2(1,1),10)},updateGameLogic:function(t){this._moveFixCom&&this._moveFixCom.updateGameLogic(t)},willRemove:function(){this.node.stopAllActions(),this._moveFixCom=null,this.node.removeComponent("PropMoveFix")}}),cc._RF.pop()},{CEntityBase:"CEntityBase",CommonValue:"CommonValue",Tools:"Tools"}],GameData:[function(t,e,i){"use strict";cc._RF.push(e,"be1affDQMtL55AvBHAk4LwI","GameData");var o=e.exports,n=t("CommonConfig"),s=t("CommonEnum"),a=t("CommonValue"),c=t("CommonFunc"),r=t("Tools"),l=t("CommonSdk"),h=t("Types"),d=function(){function t(){this.loginTime=0,this.stage=1,this.gold=260,this.power=0,this.time_power=0,this.offlineGold=600,this.time_offlineGold=0,this.time_offlineGoldGet=0,this.propertys={},this.propertys_sub={},this.list_sub=[],this.list_newsub=[],this.cur_sub=0,this.list_guide=[],this.passStage=0,this.hasGiftGold=0,this.hasGiftPower=0,this.todayGiftGoldCount=0,this.todayGiftPowerCount=0,this.todayArmsSubTryCount=0,this.addProgram_hasGet=0,this.addProgram_enter=0,this.official_timestamp=0}return t.prototype.loadData=function(t){if(t.hasOwnProperty("loginTime")&&(this.loginTime=Number(t.loginTime)),t.hasOwnProperty("stage")&&(this.stage=parseInt(t.stage)),t.hasOwnProperty("gold")&&(this.gold=parseInt(t.gold)),t.hasOwnProperty("power")&&(this.power=parseInt(t.power)),t.hasOwnProperty("time_power")&&(this.time_power=parseInt(t.time_power)),t.hasOwnProperty("offlineGold")&&(this.offlineGold=parseInt(t.offlineGold)),t.hasOwnProperty("time_offlineGold")&&(this.time_offlineGold=parseInt(t.time_offlineGold)),t.hasOwnProperty("time_offlineGoldGet")&&(this.time_offlineGoldGet=parseInt(t.time_offlineGoldGet)),t.hasOwnProperty("propertys")){this.propertys={};var e=t.propertys;for(var i in e){var o=parseInt(i),n=parseInt(e[i]);this.propertys[o]=n}}if(t.hasOwnProperty("propertys_sub"))for(var i in this.propertys_sub={},e=t.propertys_sub){var s=parseInt(i);n=parseInt(e[i]),this.propertys_sub[s]=n}if(t.hasOwnProperty("list_sub")){this.list_sub=[];for(var a=t.list_sub,c=0;c<a.length;c++)this.list_sub.push(parseInt(a[c]))}if(t.hasOwnProperty("list_newsub"))for(this.list_newsub=[],a=t.list_newsub,c=0;c<a.length;c++)this.list_newsub.push(parseInt(a[c]));if(t.hasOwnProperty("cur_sub")&&(this.cur_sub=parseInt(t.cur_sub)),t.hasOwnProperty("list_guide"))for(this.list_guide=[],a=t.list_guide,c=0;c<a.length;c++)this.list_guide.push(parseInt(a[c]));t.hasOwnProperty("passStage")&&(this.passStage=parseInt(t.passStage)),t.hasOwnProperty("hasGiftGold")&&(this.hasGiftGold=parseInt(t.hasGiftGold)),t.hasOwnProperty("hasGiftPower")&&(this.hasGiftPower=parseInt(t.hasGiftPower)),t.hasOwnProperty("todayGiftGoldCount")&&(this.todayGiftGoldCount=parseInt(t.todayGiftGoldCount)),t.hasOwnProperty("todayGiftPowerCount")&&(this.todayGiftPowerCount=parseInt(t.todayGiftPowerCount)),t.hasOwnProperty("todayArmsSubTryCount")&&(this.todayArmsSubTryCount=parseInt(t.todayArmsSubTryCount)),t.hasOwnProperty("addProgram_hasGet")&&(this.addProgram_hasGet=parseInt(t.addProgram_hasGet)),t.hasOwnProperty("addProgram_enter")&&(this.addProgram_enter=parseInt(t.addProgram_enter)),t.hasOwnProperty("official_timestamp")&&(this.official_timestamp=parseInt(t.official_timestamp))},t}();o.LastData=d;var u=function(){function t(){this.shake=0,this.sound=1,this.music=1}return t.prototype.loadData=function(t){t.hasOwnProperty("shake")&&(this.shake=parseInt(t.shake)),t.hasOwnProperty("sound")&&(this.sound=parseInt(t.sound)),t.hasOwnProperty("music")&&(this.music=parseInt(t.music))},t}();o.SettingData=u;var m=function(){function t(){this.WeaponCount=6,this.HeroRaduis=140,this.HeroRotateSpeed=320,this.EnemyOffset=10,this.EnemyOffsetDegree=5,this.ThemeId=1,this.HRotateSpeedIn=320,this.HWeaponCountIn=6,this.HeroAttackIn=8,this.HeroRaduisIn=90,this.userId="",this.cidCode="",this.isNewPlayer=!1,this.registerTime=0,this.guideStep=0,this.firstRevive=0,this.name_version="version",this.name_cid="cid",this.name_UserId="UserID",this.name_RegisterTime="RegisterTime",this.name_FirstRevive="FirstRevive",this.name_LastData="LastData",this.name_guideStep="guideStep",this.LastData=new d,this.official_enter=0,this.SettingData=new u}return t.prototype.initData=function(){this.checkVersion(),this.isNewPlayer=!1,this.userId=this.getUserID(),this.readLastData(),this.readSettingData(),this.isNewPlayer&&this.setTimeOfflineGoldGet(c.GFunc.getCurTime(),!0)},t.prototype.checkVersion=function(){var t=this.getData(this.name_version);t&&""!=t?parseInt(t)<n.GConfig.VersionCode&&this.saveData(this.name_version,n.GConfig.VersionCode.toString()):this.saveData(this.name_version,n.GConfig.VersionCode.toString())},t.prototype.saveCid=function(t){this.cidCode=t,this.saveData(this.name_cid,this.cidCode)},t.prototype.getCid=function(){if(""==this.cidCode){var t=this.getData(this.name_cid);t&&""!=t&&(this.cidCode=t)}return this.cidCode},t.prototype.newDayRefresh=function(){r.DYTools.isLaterDay(1e3*this.LastData.loginTime)&&(console.warn("\u9694\u5929\u5237\u65b0"),this.LastData.todayArmsSubTryCount=0,this.LastData.todayGiftGoldCount=0,this.LastData.todayGiftPowerCount=0,this.LastData.hasGiftGold=0,this.LastData.hasGiftPower=0),this.LastData.loginTime=c.GFunc.getCurTime(),this.saveLastData()},t.prototype.dwAdjustStage=function(){var t=a.GValue.Dic_Sub_Level[h.DWType.Fire];this.getStage()>t&&this.addListSub(h.DWType.Fire),t=a.GValue.Dic_Sub_Level[h.DWType.Ice],this.getStage()>t&&this.addListSub(h.DWType.Ice),t=a.GValue.Dic_Sub_Level[h.DWType.Laser],this.getStage()>t&&this.addListSub(h.DWType.Laser),t=a.GValue.Dic_Sub_Level[h.DWType.Knife],this.getStage()>t&&this.addListSub(h.DWType.Knife)},t.prototype.saveData=function(t,e){try{cc.sys.localStorage.setItem(t,e)}catch(i){l.GSDK.saveData(t,e),r.DYTools.error("\u4fdd\u5b58\u6570\u636e\u51fa\u9519\u4e86--"+i,t,e),l.GSDK.sendSaveDataErr(t)}},t.prototype.getData=function(t){return cc.sys.localStorage.getItem(t)},t.prototype.readLastData=function(){var t=this.getData(this.name_LastData);if(t&&""!=t){var e=JSON.parse(t);this.LastData.loadData(e)}(t=this.getData(this.name_RegisterTime))&&""!=t&&(this.registerTime=Number(t)),(t=this.getData(this.name_FirstRevive))&&""!=t&&(this.firstRevive=parseInt(t)),(t=this.getData(this.name_guideStep))&&""!=t&&(this.guideStep=parseInt(t))},t.prototype.saveLastData=function(){var t=JSON.stringify(this.LastData);this.saveData(this.name_LastData,t),""!=this.userId&&this.saveData(this.name_UserId,this.userId)},t.prototype.clearLastData=function(){this.LastData=new d,this.saveLastData(),this.firstRevive=0,this.saveData(this.name_FirstRevive,this.firstRevive.toString()),this.guideStep=0,this.saveData(this.name_guideStep,this.guideStep.toString()),this.userId="",this.saveData(this.name_UserId,this.userId)},t.prototype.saveUserID=function(t){this.userId=t,this.saveData(this.name_UserId,this.userId)},t.prototype.getUserID=function(){if(""==this.userId){var t=this.getData(this.name_UserId);t&&(this.userId=t,r.DYTools.warn("uabc = "+this.userId))}return""==this.userId&&(this.isNewPlayer=!0,this.saveUserID(r.DYTools.getRandomUserId()),this.saveRegisterTime(),r.DYTools.warn("uabc = "+this.userId)),this.userId},t.prototype.saveRegisterTime=function(){this.registerTime=(new Date).getTime(),this.saveData(this.name_RegisterTime,this.registerTime.toString())},t.prototype.getRegisterTime=function(){var t=this.getData(this.name_RegisterTime);return t&&""!=t?Number(t):0},t.prototype.setGuideStep=function(t){this.guideStep=t,this.saveData(this.name_guideStep,this.guideStep.toString())},t.prototype.getGuideStep=function(){return this.guideStep},t.prototype.isFirstRevive=function(){return 0==this.firstRevive},t.prototype.setFirstRevive=function(){this.firstRevive=1,this.saveData(this.name_FirstRevive,this.firstRevive.toString())},t.prototype.getHasGiftGold=function(){return!0},t.prototype.setHasGiftGold=function(t,e){void 0===e&&(e=!1);var i=t?1:0;this.LastData.hasGiftGold=i,e&&this.saveLastData()},t.prototype.getTodayGiftGoldCount=function(){return this.LastData.todayGiftGoldCount},t.prototype.setTodayGiftGoldCount=function(t,e){void 0===e&&(e=!1),this.LastData.todayGiftGoldCount=t,e&&this.saveLastData()},t.prototype.getHasGiftPower=function(){return!!this.LastData.hasGiftPower},t.prototype.setHasGiftPower=function(t,e){void 0===e&&(e=!1);var i=t?1:0;this.LastData.hasGiftPower=i,e&&this.saveLastData()},t.prototype.getTodayGiftPowerCount=function(){return this.LastData.todayGiftPowerCount},t.prototype.setTodayGiftPowerCount=function(t,e){void 0===e&&(e=!1),this.LastData.todayGiftPowerCount=t,e&&this.saveLastData()},t.prototype.getTodayArmsSubTryCount=function(){return this.LastData.todayArmsSubTryCount},t.prototype.setTodayArmsSubTryCount=function(t,e){void 0===e&&(e=!1),this.LastData.todayArmsSubTryCount=t,e&&this.saveLastData()},t.prototype.getGold=function(){return this.LastData.gold},t.prototype.setGold=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),t<0&&(t=0),this.LastData.gold=t,e&&this.saveLastData(),a.GValue.HomeUI&&a.GValue.HomeUI.refresh_gift_gold(),i&&a.GValue.HomeUI&&a.GValue.HomeUI.refreshGold()},t.prototype.isPowerFull=function(){var t=parseInt(n.GConfig.getGbData(s.Enum_Gb.PowerMax));return this.LastData.power>=t},t.prototype.getPower=function(){return this.LastData.power},t.prototype.setPower=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),this.LastData.power=t,e&&this.saveLastData(),a.GValue.HomeUI&&a.GValue.HomeUI.refresh_gift_power(),i&&a.GValue.HomeUI&&a.GValue.HomeUI.refreshPower()},t.prototype.usePower=function(t,e){void 0===e&&(e=!1);var i=!1;if(this.LastData.power>=t){i=!0;var o=parseInt(n.GConfig.getGbData(s.Enum_Gb.PowerMax)),r=this.LastData.power>=o;this.LastData.power-=t,r&&!(r=this.LastData.power>=o)&&(a.GValue.PowerTime=parseInt(n.GConfig.getGbData(s.Enum_Gb.PowerRecoverTime)),this.LastData.time_power=c.GFunc.getCurTime()),e&&this.saveLastData()}return a.GValue.HomeUI&&a.GValue.HomeUI.refresh_gift_power(),i},t.prototype.getTimePower=function(){return this.LastData.time_power},t.prototype.setTimePower=function(t,e){void 0===e&&(e=!1),this.LastData.time_power=t,e&&this.saveLastData()},t.prototype.getOfflineGold=function(){return this.LastData.offlineGold},t.prototype.setOfflineGold=function(t,e){void 0===e&&(e=!1),this.LastData.offlineGold=t,e&&this.saveLastData()},t.prototype.getTimeOfflineGold=function(){return this.LastData.time_offlineGold},t.prototype.setTimeOfflineGold=function(t,e){void 0===e&&(e=!1),this.LastData.time_offlineGold=t,e&&this.saveLastData()},t.prototype.getTimeOfflineGoldGet=function(){return this.LastData.time_offlineGoldGet},t.prototype.setTimeOfflineGoldGet=function(t,e){void 0===e&&(e=!1),this.LastData.time_offlineGoldGet=t,e&&this.saveLastData()},t.prototype.getStage=function(){return this.LastData.stage},t.prototype.setStage=function(t,e){void 0===e&&(e=!1);var i=!1;return n.GConfig.getLevelData(t)&&this.LastData.stage!=t&&(this.LastData.stage=t,i=!0),e&&this.saveLastData(),i},t.prototype.getMaxPassStage=function(){return this.LastData.passStage},t.prototype.setMaxPassStage=function(t){this.LastData.passStage=t},t.prototype.getPropertyLv=function(t){var e=this.LastData.propertys[t];return e||1},t.prototype.setPropertyLv=function(t,e,i){void 0===i&&(i=!1),this.LastData.propertys[t]=e,i&&this.saveLastData()},t.prototype.getPropertyLv_Sub=function(t){var e=this.LastData.propertys_sub[t];return e||1},t.prototype.setPropertyLv_Sub=function(t,e,i){void 0===i&&(i=!1),this.LastData.propertys_sub[t]=e,i&&this.saveLastData()},t.prototype.getListSub=function(){return this.LastData.list_sub},t.prototype.getListNewSub=function(){return this.LastData.list_newsub},t.prototype.clearListNewSub=function(t){void 0===t&&(t=!1),this.LastData.list_newsub=[],t&&this.saveLastData()},t.prototype.addListSub=function(t,e){if(void 0===e&&(e=!1),!r.DYTools.arrContain(this.LastData.list_sub,t)){for(var i=!1,o=0;o<this.LastData.list_sub.length;o++)if(t<this.LastData.list_sub[o]){this.LastData.list_sub.splice(o,0,t),i=!0;break}i||this.LastData.list_sub.push(t),r.DYTools.arrContain(this.LastData.list_newsub,t)||1!=this.LastData.list_sub.length&&this.LastData.list_newsub.push(t),1==this.LastData.list_sub.length&&(this.LastData.cur_sub=t),e&&this.saveLastData()}},t.prototype.getCurSubFun=function(){return this.LastData.cur_sub},t.prototype.setCurSubFun=function(t,e){void 0===e&&(e=!1),this.LastData.cur_sub=t,r.DYTools.arrRemove(this.LastData.list_newsub,t),e&&this.saveLastData(),a.GValue.HomeUI.refreshBtnShow(),a.GValue.HomeUI.initSkin()},t.prototype.getCurSubIndex=function(){return this.LastData.list_sub.indexOf(this.LastData.cur_sub)},t.prototype.getSubFunByIndex=function(t){return t>=0&&t<this.LastData.list_sub.length?this.LastData.list_sub[t]:-1},t.prototype.finishGuide=function(t,e){void 0===e&&(e=!1),this.isGuideFinish(t)||this.LastData.list_guide.push(t),e&&this.saveLastData()},t.prototype.isGuideFinish=function(t){return-1!=this.LastData.list_guide.indexOf(t)},t.prototype.get_addProgram_hasGet=function(){return this.LastData.addProgram_hasGet},t.prototype.set_addProgram_hasGet=function(t){this.LastData.addProgram_hasGet=t,this.saveLastData()},t.prototype.get_addProgram_enter=function(){return this.LastData.addProgram_enter},t.prototype.set_addProgram_enter=function(t){this.LastData.addProgram_enter=t},t.prototype.get_official_enter=function(){return 1==this.official_enter},t.prototype.set_official_enter=function(t){this.official_enter=t},t.prototype.get_official_time=function(){return this.LastData.official_timestamp},t.prototype.set_official_time=function(t){this.LastData.official_timestamp=t,this.saveLastData()},t.prototype.readSettingData=function(){var t=this.getData("SettingData");if(t&&""!=t){var e=JSON.parse(t);this.SettingData.loadData(e)}},t.prototype.saveSettingData=function(){var t=JSON.stringify(this.SettingData);this.saveData("SettingData",t)},t.prototype.setSettingShake=function(t){this.SettingData.shake=t},t.prototype.setSettingSound=function(t){this.SettingData.sound=t},t.prototype.setSettingMusic=function(t){this.SettingData.music=t},t.instance=new t,t}();o.GameData=m,o.TData=m.instance,cc._RF.pop()},{CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonSdk:"CommonSdk",CommonValue:"CommonValue",Tools:"Tools",Types:"Types"}],GameUI:[function(t,e,i){"use strict";var o;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"25b77zckYRCDoPhDJYRsk1r","GameUI");var s=t("CommonValue"),a=t("Tools"),c=t("CommonEnum"),r=t("CommonFunc"),l=t("CommonConfig"),h=t("CommonAudio"),d=t("Types");cc.Class({extends:cc.Component,properties:(o={gameNode:cc.Node,topNode:cc.Node,progNode:cc.Node,goldNode:cc.Node,goldIcon:cc.Node,goldNum:cc.Node,effectNode:cc.Node,backNode:cc.Node,curLevNum:cc.Node,proNode:cc.Node,proSpr:cc.Sprite,curPro:cc.Node,propNode:cc.Node,strongNode:cc.Node,strongSpr:cc.Sprite,slowNode:cc.Node,slowSpr:cc.Sprite,goldPNode:cc.Node,goldPSpr:cc.Sprite,fingerNode:cc.Node,skel_finger:sp.Skeleton,enemyNode:cc.Node,enemyBg:cc.Node,enemyFont:cc.Node,enemyIconWarn:{default:[],type:[cc.Node]}},n(o,"propNode",cc.Node),n(o,"enemyFontShadow",cc.Node),n(o,"bossNode",cc.Node),n(o,"bossTipNode",cc.Node),n(o,"bossTips",cc.Label),n(o,"blackNode",cc.Node),n(o,"pf_num",cc.Prefab),n(o,"atlas_ui",cc.SpriteAtlas),o),onLoad:function(){this.enemyIconWarn=[],this.killCount=0,this.goldCount=0,this._goldNum=null,this._goldList=[],this._pauseArr=[],this.fingerCall=null,this._bossTipOver=!1,this._bossTipCall=null,this._blockList=[],this.backNode.active=l.GConfig.isCheat,this.goldPos=[cc.v2(-60,80),cc.v2(-70,60),cc.v2(-80,70),cc.v2(-60,-80),cc.v2(-76,-70),cc.v2(-80,-60),cc.v2(60,80),cc.v2(70,60),cc.v2(80,70),cc.v2(60,-80),cc.v2(76,-70),cc.v2(80,-60)],window.isSendPointPage||(window.isSendPointPage=!0)},onEnable:function(){window.xmgame.hideBanner()},onDisable:function(){},start:function(){r.GFunc.adjustScreen(this.node),this.topNode.y=.5*s.GValue.Size_View.height/this.node.scale,this.progNode.y=.5*s.GValue.Size_View.height/this.node.scale-140,this.goldNode.y=.5*s.GValue.Size_View.height/this.node.scale-190,this.propNode.y=.5*s.GValue.Size_View.height/this.node.scale-190,this.curLevNum.parent.y=.5*s.GValue.Size_View.height/this.node.scale-70,this._goldNum=a.DYTools.createPrefabCom(this.goldNum,this.pf_num,"PfNum"),this._goldNum.setParam(c.Enum_Num.Blood,cc.v2(.5,.5),2,this.atlas_ui),this._goldNum.node.scale=.5,this.refreshKillCountDisplay(),this.refreshGoldNumDisplay();var t=a.DYTools.createPrefabCom(this.curLevNum,this.pf_num,"PfNum");t.setParam(c.Enum_Num.Level,cc.v2(.5,.5),2,this.atlas_ui),t.setNum(s.GValue.EntityWorld.curLevel),this.curLevNum.width=t.size.width,s.GValue.Has_TopBar&&(this.topNode.y-=44,this.progNode.y-=44,this.goldNode.y-=44,this.curLevNum.parent.y-=44,this.propNode.y-=44)},onGameBack:function(){s.GValue.DDSDK&&(s.GValue.DDSDK.parent=null),s.GValue.HomeUI=null,cc.director.loadScene("Game")},onStopMap:function(){s.GValue.EntityWorld.mapStop=!s.GValue.EntityWorld.mapStop},onBtnTip:function(){this._bossTipOver&&this.hideBossTips()},startGame:function(t){for(var e=s.GValue.EntityWorld.mapMgr.totalDistance,i=0;i<t.length;i++){var o=new cc.Node;o.x=this.proSpr.node.x+this.proSpr.node.width*(t[i].x/e-.5),this.proNode.addChild(o),o.addComponent(cc.Sprite).spriteFrame=this.atlas_ui.getSpriteFrame("pause"+t[i].y),this._pauseArr.push(o)}},pauseEnemyFinish:function(t){if(this._pauseArr[t-1]){var e=new cc.Node;this._pauseArr[t-1].addChild(e),e.addComponent(cc.Sprite).spriteFrame=this.atlas_ui.getSpriteFrame("pFinish"),this._pauseArr.push(e)}},addKillCount:function(){this.killCount++,this.refreshKillCountDisplay()},refreshKillCountDisplay:function(){},addGoldCount:function(t){this.goldCount+=t,this.refreshGoldNumDisplay()},refreshGoldNumDisplay:function(){this._goldNum.setNum(this.goldCount),this.goldNum.width=this._goldNum.size.width*this._goldNum.node.scale},refreshDisPro:function(t){this.proSpr.fillRange=t,this.curPro.x=this.proSpr.node.x+this.proSpr.node.width*(-.5+t)},showPropProgress:function(t){switch(t){case d.PropType.Strong:this.strongNode.active=!0,this.strongSpr.fillRange=1;break;case d.PropType.Slow:this.slowNode.active=!0,this.slowSpr.fillRange=1;break;case d.PropType.Gold:this.goldPNode.active=!0,this.goldPSpr.fillRange=1}},refreshPropProgress:function(t,e){switch(t){case d.PropType.Strong:this.strongNode.active=!0,this.strongSpr.fillRange=e,e<=0&&(this.strongNode.active=!1);break;case d.PropType.Slow:this.slowNode.active=!0,this.slowSpr.fillRange=e,e<=0&&(this.slowNode.active=!1);break;case d.PropType.Gold:this.goldPNode.active=!0,this.goldPSpr.fillRange=e,e<=0&&(this.goldPNode.active=!1)}},initEnterMapAct:function(){this.topNode.active=!1,this.curLevNum.parent.active=!1,this.progNode.active=!1,this.goldNode.active=!1},playGameStartAct:function(t){this.initEnterMapAct();var e=l.GConfig.actionFrameTime;this.blackNode.active=!0,this.blackNode.opacity=0;var i=cc.fadeIn(5*e),o=cc.callFunc(function(){t&&t()}),n=cc.sequence(i,o);this.blackNode.runAction(n),this.playLevelShowAct()},playBlackHideAct:function(){this.blackNode.runAction(cc.sequence(cc.fadeOut(6*l.GConfig.actionFrameTime),cc.hide()))},playLevelShowAct:function(){var t=this.curLevNum.parent;t.active=!0,t.opacity=0,t.runAction(cc.fadeIn(7*l.GConfig.actionFrameTime))},playProgressShowAct:function(){this.progNode.active=!0,this.progNode.opacity=0,this.progNode.runAction(cc.fadeIn(5*l.GConfig.actionFrameTime)),this.goldNode.active=!0,this.goldNode.opacity=0,this.goldNode.runAction(cc.fadeIn(5*l.GConfig.actionFrameTime)),this.topNode.active=!0,this.topNode.opacity=0,this.topNode.runAction(cc.fadeIn(5*l.GConfig.actionFrameTime))},showFingerGuide:function(t){this.fingerCall=t,this.fingerNode.active=!0,this.skel_finger.setAnimation(0,"play",!0)},hideFingerGuide:function(){this.skel_finger.node.active=!1,this.fingerNode.active=!1},showEnemyCome:function(t){var e=this,i=l.GConfig.actionFrameTime;this.enemyBg.active=!1,this.enemyNode.active=!0,this.enemyFontShadow.active=!1,this.enemyFont.opacity=0,this.enemyFont.scale=2.7;var o=cc.scaleTo(4*i,.8),n=cc.fadeIn(4*i),s=cc.spawn(o,n),a=cc.scaleTo(3*i,1),c=cc.callFunc(function(){e.enemyFontShadow.active=!0,e.enemyFontShadow.opacity=255,e.enemyFontShadow.runAction(cc.spawn(cc.scaleTo(5*i,1.4),cc.fadeOut(5*i)))}),r=cc.sequence(s,a,c);this.enemyFont.runAction(r);for(var d=0,u=e.enemyIconWarn;d<u.length;d++)u[d].runAction(cc.sequence(s.clone(),a.clone()));this.scheduleOnce(function(){e.enemyBg.active=!0,e.enemyBg.scaleY=1.75;var t=cc.scaleTo(3*i,1,1);e.enemyBg.runAction(t)},2*i),this.scheduleOnce(function(){t&&t();var o=cc.scaleTo(6*i,1.08),n=cc.fadeTo(6*i,153),s=cc.spawn(o,n),a=cc.scaleTo(11*i,1),c=cc.fadeTo(11*i,255),r=cc.spawn(a,c),l=cc.repeat(cc.sequence(s,r),2),h=cc.sequence(l,cc.callFunc(function(){e.enemyFont.stopAllActions();var t=cc.scaleTo(3*i,1.37),o=cc.scaleTo(4*i,.7),n=cc.sequence(t,o);e.enemyFont.runAction(cc.sequence(n,cc.callFunc(function(){var t=cc.scaleTo(4*i,1,.3);e.enemyBg.runAction(cc.sequence(t,cc.fadeOut(i),cc.callFunc(function(){e.enemyNode.active=!1})))}),cc.fadeOut(i)));for(var s=0,a=e.enemyIconWarn;s<a.length;s++)a[s].runAction(cc.sequence(n.clone(),cc.fadeOut(i)))}));e.enemyFont.runAction(h);for(var d=0,u=e.enemyIconWarn;d<u.length;d++)u[d].runAction(l.clone())},15*i),h.GAudio.playSound(h.Enum_Audio.warning)},showBossCome:function(t){this.bossNode.active=!0;var e=l.GConfig.actionFrameTime,i=this,o=this.bossNode.getChildByName("bg");o.active=!1;var n=this.bossNode.getChildByName("font");n.opacity=0,n.scale=2.7;var s=cc.scaleTo(4*e,.8),a=cc.fadeIn(4*e),c=cc.spawn(s,a),r=cc.scaleTo(3*e,1),d=cc.callFunc(function(){var t=new cc.Node;t.parent=i.bossNode,t.addComponent(cc.Sprite).spriteFrame=n.getComponent(cc.Sprite).spriteFrame;var o=cc.scaleTo(5*e,1.5),s=cc.fadeOut(5*e),a=cc.spawn(o,s),c=cc.sequence(a,cc.removeSelf());t.runAction(c)}),u=cc.delayTime(5*e),m=cc.callFunc(function(){n.stopAllActions();var t=cc.scaleTo(3*e,1.08),i=cc.scaleTo(8*e,1),o=cc.fadeTo(8*e,204),s=cc.spawn(i,o),a=cc.fadeTo(4*e,255),c=cc.sequence(t,s,a);n.runAction(cc.repeat(c,2))}),p=cc.sequence(c,r,d,u,m);n.runAction(p),this.scheduleOnce(function(){o.active=!0,o.scaleY=1.75;var t=cc.scaleTo(3*e,1),i=cc.callFunc(function(){o.stopAllActions();var t=cc.place(cc.v2(0,0)),i=cc.moveBy(4*e,cc.v2(70,0)),n=cc.sequence(t,i);o.runAction(cc.repeatForever(n))});o.runAction(cc.sequence(t,i))},2*e),this.scheduleOnce(function(){n.stopAllActions();var t=cc.scaleTo(3*e,1.54),i=cc.scaleTo(2*e,1.8),o=cc.scaleTo(4*e,.75),s=cc.fadeOut(e),a=cc.sequence(t,i,o,s);n.runAction(a)},42*e),this.scheduleOnce(function(){o.stopAllActions();var t=cc.scaleTo(4*e,1,.18),i=cc.fadeTo(4*e,51),n=cc.spawn(t,i),s=cc.fadeOut(e),a=cc.sequence(n,s);o.runAction(a)},49*e),this.scheduleOnce(function(){t&&t()},36*e),this.showStoneDrop(),this.scheduleOnce(function(){i.showStoneDrop()},5*e),this.scheduleOnce(function(){i.showStoneDrop()},25*e),this.scheduleOnce(function(){i.showStoneDrop()},27*e),h.GAudio.playSound(h.Enum_Audio.warning)},showBossTips:function(t,e){this._bossTipCall=e,this.bossTips.string=t;var i=this;this._bossTipOver=!1;var o=l.GConfig.actionFrameTime;this.bossTipNode.active=!0;var n=this.bossTipNode.getChildByName("layer");n.zIndex=-10;var s=this.bossTipNode.getChildByName("top"),a=this.bossTipNode.getChildByName("bot"),c=this.bossTipNode.getChildByName("click");s.zIndex=10,a.zIndex=10,c.zIndex=1,n.active=!1,c.opacity=0,this.gameNode.runAction(cc.fadeOut(5*o)),s.y=s.y/this.node.scale;var r=s.position;s.y=750/this.node.scale,s.runAction(cc.moveTo(4*o,r)),a.y=a.y/this.node.scale,r=a.position,a.y=-750/this.node.scale,a.runAction(cc.moveTo(4*o,r)),this.scheduleOnce(function(){n.active=!0},4*o);var h=this.bossTipNode.getChildByName("tips");h.zIndex=1;var d=h.getChildByName("p"),u=h.getChildByName("l"),m=h.getChildByName("k"),p=m.getChildByName("f");d.active=!1,u.scaleY=0,m.active=!1,p.opacity=0,this.scheduleOnce(function(){d.active=!0,d.runAction(cc.sequence(cc.scaleTo(3*o,1.1),cc.scaleTo(4*o,1)))},6*o),this.scheduleOnce(function(){u.runAction(cc.scaleTo(3*o,1))},9*o),this.scheduleOnce(function(){m.active=!0,m.scaleX=.1,m.scaleY=.9;var t=cc.scaleTo(4*o,1.03,1),e=cc.scaleTo(3*o,1);m.runAction(cc.sequence(t,e))},12*o),this.scheduleOnce(function(){p.runAction(cc.fadeIn(4*o))},19*o),this.scheduleOnce(function(){var t=cc.sequence(cc.fadeIn(4*o),cc.callFunc(function(){i._bossTipOver=!0}));c.runAction(t)},31*o)},hideBossTips:function(){var t=this,e=this,i=l.GConfig.actionFrameTime,o=this.bossTipNode.getChildByName("click"),n=this.bossTipNode.getChildByName("top"),s=this.bossTipNode.getChildByName("bot"),a=this.bossTipNode.getChildByName("tips"),c=a.getChildByName("p"),r=a.getChildByName("l"),h=a.getChildByName("k");o.opacity=0;var d=cc.scaleTo(3*i,1.25,1.15),u=cc.scaleTo(3*i,.15,.8);h.runAction(cc.sequence(d,u,cc.fadeOut(0))),this.scheduleOnce(function(){r.runAction(cc.sequence(cc.scaleTo(3*i,1,0),cc.callFunc(function(){c.active=!1})));var e=cc.scaleTo(3*i,1,1.1),o=cc.moveTo(4*i,cc.v2(0,750/t.node.scale));n.runAction(cc.sequence(e,o)),e=cc.scaleTo(3*i,1,1.1),o=cc.moveTo(4*i,cc.v2(0,-750/t.node.scale)),s.runAction(cc.sequence(e,o))},7*i),this.scheduleOnce(function(){e.bossTipNode.getChildByName("layer").active=!1,e.gameNode.runAction(cc.sequence(cc.fadeIn(5*i),cc.callFunc(function(){e._bossTipCall&&e._bossTipCall(),e.bossTipNode.active=!1})))},13*i)},showStoneDrop:function(){for(var t=this,e=l.GConfig.actionFrameTime,i=s.GValue.Size_View.width/2,o=s.GValue.Size_View.height/2,n=a.DYTools.random_int(4,6),c=(2*i-20)/n,r=function(n){var r=h._blockList.pop();r?r.active=!0:(r=new cc.Node,h.effectNode.addChild(r),r.addComponent(cc.Sprite).spriteFrame=h.atlas_ui.getSpriteFrame("block"+s.GValue.EntityWorld.levelData.bgId)),r.zIndex=a.DYTools.random_int(0,10),r.angle=a.DYTools.random_int(0,360),r.scale=a.DYTools.random_int(6,10)/10,r.position=cc.v2(a.DYTools.random_int(10-i+c*n,10-i+c*(n+1)),o/h.node.scale+10);var l=a.DYTools.random_int(20,40)*e,d=cc.delayTime(a.DYTools.random_int(3*n,7*n)*e),u=cc.moveBy(l,cc.v2(0,2*-o-100)),m=cc.tintTo(l,16,42,71);r.runAction(cc.sequence(d,cc.spawn(u,m),cc.callFunc(function(){r.active=!1,t._blockList.push(r)})))},h=this,d=0;d<n;d++)r(d);for(n=a.DYTools.random_int(2,3),c=(2*i-100)/n,d=0;d<n;d++){var u=new cc.Node;u.zIndex=a.DYTools.random_int(0,10),this.effectNode.addChild(u),u.addComponent(cc.Sprite).spriteFrame=this.atlas_ui.getSpriteFrame("dust"),u.scaleY=a.DYTools.random_int(20,30)/10,u.position=cc.v2(a.DYTools.random_int(50-i+c*d,50-i+c*(d+1)),o/this.node.scale+u.height*u.scaleY);var m=cc.delayTime(a.DYTools.random_int(d,2*d)*e),p=a.DYTools.random_int(80,120)/100,f=cc.moveBy(p,cc.v2(0,-o-u.height*u.scaleY)),_=cc.scaleTo(p,1.8),y=cc.spawn(f,_),g=cc.fadeOut(.2),v=cc.moveBy(.2,cc.v2(0,-a.DYTools.random_int(220,360))),C=cc.spawn(g,v);u.runAction(cc.sequence(m,y,C,cc.removeSelf()))}},playGameOverAction:function(){this.curLevNum.parent.active=!1,this.proNode.runAction(cc.fadeOut(.2)),this.goldNode.runAction(cc.fadeOut(.2)),this.propNode.active=!1},playGoldFlyEffect:function(t,e,i){var o=this.goldIcon.convertToWorldSpaceAR(cc.v2(0,0)),n=i.y>s.GValue.ViewCenter.y?7:14;i=this.node.convertToNodeSpaceAR(i),o=this.node.convertToNodeSpaceAR(o);for(var c=l.GConfig.actionFrameTime,r=this,h=0,d=function(s){var l=u._goldList.pop(),d=null;l?(l.stopAllActions(),(d=l.getChildByName("gold")).stopAllActions(),d.scale=1):(l=new cc.Node,u.node.addChild(l),(d=new cc.Node).name="gold",l.addChild(d),d.addComponent(cc.Sprite).spriteFrame=u.atlas_ui.getSpriteFrame("gold")),l.scale=.9,l.position=i;var m=Math.floor(e/t);s==t-1&&(m=e-h),h+=m;var p=s%3;if(1==t&&(p=a.DYTools.random_int(0,2)),0==p){var f=cc.place(i.add(cc.v2(-3,5))),_=cc.moveTo(3*c,i.add(cc.v2(-63,-40))),y=cc.moveTo(5*c,i.add(cc.v2(-116,-73))),g=cc.moveTo(c*n,o),v=cc.sequence(f,_,y,g,cc.callFunc(function(){r.addGoldCount(m),l.position=cc.v2(-1e4,-1e4),r._goldList.push(l)}));l.runAction(v)}else if(1==p){f=cc.place(i.add(cc.v2(4,-5))),_=cc.moveTo(2*c,i.add(cc.v2(53,-34))),y=cc.moveTo(6*c,i.add(cc.v2(71,-62)));var C=cc.moveTo(c*n,o);v=cc.sequence(f,_,y,C,cc.callFunc(function(){r.addGoldCount(m),l.position=cc.v2(-1e4,-1e4),r._goldList.push(l)})),l.runAction(v)}else 2==p&&(f=cc.place(i.add(cc.v2(6,53))),_=cc.moveTo(3*c,i.add(cc.v2(-40,128))),y=cc.moveTo(6*c,i.add(cc.v2(-51,150))),g=cc.moveTo(c*n,o),v=cc.sequence(f,_,y,g,cc.callFunc(function(){r.addGoldCount(m),l.position=cc.v2(-1e4,-1e4),r._goldList.push(l)})),l.runAction(v));var S=cc.scaleTo(1*c,.68,1),D=cc.scaleTo(1*c,.38,1),T=cc.scaleTo(1*c,.15,1),G=cc.scaleTo(1*c,.58,1),A=cc.scaleTo(1*c,1,1);d.runAction(cc.repeat(cc.sequence(S,D,T,G,A),3))},u=this,m=0;m<t;m++)d(m)},playGoldEnemyDie:function(t,e){var i=this.node.convertToNodeSpaceAR(t),o=this.goldIcon.convertToWorldSpaceAR(cc.v2(0,0));o=this.node.convertToNodeSpaceAR(o);for(var n=this,s=(l.GConfig.actionFrameTime,[]),a=function(t){var a=c._goldList.pop();if(a)a.active=!0;else{a=new cc.Node,c.node.addChild(a);var r=new cc.Node;a.addChild(r),r.addComponent(cc.Sprite).spriteFrame=c.atlas_ui.getSpriteFrame("gold")}s.push(a),a.opacity=1,a.position=i,a.scale=1;var l=Math.floor(e/10);9==t&&(l=e-0),c.playSingleGold(a,t,o,function(){n.addGoldCount(l),a.active=!1,n._goldList.push(a)})},c=this,r=0;r<10;r++)a(r)},playSingleGold:function(t,e,i,o){var n=l.GConfig.actionFrameTime,s=cc.callFunc(function(){o&&o()});t.scale=.8;var a=cc.moveTo(7*n,i),c=cc.scaleTo(7*n,.7),r=cc.spawn(a,c),h=t.position;switch(e){case 0:t.position=h.add(cc.v2(-7,13)),t.opacity=255,t.angle=162;var d=cc.scaleTo(3*n,1),u=cc.moveTo(3*n,h.add(cc.v2(0,24))),m=cc.spawn(d,u),p=cc.scaleTo(6*n,.8),f=cc.moveTo(6*n,h.add(cc.v2(2,42))),_=cc.spawn(p,f);t.runAction(cc.sequence(m,_,cc.delayTime(n),r,s));break;case 1:t.position=h.add(cc.v2(-6,-3)),t.angle=162,t.opacity=255;var y=cc.scaleTo(2*n,.95),g=cc.moveTo(2*n,h.add(cc.v2(-31,-15))),v=cc.spawn(y,g),C=cc.scaleTo(9*n,.8),S=cc.moveTo(9*n,h.add(cc.v2(-89,-33))),D=cc.spawn(C,S);t.runAction(cc.sequence(v,D,cc.delayTime(n),r,s));break;case 2:t.position=h.add(cc.v2(-11,25)),t.opacity=255;var T=cc.scaleTo(2*n,1.02),G=cc.moveTo(2*n,h.add(cc.v2(-40,51))),A=cc.spawn(T,G),w=cc.scaleTo(2*n,.8),b=cc.moveTo(2*n,h.add(cc.v2(-105,75))),E=cc.spawn(w,b);t.runAction(cc.sequence(A,E,cc.delayTime(n),r,s));break;case 3:t.position=h.add(cc.v2(5,-5)),t.angle=49,t.opacity=255;var P=cc.scaleTo(2*n,.98),N=cc.moveTo(2*n,h.add(cc.v2(39,7))),k=cc.spawn(P,N),F=cc.scaleTo(3*n,.91),V=cc.moveTo(3*n,h.add(cc.v2(77,19))),x=cc.spawn(F,V),I=cc.scaleTo(3*n,.8),R=cc.moveTo(3*n,h.add(cc.v2(129,35))),B=cc.rotateTo(3*n,-94),M=cc.spawn(I,R,B);t.runAction(cc.sequence(k,x,M,cc.delayTime(n),r,s));break;case 4:t.position=h.add(cc.v2(14,14)),t.angle=162,t.opacity=255;var L=cc.scaleTo(2*n,1),O=cc.moveTo(2*n,h.add(cc.v2(31,43))),W=cc.spawn(L,O),Y=cc.scaleTo(4*n,.9),K=cc.moveTo(4*n,h.add(cc.v2(46,66))),H=cc.spawn(Y,K),U=cc.scaleTo(5*n,.8),z=cc.moveTo(5*n,h.add(cc.v2(54,82))),q=cc.spawn(U,z);t.runAction(cc.sequence(W,H,q,cc.delayTime(n),r,s));break;case 5:t.position=h.add(cc.v2(-2,7)),t.angle=162,t.opacity=255;var X=cc.scaleTo(2*n,.92),j=cc.moveTo(2*n,h.add(cc.v2(-44,24))),Z=cc.spawn(X,j),J=cc.scaleTo(3*n,.86),Q=cc.moveTo(3*n,h.add(cc.v2(-75,60))),$=cc.spawn(J,Q),tt=cc.scaleTo(8*n,.8),et=cc.moveTo(8*n,h.add(cc.v2(-82,76))),it=cc.spawn(tt,et);t.runAction(cc.sequence(Z,$,it,cc.delayTime(n),r,s));break;case 6:t.position=h.add(cc.v2(22,-7)),t.angle=86,t.opacity=255;var ot=cc.scaleTo(2*n,.9),nt=cc.moveTo(2*n,h.add(cc.v2(29,-14))),st=cc.spawn(ot,nt),at=cc.scaleTo(4*n,.86),ct=cc.moveTo(4*n,h.add(cc.v2(61,-17))),rt=cc.spawn(at,ct),lt=cc.scaleTo(8*n,.8),ht=cc.moveTo(8*n,h.add(cc.v2(90,-20))),dt=cc.spawn(lt,ht);t.runAction(cc.sequence(st,rt,dt,cc.delayTime(n),r,s));break;case 7:t.position=h.add(cc.v2(-1,-34)),t.angle=0,t.opacity=255;var ut=cc.scaleTo(2*n,.98),mt=cc.moveTo(2*n,h.add(cc.v2(1,-40))),pt=cc.spawn(ut,mt),ft=cc.scaleTo(5*n,.9),_t=cc.moveTo(5*n,h.add(cc.v2(22,-76))),yt=cc.spawn(ft,_t),gt=cc.scaleTo(5*n,.8),vt=cc.moveTo(5*n,h.add(cc.v2(34,-99))),Ct=cc.spawn(gt,vt);t.runAction(cc.sequence(pt,yt,Ct,cc.delayTime(n),r,s));break;case 8:t.position=h.add(cc.v2(-3,-16)),t.angle=30,t.opacity=255;var St=cc.scaleTo(2*n,.92),Dt=cc.moveTo(2*n,h.add(cc.v2(-30,-20))),Tt=cc.spawn(St,Dt),Gt=cc.scaleTo(4*n,.87),At=cc.moveTo(4*n,h.add(cc.v2(-53,-44))),wt=cc.spawn(Gt,At),bt=cc.scaleTo(5*n,.8),Et=cc.moveTo(5*n,h.add(cc.v2(-70,-62))),Pt=cc.spawn(bt,Et);t.runAction(cc.sequence(Tt,wt,Pt,cc.delayTime(n),r,s));break;case 9:t.position=h.add(cc.v2(17,-3)),t.angle=0,t.opacity=255;var Nt=cc.scaleTo(3*n,1.03),kt=cc.moveTo(3*n,h.add(cc.v2(34,28))),Ft=cc.spawn(Nt,kt),Vt=cc.scaleTo(3*n,.95),xt=cc.moveTo(3*n,h.add(cc.v2(48,42))),It=cc.spawn(Vt,xt),Rt=cc.scaleTo(9*n,.8),Bt=cc.moveTo(9*n,h.add(cc.v2(68,61))),Mt=cc.spawn(Rt,Bt);t.runAction(cc.sequence(Ft,It,Mt,cc.delayTime(n),r,s));break;case 10:t.position=h.add(cc.v2(10,-16)),t.angle=86,t.opacity=255;var Lt=cc.scaleTo(3*n,.95),Ot=cc.moveTo(3*n,h.add(cc.v2(39,-37))),Wt=cc.spawn(Lt,Ot),Yt=cc.scaleTo(9*n,.8),Kt=cc.moveTo(9*n,h.add(cc.v2(114,-83))),Ht=cc.spawn(Yt,Kt);t.runAction(cc.sequence(Wt,Ht,cc.delayTime(n),r,s));break;case 11:t.position=h.add(cc.v2(2,3)),t.angle=0,t.opacity=255;var Ut=cc.scaleTo(2*n,1),zt=cc.moveTo(2*n,h.add(cc.v2(-14,28))),qt=cc.spawn(Ut,zt),Xt=cc.scaleTo(4*n,.92),jt=cc.moveTo(4*n,h.add(cc.v2(-37,64))),Zt=cc.spawn(Xt,jt),Jt=cc.scaleTo(5*n,.8),Qt=cc.moveTo(5*n,h.add(cc.v2(-51,85))),$t=cc.spawn(Jt,Qt);t.runAction(cc.sequence(qt,Zt,$t,cc.delayTime(n),r,s))}}}),cc._RF.pop()},{CommonAudio:"CommonAudio",CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonValue:"CommonValue",Tools:"Tools",Types:"Types"}],GuideUI:[function(t,e,i){"use strict";cc._RF.push(e,"87f47bgkF5Oko6Ye4+1R+Xh","GuideUI");var o=t("CommonFunc"),n=t("GameData"),s=t("CommonEnum"),a=t("CommonConfig"),c=t("ConfigData"),r=(t("Tools"),t("PanelLevelGuide")),l=t("ADShareManager"),h=t("CommonValue");cc.Class({extends:cc.Component,properties:{node_shield:cc.Node,node_clickShield:cc.Node,node_hand:cc.Node,node_circle:cc.Node,node_rect:cc.Node,node_screen:cc.Node,node_popup:cc.Node,btn_clear:cc.Node,pf_panelLevelGuide:cc.Prefab},onLoad:function(){this.target=null,this.callback=null,this.cur_guideData=null;var t=this;o.GFunc.set_click(this.node_shield,function(){},this),o.GFunc.set_click(this.node_clickShield,function(){},this),o.GFunc.set_click(this.node_circle,function(){t.onClickGuide()},this),o.GFunc.set_click(this.node_rect,function(){t.onClickGuide()},this),o.GFunc.set_click(this.node_screen,function(){t.onClickGuide()},this),this.btn_clear.active=a.GConfig.isCheat,o.GFunc.set_click(this.btn_clear,function(){n.TData.clearLastData(),l.ADShareMgr.clearData(),h.GValue.DDSDK&&(h.GValue.DDSDK.parent=null),h.GValue.HomeUI=null,cc.director.loadScene("Launcher")},this)},init:function(){},checkGuide:function(t,e,i){var o=this.isGuideTrigger(t);return o?(this.cur_guideData=a.GConfig.getGuideData(t),this.callback=i,this.target=e,this.showUI(this.cur_guideData),o):o},isGuideTrigger:function(t){if(!a.GConfig.getGuideData(t))return!1;if(this.cur_guideData)return!1;if(n.TData.isGuideFinish(t))return!1;var e=!1;switch(t){case c.E_GuideId.ClickBtnSysMain:case c.E_GuideId.ClickBtnLvupMain:n.TData.getStage()>1&&1==n.TData.getPropertyLv(s.Enum_PropertyId.ArmsMain)&&o.GFunc.canPropertyLvup(s.Enum_PropertyId.ArmsMain)&&(e=!0);break;case c.E_GuideId.ClickBtnSysSub:case c.E_GuideId.ClickBtnLvupSub:1==n.TData.getListSub().length&&o.GFunc.isCanPropertyArmsSubLvupCurFun()&&(e=!0)}return e},showUI:function(t){var e=this,i=a.GConfig.actionFrameTime;this.node_shield.active=!0,this.node_clickShield.active=!1;var o=cc.v2(0,0);if(e.target){var n=e.target.convertToWorldSpaceAR(cc.v2(0,0));o=e.node.convertToNodeSpaceAR(n)}if(this.node_rect.active=!1,this.node_circle.active=!1,this.node_screen.active=!1,this.scheduleOnce(function(){if(t.uiClickDelay>0&&(e.node_clickShield.active=!0,e.scheduleOnce(function(){e.node_clickShield.active=!1},t.uiClickDelay)),t.uiType==c.E_GuideUIType.Circle){e.node_circle.active=!0,e.node_circle.stopAllActions(),e.node_circle.setPosition(o.add(t.uiEnd));var n=cc.callFunc(function(){e.node_rect.scale=1*t.uiScale}),s=cc.scaleTo(7*i,1.1*t.uiScale),a=cc.scaleTo(13*i,1*t.uiScale),r=cc.sequence(n,s,a),l=cc.repeatForever(r);e.node_circle.runAction(l)}else t.uiType==c.E_GuideUIType.Rect?(e.node_rect.active=!0,e.node_rect.stopAllActions(),e.node_rect.setPosition(o.add(t.uiEnd)),n=cc.callFunc(function(){e.node_rect.scale=1*t.uiScale}),s=cc.scaleTo(7*i,1.1*t.uiScale),a=cc.scaleTo(13*i,1*t.uiScale),r=cc.sequence(n,s,a),l=cc.repeatForever(r),this.node_rect.runAction(l)):t.uiType==c.E_GuideUIType.Screen?e.node_screen.active=!0:e.endGuide()},t.uiDelay),t.handShow){this.node_hand.active=!0,this.node_hand.stopAllActions(),this.node_hand.opacity=0,this.node_hand.setPosition(o.add(t.handStart));var s=cc.delayTime(i*t.handDelay),r=cc.moveTo(t.handMoveTime,o.add(t.handEnd)),l=cc.fadeTo(t.handMoveTime,255),h=cc.spawn(r,l),d=cc.callFunc(function(){var t=cc.scaleTo(7*i,.85),o=cc.scaleTo(8*i,1),n=cc.sequence(t,o),s=cc.repeatForever(n);e.node_hand.runAction(s)}),u=cc.sequence(s,h,d);this.node_hand.runAction(u)}else this.node_hand.active=!1},endGuide:function(){if(this.cur_guideData){for(var t=0;t<this.cur_guideData.finishIdList.length;t++)n.TData.finishGuide(this.cur_guideData.finishIdList[t]);this.cur_guideData=null}if(this.node_circle.active=!1,this.node_rect.active=!1,this.node_screen.active=!1,this.node_hand.active=!1,this.node_shield.active=!1,this.node_clickShield.active=!1,this.callback){var e=this.callback;this.callback=null,e()}},onClickGuide:function(){this.endGuide()},set_shield_state:function(t){this.node_shield.active=t},popup_panelLevelGuide:function(t){var e=cc.instantiate(this.pf_panelLevelGuide);if(e){var i=e.getComponent(r);i&&(this.node_popup.addChild(e),i.init(t))}}}),cc._RF.pop()},{ADShareManager:"ADShareManager",CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonValue:"CommonValue",ConfigData:"ConfigData",GameData:"GameData",PanelLevelGuide:"PanelLevelGuide",Tools:"Tools"}],Hawkeye:[function(t,e,i){"use strict";cc._RF.push(e,"bfb61BOTZ9NPLn2vbxubs0+","Hawkeye");var o=e.exports;Object.defineProperty(o,"__esModule",{value:!0});var n=t("CommonConfig"),s=t("GameData"),a=t("ConfigData"),c=t("ADShareManager"),r=t("CommonValue"),l=function(){this.gameId=14,this.userId="",this.registerTime=0,this.reportId="",this.level=0,this.cid=""},h=function(){function t(){this.Server_Report="https://manage.dadagem.xyz/report",this.Server_Param="https://manage.dadagem.xyz/manager/getConfig"}return t.prototype.initParam=function(){var t=this,e=cc.loader.getXMLHttpRequest();e.open("POST",this.Server_Param,!0),e.timeout=5e3,e.ontimeout=function(){}.bind(this),e.onreadystatechange=function(){var i=e.readyState,o=e.status;if(4==i&&200==o){var n=e.responseText,s=JSON.parse(n);t.dealParam(s)}};e.send(JSON.stringify({app:"xuanzhuandashi"}))},t.prototype.dealParam=function(t){var e="english_"+n.GConfig.Version_Num;if(t.hasOwnProperty(e)){var i=t[e];if(i.hasOwnProperty("advershare"))for(var o=i.advershare,s=0;s<o.length;s++)(l=new a.ADShareData).loadData(o[s]),c.ADShareMgr.addAdShareData(l);if(i.hasOwnProperty("share"))for(o=i.share,s=0;s<o.length;s++){var l;(l=new a.ShareData).loadData(o[s]),c.ADShareMgr.addShareData(l)}if(i.hasOwnProperty("global")){for(o=i.global,s=0;s<o.length;s++)n.GConfig.addGbData(parseInt(o[s].id),o[s].ver);c.ADShareMgr.initParam(),r.GValue.initCommonValue()}}},t.prototype.getHKData=function(){var t=new l;return t.userId=s.TData.getUserID(),t.registerTime=s.TData.getRegisterTime(),t.level=s.TData.getStage(),t.cid=s.TData.getCid(),t},t.prototype.sendReport=function(t){if(t){var e=JSON.stringify(t);this.sendMsg(e)}},t.prototype.sendLogin=function(){var t=this.getHKData();t.reportId="01",this.sendReport(t)},t.prototype.sendOnline=function(){var t=this.getHKData();t.reportId="02",this.sendReport(t)},t.prototype.sendStageTime=function(t,e){var i=this.getHKData();i.reportId="03-"+t+"-"+e,this.sendReport(i)},t.prototype.sendLoading=function(t){var e=this.getHKData();e.reportId="04-00-"+t,this.sendReport(e)},t.prototype.sendGuide=function(t){var e=this.getHKData();e.reportId="04-01-"+t,this.sendReport(e)},t.prototype.sendShareOut=function(t,e){var i=this.getHKData();i.reportId="05-00-"+t+"-"+e,this.sendReport(i)},t.prototype.sendShareIn=function(t,e,i){var o=this.getHKData();o.reportId="05-01-"+t+"-"+e+"-"+i,this.sendReport(o)},t.prototype.sendVideoShow=function(t){var e=this.getHKData();e.reportId="06-00-"+t,this.sendReport(e)},t.prototype.sendVideoPlay=function(t){var e=this.getHKData();e.reportId="06-01-"+t,this.sendReport(e)},t.prototype.sendVideoFinish=function(t){var e=this.getHKData();e.reportId="06-02-"+t,this.sendReport(e)},t.prototype.sendDieInfo=function(t,e){var i=this.getHKData();i.reportId="20-"+t+"-"+e,this.sendReport(i)},t.prototype.sendStageFail=function(t){var e=this.getHKData();e.reportId="21-"+t,this.sendReport(e)},t.prototype.sendWeaponLev=function(t,e,i,o){var n=this.getHKData();n.reportId="22-"+t+"-"+e+"-"+i+"-"+o,this.sendReport(n)},t.prototype.sendAdverCount=function(t){var e=this.getHKData();e.reportId="23-"+t,this.sendReport(e)},t.prototype.sendSaveDataErr=function(t){var e=this.getHKData();e.reportId="9999-"+t,this.sendReport(e)},t.prototype.sendGameErr=function(t){console.log("\u6e38\u620f\u9519\u8bef--"+t);var e=this.getHKData();e.reportId="9998-"+t,this.sendReport(e)},t.prototype.sendMsg=function(t){var e=cc.loader.getXMLHttpRequest();e.open("POST",this.Server_Report,!0),e.timeout=5e3,e.ontimeout=function(){}.bind(this),e.onreadystatechange=function(){var t=e.readyState,i=e.status;if(4==t&&200==i){var o=e.responseText;JSON.parse(o).msgId}},e.send(t)},t.instance=new t,t}();o.Hawkeye=h,o.HKReport=h.instance,cc._RF.pop()},{ADShareManager:"ADShareManager",CommonConfig:"CommonConfig",CommonValue:"CommonValue",ConfigData:"ConfigData",GameData:"GameData"}],HomeUI:[function(e,i,o){"use strict";var n;function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(i,"6cb0b/u0CJDUaACCMQIwm9Q","HomeUI");var a=e("CommonFunc"),c=e("CommonAudio"),r=e("GameData"),l=e("PfNum"),h=e("CommonEnum"),d=(e("ConfigData"),e("StageUI")),u=e("PropertyUI"),m=e("CommonValue"),p=e("CommonConfig"),f=e("Tools"),_=e("ADShareManager"),y=e("PanelOffline"),g=e("PanelPower"),v=e("PanelGold"),C=e("PfFrameAnim"),S=e("PanelCheat"),D=e("CommonSdk"),T=e("PanelAddProgram");cc.Class((s(n={extends:cc.Component,properties:{node_gray:cc.Node,node_shield:cc.Node,node_logo:cc.Node,node_stage:cc.Node,node_gold:cc.Node,node_gold_num:cc.Node,node_gold_icon:cc.Node,node_power:cc.Node,node_power_num:cc.Node,node_power_recover:cc.Node,label_powerTime:cc.Label,node_setting:cc.Node,btn_setting:cc.Node,btn_audio_on:cc.Node,btn_audio_off:cc.Node,btn_shake_on:cc.Node,btn_shake_off:cc.Node,bg_setting:cc.Node,node_bottom:cc.Node,btn_sys_arms1:cc.Node,btn_sys_arms1_bg:cc.Node,show_sys_arms1:cc.Node,show_sys_arms1_shadow:cc.Node,btn_sys_arms2:cc.Node,show_sys_arms2:cc.Node,btn_sys_gold:cc.Node,show_sys_gold:cc.Node,gift_power:cc.Node,gift_gold:cc.Node,node_property:cc.Node,node_right:cc.Node,btn_start:cc.Node,btn_start_layer:cc.Node,node_offline:cc.Node,btn_offline:cc.Node,sp_offline_full:cc.Sprite,sp_offline_recover_full:cc.Sprite,node_offline_font_full:cc.Node,node_offline_font_get:cc.Node,node_offline_num:cc.Node,icon_sys_arms1:cc.Node,icon_sys_arms2:cc.Node,icon_sys_gold:cc.Node,node_addprogram:cc.Node,pf_addprogram:cc.Prefab,node_ap_gold:cc.Node,node_ap_power:cc.Node,node_official:cc.Node,node_cheat:cc.Node,node_player:cc.Node,show_player:cc.Node,effect_player:cc.Node,skel_gold_up:sp.Skeleton,skel_gold_lvup:sp.Skeleton,skel_sub_lvup:sp.Skeleton,pf_num:cc.Prefab,pf_stage:cc.Prefab,pf_property:cc.Prefab,pf_panelOffline:cc.Prefab,pf_panelPower:cc.Prefab,pf_panelGold:cc.Prefab,pf_panelCheat:cc.Prefab,atlas_gameui:cc.SpriteAtlas,atlas_homeui:cc.SpriteAtlas,atlas_property:cc.SpriteAtlas,skel_main_lvup_circle:sp.SkeletonData,skel_main_lvup_shine:sp.SkeletonData,node_btn:cc.Node,node_cost:cc.Node,btn_lvup:cc.Node,node_btn_max:cc.Node,sp_icon_gold:cc.Sprite,sp_btn_lvup:cc.Sprite,node_costNum:cc.Node,node_btn_2:cc.Node,node_cost_2:cc.Node,btn_lvup_2:cc.Node,node_btn_max_2:cc.Node,sp_btn_lvup2:cc.Sprite,node_video:cc.Node,node_video_2:cc.Node,sp_icon_gold_2:cc.Sprite,node_costNum_2:cc.Node,btn_skin:cc.Node},ctor:function(){var t=this;this.diffX_sys=80,this.diffY_sys=500,this.downY_propertySys=-50,this.isChangeSys=!1,this.PlayerSlowRatioCount=7,this.dic_sysBtnShow={},this.com_property=null,this.isLvup=!1,this.isStart=!0,this.isFirstProp=!1,this.color_value=cc.color(240,240,150),this.color_cost=cc.color(85,45,10),setTimeout(function(){t.isStart=!1},250)},initBtnNum:function(){var t=this,e=cc.instantiate(this.pf_num);this.node_costNum.addChild(e),this.com_cost=e.getComponent(l),this.com_cost.setParam(h.Enum_Num.Blood,cc.v2(0,.5),2,this.atlas_gameui),this.com_cost.setNum(0),e.scale=.5,a.GFunc.set_click(this.node_btn_max,function(){a.GFunc.showFloatTips("",t.atlas_homeui,"tip_font_lvfull")},this);var i=cc.instantiate(this.pf_num);this.node_costNum_2.addChild(i),this.com_cost2=i.getComponent(l),this.com_cost2.setParam(h.Enum_Num.Blood,cc.v2(0,.5),2,this.atlas_gameui),this.com_cost2.setNum(0),i.scale=.5,a.GFunc.set_click(this.node_btn_max_2,function(){a.GFunc.showFloatTips("",t.atlas_homeui,"tip_font_lvfull")},this),this.refreshBtnUi(h.Enum_PropertyId.ArmsMain,0,null),this.refreshSub()},refreshSub:function(){var t=r.TData.getCurSubFun();this.refreshBtnUi(h.Enum_PropertyId.ArmsSub,1,t),this.initSkin(),this.refreshBtnShow()},updatePlayerSlowRatio:function(){m.GValue.PlayerSlowRatio=m.GValue.PlayerSlowRatio-1/this.PlayerSlowRatioCount,m.GValue.PlayerSlowRatio<=.1&&(m.GValue.PlayerSlowRatio=.1)},refreshBtns:function(){r.TData.getGold(),this.cost,a.GFunc.changeAtlasSprite(this.atlas_property,this.sp_btn_lvup,"board_btn"),a.GFunc.changeAtlasSprite(this.atlas_property,this.sp_btn_lvup2,"board_btn"),a.GFunc.changeAtlasSprite(this.atlas_property,this.sp_icon_gold,"icon_gold"),a.GFunc.changeAtlasSprite(this.atlas_property,this.sp_icon_gold_2,"icon_gold"),this.com_cost&&(this.com_cost.color=this.color_cost),this.com_cost2&&(this.com_cost2.color=this.color_cost)},refreshBtnUi:function(t,e,i){var o=0==e?this.com_cost:this.com_cost2,n=0==e?this.node_costNum:this.node_costNum_2,s=0==e?this.node_cost:this.node_cost_2,c=0==e?this.node_btn:this.node_btn_2,l=0==e?this.node_btn_max:this.node_btn_max_2,d=0==e?this.node_video:this.node_video_2,u=m.GValue,_=null,y=!1,g=!1;if(t==h.Enum_PropertyId.ArmsMain)(_=p.GConfig.getPropertyData_Main())&&(this.lv=_.lv,this.value=_.atk,this.cost=_.gd),p.GConfig.getPropertyArmsMainData(this.lv+1)||(y=!0),u.HomeUI.change_arms1();else if(t==h.Enum_PropertyId.ArmsSub){if(f.DYTools.arrContain(r.TData.getListSub(),i))(_=p.GConfig.getPropertyData_Sub(i))&&(this.lv=_.lv,this.value=_.atk,this.cost=_.gd),p.GConfig.getPropertyArmsSubData(i,this.lv+1)||(y=!0),u.ArmsSub_TryFinish==_.fun&&(g=!0);else{var v=u.Dic_Sub_Level[i];v=v||0}u.HomeUI.com_property&&u.HomeUI.com_property.refresh_sublv()}else if(t==h.Enum_PropertyId.GoldKill)(_=p.GConfig.getPropertyData_GoldKill())&&(this.lv=_.lv,this.value=_.val,this.cost=_.gd),p.GConfig.getPropertyGoldKillData(this.lv+1)||(y=!0);else if(t==h.Enum_PropertyId.GoldOffline){(_=p.GConfig.getPropertyData_GoldOffline())&&(this.lv=_.lv,this.value=_.out,this.cost=_.gd),p.GConfig.getPropertyGoldOfflineData(this.lv+1)||(y=!0)}if(o){o.setString(a.GFunc.getNumK(this.cost));var C=o.size,S=n.x+C.width*o.node.scale;s.x=.5*-S,o.color=this.color_cost}y||g?(c.active=!1,l.active=!0):(c.active=!0,l.active=!1),this.cost>r.TData.getGold()?(s.active=!1,d.active=!0):(s.active=!0,d.active=!1),this.refreshBtns()},onClickBtnLvup:function(e,i){var o=this,n=null,s=p.GConfig;if(e==h.Enum_PropertyId.ArmsMain)(n=s.getPropertyData_Main())&&(this.lv=n.lv,this.value=n.atk,this.cost=n.gd),s.getPropertyArmsMainData(this.lv+1)||(l=!0),m.GValue.HomeUI.change_arms1();else if(e==h.Enum_PropertyId.ArmsSub){if(f.DYTools.arrContain(r.TData.getListSub(),i))(n=s.getPropertyData_Sub(i))&&(this.lv=n.lv,this.value=n.atk,this.cost=n.gd),s.getPropertyArmsSubData(i,this.lv+1)||(l=!0),m.GValue.ArmsSub_TryFinish==n.fun&&(t=!0);else{var c=m.GValue.Dic_Sub_Level[i];c=c||0}m.GValue.HomeUI.com_property&&m.GValue.HomeUI.com_property.refresh_sublv()}if(!this.isLvup){var l=this;if(r.TData.getGold()>=this.cost){if(this.isLvup=!0,this.scheduleOnce(function(){l.isLvup=!1},.5),e==h.Enum_PropertyId.ArmsSub)r.TData.setPropertyLv_Sub(i,this.lv+1),D.GSDK.sendSubLvup(i,this.lv+1),r.TData.getGuideStep()<h.Enum_GuideStep.SubUp&&r.TData.setGuideStep(h.Enum_GuideStep.SubUp);else if(e==h.Enum_PropertyId.ArmsMain){n=a.GFunc.getCurMainChange();r.TData.setPropertyLv(e,this.lv+1),D.GSDK.sendMainLvup(this.lv+1);var d=a.GFunc.getCurMainChange();n!=d&&(a.GFunc.changePlayerMainWeapon(),m.GValue.HomeUI.com_property.changeMain(n,d)),r.TData.getGuideStep()<h.Enum_GuideStep.MainUp&&r.TData.setGuideStep(h.Enum_GuideStep.MainUp)}else r.TData.setPropertyLv(e,this.lv+1);r.TData.setGold(r.TData.getGold()-this.cost),m.GValue.HomeUI.refreshGold(),a.GFunc.showFloatTips("Upgrade Success!"),this.play_audio_lvup(),this.refreshButtonsss()}else window.loadSuc=function(){if(o.isLvup=!0,o.scheduleOnce(function(){l.isLvup=!1},.5),e==h.Enum_PropertyId.ArmsSub)r.TData.setPropertyLv_Sub(i,o.lv+1),D.GSDK.sendSubLvup(i,o.lv+1),r.TData.getGuideStep()<h.Enum_GuideStep.SubUp&&r.TData.setGuideStep(h.Enum_GuideStep.SubUp);else if(e==h.Enum_PropertyId.ArmsMain){var t=a.GFunc.getCurMainChange();r.TData.setPropertyLv(e,o.lv+1),D.GSDK.sendMainLvup(o.lv+1);var n=a.GFunc.getCurMainChange();t!=n&&(a.GFunc.changePlayerMainWeapon(),m.GValue.HomeUI.com_property.changeMain(t,n)),r.TData.getGuideStep()<h.Enum_GuideStep.MainUp&&r.TData.setGuideStep(h.Enum_GuideStep.MainUp)}else r.TData.setPropertyLv(e,o.lv+1);m.GValue.HomeUI.refreshGold(),a.GFunc.showFloatTips("Upgrade Success!"),o.play_audio_lvup(),o.refreshButtonsss()},window.loadFail=null,window.xmgame.showVideo(function(){if(o.isLvup=!0,o.scheduleOnce(function(){l.isLvup=!1},.5),e==h.Enum_PropertyId.ArmsSub)r.TData.setPropertyLv_Sub(i,o.lv+1),D.GSDK.sendSubLvup(i,o.lv+1),r.TData.getGuideStep()<h.Enum_GuideStep.SubUp&&r.TData.setGuideStep(h.Enum_GuideStep.SubUp);else if(e==h.Enum_PropertyId.ArmsMain){var t=a.GFunc.getCurMainChange();r.TData.setPropertyLv(e,o.lv+1),D.GSDK.sendMainLvup(o.lv+1);var n=a.GFunc.getCurMainChange();t!=n&&(a.GFunc.changePlayerMainWeapon(),m.GValue.HomeUI.com_property.changeMain(t,n)),r.TData.getGuideStep()<h.Enum_GuideStep.MainUp&&r.TData.setGuideStep(h.Enum_GuideStep.MainUp)}else r.TData.setPropertyLv(e,o.lv+1);m.GValue.HomeUI.refreshGold(),a.GFunc.showFloatTips("Upgrade Success!"),o.play_audio_lvup(),o.refreshButtonsss()},function(){},function(){window.xmgame.showPanelLoad()})}},play_audio_lvup:function(){c.GAudio.playSound(c.Enum_Audio.lvup_arms)},refreshButtonsss:function(){var t=r.TData.getCurSubFun();this.refreshBtnUi(h.Enum_PropertyId.ArmsMain,0,null),this.refreshBtnUi(h.Enum_PropertyId.ArmsSub,1,t)},onLoad:function(){var t=this,e=this;a.GFunc.set_click(this.node_gray,function(){t.onClickLayerGray()},this),a.GFunc.set_click(this.node_offline,function(){t.onClickBtnOffline()},this),a.GFunc.set_click(this.gift_power,function(){t.onClickBtnGiftPower()},this),a.GFunc.set_click(this.gift_gold,function(){t.onClickBtnGiftGold()},this),a.GFunc.set_click(this.btn_setting,function(){e.onClickBtnSetting()},this),a.GFunc.set_click(this.btn_audio_on,function(){e.onClickBtnAudioOn()},this),a.GFunc.set_click(this.btn_audio_off,function(){e.onClickBtnAudioOff()},this),a.GFunc.set_click(this.btn_shake_on,function(){e.onClickBtnShakeOn()},this),a.GFunc.set_click(this.btn_shake_off,function(){e.onClickBtnShakeOff()},this),a.GFunc.set_click(this.btn_sys_arms1,function(){console.log("btn_sys_arms1"),t.node_btn_max.active?a.GFunc.showFloatTips("",e.atlas_homeui,"tip_font_lvfull"):e.onClickBtnLvup(h.Enum_PropertyId.ArmsMain,0)},this),a.GFunc.set_click(this.btn_sys_arms2,function(){t.node_btn_max_2.active?a.GFunc.showFloatTips("",e.atlas_homeui,"tip_font_lvfull"):e.onClickBtnLvup(h.Enum_PropertyId.ArmsSub,r.TData.getCurSubFun())},this),a.GFunc.set_click(this.btn_sys_gold,function(){e.onClickBtnSysGold()},this),a.GFunc.set_click(this.btn_start_layer,function(){e.onClickBtnStart()},this),this.resetSysIconAction(),a.GFunc.set_click(this.node_addprogram,function(){t.click_addprogram()},this),a.GFunc.set_click(this.btn_skin,function(){0==r.TData.getListSub().length?e.click_skin():e.onClickBtnSysArmsSub()},this),this.node_cheat.active=p.GConfig.isCheat,this.node_bottom.setPosition(cc.v2(0,.5*-m.GValue.Size_View.height)),this.initGameAgainAction(),setTimeout(function(){t.openOfflineWin()},300)},initSkin:function(){this.btn_skin.active=!0},click_skin:function(){var t=this,e=this;e.skin_id=1,window.loadSuc=function(){r.TData.addListSub(e.skin_id),a.GFunc.createPrefabByName("PanelNew",t.node,function(t){t.create(e.skin_id,cc.Vec2.ZERO,function(){})}),e.refreshPos()},window.loadFail=null,window.xmgame.showVideo(function(){r.TData.addListSub(e.skin_id),a.GFunc.createPrefabByName("PanelNew",t.node,function(t){t.create(e.skin_id,cc.Vec2.ZERO,function(){})}),e.refreshPos()},function(){},function(){window.xmgame.showPanelLoad()})},start:function(){var t=this;m.GValue.Has_TopBar&&(this.node_power.y-=44,this.node_gold.y-=44,this.node_setting.y-=44,this.scheduleOnce(function(){t.node_addprogram&&(t.node_addprogram.position=t.node_addprogram.position.add(cc.v2(10,-40)),f.DYTools.log("node_addprogram",t.node_addprogram.position))}))},init:function(){if(this.initGold(),this.initPower(),this.initOffline(),this.initSetting(),this.initStage(),this.initPropertySys(),this.refresh_gifts(),this.refresh_addprogram(),this.refresh_official(),this.isGameAgain()){if(this.hidePlayer(),m.GValue.GameOverGold>0){var t=this;this.playGoldEffect(m.GValue.GameOverGold,function(){t.playGameAgainAction()})}else this.playGameAgainAction();m.GValue.GameOverGold=-1}else this.endUiINAction();this.initBtnNum()},refresh_gifts:function(){this.refresh_gift_power(),this.refresh_gift_gold()},refresh_gift_power:function(){if(this.visible_gift_power(!1),r.TData.getHasGiftPower())this.visible_gift_power(!0);else{var t=r.TData.getPower(),e=parseInt(p.GConfig.getGbData(h.Enum_Gb.GiftPowerFallDown));if(t<=(e=e||0)&&_.ADShareMgr.getActualAdShare(h.Enum_ADShare.AS_Power)>0){var i=r.TData.getTodayGiftPowerCount();r.TData.setTodayGiftPowerCount(i+1),r.TData.setHasGiftPower(!0),this.visible_gift_power(!0)}}},visible_gift_power:function(t){this.gift_power.active=!0},refresh_gift_gold:function(){if(this.visible_gift_gold(!1),r.TData.getHasGiftGold())this.visible_gift_gold(!0);else{var t=a.GFunc.canPropertyLvup(h.Enum_PropertyId.ArmsMain),e=a.GFunc.getCanPropertyArmsSubLvupFun()>0;if(!t&&!e){var i=parseInt(p.GConfig.getGbData(h.Enum_Gb.GiftGoldStage));if(r.TData.getStage()>i&&_.ADShareMgr.getActualAdShare(h.Enum_ADShare.AS_Gold)>0){var o=r.TData.getTodayGiftGoldCount();r.TData.setTodayGiftGoldCount(o+1),r.TData.setHasGiftGold(!0),this.visible_gift_gold(!0)}}}},visible_gift_gold:function(t){this.gift_gold.active=!0},initGold:function(){this.node_gold_num.destroyAllChildren();var t=cc.instantiate(this.pf_num);this.node_gold_num.addChild(t),this.com_gold=t.getComponent(l),this.com_gold.setParam(h.Enum_Num.Blood,cc.v2(0,.5),4,this.atlas_gameui),t.scale=.5,this.refreshGold()},refreshGold:function(t){if(void 0===t&&(t=-1),this.com_gold){var e=r.TData.getGold();t>=0&&(e=t),this.com_gold.setString(a.GFunc.getNumString(e))}this.refreshButtonsss()},playGoldEffect:function(t,e){var i=this;this.refreshGold(r.TData.getGold()-t);var o=this.node_gold_icon.convertToWorldSpaceAR(cc.v2(0,0)),n=this.node.convertToNodeSpaceAR(o),s=this.atlas_homeui.getSpriteFrame("icon_gold");a.GFunc.flyGold(this.node,s,cc.v2(0,0),n,18,null,function(){i.refreshGold()}),this.scheduleOnce(function(){e&&e()},21*p.GConfig.actionFrameTime),c.GAudio.playSound(c.Enum_Audio.fly_gold)},can_popup_panelGold:function(){var t=_.ADShareMgr.getActualAdShare(h.Enum_ADShare.AS_Gold);return t==h.Enum_AdShareType.Ad||t==h.Enum_AdShareType.Share},popup_panelGold:function(t,e){void 0===e&&(e=null);var i=_.ADShareMgr.getActualAdShare(h.Enum_ADShare.AS_Gold),o=cc.instantiate(this.pf_panelGold);m.GValue.Root_Canvas.addChild(o),o.getComponent(v).init(t,i,e)},onClickBtnGiftGold:function(t){void 0===t&&(t=null);var e=r.TData.getStage(),i=p.GConfig.getLevelData(e);i&&this.popup_panelGold(i.giftGold,t)},goldLessPopupPanelGold:function(t){if(r.TData.getHasGiftGold()){if(this.can_popup_panelGold())return this.visible_gift_gold(!0),this.onClickBtnGiftGold(t),!0}else{var e=a.GFunc.canPropertyLvup(h.Enum_PropertyId.ArmsMain),i=a.GFunc.getCanPropertyArmsSubLvupFun()>0;if(!e&&!i){var o=parseInt(p.GConfig.getGbData(h.Enum_Gb.GiftGoldStage));if(r.TData.getStage()>o&&this.can_popup_panelGold())return r.TData.setHasGiftGold(!0),this.visible_gift_gold(!0),this.onClickBtnGiftGold(t),!0}}return!1},initPower:function(){this.node_power_num.destroyAllChildren();var t=cc.instantiate(this.pf_num);this.node_power_num.addChild(t),this.com_power=t.getComponent(l),this.com_power.setParam(h.Enum_Num.Blood,cc.v2(0,.5),2,this.atlas_gameui),t.scale=.5,this.refreshPower()},refreshPower:function(){if(this.com_power){var t=r.TData.getPower();this.com_power.setString(a.GFunc.getNumK(t))}this.refreshPowerRecover()},refreshPowerRecover:function(){r.TData.isPowerFull()?this.node_power_recover.active&&(this.node_power_recover.active=!1):(this.node_power_recover.active||(this.node_power_recover.active=!0),this.label_powerTime.string=a.GFunc.getTimeSecondStr(m.GValue.PowerTime)+" +1")},reducePowerAction:function(t,e){void 0===e&&(e=!0);var i=new cc.Node;i.setPosition(0,100),m.GValue.Root_Canvas.addChild(i);var o=new cc.Node;i.addChild(o);var n=new cc.Node;n.anchorX=1,o.addChild(n);var s=n.addComponent(cc.Sprite);a.GFunc.changeAtlasSprite(this.atlas_homeui,s,"icon_power");var c=cc.instantiate(this.pf_num);c.scale=.6,o.addChild(c);var r=c.addComponent(l);r.setParam(h.Enum_Num.Blood,cc.v2(0,.5),2,this.atlas_gameui),r.sub_diffY=20,r.setString((e?"-":"+")+t),o.scale=1.3;var d=p.GConfig.actionFrameTime,u=cc.moveTo(5*d,cc.v2(0,85)),f=cc.scaleTo(5*d,2.8),_=cc.spawn(u,f),y=cc.moveTo(8*d,cc.v2(0,155)),g=cc.scaleTo(8*d,2.3),v=cc.fadeOut(8*d),C=cc.spawn(y,g,v),S=cc.sequence(_,C,cc.removeSelf());o.runAction(S)},can_popup_panelPower:function(){var t=_.ADShareMgr.getActualAdShare(h.Enum_ADShare.AS_Power);return t==h.Enum_AdShareType.Ad||t==h.Enum_AdShareType.Share},popup_panelPower:function(t){var e=_.ADShareMgr.getActualAdShare(h.Enum_ADShare.AS_Power),i=cc.instantiate(this.pf_panelPower);m.GValue.Root_Canvas.addChild(i),i.getComponent(g).init(t,e)},onClickBtnGiftPower:function(){var t=parseInt(p.GConfig.getGbData(h.Enum_Gb.GiftPowerRecover));t=t||0,this.popup_panelPower(t)},initSetting:function(){r.TData.SettingData.music?(this.btn_audio_on.active=!0,this.btn_audio_off.active=!1):(this.btn_audio_on.active=!1,this.btn_audio_off.active=!0),r.TData.SettingData.shake?(this.btn_shake_on.active=!0,this.btn_shake_off.active=!1):(this.btn_shake_on.active=!1,this.btn_shake_off.active=!0),this.bg_setting.active=!1},onClickBtnSetting:function(){a.GFunc.createPrefabByName("PanelSetting",this.node,function(t){t.node.zIndex=101})},onClickBtnAudioOn:function(){c.GAudio.musicOn=!1,c.GAudio.soundOn=!1,this.btn_audio_on.active=!1,this.btn_audio_off.active=!0},onClickBtnAudioOff:function(){c.GAudio.musicOn=!0,c.GAudio.soundOn=!0,this.btn_audio_on.active=!0,this.btn_audio_off.active=!1},onClickBtnShakeOn:function(){r.TData.setSettingShake(0),this.btn_shake_on.active=!1,this.btn_shake_off.active=!0},onClickBtnShakeOff:function(){r.TData.setSettingShake(1),this.btn_shake_on.active=!0,this.btn_shake_off.active=!1},initStage:function(){this.node_stage.destroyAllChildren();var t=cc.instantiate(this.pf_stage);this.node_stage.addChild(t),this.com_stage=t.getComponent(d),this.com_stage.init(r.TData.getStage())},initOffline:function(){this.node_offline_num.destroyAllChildren();var t=cc.instantiate(this.pf_num);this.node_offline_num.addChild(t),this.com_offline_num=t.getComponent(l),this.com_offline_num.setParam(h.Enum_Num.Blood,cc.v2(.5,.5),2,this.atlas_gameui),t.scale=.5,this.refreshOffline()},refreshOfflineAnim:function(){if(r.TData.getOfflineGold()>0){this.node_offline.stopAllActions(),(i=this.node_offline.getChildByName("anim"))||((i=cc.instantiate(m.GValue.pf_anim)).name="anim",this.node_offline.addChild(i));var t=i.getComponent(C);t.init(this.atlas_homeui,"ol",4,2*p.GConfig.actionFrameTime,function(){t.stop()});var e=p.GConfig.actionFrameTime;cc.scaleTo(3*e,1.15),cc.scaleTo(3*e,.9),cc.callFunc(function(){t.reset()}),cc.scaleTo(3*e,1.05),cc.scaleTo(4*e,1)}else{var i;this.node_offline.stopAllActions(),(i=this.node_offline.getChildByName("anim"))&&i.removeFromParent()}},refreshOffline:function(){if(this.com_offline_num){var t=r.TData.getOfflineGold();this.com_offline_num.setString(a.GFunc.getNumK(t))}this.refreshOfflineRecover(),this.refreshOfflineAnim()},refreshOfflineRecover:function(){var t=r.TData.getStage(),e=p.GConfig.getLevelData(t),i=0;e&&(i=e.offlineGoldMax);var o=r.TData.getOfflineGold();if(i>0){if(m.GValue.OfflineGoldOnceRecoverTime>0){var n=m.GValue.OfflineGoldTime/m.GValue.OfflineGoldOnceRecoverTime;this.sp_offline_recover_full.fillRange=1-n}var s=o/i;this.sp_offline_full.fillRange=s,s>=1?(this.node_offline_font_full.opacity=255,this.sp_offline_recover_full.fillRange=1):this.node_offline_font_full.opacity=0,this.node_offline_font_get.opacity=o>0?255:0}},openOfflineWin:function(){if(!window.offlineIsOpen){window.offlineIsOpen=!0;var t=r.TData.getOfflineGold();if(window.initOfflineWinOk=!1,t>0){window.initOfflineWinOk=!0;var e=_.ADShareMgr.getActualAdShare(h.Enum_ADShare.AS_Offline),i=cc.instantiate(this.pf_panelOffline);m.GValue.Root_Canvas.addChild(i),i.getComponent(y).init(t,1,e)}}},onClickBtnOffline:function(){var t=r.TData.getOfflineGold();if(t>0){var e=_.ADShareMgr.getActualAdShare(h.Enum_ADShare.AS_Offline);if(f.DYTools.error("\u79bb\u7ebf\u6536\u76ca\u7c7b\u578b = "+e),e==h.Enum_AdShareType.Free||e==h.Enum_AdShareType.None)this.getOfflineGoldValue(t);else{var i=a.GFunc.getGoldOfflineCurTime(),o=p.GConfig.getGbData(h.Enum_Gb.OfflineTimes),n=f.DYTools.stringToNumber(o,p.GConfig.SeparatorII),s=3600*n[0],c=1;if(i>=3600*n[1]?c=3:i>=s&&(c=2),f.DYTools.error("\u79bb\u7ebf\u6536\u76ca\u95f4\u9694 = "+i,c),1==c)this.getOfflineGoldValue(t);else{var l=cc.instantiate(this.pf_panelOffline);m.GValue.Root_Canvas.addChild(l),l.getComponent(y).init(t,c,e)}}}else a.GFunc.showFloatTips("",this.atlas_homeui,"tip_font_offline")},getOfflineGoldValue:function(t){var e=r.TData.getGold();r.TData.setGold(e+t),r.TData.setOfflineGold(0),r.TData.setTimeOfflineGold(a.GFunc.getCurTime()),this.node_offline_font_full.active&&(m.GValue.OfflineGoldTime=m.GValue.OfflineGoldOnceRecoverTime),this.refreshOffline(),this.playGoldEffect(t,null),this.com_property.show(this.cur_sysBtn,!1),r.TData.setTimeOfflineGoldGet(a.GFunc.getCurTime())},moveupOffline:function(){this.node_right.stopAllActions();var t=cc.moveBy(2*p.GConfig.actionFrameTime,cc.v2(0,200));this.node_right.runAction(t)},movedownOffline:function(){this.node_right.stopAllActions();var t=cc.moveBy(2*p.GConfig.actionFrameTime,cc.v2(0,-200));this.node_right.runAction(t)},initPropertySys:function(){var t=p.GConfig.actionFrameTime;this.cur_sysBtn=h.Enum_PropertySys.None,this.dic_sysBtnShow={},this.dic_sysBtnShow[h.Enum_PropertySys.ArmsMain]=this.show_sys_arms1,this.dic_sysBtnShow[h.Enum_PropertySys.ArmsSub]=this.show_sys_arms2,this.dic_sysBtnShow[h.Enum_PropertySys.Gold]=this.show_sys_gold,this.dic_sysBtnPosDiff={},this.dic_sysBtnPosDiff[h.Enum_PropertySys.ArmsMain]=cc.v2(130,0),this.dic_sysBtnPosDiff[h.Enum_PropertySys.ArmsSub]=cc.v2(200,-500),this.dic_sysBtnPosDiff[h.Enum_PropertySys.Gold]=cc.v2(0,0);var e=function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(e){i.dic_sysBtnShow[e].y=i.downY_propertySys;var o=new cc.Node;o.name="lvuptip",o.setPosition(0,270),i.dic_sysBtnShow[e].addChild(o,-1);var n=new cc.Node;o.addChild(n);var s=n.addComponent(cc.Sprite);a.GFunc.changeAtlasSprite(i.atlas_homeui,s,"arrow_lvup");var c=new cc.Node;o.addChild(c);var r=c.addComponent(cc.Sprite);a.GFunc.changeAtlasSprite(i.atlas_homeui,r,"arrow_lvup"),c.setAnchorPoint(.5,.5),a.GFunc.set_click(c,function(){},i);var l=cc.moveBy(7*t,cc.v2(0,2)),d=cc.moveBy(5*t,cc.v2(0,-2)),u=cc.sequence(l,d),p=cc.delayTime(7*t),f=cc.callFunc(function(){n.stopAllActions(),n.y=c.y,n.scale=c.scale,n.opacity=255;var e=cc.scaleBy(5*t,1.4),i=cc.fadeTo(5*t,0),o=cc.spawn(e,i);n.runAction(o)}),_=cc.sequence(p,f),y=cc.repeatForever(cc.spawn(u,_));if(c.runAction(y),parseInt(e)==h.Enum_PropertySys.ArmsSub){var g=new cc.Node;g.name="newsub",g.setPosition(-80,280),i.dic_sysBtnShow[e].addChild(g);var v=new cc.Node;g.addChild(v);v.addComponent(cc.Sprite);v.setAnchorPoint(0,.5),a.GFunc.set_click(v,function(){},i);var C=cc.moveBy(7*t,cc.v2(0,2)),S=cc.moveBy(5*t,cc.v2(0,-2)),D=cc.sequence(C,S),T=cc.delayTime(7*t),G=cc.callFunc(function(){n.stopAllActions(),n.y=v.y,n.scale=v.scale,n.opacity=255;var e=cc.scaleBy(5*t,1.4),i=cc.fadeTo(5*t,0),o=cc.spawn(e,i);n.runAction(o)}),A=cc.sequence(T,G),w=cc.repeatForever(cc.spawn(D,A));if(v.runAction(w),m.GValue.ArmsSub_TryWill>0){var b=new cc.Node;b.name="try",b.setPosition(3,260),i.dic_sysBtnShow[e].addChild(b);var E=new cc.Node;b.addChild(E);var P=E.addComponent(cc.Sprite);a.GFunc.changeAtlasSprite(i.atlas_homeui,P,"arrow_try"),E.setAnchorPoint(.5,0),a.GFunc.set_click(E,function(){},i);var N=cc.moveBy(7*t,cc.v2(0,2)),k=cc.moveBy(5*t,cc.v2(0,-2)),F=cc.sequence(N,k),V=cc.repeatForever(F);E.runAction(V)}}}),i=this;for(var o in this.dic_sysBtnShow)e(o);this.node_property.destroyAllChildren();var n=cc.instantiate(this.pf_property);a.GFunc.adjustScreen(n),this.node_property.addChild(n),this.com_property=n.getComponent(u),this.com_property.init(),this.com_property.show(h.Enum_PropertySys.None),0==r.TData.getListSub().length?(this.btn_sys_arms1.position=this.btn_sys_arms1.position.add(this.dic_sysBtnPosDiff[h.Enum_PropertySys.ArmsMain]),this.btn_sys_arms2.position=this.btn_sys_arms2.position.add(this.dic_sysBtnPosDiff[h.Enum_PropertySys.ArmsSub]),this.node_btn.position=this.btn_sys_arms1.position.add(cc.v2(0,40)),this.node_btn_2.position=this.btn_sys_arms2.position.add(cc.v2(10,40)),this.isFirstProp=!0):m.GValue.FirstGetSub&&(this.btn_sys_arms1.position=this.btn_sys_arms1.position.add(this.dic_sysBtnPosDiff[h.Enum_PropertySys.ArmsMain]),this.btn_sys_arms2.position=this.btn_sys_arms2.position.add(this.dic_sysBtnPosDiff[h.Enum_PropertySys.ArmsSub]),this.node_btn.position=this.btn_sys_arms1.position.add(cc.v2(0,40)),this.node_btn_2.position=this.btn_sys_arms2.position.add(cc.v2(10,40)),this.isFirstProp=!0),this.refresh_sys_lvuptip(!0),this.change_arms1bg(),this.change_arms1(),this.change_Sublogo()},refreshPos:function(){var t=this;this.isFirstProp&&(this.isFirstProp=!1,this.unlock_syssub(function(){t.node_shield.active=!1,t.checkGuide(),t.node_btn.position=t.btn_sys_arms1.position.add(cc.v2(0,40)),t.node_btn_2.position=t.btn_sys_arms2.position.add(cc.v2(10,40)),t.change_Sublogo(),t.refreshBtnUi();var e=t.getFunByIndex(r.TData.getCurSubIndex());t.changeSubEffect(e)}))},unlock_syssub:function(t){var e=5*p.GConfig.actionFrameTime;this.btn_sys_arms1_bg.getComponent(cc.Sprite).spriteFrame=this.atlas_homeui.getSpriteFrame("btn_sys_l");var i=this.btn_sys_arms1.getPosition().sub(this.dic_sysBtnPosDiff[h.Enum_PropertySys.ArmsMain]),o=cc.moveTo(e,i);this.btn_sys_arms1.runAction(o);var n=this.btn_sys_gold.getPosition().sub(this.dic_sysBtnPosDiff[h.Enum_PropertySys.Gold]),s=cc.moveTo(e,n);this.btn_sys_gold.runAction(s);var a=this.btn_sys_arms2.getPosition().sub(this.dic_sysBtnPosDiff[h.Enum_PropertySys.ArmsSub]),c=cc.delayTime(e),r=cc.moveTo(e,a),l=cc.callFunc(function(){t&&t()}),d=cc.sequence(c,r,l);this.btn_sys_arms2.runAction(d)}},"unlock_syssub",function(t){var e=5*p.GConfig.actionFrameTime;this.btn_sys_arms1_bg.getComponent(cc.Sprite).spriteFrame=this.atlas_homeui.getSpriteFrame("btn_sys_l");var i=this.btn_sys_arms1.getPosition().sub(this.dic_sysBtnPosDiff[h.Enum_PropertySys.ArmsMain]),o=cc.moveTo(e,i);this.btn_sys_arms1.runAction(o);var n=this.btn_sys_gold.getPosition().sub(this.dic_sysBtnPosDiff[h.Enum_PropertySys.Gold]),s=cc.moveTo(e,n);this.btn_sys_gold.runAction(s);var a=this.btn_sys_arms2.getPosition().sub(this.dic_sysBtnPosDiff[h.Enum_PropertySys.ArmsSub]),c=cc.delayTime(e),r=cc.moveTo(e,a),l=cc.callFunc(function(){t&&t()}),d=cc.sequence(c,r,l);this.btn_sys_arms2.runAction(d)}),s(n,"refresh_sys_lvuptip",function(t){for(var e in this.cur_sysBtn!=h.Enum_PropertySys.None&&(t=!1),this.dic_sysBtnShow){var i=this.dic_sysBtnShow[e],o=!1;if(parseInt(e)==h.Enum_PropertySys.ArmsSub){var n=i.getChildByName("try");n&&t&&m.GValue.ArmsSub_TryWill>0&&(n.active=!0,o=!0);var s=i.getChildByName("newsub");s&&t&&!o&&r.TData.getListNewSub().length>0&&(s.active=!0,o=!0)}var c=i.getChildByName("lvuptip");c&&t&&(parseInt(e)==h.Enum_PropertySys.ArmsMain?a.GFunc.canPropertyLvup(h.Enum_PropertyId.ArmsMain)&&(c.active=!0):parseInt(e)==h.Enum_PropertySys.ArmsSub?o||a.GFunc.isCanPropertyArmsSubLvupCurFun()&&(c.active=!0):(parseInt(e),h.Enum_PropertySys.Gold))}}),s(n,"setSysBtnShowScale",function(t){for(var e in this.dic_sysBtnShow)this.dic_sysBtnShow[e].scale=t}),s(n,"openBtnSys",function(t,e){var i=this.dic_sysBtnShow[t];i.stopAllActions();var o=cc.moveTo(.2,cc.v2(i.x,0)),n=cc.callFunc(function(){e&&e()}),s=cc.sequence(o,n);i.runAction(s)}),s(n,"closeBtnSys",function(t,e){var i=this.dic_sysBtnShow[t];i.stopAllActions();var o=cc.moveTo(.2,cc.v2(i.x,this.downY_propertySys)),n=cc.callFunc(function(){e&&e()}),s=cc.sequence(o,n);i.runAction(s)}),s(n,"change_arms1bg",function(){r.TData.getStage()>5&&(this.btn_sys_arms1_bg.getComponent(cc.Sprite).spriteFrame=this.atlas_homeui.getSpriteFrame("btn_sys_l"),this.com_property.moveArrowdown(-130))}),s(n,"change_arms1",function(){var t=a.GFunc.getCurMainChange(),e="k"+t.imageId,i="sw_"+t.imageId;try{var o=this.icon_sys_arms1.getComponent(cc.Sprite),n=this.show_sys_arms1_shadow.getComponent(cc.Sprite);o.spriteFrame=m.GValue.Atlas_Game.getSpriteFrame(e),n.spriteFrame=m.GValue.Atlas_Game.getSpriteFrame(i)}catch(t){console.log("\u6362\u56fe\u5931\u8d25\uff0c\u83b7\u53d6\u7684\u8282\u70b9\u4e3a\u7a7a")}}),s(n,"change_Sublogo",function(){var t="arms_sub_"+r.TData.getCurSubFun();try{this.icon_sys_arms2.getChildByName("arms2").getComponent(cc.Sprite).spriteFrame=this.atlas_property.getSpriteFrame(t)}catch(t){console.log("\u83b7\u53d6\u8282\u70b9\u6216\u8005\u7cbe\u7075\u5931\u8d25")}}),s(n,"changeBtnSys",function(t){var e=this;if(!this.isChangeSys){if(this.isChangeSys=!0,this.scheduleOnce(function(){e.isChangeSys=!1},1),this.node_shield.active=!0,this.node_gray.active=!0,this.btn_start.active=!1,this.cur_sysBtn==h.Enum_PropertySys.None)this.openBtnSys(t,function(){e.node_shield.active=!1,e.dic_sysBtnShow[t],e.com_property.show(t)}),this.cur_sysBtn=t,this.moveupPlayer(),this.refresh_sys_lvuptip(!1),c.GAudio.playSound(c.Enum_Audio.lvup_open_close),this.com_property.refreshNext();else if(this.cur_sysBtn==t)this.closeBtnSys(t,function(){e.node_shield.active=!1,e.node_gray.active=!1,e.btn_start.active=!0}),this.cur_sysBtn=h.Enum_PropertySys.None,this.com_property.show(h.Enum_PropertySys.None),this.movedownPlayer(),this.refresh_sys_lvuptip(!0),c.GAudio.playSound(c.Enum_Audio.lvup_open_close),this.com_property.resetSub(),this.refreshButtonsss();else{for(var i in this.openBtnSys(t,function(){e.node_shield.active=!1,e.dic_sysBtnShow[t],e.com_property.show(t)}),c.GAudio.playSound(c.Enum_Audio.lvup_open_close),this.dic_sysBtnShow){var o=parseInt(i);o!=t&&this.closeBtnSys(o,null)}this.cur_sysBtn=t,this.com_property.resetSub()}this.change_Sublogo(),this.change_arms1(),this.changeSysEffectPlayer(this.cur_sysBtn)}}),s(n,"onClickBtnSysArmsMain",function(){this.changeBtnSys(h.Enum_PropertySys.ArmsMain)}),s(n,"onClickBtnSysArmsSub",function(){this.changeBtnSys(h.Enum_PropertySys.ArmsSub)}),s(n,"onClickBtnSysGold",function(){this.changeBtnSys(h.Enum_PropertySys.Gold)}),s(n,"onClickLayerGray",function(){this.cur_sysBtn==h.Enum_PropertySys.ArmsMain?this.onClickBtnSysArmsMain():this.cur_sysBtn==h.Enum_PropertySys.ArmsSub?this.onClickBtnSysArmsSub():this.cur_sysBtn==h.Enum_PropertySys.Gold&&this.onClickBtnSysGold()}),s(n,"resetSysIconAction",function(){this.icon_sys_arms1.stopAllActions(),this.icon_sys_arms2.stopAllActions(),this.icon_sys_gold.stopAllActions();var t=cc.moveBy(.8,cc.v2(0,-10)),e=cc.moveBy(.8,cc.v2(0,10)),i=cc.sequence(t,e),o=cc.repeatForever(i);this.icon_sys_arms1.runAction(o),this.icon_sys_arms2.runAction(o.clone()),this.icon_sys_gold.runAction(o.clone())}),s(n,"hidePlayer",function(){a.GFunc.setPlayerVisible(!1)}),s(n,"showPlayer",function(){a.GFunc.setPlayerVisible(!0)}),s(n,"moveupPlayer",function(){a.GFunc.changePlayerParentToUI(this.show_player),this.node_player.stopAllActions();var t=cc.moveBy(5*p.GConfig.actionFrameTime,cc.v2(0,150));this.node_player.runAction(t)}),s(n,"movedownPlayer",function(){this.node_player.stopAllActions();var t=cc.moveTo(5*p.GConfig.actionFrameTime,cc.v2(0,0));this.node_player.runAction(t)}),s(n,"changeSysEffectPlayer",function(t){this.unschedule(this.updatePlayerSlowRatio),t==h.Enum_PropertySys.ArmsMain?this.schedule(this.updatePlayerSlowRatio,.1,this.PlayerSlowRatioCount,0):m.GValue.PlayerSlowRatio=1,t==h.Enum_PropertySys.Gold?this.skel_gold_up.setAnimation(0,"play",!0):this.skel_gold_up.setAnimation(0,"idle",!1);var e=m.GValue.EntityWorld.player.followPlayerOut.node,i=m.GValue.EntityWorld.player.followPlayerIn.node,o=m.GValue.EntityWorld.player.node;t==h.Enum_PropertySys.ArmsMain?(e.opacity=255,m.GValue.EntityWorld.player.followPlayerOut.setShadowOpacity(255),i.opacity=0,m.GValue.EntityWorld.player.followPlayerIn.setShadowOpacity(0),o.opacity=100):t==h.Enum_PropertySys.ArmsSub?(e.opacity=0,m.GValue.EntityWorld.player.followPlayerOut.setShadowOpacity(0),i.opacity=255,m.GValue.EntityWorld.player.followPlayerIn.setShadowOpacity(255),o.opacity=255):t==h.Enum_PropertySys.Gold?(e.opacity=0,m.GValue.EntityWorld.player.followPlayerOut.setShadowOpacity(0),i.opacity=0,m.GValue.EntityWorld.player.followPlayerIn.setShadowOpacity(0),o.opacity=100):(e.opacity=255,m.GValue.EntityWorld.player.followPlayerOut.setShadowOpacity(255),i.opacity=255,m.GValue.EntityWorld.player.followPlayerIn.setShadowOpacity(255),o.opacity=255)}),s(n,"refreshBtnShow",function(){this.btn_skin.getChildByName("icon_ad").active=0==r.TData.getListSub().length,this.btn_skin.getChildByName("offline_font_get").getComponent(cc.Label).string=0==r.TData.getListSub().length?"Free Skin":"Skin"}),s(n,"effect_gold_lvup",function(){this.skel_gold_lvup.setAnimation(0,"play",!1)}),s(n,"effect_sub_lvup",function(){this.skel_sub_lvup.setAnimation(0,"play",!1)}),s(n,"effect_main_lvup",function(){var t=this,e=new cc.Node;e.setPosition(cc.v2(0,-30)),e.scale=.9,this.effect_player.addChild(e);var i=e.addComponent(sp.Skeleton);i.skeletonData=this.skel_main_lvup_circle,i.premultipliedAlpha=!1,i.setAnimation(0,"play",!1),i.setCompleteListener(function(t,i){"play"==(t.animation?t.animation.name:"")&&e.destroy()});var o=p.GConfig.actionFrameTime;this.scheduleOnce(function(){for(var e=m.GValue.EntityWorld.player.followPlayerOut.knivesCmp.knives,i=function(i){var o=e[i],n=new cc.Node;o.addChild(n);var s=n.addComponent(sp.Skeleton);s.skeletonData=t.skel_main_lvup_shine,s.premultipliedAlpha=!1,s.setAnimation(0,"play",!1),s.setCompleteListener(function(t,e){"play"==(t.animation?t.animation.name:"")&&n.destroy()})},o=0;o<e.length;o++)i(o)},2*o)}),s(n,"changeSubEffect",function(t){if(-1!=t){var e=this,i=this,o=p.GConfig.actionFrameTime;if(f.DYTools.arrContain(r.TData.getListSub(),t)&&r.TData.setCurSubFun(t),0!=t){var n="change_sub_"+t;c.GAudio.playSound(n)}var s=m.GValue.EntityWorld.player.node,l=s.scale,h=m.GValue.EntityWorld.player.followPlayerIn.node,d=h.scale;this.node_shield.active=!0,s.scaleX=s.scaleY=1,h.stopAllActions(),h.scaleX=h.scaleY=1;var u=cc.scaleTo(5*o,0),_=cc.fadeTo(0*o,0),y=cc.sequence(u,_);h.runAction(y),s.stopAllActions();var g=cc.delayTime(3*o),v=cc.scaleTo(3*o,.7*l),C=cc.fadeTo(0*o,0),S=cc.callFunc(function(){a.GFunc.changePlayerTheme(t),setTimeout(function(){var i=new cc.Node;i.setPosition(0,-30),e.effect_player.addChild(i);var o=i.addComponent(sp.Skeleton),n="skel_changesub_"+t,s="skel/"+n+"/"+n;cc.loader.loadRes(s,sp.SkeletonData,function(t,e){t||(o.skeletonData=e,o.premultipliedAlpha=!1,o.setAnimation(0,"play",!1),o.setCompleteListener(function(t,e){"play"==(t.animation?t.animation.name:"")&&i.destroy()}))})},0)}),D=cc.delayTime(4*o),T=cc.scaleTo(0*o,.6*l),G=cc.fadeTo(0*o,255),A=cc.scaleTo(3*o,1.05*l),w=cc.scaleTo(4*o,l),b=cc.callFunc(function(){h.stopAllActions(),h.opacity=255,h.scale=.5*d;var t=cc.scaleTo(3*o,.7*d),e=cc.scaleTo(2*o,.9*d),n=cc.scaleTo(4*o,1.3*d),s=cc.scaleTo(10*o,d),a=cc.callFunc(function(){i.node_shield.active=!1}),c=cc.sequence(t,e,n,s,a);h.runAction(c)}),E=cc.sequence(g,v,C,S,D,T,G,A,w,b);s.runAction(E)}}),s(n,"onClickBtnStart",function(){if(console.log("onClickBtnStart..."),!this.isStart)if(r.TData.usePower(parseInt(p.GConfig.getGbData(h.Enum_Gb.PowerUse)))){a.GFunc.changePlayerParentToMap(),this.refreshPower();var t=this;this.node_shield.active=!0,this.isStart=!0,this.playHideAction(function(){t.node_shield.active=!1,t.node.active=!1,m.GValue.EntityWorld.gameStart(r.TData.getStage())})}else r.TData.getHasGiftPower()&&this.can_popup_panelPower()?this.onClickBtnGiftPower():a.GFunc.showFloatTips("",this.atlas_homeui,"tip_font_power")}),s(n,"playHideAction",function(t){var e=this,i=p.GConfig.actionFrameTime;this.btn_start.active=!1;var o=this.node_logo.position,n=cc.moveTo(4*i,o.add(cc.v2(0,-18))),s=cc.moveTo(5*i,o.add(cc.v2(0,260))),a=cc.fadeOut(5*i),c=cc.spawn(s,a);this.node_logo.runAction(cc.sequence(n,c)),o=this.node_stage.position,n=cc.moveTo(4*i,o.add(cc.v2(0,-36))),s=cc.moveTo(5*i,o.add(cc.v2(0,310))),a=cc.fadeOut(5*i),c=cc.spawn(s,a),this.node_stage.runAction(cc.sequence(n,c)),setTimeout(function(){e.reducePowerAction(parseInt(p.GConfig.getGbData(h.Enum_Gb.PowerUse)))},1e3*i*5),o=this.node_bottom.position,n=cc.moveTo(4*i,o.add(cc.v2(0,18))),s=cc.moveTo(5*i,o.add(cc.v2(0,-300))),this.node_bottom.runAction(cc.sequence(n,s,cc.callFunc(function(){e.node.active=!1,t&&t()}))),o=this.node_right.position,n=cc.moveTo(4*i,o.add(cc.v2(-6,0))),s=cc.moveTo(5*i,o.add(cc.v2(720,0))),this.node_right.runAction(cc.sequence(n,s,cc.callFunc(function(){})))}),s(n,"initGameAgainAction",function(){this.isGameAgain()&&(this.node_shield.active=!0,this.node_logo.active=!1,this.btn_start.active=!1,this.node_stage.active=!1,this.node_right.active=!1)}),s(n,"isGameAgain",function(){return m.GValue.GameOverGold>=0}),s(n,"playGameAgainAction",function(){console.log("playGameAgainAction");var t=this;t.showPlayer(),this.node_logo.active=!0,t.btn_start.active=!0,t.btn_start_layer.active=!0,this.node_right.active=!0;var e=p.GConfig.actionFrameTime;this.node_stage.active=!0,this.node_stage.opacity=0,this.node_stage.runAction(cc.sequence(cc.fadeIn(5*e),cc.delayTime(e),cc.callFunc(function(){m.GValue.ChangeStage?(m.GValue.ChangeStage=!1,t.scheduleOnce(function(){t.endUiINAction()},e)):t.endUiINAction()})))}),s(n,"endUiINAction",function(){var t=this;this.node_shield.active=!1,m.GValue.FirstGetSub?(m.GValue.FirstGetSub=!1,this.node_shield.active=!0,this.unlock_syssub(function(){t.node_shield.active=!1,t.checkGuide();var e=t.getFunByIndex(r.TData.getCurSubIndex());t.changeSubEffect(e)})):t.checkGuide()}),s(n,"getFunByIndex",function(t){var e=r.TData.getSubFunByIndex(t);if(t>=r.TData.getListSub().length){var i=t-r.TData.getListSub().length,o=a.GFunc.getUnGetArmsSubList();i<o.length&&(e=o[i])}return e}),s(n,"checkGuide",function(){}),s(n,"onEnable",function(){window.xmgame.hideBanner()}),s(n,"onDisable",function(){}),s(n,"onBtnCheat",function(){var t=cc.instantiate(this.pf_panelCheat);a.GFunc.adjustScreen(t),this.node.addChild(t,111),t.getComponent(S)}),s(n,"refresh_addprogram",function(){this.node_addprogram&&(p.GConfig.isWx?r.TData.get_addProgram_hasGet()?(this.node_addprogram.destroy(),this.node_addprogram=null):this.node_addprogram.active=!0:(this.node_addprogram.destroy(),this.node_addprogram=null))}),s(n,"click_addprogram",function(){var t=cc.instantiate(this.pf_addprogram);m.GValue.Root_Canvas.addChild(t),t.getComponent(T.PanelAddProgram).init()}),s(n,"refresh_official",function(){this.node_official&&f.DYTools.isLaterDay(1e3*r.TData.get_official_time())&&r.TData.get_official_enter()&&(this.node_official.active=!0)}),s(n,"checkOfficial",function(){if(f.DYTools.isLaterDay(1e3*r.TData.get_official_time())&&r.TData.get_official_enter()){f.DYTools.log("\u516c\u4f17\u5956\u52b1");var t=0,e=p.GConfig.getGbData(h.Enum_Gb.officialEnter);if(e)for(var i=e.split("#"),o=0;o<i.length;o++){var n=f.DYTools.stringToNumber(i[o],"*");if(2==n.length){var s=n[0],a=n[1];s==h.Enum_Reward.Gold||s==h.Enum_Reward.Power&&(t=a)}}var c=r.TData.getPower()+t;this.reducePowerAction(t,!1),r.TData.setPower(c,!0),this.refresh_official(),this.refreshPower()}r.TData.set_official_enter(0)}),n)),cc._RF.pop()},{ADShareManager:"ADShareManager",CommonAudio:"CommonAudio",CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonSdk:"CommonSdk",CommonValue:"CommonValue",ConfigData:"ConfigData",GameData:"GameData",PanelAddProgram:"PanelAddProgram",PanelCheat:"PanelCheat",PanelGold:"PanelGold",PanelOffline:"PanelOffline",PanelPower:"PanelPower",PfFrameAnim:"PfFrameAnim",PfNum:"PfNum",PropertyUI:"PropertyUI",StageUI:"StageUI",Tools:"Tools"}],ItemProperty:[function(t,e,i){"use strict";cc._RF.push(e,"8f7571kDeNEy7VNB5voKqxj","ItemProperty");var o=t("PfNum"),n=t("CommonEnum"),s=t("CommonFunc"),a=t("CommonConfig"),c=t("GameData"),r=t("CommonValue"),l=(t("ConfigData"),t("CommonAudio")),h=t("Tools"),d=t("CommonSdk");cc.Class({extends:cc.Component,properties:{node_content:cc.Node,node_op:cc.Node,sp_icon:cc.Sprite,sp_font:cc.Sprite,node_level:cc.Node,node_lvNum:cc.Node,node_value:cc.Node,node_max:cc.Node,node_btn_max:cc.Node,node_btn:cc.Node,btn_lvup:cc.Node,sp_btn_lvup:cc.Sprite,node_cost:cc.Node,sp_icon_gold:cc.Sprite,node_costNum:cc.Node,node_shine:cc.Node,node_label:cc.Node,label_tip:cc.Label,node_level_main:cc.Node,sp_main_icon:cc.Sprite,node_main_lv:cc.Node,pf_num:cc.Prefab,atlas_property:cc.SpriteAtlas,atlas_game:cc.SpriteAtlas,atlas_homeui:cc.SpriteAtlas},onLoad:function(){this.color_value=cc.color(240,240,150),this.color_cost=cc.color(85,45,10),this.scale_value=1,this.isLvup=!1,this.lv=1,this.value=1,this.cost=100;var t=this,e=cc.instantiate(this.pf_num);this.node_lvNum.addChild(e),this.com_lv=e.getComponent(o),this.com_lv.setParam(n.Enum_Num.Property,cc.v2(0,.5),2,this.atlas_property),this.com_lv.setNum(0);var i=cc.instantiate(this.pf_num);this.node_value.addChild(i),this.com_value=i.getComponent(o),this.com_value.setParam(n.Enum_Num.Blood,cc.v2(0,.5),2,this.atlas_game),this.com_value.setNum(0),this.node_value.scale=this.scale_value;var a=cc.instantiate(this.pf_num);this.node_costNum.addChild(a),this.com_cost=a.getComponent(o),this.com_cost.setParam(n.Enum_Num.Blood,cc.v2(0,.5),2,this.atlas_game),this.com_cost.setNum(0),a.scale=.5,s.GFunc.set_click(this.btn_lvup,function(){t.onClickBtnLvup()},this),s.GFunc.set_click(this.node_btn_max,function(){s.GFunc.showFloatTips("",t.atlas_homeui,"tip_font_lvfull")},this)},init:function(t,e,i,o){void 0===o&&(o=0),this.propertyId=t,this.fun=o,e.length>0&&s.GFunc.changeAtlasSprite(this.atlas_property,this.sp_font,e),i.length>0?s.GFunc.changeAtlasSprite(this.atlas_property,this.sp_icon,i):this.sp_icon.node.active=!1,this.refresh(),this.propertyId!=n.Enum_PropertyId.ArmsMain&&this.propertyId!=n.Enum_PropertyId.ArmsSub||(this.node_btn.active=!1)},hide_op:function(){this.node_op.active=!1},show_op:function(){var t=a.GConfig.actionFrameTime;this.node_op.active=!0,this.node_op.stopAllActions(),this.node_op.scale=.7;var e=cc.scaleTo(3*t,1.05),i=cc.scaleTo(3*t,1),o=cc.sequence(e,i);this.node_op.runAction(o)},lvupAction:function(){var t=this,e=this,i=a.GConfig.actionFrameTime;this.node_value.stopAllActions();var o=cc.scaleTo(3*i,1.5*this.scale_value),c=cc.scaleTo(5*i,1*this.scale_value),l=cc.sequence(o,c);this.node_value.runAction(l),this.node_level.stopAllActions(),this.node_level.scale=1.2;var h=cc.scaleTo(3*i,1);this.node_level.runAction(h),this.node_shine.active=!0,this.node_shine.opacity=255,this.node_shine.scale=1,this.node_shine.stopAllActions();var d=cc.scaleTo(4*i,1.9,1.8),u=cc.scaleTo(4*i,2.2,3.6),m=cc.fadeTo(4*i,0),p=cc.spawn(u,m),f=cc.sequence(d,p);this.node_shine.runAction(f),this.propertyId==n.Enum_PropertyId.GoldKill||this.propertyId==n.Enum_PropertyId.GoldOffline?r.GValue.HomeUI.effect_gold_lvup():this.propertyId==n.Enum_PropertyId.ArmsSub?r.GValue.HomeUI.effect_sub_lvup():this.propertyId==n.Enum_PropertyId.ArmsMain&&r.GValue.HomeUI.effect_main_lvup(),this.scheduleOnce(function(){if(t.propertyId==n.Enum_PropertyId.ArmsMain){var o=e.sp_main_icon.node,a=new cc.Node;o.addChild(a);var c=a.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(e.atlas_property,c,"main_shine_2");var r=cc.scaleTo(2*i,1.1,1.1),l=cc.scaleTo(5*i,2.3,1.9),h=cc.fadeTo(5*i,0),d=cc.spawn(l,h),u=cc.sequence(r,d,cc.removeSelf());a.runAction(u);var m=new cc.Node;o.addChild(m),m.addComponent(cc.Sprite).spriteFrame=e.sp_main_icon.spriteFrame,m.color=cc.Color.BLACK,m.scale=.8;var p=cc.scaleTo(3*i,2.4),f=cc.scaleTo(3*i,1),_=cc.fadeTo(3*i,0),y=cc.spawn(f,_),g=cc.sequence(p,y,cc.removeSelf());m.runAction(g);var v=new cc.Node;o.addChild(v);var C=v.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(e.atlas_property,C,"main_shine_1"),v.opacity=0;var S=cc.delayTime(3*i),D=cc.fadeIn(0),T=cc.scaleTo(3*i,2.05,.55),G=cc.scaleTo(5*i,3.05,.8),A=cc.fadeTo(5*i,0),w=cc.spawn(G,A),b=cc.sequence(S,D,T,w,cc.removeSelf());v.runAction(b)}},8*i)},play_audio_lvup:function(){this.propertyId==n.Enum_PropertyId.ArmsMain||this.propertyId==n.Enum_PropertyId.ArmsSub?l.GAudio.playSound(l.Enum_Audio.lvup_arms):l.GAudio.playSound(l.Enum_Audio.lvup_gold)},refresh:function(){var t=!1,e=!1;if(this.propertyId==n.Enum_PropertyId.ArmsMain){(d=a.GConfig.getPropertyData_Main())&&(this.lv=d.lv,this.value=d.atk,this.cost=d.gd),a.GConfig.getPropertyArmsMainData(this.lv+1)||(t=!0),this.node_op.y=0,this.node_content.x=-45,this.node_content.y=0,this.node_level_main.active=!0,s.GFunc.changeAtlasSprite(r.GValue.Atlas_Game,this.sp_main_icon,"k"+d.imageId),r.GValue.HomeUI.change_arms1();var i=this.node_main_lv.getComponent(o);i||(i=this.node_main_lv.addComponent(o)).setParam(n.Enum_Num.SubLv,cc.v2(.5,.5),0,this.atlas_property),i.setString("l"+this.lv)}else if(this.propertyId==n.Enum_PropertyId.ArmsSub){if(h.DYTools.arrContain(c.TData.getListSub(),this.fun))this.node_label.active=!1,this.node_content.active=!0,this.node_op.active=!0,(d=a.GConfig.getPropertyData_Sub(this.fun))&&(this.lv=d.lv,this.value=d.atk,this.cost=d.gd),a.GConfig.getPropertyArmsSubData(this.fun,this.lv+1)||(t=!0),r.GValue.ArmsSub_TryFinish==d.fun&&(e=!0),this.node_op.x=350,this.node_op.y=240,this.node_content.x=20,this.node_content.y=240;else{this.node_label.active=!0,this.node_content.active=!1,this.node_op.active=!1;var l=r.GValue.Dic_Sub_Level[this.fun];l=l||0,this.label_tip.string="touch to unlock"}r.GValue.HomeUI.com_property&&r.GValue.HomeUI.com_property.refresh_sublv()}else if(this.propertyId==n.Enum_PropertyId.GoldKill)(d=a.GConfig.getPropertyData_GoldKill())&&(this.lv=d.lv,this.value=d.val,this.cost=d.gd),a.GConfig.getPropertyGoldKillData(this.lv+1)||(t=!0);else if(this.propertyId==n.Enum_PropertyId.GoldOffline){var d;(d=a.GConfig.getPropertyData_GoldOffline())&&(this.lv=d.lv,this.value=d.out,this.cost=d.gd),a.GConfig.getPropertyGoldOfflineData(this.lv+1)||(t=!0)}if(this.com_lv&&this.com_lv.setNum(this.lv),this.com_value&&(this.com_value.setNum(this.value),this.com_value.color=this.color_value,e?(this.node_max.active=!0,this.com_value.node.active=!1):(this.node_max.active=!1,this.com_value.node.active=!0)),this.com_cost){this.com_cost.setString(s.GFunc.getNumK(this.cost));var u=this.com_cost.size,m=this.node_costNum.x+u.width*this.com_cost.node.scale;this.node_cost.x=.5*-m,this.com_cost.color=this.color_cost}t||e?(this.node_btn.active=!1,this.node_btn_max.active=!0):(this.node_btn.active=!0,this.node_btn_max.active=!1),this.propertyId!=n.Enum_PropertyId.ArmsMain&&this.propertyId!=n.Enum_PropertyId.ArmsSub||(this.node_btn.active=!1,this.node_btn_max.active=!1),this.refreshBtns()},refreshBtns:function(){c.TData.getGold(),this.cost,s.GFunc.changeAtlasSprite(this.atlas_property,this.sp_btn_lvup,"board_btn"),s.GFunc.changeAtlasSprite(this.atlas_property,this.sp_icon_gold,"icon_gold"),this.com_cost&&(this.com_cost.color=this.color_cost)},onClickBtnLvup:function(){if(!this.isLvup){var t=this,e=a.GConfig.actionFrameTime;this.node_op.stopAllActions();var i=cc.scaleTo(2*e,.8),o=cc.scaleTo(3*e,1),l=cc.sequence(i,o);if(this.node_op.runAction(l),c.TData.getGold()>=this.cost){if(this.isLvup=!0,this.scheduleOnce(function(){t.isLvup=!1},.5),this.propertyId==n.Enum_PropertyId.ArmsSub)c.TData.setPropertyLv_Sub(this.fun,this.lv+1),d.GSDK.sendSubLvup(this.fun,this.lv+1),c.TData.getGuideStep()<n.Enum_GuideStep.SubUp&&c.TData.setGuideStep(n.Enum_GuideStep.SubUp);else if(this.propertyId==n.Enum_PropertyId.ArmsMain){var h=s.GFunc.getCurMainChange();c.TData.setPropertyLv(this.propertyId,this.lv+1),d.GSDK.sendMainLvup(this.lv+1);var u=s.GFunc.getCurMainChange();h!=u&&(s.GFunc.changePlayerMainWeapon(),r.GValue.HomeUI.com_property.changeMain(h,u)),c.TData.getGuideStep()<n.Enum_GuideStep.MainUp&&c.TData.setGuideStep(n.Enum_GuideStep.MainUp)}else c.TData.setPropertyLv(this.propertyId,this.lv+1);c.TData.setGold(c.TData.getGold()-this.cost),r.GValue.HomeUI.refreshGold(),this.refresh(),this.play_audio_lvup(),this.lvupAction()}else if(!r.GValue.HomeUI.goldLessPopupPanelGold(function(){t.refreshBtns()})){var m=this.node_op.convertToWorldSpaceAR(cc.v2(0,0));m.addSelf(cc.v2(0,70)),s.GFunc.showFloatTips("",this.atlas_homeui,"tip_font_gold",m)}}},checkGuide:function(){}}),cc._RF.pop()},{CommonAudio:"CommonAudio",CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonSdk:"CommonSdk",CommonValue:"CommonValue",ConfigData:"ConfigData",GameData:"GameData",PfNum:"PfNum",Tools:"Tools"}],KnifeDropCollisionWallListener:[function(t,e,i){"use strict";cc._RF.push(e,"623a4bTZ6FNf7mpCOEFjb+c","KnifeDropCollisionWallListener"),cc.Class({extends:cc.Component,properties:{label:cc.Label},ctor:function(){},onCollisionExit:function(t,e){4!=t.node.groupIndex&&10!=t.node.groupIndex||this.noticeWallLeave(t)},onCollisionEnter:function(t,e){4!=t.node.groupIndex&&10!=t.node.groupIndex||this.noticeWallCollision(t)},noticeWallCollision:function(t){this.node.parent.emit("wallCollision",t)},noticeWallLeave:function(t){this.node.parent.emit("wallLeave",t)}}),cc._RF.pop()},{}],KnifeRivalEffect:[function(t,e,i){"use strict";cc._RF.push(e,"c98b1YXMwhBbKIOggW393ZL","KnifeRivalEffect");var o=t("CommonValue"),n=t("Types");cc.Class({extends:cc.Component,properties:{anim:cc.Animation},ctor:function(){},onLoad:function(){this.anim.on("finished",this.animEnd,this)},animEnd:function(){this.anim.off("finished",this.animEnd,this),o.GValue.EntityWorld.addEntitySys.poolMgr.put(n.PoolType.EFFECT,this.node)}}),cc._RF.pop()},{CommonValue:"CommonValue",Types:"Types"}],KnifeThrowCtrl:[function(t,e,i){"use strict";cc._RF.push(e,"32e2f8arjtENpfgT3bLt+Lx","KnifeThrowCtrl");var o=t("Tools"),n=t("CommonValue");cc.Class({extends:cc.Component,properties:{},ctor:function(){this._knife=null,this._collider=null,this._initSpeed=0,this._speed=0,this._dir=cc.Vec2.ZERO,this._checkCol=!0,this._minViewX=0,this._maxViewX=0,this._minViewY=0,this._maxViewY=0,this._minX=null,this._maxX=null,this._minY=null,this._maxY=null,this._collisionWalls=[],this.colingWalls=[],this._dxDirty=!1,this._dyDirty=!1},init:function(t,e,i,o){void 0===o&&(o=!0),this._knife=t,this._collider=t.landNode.getComponent(cc.BoxCollider),this._initSpeed=e,this._speed=e,this._dir=i.normalize(),this._checkCol=o,this._minViewX=0,this._maxViewX=n.GValue.Size_View.width,this._minViewY=0,this._maxViewY=n.GValue.Size_View.height,this.node.on("wallCollision",this.collisionWall,this),this.node.on("wallLeave",this.leaveWall,this)},updateGameLogic:function(t){if(this._collider){var e=this._speed*t,i=this._dir.mul(e);this.node.position=this.node.position.add(i),this.node.angle+=3*e,this._checkCol?(this.fixPositionByWall()||this.fixPositionByScreen(),this._dxDirty&&(this._dir.x=-this._dir.x,this._dxDirty=!1),this._dyDirty&&(this._dir.y=-this._dir.y,this._dyDirty=!1),this._speed-=15):this._speed-=10,this._speed>.7*this._initSpeed?this.node.scale=2-(this._speed-.7*this._initSpeed)/this._initSpeed:this.node.scale=1+this._speed/this._initSpeed*.7,this._speed<0&&(this._speed=0,this.node.emit("dropOver"))}},fixPositionByScreen:function(){var t=this.node.position.add(n.GValue.EntityWorld.mapMgr.mapTop.position).mul(n.GValue.MapScale);t.x<this._minViewX?(this.node.x=this.node.parent.convertToNodeSpaceAR(cc.v2(this._minViewX,0)).x,this._dxDirty=!0):t.x>this._maxViewX&&(this.node.x=this.node.parent.convertToNodeSpaceAR(cc.v2(this._maxViewX,0)).x,this._dxDirty=!0),t.y<this._minViewY?(this.node.y=this.node.parent.convertToNodeSpaceAR(cc.v2(0,this._minViewY)).y,this._dyDirty=!0):t.y>this._maxViewY&&(this.node.y=this.node.parent.convertToNodeSpaceAR(cc.v2(0,this._maxViewY)).y,this._dyDirty=!0)},fixPositionByWall:function(){if(0==this._collisionWalls.length)return!1;for(var t=0;t<this._collisionWalls.length;t++){var e=this._collisionWalls[t],i=(this._collider,e.node.parent),n=this.node.parent,s=i.position;switch(e.tag){case 0:var a=e.size.height;this._maxY=s.y-e.offset.y-.5*a,this.node.y>this._maxY&&(this.node.y=this._maxY,this._dyDirty=!0);break;case 1:a=e.size.height,this._minY=s.y+e.offset.y+.5*a,this.node.y<this._minY&&(this.node.y=this._minY,this._dyDirty=!0);break;case 2:a=e.size.height,this._minX=s.x+e.offset.y+.5*a,this.node.x<this._minX&&(this.node.x=this._minX,this._dxDirty=!0);break;case 3:a=e.size.height,this._maxX=s.x-e.offset.y-.5*a,this.node.x>this._maxX&&(this.node.x=this._maxX,this._dxDirty=!0);break;case 4:if(s=s.add(e.node.position),(d=(h=this.node.position.sub(s)).mag())<(u=e.radius-6)){var c=h.x/d,r=h.y/d,l=s.add(cc.v2(u*c,u*r));this.node.position=l,this._dyDirty=!0,this._dxDirty=!0}break;case 5:s.addSelf(e.node.position),(d=(h=this.node.position.sub(s)).mag())<(u=e.radius-6)&&(c=h.x/d,r=h.y/d,l=s.add(cc.v2(u*c,u*r)),this.node.position=l,this._dyDirty=!0,this._dxDirty=!0);break;case 6:var h,d;s=e.node.convertToWorldSpaceAR(cc.v2(0,0)),s=n.convertToNodeSpaceAR(s),(d=(h=this.node.position.sub(s)).mag())<(u=.5*e.size.width+35-6)&&(c=h.x/d,r=h.y/d,l=s.add(cc.v2(u*c,u*r)),this.node.position=l,this._dyDirty=!0,this._dxDirty=!0);break;case 101:if(o.DYTools.arrContain(this.colingWalls,e))break;this.colingWalls.push(e);var u=e.size.width,m=e.size.height,p=Math.abs(i.angle);(p>80&&p<100||p>260&&p<280)&&(u=e.size.height,m=e.size.width),s.addSelf(e.node.position),o.DYTools.isNumberDiffRange(this.node.y,s.y,m/2)?this._dxDirty=!0:o.DYTools.isNumberDiffRange(this.node.x,s.x,u/2)?this._dyDirty=!0:this.node.x>s.x&&this.node.y>s.y?this._dir.x<0&&this._dir.y<0?(this._dyDirty=!0,this._dxDirty=!0):this._dir.x<0?this._dxDirty=!0:this._dir.y<0&&(this._dyDirty=!0):this.node.x>s.x&&this.node.y<s.y?this._dir.x<0&&this._dir.y>0?(this._dyDirty=!0,this._dxDirty=!0):this._dir.x<0?this._dxDirty=!0:this._dir.y>0&&(this._dyDirty=!0):this.node.x<s.x&&this.node.y<s.y?this._dir.x>0&&this._dir.y>0?(this._dyDirty=!0,this._dxDirty=!0):this._dir.x>0?this._dxDirty=!0:this._dir.y>0&&(this._dyDirty=!0):this._dir.x>0&&this._dir.y<0?(this._dyDirty=!0,this._dxDirty=!0):this._dir.x>0?this._dxDirty=!0:this._dir.y<0&&(this._dyDirty=!0)}}return!0},collisionWall:function(t){o.DYTools.arrContains(this._collisionWalls,t)||this._collisionWalls.push(t)},leaveWall:function(t){o.DYTools.arrRemove(this._collisionWalls,t),o.DYTools.arrRemove(this.colingWalls,t)}}),cc._RF.pop()},{CommonValue:"CommonValue",Tools:"Tools"}],LaserComponent:[function(t,e,i){"use strict";cc._RF.push(e,"4099eJXeE5FeIRnOYMIGFJE","LaserComponent");var o=t("Tools"),n=t("CommonConfig"),s=t("CommonValue");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.followEntity=null,this.frameList=[],this.frameTime=[],this.frameNum=[],this.frameCount=[],this.frameImage=[],this.laserNode=null,this.startNode=null,this.lightNode=null},init:function(t,e){this.followEntity=t;var i,o="dw"+e+"_1_";this.laserNode=new cc.Node,this.laserNode.anchorY=0,this.node.addChild(this.laserNode),(i=this.laserNode.addComponent(cc.Sprite)).spriteFrame=s.GValue.Atlas_Game.getSpriteFrame(o+0),o="dw"+e+"_2_",this.startNode=new cc.Node,this.startNode.position=cc.v2(0,5),this.node.addChild(this.startNode,1),(i=this.startNode.addComponent(cc.Sprite)).spriteFrame=s.GValue.Atlas_Game.getSpriteFrame(o+0),this.addFrameAnim(i,o,2),o="dw"+e+"_3_",this.lightNode=new cc.Node,this.lightNode.position=cc.v2(0,54),this.node.addChild(this.lightNode,2),(i=this.lightNode.addComponent(cc.Sprite)).spriteFrame=s.GValue.Atlas_Game.getSpriteFrame(o+0),this.addFrameAnim(i,o,3)},enterStrong:function(t){this.laserNode.getComponent(cc.Sprite).spriteFrame=0==t?s.GValue.Atlas_Game.getSpriteFrame("dw2_1_0"):s.GValue.Atlas_Game.getSpriteFrame("dw2_1_1")},setEnemy:function(t,e){var i=cc.v2(0,0),o=cc.v2(0,0),n=t.radius;t.isSnake?(i=t.node_tail.convertToWorldSpaceAR(cc.v2(0,0)),o=this.node.parent.convertToNodeSpaceAR(i)):t.isFire?(i=t.node_collider.convertToWorldSpaceAR(cc.v2(0,0)),o=this.node.parent.convertToNodeSpaceAR(i),n-=100):(i=t.node.convertToWorldSpaceAR(cc.v2(0,0)),o=this.node.parent.convertToNodeSpaceAR(i));var s=cc.v2(0,50).signAngle(o),a=cc.v2(0,e).rotate(s),c=a.sub(o).mag()-n;return s=cc.v2(0,50).signAngle(o.sub(a)),this.node.position=a,this.node.angle=-cc.misc.radiansToDegrees(s),this.node.opacity=255,this.laserNode.scaleY=c/50,this.lightNode.position=cc.v2(0,c),this.node.angle},updateGameLogic:function(t){for(var e=0;e<this.frameList.length;e++)if(this.frameTime[e]=this.frameTime[e]+t,this.frameTime[e]>n.GConfig.actionFrameTime){this.frameCount[e]++;var i=this.frameList[e];this.frameCount[e]>=this.frameNum[e]&&(this.frameCount[e]=0);var o=this.frameCount[e];i.spriteFrame=this.frameImage[e][o]}},addFrameAnim:function(t,e,i){if(!o.DYTools.arrContains(this.frameList,t)){this.frameList.push(t),this.frameNum.push(i),this.frameCount.push(0),this.frameTime.push(0);for(var n=[],a=0;a<i;a++)n.push(s.GValue.Atlas_Game.getSpriteFrame(e+a));this.frameImage.push(n)}}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonValue:"CommonValue",Tools:"Tools"}],Launcherr:[function(t,e,i){"use strict";cc._RF.push(e,"8b9c9QBhRVFJ5u3nhn9BRgi","Launcherr");var o=t("CommonValue"),n=t("GameData"),s=t("Tools"),a=t("ConfigData"),c=t("CommonConfig"),r=t("CommonFunc"),l=(t("GuideUI"),t("CommonAudio")),h=t("CommonEnum"),d=t("CommonSdk"),u=t("ADShareManager");t("AndroidManager"),t("NetUp");cc.Class({extends:cc.Component,properties:{node_label_tip:cc.Node,node_out:cc.Node,node_in:cc.Node,node_load:cc.Node,node_role:cc.Node},onLoad:function(){this._jsonCount=0,this._totalJsonNum=21,this.loginSuccess=!1,this.jsonOver=!1,this.isLoading=!0,this.loadTime=0,this.reLoad=!1,this.minWaitTime=3,this.sdkWaitTime=3,cc.macro.DOWNLOAD_MAX_CONCURRENT=2,window.xmgame.sendEvent("loading_begin"),setTimeout(function(){window.xmgame.sendEvent("loading_end")},1e3),window.xmgame.sendEvent("game_end")},start:function(){var t=this;n.TData.initData(),this.reLoad=!1,this.isLoading=!0,this.loadTime=0,this._jsonCount=0,this.jsonOver=!1;Date.now();var e=this.node_load.getComponent(cc.Sprite),i=0;cc.director.preloadScene("Game",function(o,n){if(o>i||0==i){(i=o)>=738&&(i=738);var s=Math.floor(i/738*100);e.fillRange=Math.floor(i/738*100)/100,t.loginSuccess=!0,t.node_label_tip.getComponent(cc.Label).string="Loading "+s+"%....."}},function(t,e){}),this.ui_action(),c.GConfig.isDevelop,this.loadConfig(),o.GValue.Size_View=cc.view.getVisibleSize(),o.GValue.WorldRect=cc.rect(0,0,o.GValue.Size_View.width,o.GValue.Size_View.height),o.GValue.ViewCenter=cc.v2(.5*o.GValue.Size_View.width,.5*o.GValue.Size_View.height),window.xmgame.initConfig()},ui_action:function(){var t=cc.rotateBy(4,360),e=cc.repeatForever(t);this.node_out.runAction(e);var i=cc.rotateBy(4,-360),o=cc.repeatForever(i);this.node_in.runAction(o)},update:function(t){this.minWaitTime-=t,this.sdkWaitTime-=t,this.loadTime+=t,this.minWaitTime>0||(this.sdkWaitTime,this._jsonCount>=this._totalJsonNum&&(this.jsonOver=!0,this.loginSuccess&&(n.TData.newDayRefresh(),u.ADShareMgr.initAdShare(),this._jsonCount=-1,o.GValue.initCommonValue(),n.TData.isNewPlayer&&n.TData.setPower(parseInt(c.GConfig.getGbData(h.Enum_Gb.PowerMax)),!0,!1),cc.director.loadScene("Game",function(){}))),this.isLoading&&this.loadTime>30&&(this.isLoading=!1,this.loadTime=0,c.GConfig.isDevelop||(d.GSDK.sendGameErr(h.Enum_ReportErr.MainSceneLoad),d.GSDK.show_model("\u63d0\u793a","\u7f51\u7edc\u8fde\u63a5\u4f3c\u4e4e\u6709\u95ee\u9898\uff0c\u8bf7\u5c1d\u8bd5\u91cd\u65b0\u52a0\u8f7d",function(){o.GValue.FirstMain=!0,o.GValue.DDSDK=null,o.GValue.DDSDKUI=null,cc.director.loadScene("Launcher")},function(){}))))},preLoadScene:function(){var t=this;cc.director.preloadScene("Game",function(){},function(e,i){i?t.jsonOver&&cc.director.loadScene("Game"):s.DYTools.error("\u573a\u666f\u52a0\u8f7d\u5931\u8d25",e)})},loadConfig:function(){l.GAudio.init(),r.GFunc.preLoadMap(n.TData.getStage()),this.loadLevel(),this.loadEnemy(),this.loadAttr(),this.loadEnemyOut(),this.loadEnemyCon(),this.loadMapPause(),this.loadMapEnemy(),this.loadMapBoss(),this.loadConfigKnifeBoss(),this.loadMapBossSnake(),this.loadMapBossCircle(),this.loadMapBossFire(),this.loadMapBossElectr(),this.loadPropertyArmsMain(),this.loadPropertyArmsSub(),this.loadPropertyGoldKill(),this.loadPropertyGoldOffline(),this.loadGb(),this.loadGuide(),this.loadAdShare(),this.loadShare(),r.GFunc.initEnemySkinDict()},loadLevel:function(){this.loadJson("config/level",function(t){o.GValue.Dic_Sub_Level={};for(var e=t.json,i=0;i<e.length;i++){var s=new a.ConfigLevelData;s.loadData(e[i]),c.GConfig.addLevelData(s),s.fun>0&&(o.GValue.Dic_Sub_Level[s.fun]=s.level)}n.TData.dwAdjustStage()})},loadEnemy:function(){this.loadJson("config/showupspot",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.ConfigEnemyOutData;o.loadData(e[i]),c.GConfig.addEnemyOutData(o)}})},loadAttr:function(){this.loadJson("config/skill",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.ConfigAttrData;o.loadData(e[i]),c.GConfig.addAttrData(o)}})},loadEnemyOut:function(){this.loadJson("config/moster",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.ConfigEnemyData;o.loadData(e[i]),c.GConfig.addEnemyData(o)}})},loadEnemyCon:function(){this.loadJson("config/suc",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.ConfigEnemyConData;o.loadData(e[i]),c.GConfig.addEnemyConData(o)}})},loadMapPause:function(){this.loadJson("config/pause",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.ConfigPauseData;o.loadData(e[i]),c.GConfig.addPauseData(o)}})},loadMapEnemy:function(){this.loadJson("config/handput",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.ConfigMapEnemyAreaData;o.loadData(e[i]),c.GConfig.addMapAreaEnemyData(o)}})},loadMapBoss:function(){this.loadJson("config/boss",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.ConfigMapBossData;o.loadData(e[i]),c.GConfig.addMapBossData(o)}})},loadConfigKnifeBoss:function(){this.loadJson("config/boss_knife",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.ConfigKnifeBossData;o.loadData(e[i]),c.GConfig.addKnifeBossData(o)}})},loadMapBossSnake:function(){this.loadJson("config/boss_snake",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.ConfigMapBossSnakeData;o.loadData(e[i]),c.GConfig.addMapBossSnakeData(o)}})},loadMapBossCircle:function(){this.loadJson("config/boss_ice",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.ConfigMapBossCircleData;o.loadData(e[i]),c.GConfig.addMapBossCircleData(o)}})},loadMapBossFire:function(){this.loadJson("config/boss_fire",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.ConfigMapBossFireData;o.loadData(e[i]),c.GConfig.addMapBossFireData(o)}})},loadMapBossElectr:function(){this.loadJson("config/boss_electr",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.ConfigMapBossElectrData;o.loadData(e[i]),c.GConfig.addMapBossElectrData(o)}})},loadPropertyArmsMain:function(){this.loadJson("config/main",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.ConfigPropertyArmsMainData;o.loadData(e[i]),c.GConfig.addPropertyArmsMainData(o)}r.GFunc.getArmsMainChange()})},loadPropertyArmsSub:function(){this.loadJson("config/sub",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.ConfigPropertyArmsSubData;o.loadData(e[i]),c.GConfig.addPropertyArmsSubData(o)}})},loadPropertyGoldKill:function(){this.loadJson("config/gold1",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.ConfigPropertyGoldKillData;o.loadData(e[i]),c.GConfig.addPropertyGoldKillData(o)}})},loadPropertyGoldOffline:function(){this.loadJson("config/gold2",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.ConfigPropertyGoldOfflineData;o.loadData(e[i]),c.GConfig.addPropertyGoldOfflineData(o)}})},loadGb:function(){this.loadJson("config/global",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=e[i];c.GConfig.addGbData(parseInt(o.id),o.ver)}})},loadGuide:function(){this.loadJson("config/guide",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.GuideData;o.loadData(e[i]),c.GConfig.addGuideData(o.id,o)}})},loadAdShare:function(){this.loadJson("config/advershare",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.ADShareData;o.loadData(e[i]),u.ADShareMgr.addAdShareData(o)}})},loadShare:function(){this.loadJson("config/share",function(t){for(var e=t.json,i=0;i<e.length;i++){var o=new a.ShareData;o.loadData(e[i]),u.ADShareMgr.addShareData(o)}})},loadJson:function(t,e){var i=this;cc.loader.loadRes(t,function(o,n){o?(s.DYTools.error(o),i.loadJson(t,e)):(e&&e(n),i._jsonCount++)})},checkArea:function(){var t=cc.loader.getXMLHttpRequest();t.open("POST","https://wxgame.chiji-h5.com/wxgs_sdk/getcity.action",!0),t.timeout=5e3,t.ontimeout=function(){s.DYTools.error("checkArea--timeout")},t.onreadystatechange=function(){var e=t.readyState,i=t.status;if(4==e&&200==i){var n=t.responseText,a=JSON.parse(n);o.GValue.curCity=a.city,s.DYTools.log("checkArea = "+a+", city = "+o.GValue.curCity),o.GValue.checkCity()}},t.send()}}),cc._RF.pop()},{ADShareManager:"ADShareManager",AndroidManager:"AndroidManager",CommonAudio:"CommonAudio",CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonSdk:"CommonSdk",CommonValue:"CommonValue",ConfigData:"ConfigData",GameData:"GameData",GuideUI:"GuideUI",NetUp:"NetUp",Tools:"Tools"}],LoadingData:[function(t,e,i){"use strict";cc._RF.push(e,"74a18KaWRVIMqXKc/I6le1G","LoadingData"),cc.Class({extends:cc.Component,properties:{},ctor:function(){this.load_force=!0,this.list_res_pf=[],this.list_res_atlas=[],this.list_res_image=[],this.list_res_spine=[],this.list_res_webtexture=[],this.list_res_json=[],this.len_pf=0,this.len_atlas=0,this.len_image=0,this.len_spine=0,this.len_webtexture=0,this.len_json=0,this.list_release_res_pf=[],this.list_release_res_atlas=[],this.list_release_res_image=[],this.list_release_res_spine=[],this.list_release_res_webtexture=[],this.list_release_res_json=[],this.callback_loadres_success=null,this.callback_progress_change=null,this.reload_count_cur=0,this.reload_count_total=5,this.load_number_cur=0,this.load_number_total=0},setLoadForce:function(t){this.load_force=t},addListResPf:function(t,e){void 0===e&&(e=!0),this.list_res_pf.push(t),e&&this.list_release_res_pf.push(t)},addListResAtlas:function(t,e){void 0===e&&(e=!0),this.list_res_atlas.push(t),e&&this.list_release_res_atlas.push(t)},addListResImage:function(t,e){void 0===e&&(e=!0),this.list_res_image.push(t),e&&this.list_release_res_image.push(t)},addListResSpine:function(t,e){void 0===e&&(e=!0),this.list_res_spine.push(t),e&&this.list_release_res_spine.push(t)},addListResWebTexture:function(t,e){void 0===e&&(e=!0),this.list_res_webtexture.push(t),e&&this.list_release_res_webtexture.push(t)},addListResJson:function(t,e){void 0===e&&(e=!0),this.list_res_json.push(t),e&&this.list_release_res_json.push(t)},loadResPf:function(t){if(t>=this.len_pf)this.loadResAtlas(0);else{var e=this,i=this.list_res_pf[t];cc.loader.loadRes(i,cc.Prefab,function(i,o){i&&e.load_force?e.reloadResTip(e.loadResPf.bind(e),t):(e.addProgress(1),e.loadResPf(t+1))})}},loadResAtlas:function(t){if(t>=this.len_atlas)this.loadResImage(0);else{var e=this,i=this.list_res_atlas[t];cc.loader.loadRes(i,cc.SpriteAtlas,function(o,n){o?e.load_force?e.reloadResTip(e.loadResAtlas.bind(e),t):(e.addProgress(1),e.loadResAtlas(t+1)):(e.set_success_resource(i,n),e.addProgress(1),e.loadResAtlas(t+1))})}},loadResImage:function(t){if(t>=this.len_image)this.loadResSpine(0);else{var e=this,i=this.list_res_image[t];cc.loader.loadRes(i,cc.SpriteFrame,function(i,o){i&&e.load_force?e.reloadResTip(e.loadResImage.bind(e),t):(e.addProgress(1),e.loadResImage(t+1))})}},loadResSpine:function(t){if(t>=this.len_spine)this.loadResWebTexture(0);else{var e=this,i=this.list_res_spine[t];cc.loader.loadRes(i,sp.SkeletonData,function(i,o){i&&e.load_force?e.reloadResTip(e.loadResSpine.bind(e),t):(e.addProgress(1),e.loadResSpine(t+1))})}},loadResWebTexture:function(t){if(t>=this.len_webtexture)this.loadResJson(0);else{var e=this,i=this.list_res_webtexture[t];cc.loader.load(i,function(i,o){i&&e.load_force?e.reloadResTip(e.loadResWebTexture.bind(e),t):(e.addProgress(1),e.loadResWebTexture(t+1))})}},loadResJson:function(t){if(t>=this.len_json)this.loadResSuccess();else{var e=this,i=this.list_res_json[t];cc.loader.loadRes(i,function(i,o){i&&e.load_force?e.reloadResTip(e.loadResJson.bind(e),t):(e.addProgress(1),e.loadResJson(t+1))})}},reloadResTip:function(t,e){this.reload_count_cur>=this.reload_count_total?this.showReloginUI():(this.reload_count_cur++,t(e))},set_success_resource:function(t,e){},loadResSuccess:function(){this.callback_loadres_success&&this.callback_loadres_success(),this.list_res_pf.splice(0),this.list_res_atlas.splice(0),this.list_res_image.splice(0),this.list_res_spine.splice(0),this.list_res_webtexture.splice(0),this.list_res_json.splice(0),this.len_pf=0,this.len_atlas=0,this.len_image=0,this.len_spine=0,this.len_webtexture=0,this.len_json=0,this.callback_loadres_success=null,this.callback_progress_change=null,this.load_number_cur=0,this.load_number_total=0},loadRes:function(t,e){this.callback_loadres_success=t,this.callback_progress_change=e,this.len_pf=this.list_res_pf.length,this.len_atlas=this.list_res_atlas.length,this.len_image=this.list_res_image.length,this.len_spine=this.list_res_spine.length,this.len_webtexture=this.list_res_webtexture.length,this.len_json=this.list_res_json.length,this.load_number_total=this.len_pf+this.len_atlas+this.len_image+this.len_spine+this.len_webtexture+this.len_json,this.loadResPf(0)},releaseRes:function(){for(var t=this.list_release_res_pf.length,e=0;e<t;e++)cc.loader.releaseRes(this.list_release_res_pf[e],cc.Prefab);var i=this.list_release_res_atlas.length;for(e=0;e<i;e++);var o=this.list_release_res_image.length;for(e=0;e<o;e++);var n=this.list_release_res_spine.length;for(e=0;e<n;e++);var s=this.list_release_res_webtexture.length;for(e=0;e<s;e++);var a=this.list_release_res_json.length;for(e=0;e<a;e++);},addProgress:function(t){this.load_number_cur=this.load_number_cur+t,this.callback_progress_change&&this.callback_progress_change()},getProgress:function(){if(this.load_number_total<=0)return 0;var t=this.load_number_cur,e=this.load_number_total;return parseFloat(t.toString())/e*100},getResNumTotal:function(){return this.load_number_total},getResNumCur:function(){return this.load_number_cur},showReloginUI:function(){}}),cc._RF.pop()},{}],MapManager:[function(t,e,i){"use strict";cc._RF.push(e,"6cdecMfaktBKq/LyqOitKeS","MapManager");var o=t("Tools"),n=t("CommonValue"),s=t("CommonConfig"),a=t("CommonFunc"),c=t("CommonAudio"),r=t("EntityBlock");cc.Class({extends:cc.Component,properties:{mapBottom:cc.Node,mapTop:cc.Node,bgShield:cc.Node,skel_stone:sp.Skeleton,pf_wall:cc.Prefab,pf_wall1:cc.Prefab,pf_wall2:cc.Prefab,pf_wallC:cc.Prefab,pf_wallD:cc.Prefab,pf_wallS:cc.Prefab,pf_block:cc.Prefab},onLoad:function(){this._finishCall=null,this._lvData=null,this._mapData=null,this._wallList=[],this._addSys=null,this._bgNode=null,this._wallNode=null,this._loadStart=!1,this._wayCount=0,this._wayFinishCount=0,this.gameStart=!1,this.mapSpeedH=100,this.mapSpeedV=100,this.mapSpeed=100,this.curSpeed=0,this.acceleratedSpeed=5,this.mapStop=!1,this.blockArr=[],this.blockRectArr=[],this.wayVec=[],this.curDir=cc.Vec2.ZERO,this.curDirTag=0,this.curDestVec=cc.Vec2.ZERO,this.curDirSpeed=cc.Vec2.ZERO,this.mapOver=!1,this.mapEndStone=null,this.stoneBombCall=null,this.totalDistance=0,this.curDistance=0,this.enemyOutArr=[],this.curEnemyOut=[],this.conEnemyArr=[],this.curConOut=[],this.pauseArr=[],this.areaArr=[],this.areaEnemyArr=[],this.areaEnemyAwakeArr=[],this.bossData=null,this.bossPause=null,this.pauseDis=[];var t=this;this.skel_stone.setCompleteListener(function(e,i){var o=e.animation?e.animation.name:"";"idle"==o||"light"==o||(t.skel_stone.node.active&&t.skel_stone.setAnimation(0,"idle",!0),t.stoneBombCall&&t.stoneBombCall())})},clear:function(){this._wallNode.removeAllChildren()},init:function(t,e,i){this._finishCall=i,this._lvData=t,this._addSys=e,this._bgNode=e.mapBg,this._wallNode=e.mapWall,this._wayCount=0,this._wayFinishCount=0,this.mapSpeedV=t.mapSpeedV,this.mapSpeedH=t.mapSpeedH,this.mapOver=!1,this.mapEndStone=null,this.stoneBombCall=null,this.enemyOutArr=[],this.curEnemyOut=[],this.conEnemyArr=[],this.curConOut=[],this.pauseArr=[],this.areaArr=[],this.areaEnemyArr=[],this.areaEnemyAwakeArr=[],this.pauseDis=[],this.loadAtlas(this._lvData.bgId)},loadAtlas:function(t){var e=this;cc.loader.loadRes("images/game/package_wall"+t,cc.SpriteAtlas,function(i,s){i?(o.DYTools.error("wall error"),e.loadAtlas(t)):(n.GValue.Atlas_Wall=s,e.loadData())})},loadData:function(){var t=this;this._mapData=s.GConfig.MapDict[this._lvData.level];var e=function(e){for(var i=0;i<e.eL.length;i++)t.enemyOutArr.push(e.eL[i]);for(i=0;i<e.vL.length;i++)t.wayVec.push(e.vL[i].clone());for(i=0;i<e.cL.length;i++)t.conEnemyArr.push(e.cL[i]);for(i=0;i<e.pL.length;i++)t.pauseArr.push(e.pL[i]);for(i=0;i<e.aL.length;i++)t.areaArr.push(e.aL[i]);t.bossData=e.boss,t.bossPause=e.bP,t._loadStart=!0};this._mapData?e(t._mapData):a.GFunc.preLoadMap(this._lvData.level,function(i){t._mapData=i,e(t._mapData)})},createMap:function(){var t=this._bgNode.getComponent(cc.Sprite);t.type=cc.Sprite.Type.TILED,t.spriteFrame=n.GValue.Atlas_Wall.getSpriteFrame("bg"+this._lvData.bgId),this._bgNode.setContentSize(this._mapData.bgW,this._mapData.bgH);for(var e=0;e<this._mapData.bL.length;e++)this.createBlock(this._mapData.bL[e]);for(e=0;e<this._mapData.wL.length;e++)this.createWall(this._mapData.wL[e]);for(e=0;e<this._mapData.aL.length;e++)this.createAreaEnemys(this._mapData.aL[e]);this.skel_stone.node.active=!0,this.skel_stone.node.position=cc.v2(-1e4,-1e4),this.skel_stone.node.zIndex=cc.macro.MAX_ZINDEX,this.calculateMoveDis(),this.mapReady(),this._finishCall&&this._finishCall()},createWall:function(t){var e=null;switch(t.dr){case 0:case 1:case 2:case 3:0==t.ty?e=cc.instantiate(this.pf_wall):1==t.ty?e=cc.instantiate(this.pf_wallD):2==t.ty&&(e=cc.instantiate(this.pf_wallS),this.mapEndStone=e);break;case 4:(e=cc.instantiate(this.pf_wall1)).zIndex=1;break;case 5:(e=cc.instantiate(this.pf_wallC)).zIndex=1;break;case 6:e=cc.instantiate(this.pf_wall2);break;default:return void o.DYTools.error("\u5899\u58c1tag\u9519\u8bef",t)}e.position=cc.v2(t.x,t.y),e.getComponent("CEntityWall").init(t,this._lvData.bgId),e.parent=this._wallNode,this._wallList.push(e)},createBlock:function(t){var e=cc.instantiate(this.pf_block);e.position=cc.v2(t.x,t.y);var i=e.getComponent(r);i.init(t,this._lvData.bgId),e.parent=this._wallNode,this.blockArr.push(i);var o=e.position.add(i.colCollider.node.position),n=i.width,s=i.height,a=cc.rect(o.x-n/2-0,o.y-s/2-0,n+0,s+0);this.blockRectArr.push(a)},createAreaEnemys:function(t){var e=s.GConfig.getMapAreaEnemyData(t.oId);if(e){for(var i=[],n=[],a=cc.v2(t.x,t.y),c=0;c<e.enemys.length;c++){var r=e.enemys[c];i.push(this._addSys.addSleepEnemys(r.id,r.pos.add(a),r.rotate)),n.push(r.awakePos.add(a))}this.areaEnemyArr.push(i),this.areaEnemyAwakeArr.push(n)}else o.DYTools.error("\u5730\u56fe\u533a\u57df\u602a\u65e0\u8be5\u914d\u7f6e:"+t.id,t.oId)},mapReady:function(){this.setMoveDir(!0);var t=this._mapData.vL[0],e=this.mapBottom.parent,i=cc.Vec2.ZERO;switch(this.curDirTag){case 1:i=e.convertToNodeSpaceAR(cc.v2(n.GValue.ViewCenter.x,0));break;case 2:i=e.convertToNodeSpaceAR(cc.v2(n.GValue.ViewCenter.x,n.GValue.Size_View.height));break;case 3:i=e.convertToNodeSpaceAR(cc.v2(n.GValue.Size_View.width,n.GValue.ViewCenter.y));break;case 4:i=e.convertToNodeSpaceAR(cc.v2(0,n.GValue.ViewCenter.y))}this.mapBottom.position=i.sub(t),this.mapTop.position=i.sub(t),this.mapTop.opacity=0},update:function(t){this._loadStart&&this._wayFinishCount>=this._wayCount&&(this.createMap(),this._loadStart=!1)},updateMap:function(t){if(this.gameStart&&this.curSpeed>=0&&!this.curDir.equals(cc.Vec2.ZERO)&&(this.mapStop?(this.curSpeed>0&&(this.curSpeed-=this.acceleratedSpeed),this.curSpeed<0&&(this.curSpeed=0)):(this.curSpeed<this.mapSpeed&&(this.curSpeed+=this.acceleratedSpeed),this.curSpeed>this.mapSpeed&&(this.curSpeed=this.mapSpeed)),this.curSpeed>0)){if(this.wayVec.length>1){var e=this.curSpeed*t,i=this.mapBottom.position.add(cc.v2(this.curDir.x*e,this.curDir.y*e));(o=this.checkMoveDest())[0]?(i=this.mapBottom.position.add(o[1]),this.wayVec.splice(0,1),this.setMoveDir(),this.setSpeed(),this.curDistance+=i.sub(this.mapBottom.position).mag()):this.curDistance+=e,this.mapBottom.position=i,this.mapTop.position=i}else if(1==this.wayVec.length){var o;e=this.curSpeed*t,i=this.mapBottom.position.add(cc.v2(this.curDir.x*e,this.curDir.y*e)),(o=this.checkMoveDest(!0))[0]?(i=this.mapBottom.position.add(o[1]),this.wayVec.splice(0,1),this.setMoveDir(),this.setSpeed(),this.curDistance+=i.sub(this.mapBottom.position).mag()):this.curDistance+=e,this.mapBottom.position=i,this.mapTop.position=i}this.refreshDistance()}},calculateMoveDis:function(){for(var t=0,e=this._mapData.vL,i=[],s=0,a=1;a<e.length;a++){var c=this.pauseArr[s],r=!1,l=!1;if(c||this.bossData){var h=e[a-1],d=e[a],u=Math.min(h.x,d.x),m=Math.min(h.y,d.y),p=0,f=0;o.DYTools.isNumberDiffRange(h.x,d.x,10)?(p=100,f=o.DYTools.numberDiffAbs(h.y,d.y)+4,u-=50):(p=o.DYTools.numberDiffAbs(h.x,d.x)+4,f=100,m-=50);var _=cc.rect(u,m,p,f);c?_.contains(cc.v2(c.x,c.y))&&(s++,r=!0):_.contains(cc.v2(this.bossData.x,this.bossData.y))&&(l=!0)}var y,g=0;if(1==a)(y=e[a].sub(e[a-1])).x>1?y.x-=n.GValue.ViewCenter.x/n.GValue.MapScale:y.x<-1&&(y.x+=n.GValue.ViewCenter.x/n.GValue.MapScale),y.y>1?y.y-=n.GValue.ViewCenter.y/n.GValue.MapScale:y.y<-1&&(y.y+=n.GValue.ViewCenter.y/n.GValue.MapScale),g=y.mag(),r?((v=cc.v2(c.x,c.y).sub(e[a-1])).x>1?v.x-=n.GValue.ViewCenter.x/n.GValue.MapScale:v.x<-1&&(v.x+=n.GValue.ViewCenter.x/n.GValue.MapScale),v.y>1?v.y-=n.GValue.ViewCenter.y/n.GValue.MapScale:v.y<-1&&(v.y+=n.GValue.ViewCenter.y/n.GValue.MapScale),i.push(cc.v2(t+v.mag(),0))):l&&((v=cc.v2(this.bossData.x,this.bossData.y).sub(e[a-1])).x>1?v.x-=n.GValue.ViewCenter.x/n.GValue.MapScale:v.x<-1&&(v.x+=n.GValue.ViewCenter.x/n.GValue.MapScale),v.y>1?v.y-=n.GValue.ViewCenter.y/n.GValue.MapScale:v.y<-1&&(v.y+=n.GValue.ViewCenter.y/n.GValue.MapScale),i.push(cc.v2(t+v.mag(),1)));else if(g=(y=(y=cc.v2(e[a].x,e[a].y)).sub(e[a-1])).mag(),r){var v=cc.v2(c.x,c.y).sub(e[a-1]);i.push(cc.v2(t+v.mag(),0))}else l&&(v=cc.v2(this.bossData.x,this.bossData.y).sub(e[a-1]),i.push(cc.v2(t+v.mag(),1)));t+=g}this.totalDistance=t,this.pauseDis=i},refreshDistance:function(){n.GValue.EntityWorld.gameUI.refreshDisPro(this.curDistance/this.totalDistance)},playEnterAct:function(){this.mapTop.runAction(cc.fadeIn(5*s.GConfig.actionFrameTime))},startGame:function(){this.bgShield.scale=1/n.GValue.MapScale,this.setSpeed(),this.gameStart=!0},playMapEndStoneBlink:function(){},playMapEndStoneAct:function(t){this.stoneBombCall=t,this.skel_stone.setAnimation(0,"play"+n.GValue.EntityWorld.levelData.bgId,!1),this.mapEndStone.active=!1,c.GAudio.playSound(c.Enum_Audio.stoneBomb)},setMapStop:function(t){this.mapStop=t},checkEnemyOut:function(t){if(void 0===t&&(t=!0),this.enemyOutArr.length>0){var e=this.enemyOutArr[0],i=this._wallNode.convertToWorldSpaceAR(cc.v2(0,0));if(i=i.add(cc.v2(e.x,e.y).mul(n.GValue.MapScale)),n.GValue.WorldRect.contains(i))return t&&this.enemyOutArr.splice(0,1),e}return null},checkContinuumEnemy:function(){if(this.conEnemyArr.length>0){var t=this.conEnemyArr[0],e=this._wallNode.convertToWorldSpaceAR(cc.v2(0,0));if(e=e.add(cc.v2(t.x,t.y).mul(n.GValue.MapScale)),n.GValue.WorldRect.contains(e))return this.conEnemyArr.splice(0,1),this.curConOut.push(t),t}return null},checkMapPause:function(){if(this.pauseArr.length>0){var t=this.pauseArr[0],e=this._wallNode.convertToWorldSpaceAR(cc.v2(0,0));if(e=e.add(cc.v2(t.x,t.y).mul(n.GValue.MapScale)),o.DYTools.isInSreen(e)){var i=o.DYTools.subScreen(0,e);if(o.DYTools.isNumberDiffRange(i.x,0,15)&&o.DYTools.isNumberDiffRange(i.y,0,15))return this.pauseArr.splice(0,1),0!=this.pauseArr.length||this.bossData||(this.mapOver=!0),t}}return null},checkAreaEnemy:function(){if(this.areaEnemyArr.length>0){for(var t=this._addSys.enemyNode.convertToWorldSpaceAR(cc.v2(0,0)),e=this.areaEnemyArr[0],i=this.areaEnemyAwakeArr[0],s=0;s<i.length;s++){var a=i[s];if(a=t.add(a),o.DYTools.isInSreen(a)){var c=e[s];c.awake(n.GValue.EntityWorld.player),n.GValue.EntityWorld.addEnemy(c),e.splice(s,1),i.splice(s,1),s--}}0==e.length&&(this.areaEnemyArr.splice(0,1),this.areaEnemyAwakeArr.splice(0,1))}},checkBoss:function(){if(this.bossData){var t=this._wallNode.convertToWorldSpaceAR(cc.v2(0,0));if(t=t.add(cc.v2(this.bossData.x,this.bossData.y).mul(n.GValue.MapScale)),o.DYTools.isInSreen(t)){var e=o.DYTools.subScreen(0,t);if(o.DYTools.isNumberDiffRange(e.x,0,15)&&o.DYTools.isNumberDiffRange(e.y,0,15))return this.mapOver=!0,this.bossData}}return null},setSpeed:function(){switch(this.curDirTag){case 1:case 2:this.mapSpeed=this.mapSpeedV;break;case 3:case 4:this.mapSpeed=this.mapSpeedH;break;default:o.DYTools.error("\u5730\u56fe\u65b9\u5411\u9519\u8bef",this.curDir),this.mapSpeed=this.mapSpeedV}},setMoveDir:function(t){if(void 0===t&&(t=!1),0!=this.wayVec.length){var e=cc.v2(0,0),i=cc.v2(0,0);t?(e=this.wayVec[0].mul(n.GValue.MapScale),this.wayVec.splice(0,1)):e=this.curDestVec,i=this.wayVec[0],this.curDestVec=i.mul(n.GValue.MapScale);var o=this.curDestVec.sub(e);if(this.curDir=o.neg().normalize(),this.curDirSpeed=this.curDir.mul(this.mapSpeed),Math.abs(o.x)-.5<0?o.y>0?this.curDirTag=1:this.curDirTag=2:Math.abs(o.y)-.5<0?o.x>0?this.curDirTag=4:this.curDirTag=3:o.x>0?o.y>0?this.curDirTag=8:this.curDirTag=7:o.y>0?this.curDirTag=5:this.curDirTag=6,1==this.wayVec.length){var s=cc.Vec2.ZERO,a=0;switch(this.curDirTag){case 1:s=cc.v2(0,20);break;case 2:s=cc.v2(0,-20),a=180;break;case 3:s=cc.v2(-20,0),a=-90;break;case 4:s=cc.v2(20,0),a=90}this.skel_stone.node.angle=a,this.skel_stone.node.position=this.mapEndStone.position.add(s),this.skel_stone.setAnimation(0,"light",!0)}}else this.mapOver=!0,this.curDir=cc.Vec2.ZERO},checkMoveDest:function(t){void 0===t&&(t=!1);var e=!1,i=this.mapBottom.convertToWorldSpaceAR(cc.v2(0,0));i=i.add(this.curDestVec);var n=o.DYTools.subScreen(0,i);switch(this.curDirTag){case 1:n.y<=0&&(e=!0);break;case 2:n.y>=0&&(e=!0);break;case 3:n.x>=0&&(e=!0);break;case 4:n.x<=0&&(e=!0);break;case 5:n.y<=0&&n.x>=0&&(e=!0);break;case 6:n.y>=0&&n.x>=0&&(e=!0);break;case 7:n.y>=0&&n.x<=0&&(e=!0);break;case 8:n.y<=0&&n.x<=0&&(e=!0)}var s=[];return s[0]=e,s[1]=n,s},getMapSpeedDir:function(){return this.mapStop||this.mapOver?cc.Vec2.ZERO:this.curDirSpeed}}),cc._RF.pop()},{CommonAudio:"CommonAudio",CommonConfig:"CommonConfig",CommonFunc:"CommonFunc",CommonValue:"CommonValue",EntityBlock:"EntityBlock",Tools:"Tools"}],NetBase:[function(t,e,i){"use strict";cc._RF.push(e,"e6a58ou0+5J2YFd9Irl0yga","NetBase");var o=e.exports;Object.defineProperty(o,"__esModule",{value:!0});var n=t("CommonFunc"),s=t("CommonConfig"),a=t("NetDown"),c=t("Tools"),r=t("GameData"),l=function(){function t(){this.userName_login="",this.list_request=[],this.is_request=!1,this._start_game=!1,this._resend=!1}return t.prototype.sendData=function(t){t.openId=r.TData.userId;var e=JSON.stringify(t);e=n.GFunc.encode(e),this.sendMsg(e)},t.prototype.sendMsg=function(t){var e=cc.loader.getXMLHttpRequest();e.open("POST",s.GConfig.Url_Login,!0),e.timeout=5e3,e.ontimeout=function(){c.DYTools.error("send_data--timeout")}.bind(this),e.onreadystatechange=function(){var t=e.readyState,i=e.status;if(4==t){if(200==i){this.list_request.splice(0,1);var o=e.responseText;o=n.GFunc.decode(o);var s=JSON.parse(o),c=s.msgId;c==a.Enum_Net_MsgId.Error_D?a.GNetDown.f_deal_error(s):a.GNetDown.f_deal_msg(c,s)}else this._resend||this.list_request.splice(0,1);this.is_request=!1}}.bind(this),e.send(t)},t.instance=new t,t}();o.NetBase=l,o.GNet=l.instance,cc._RF.pop()},{CommonConfig:"CommonConfig",CommonFunc:"CommonFunc",GameData:"GameData",NetDown:"NetDown",Tools:"Tools"}],NetDown:[function(t,e,i){"use strict";cc._RF.push(e,"3462bqx6xBFZochOiyuN9cS","NetDown");var o=e.exports;Object.defineProperty(o,"__esModule",{value:!0});var n=t("CommonFunc"),s=t("NetUp"),a=t("GameData");o.Enum_Net_MsgId=cc.Enum({Error_D:1e3,Login_U:1100,Login_D:1101,UserInfo_U:1102,UserInfo_D:1103,Form_U:1104,Form_D:1105,Rank_U:1206,Rank_D:1207,Score_U:1208,Score_D:1209,ADShare_U:1210,ADShare_D:1211});var c=function(){function t(){}return t.prototype.f_deal_msg=function(t,e){switch(t){case o.Enum_Net_MsgId.Login_D:e.hasOwnProperty("openId")&&a.TData.saveUserID(e.openId),e.hasOwnProperty("isNew")&&(a.TData.isNewPlayer=1==parseInt(e.isNew)),e.hasOwnProperty("now"),s.GNetUp.loginCallback&&(s.GNetUp.loginCallback(),s.GNetUp.loginCallback=null);break;case o.Enum_Net_MsgId.UserInfo_D:case o.Enum_Net_MsgId.Form_D:case o.Enum_Net_MsgId.Rank_D:case o.Enum_Net_MsgId.Score_D:}},t.prototype.f_deal_error=function(t){var e="";t.hasOwnProperty("requestId")&&parseInt(t.requestId),t.hasOwnProperty("errorId")&&parseInt(t.errorId),t.hasOwnProperty("errorMsg")&&(e=t.errorMsg),""!=e&&n.GFunc.showFloatTips(e)},t.instance=new t,t}();o.GNetDown=c.instance,cc._RF.pop()},{CommonFunc:"CommonFunc",GameData:"GameData",NetUp:"NetUp"}],NetUp:[function(t,e,i){"use strict";cc._RF.push(e,"4d4a8O1JWhA1oRVfKiCRHPy","NetUp");var o=e.exports,n=(t("CommonSdk"),t("NetBase"),t("CommonConfig"),t("ADShareManager"),t("GameData"),function(){function t(){this.loginCallback=null,this.userInfoCallback=null,this.rankCall=null}return t.prototype.checkLogin=function(t){},t.prototype.sendLogin=function(t,e){void 0===e&&(e=null),this.loginCallback=e},t.prototype.sendForm=function(t){},t.prototype.sendUserInfo=function(t,e){this.userInfoCallback=e},t.prototype.sendRank=function(t){void 0===t&&(t=null),this.rankCall=t},t.prototype.sendAdShare=function(t){},t.instance=new t,t}());o.GNetUp=n.instance,cc._RF.pop()},{ADShareManager:"ADShareManager",CommonConfig:"CommonConfig",CommonSdk:"CommonSdk",GameData:"GameData",NetBase:"NetBase"}],PanelAddProgram:[function(t,e,i){"use strict";cc._RF.push(e,"0dac6S0gLpKUIreAWsR7x7r","PanelAddProgram");var o=t("GameData"),n=t("CommonFunc"),s=t("CommonValue"),a=t("PfNum"),c=t("CommonEnum"),r=(t("CommonSdk"),t("CommonConfig")),l=t("Tools");cc.Class({extends:cc.Component,properties:{node_gray:cc.Node,node_count_gold:cc.Node,node_count_power:cc.Node,btn_get:cc.Node,btn_unfinish:cc.Node,node_arrow:cc.Node,btn_close:cc.Node,atlas_gameui:cc.SpriteAtlas,node_gold:cc.Node,node_power:cc.Node},onLoad:function(){this.reward_gold=0,this.reward_power=0;var t=this;n.GFunc.adjustScreen(this.node),n.GFunc.set_click(this.node_gray,function(){},this),n.GFunc.set_click(this.btn_get,function(){t.click_get()},this),n.GFunc.set_click(this.btn_unfinish,function(){t.click_unfinish()},this),n.GFunc.set_click(this.btn_close,function(){t.close()},this)},init:function(){var t=this,e=r.GConfig.getGbData(c.Enum_Gb.addMyProgram);if(e)for(var i=e.split("#"),h=0;h<i.length;h++){var d=l.DYTools.stringToNumber(i[h],"*");if(2==d.length){var u=d[0],m=d[1];u==c.Enum_Reward.Gold?this.reward_gold=m:u==c.Enum_Reward.Power&&(this.reward_power=m)}}var p=function(){o.TData.get_addProgram_enter()?(t.btn_get.active=!0,t.btn_unfinish.active=!1,t.node_arrow.active=!1):(t.btn_get.active=!1,t.btn_unfinish.active=!0,t.node_arrow.active=!0)};p(),this.schedule(p,1,cc.macro.REPEAT_FOREVER,1);var f=cc.instantiate(s.GValue.pf_num);this.node_count_gold.addChild(f);var _=f.getComponent(a.default);_.setParam(c.Enum_Num.Blood,cc.v2(.5,.5),2,this.atlas_gameui),_.setString(n.GFunc.getNumK(this.reward_gold)),f.scale=.5;var y=cc.instantiate(s.GValue.pf_num);this.node_count_power.addChild(y);var g=y.getComponent(a.default);g.setParam(c.Enum_Num.Blood,cc.v2(.5,.5),2,this.atlas_gameui),g.setString(n.GFunc.getNumK(this.reward_power)),y.scale=.5,this.reward_gold<=0&&(this.node_gold.active=!1,this.node_power.x=0),this.reward_power<=0&&(this.node_power.active=!1,this.node_gold.x=0)},click_get:function(){if(o.TData.get_addProgram_hasGet())n.GFunc.showFloatTips("\u4e0d\u80fd\u91cd\u590d\u9886\u53d6\u5956\u52b1");else{o.TData.set_addProgram_hasGet(1);var t=o.TData.getGold()+this.reward_gold,e=o.TData.getPower()+this.reward_power;o.TData.setGold(t),o.TData.setPower(e),n.GFunc.showFloatTips("\u9886\u53d6\u6210\u529f"),this.close(),s.GValue.HomeUI&&(s.GValue.HomeUI.refresh_addprogram(),s.GValue.HomeUI.refreshGold(),s.GValue.HomeUI.refreshPower())}},click_unfinish:function(){n.GFunc.showFloatTips('\u4ece"\u6211\u7684\u5c0f\u7a0b\u5e8f"\u8fdb\u5165\u540e\u9886\u53d6')},close:function(){this.node.destroy()}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonSdk:"CommonSdk",CommonValue:"CommonValue",GameData:"GameData",PfNum:"PfNum",Tools:"Tools"}],PanelBase:[function(t,e,i){"use strict";cc._RF.push(e,"ab2030GaRdLKq+w2knx8MPu","PanelBase"),cc.Class({extends:cc.Component,ctor:function(){this._btnAble=!0,this._btnTime=.3},start:function(){},btnClickAble:function(){return!!this._btnAble&&(this.scheduleOnce(function(){this._btnAble=!0}.bind(this),this._btnTime),!0)},onEnter:function(){},onExit:function(){this.node.removeFromParent()}}),cc._RF.pop()},{}],"PanelCheat copy":[function(t,e,i){"use strict";cc._RF.push(e,"0606dUGgatGbqUgSExpBvXp","PanelCheat copy");t("Tools"),t("CommonConfig"),t("CommonValue");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.load_force=!0,this.list_res_pf=[],this.list_res_atlas=[],this.list_res_image=[],this.list_res_spine=[],this.list_res_webtexture=[],this.list_res_json=[],this.len_pf=0,this.len_atlas=0,this.len_image=0,this.len_spine=0,this.len_webtexture=0,this.len_json=0,this.list_release_res_pf=[],this.list_release_res_atlas=[],this.list_release_res_image=[],this.list_release_res_spine=[],this.list_release_res_webtexture=[],this.list_release_res_json=[],this.callback_loadres_success=null,this.callback_progress_change=null,this.reload_count_cur=0,this.reload_count_total=5,this.load_number_cur=0,this.load_number_total=0}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonValue:"CommonValue",Tools:"Tools"}],PanelCheat:[function(t,e,i){"use strict";cc._RF.push(e,"deb42zu4BtLxr0/c4qGBmk1","PanelCheat");var o=t("GameData"),n=t("AndroidManager"),s=t("CommonValue");cc.Class({extends:cc.Component,properties:{energyInput:cc.EditBox,goldInput:cc.EditBox,levelInput:cc.EditBox,is_checkmark:cc.Toggle,not_checkmark:cc.Toggle},onLoad:function(){this.energyInput.string=String(o.TData.getPower()),this.goldInput.string=String(o.TData.getGold()),this.levelInput.string=String(o.TData.getStage()),1==n.AndroidMgr.getAfStatus()?this.is_checkmark.isChecked=!0:this.not_checkmark.isChecked=!0,window.xmgame.showBanner()},onDisable:function(){window.xmgame.hideBanner()},start:function(){},onBtnCancelClicked:function(){this.onBtnClicked(0)},onBtnSureClicked:function(){this.onBtnClicked(1)},onBtnIsBuyFb:function(){this.onBtnClicked(2)},onBtnNotBuyFb:function(){this.onBtnClicked(3)},onBtnClicked:function(t){switch(t){case 0:this.removeSelf();break;case 1:this.change(),s.GValue.DDSDK&&(s.GValue.DDSDK.parent=null),s.GValue.HomeUI=null,cc.director.loadScene("Game");break;case 2:n.AndroidMgr.setAfStatus(1);break;case 3:n.AndroidMgr.setAfStatus(0)}},removeSelf:function(){this.node.destroy()},change:function(){var t=Number(this.energyInput.string),e=Number(this.goldInput.string),i=Number(this.levelInput.string);o.TData.setPower(t),o.TData.setGold(e),o.TData.setStage(i),this.node.destroy()}}),cc._RF.pop()},{AndroidManager:"AndroidManager",CommonValue:"CommonValue",GameData:"GameData"}],PanelGold:[function(t,e,i){"use strict";cc._RF.push(e,"3ad8eBlxwBPorhi25IBoyS4","PanelGold");var o=t("CommonFunc"),n=t("CommonValue"),s=t("GameData"),a=t("ADShareManager"),c=t("CommonEnum"),r=t("PfNum"),l=t("CommonSdk"),h=t("AndroidManager");cc.Class({extends:cc.Component,properties:{node_gray:cc.Node,node_ui:cc.Node,node_num:cc.Node,btn_get:cc.Node,sp_get:cc.Sprite,font_collect:cc.Sprite,skel_btn_shine_get:sp.Skeleton,btn_close:cc.Node,btn_no:cc.Node,atlas_offline:cc.SpriteAtlas,atlas_gameui:cc.SpriteAtlas},onLoad:function(){this.adShare=1,this.count=0,this.com_num=null,this.successCall=null;var t=this;o.GFunc.set_click(this.node_gray,function(){},this),o.GFunc.set_click(this.btn_get,function(){t.get_normal()},this),o.GFunc.set_click(this.btn_close,function(){t.close()},this),o.GFunc.set_click(this.btn_no,function(){t.close()},this),o.GFunc.set_action_btn(this.btn_get,this.skel_btn_shine_get)},init:function(t,e,i){void 0===i&&(i=null),this.adShare=e,this.count=t,this.successCall=i,this.initUI(),c.Enum_AdShareType.Ad==e?l.GSDK.sendVideoShow(c.Enum_ADShare.AS_Gold):c.Enum_AdShareType.Share==e&&a.ADShareMgr.clearShareProbCount(c.Enum_ADShare.AS_Gold)},initUI:function(){var t=cc.instantiate(n.GValue.pf_num);this.node_num.addChild(t),this.com_num=t.getComponent(r),this.com_num.setParam(c.Enum_Num.Blood,cc.v2(.5,.5),2,this.atlas_gameui),this.com_num.setString(o.GFunc.getNumK(this.count)),1==h.AndroidMgr.getAfStatus()?(this.sp_get.node.active=!1,this.font_collect.node.x=0):this.adShare==c.Enum_AdShareType.Share&&o.GFunc.changeAtlasSprite(this.atlas_offline,this.sp_get,"icon_share")},get_normal:function(){var t=this,e=function(){t.close();var e=s.TData.getGold();s.TData.setGold(e+t.count),n.GValue.HomeUI.playGoldEffect(t.count,null),n.GValue.HomeUI.refreshGold(),n.GValue.HomeUI.refresh_sys_lvuptip(!0),s.TData.setHasGiftGold(!1),n.GValue.HomeUI.refresh_gift_gold(),t.successCall&&t.successCall()};a.ADShareMgr.adShare(c.Enum_ADShare.AS_Gold,e,e)},close:function(){this.node.destroy()}}),cc._RF.pop()},{ADShareManager:"ADShareManager",AndroidManager:"AndroidManager",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonSdk:"CommonSdk",CommonValue:"CommonValue",GameData:"GameData",PfNum:"PfNum"}],PanelLevelGuide:[function(t,e,i){"use strict";cc._RF.push(e,"7dbd4/wFgpDzYn899QSdSii","PanelLevelGuide");var o=t("CommonFunc");cc.Class({extends:cc.Component,properties:{node_gray:cc.Node,node_ui:cc.Node,node_close:cc.Node,skel_levelguide:sp.Skeleton},onLoad:function(){this.canClose=!1;var t=this;o.GFunc.set_click(this.node_gray,function(){},this),o.GFunc.set_click(this.node_close,function(){t.close()},this)},init:function(t){this.callback_close=t,this.play_action()},play_action:function(){var t=this;this.skel_levelguide.setAnimation(0,"play",!0),this.skel_levelguide.setCompleteListener(function(e,i){if("play"==(e.animation?e.animation.name:"")&&!t.canClose){t.canClose=!0,t.node_close.active=!0,t.node_close.opacity=0;var o=cc.fadeIn(1);t.node_close.runAction(o)}})},close:function(){this.canClose&&(this.callback_close&&(this.callback_close(),this.callback_close=null),this.node.destroy())}}),cc._RF.pop()},{CommonFunc:"CommonFunc"}],PanelLoading:[function(t,e,i){"use strict";cc._RF.push(e,"9c0b5yXgrdFHKPViwX+prJj","PanelLoading");var o=t("PanelBase"),n=t("AndroidManager");cc.Class({extends:o,properties:{},statics:{prefabPath:"prefab/Panel/Modal/PanelLoading"},start:function(){this.scheduleOnce(function(){n.AndroidMgr.hideAdLoading()},15)}}),cc._RF.pop()},{AndroidManager:"AndroidManager",PanelBase:"PanelBase"}],PanelLoad:[function(t,e,i){"use strict";cc._RF.push(e,"df565Nm+d9Nd69FYE2P7KZF","PanelLoad");var o=t("PanelBase");t("Tools"),t("CommonValue"),t("CommonEnum"),t("CommonConfig"),t("CommonFunc"),t("GameData"),t("CEntityKnife"),t("CommonAudio"),t("CommonSdk"),t("ADShareManager"),t("AndroidManager");cc.Class({extends:o,properties:{},statics:{prefabPath:"prefab/ui/PanelLoad"},timeSet:null,onEnable:function(){var t=this;console.log("onEnable"),this.isInLoaded=!0,this.loadTime=0,setTimeout(function(){t.isInLoaded=!1},5e3),this.timeSet&&clearInterval(this.timeSet),this.timeSet=setInterval(function(){window.xmgame.showVideo(function(){window.loadSuc&&window.loadSuc()},function(){window.loadFail&&window.loadFail()},function(){})},1e3)},onDisable:function(){console.log("onDisable"),this.loadTime=0,this.isInLoaded=!1,window.xmgame.isPlaying||window.loadFail&&window.loadFail(),this.timeSet&&clearInterval(this.timeSet)},closeWin:function(){this.isInLoaded||(this.isInLoaded=!1,this.node.active=!1)},onLoad:function(){},start:function(){},update:function(t){}}),cc._RF.pop()},{ADShareManager:"ADShareManager",AndroidManager:"AndroidManager",CEntityKnife:"CEntityKnife",CommonAudio:"CommonAudio",CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonSdk:"CommonSdk",CommonValue:"CommonValue",GameData:"GameData",PanelBase:"PanelBase",Tools:"Tools"}],PanelModal:[function(t,e,i){"use strict";cc._RF.push(e,"2d5d6d1qXdM3JOOPKkfTgqL","PanelModal");var o=t("PanelBase");cc.Class({extends:o,properties:{l_title:cc.Label,l_content:cc.Label,n_btn_cancle:cc.Node,n_btn_sure:cc.Node},ctor:function(){this.l_title=null,this.l_content=null,this.n_btn_cancle=null,this.n_btn_sure=null,this._sureCall=null,this._cancelCall=null,this._titleStr=""},start:function(){},onBtnCancelClicked:function(){this.onBtnClicked(0)},onBtnSureClicked:function(){this.onBtnClicked(1)},onBtnClicked:function(t){if(this.btnClickAble())switch(t){case 0:this._cancelCall&&this._cancelCall(),this.removeSelf();break;case 1:this._sureCall&&this._sureCall(),"0"!=this._titleStr&&this.removeSelf()}},removeSelf:function(){this.onExit()},create:function(t,e,i,o){this._sureCall=i,this._cancelCall=o,this._titleStr=t,this.l_content.string=e,"1"==t?(this.n_btn_cancle.active=!1,this.n_btn_sure.x=0):"2"==t?(this.n_btn_cancle.active=!1,this.n_btn_sure.x=0):(this.l_title.node.active=""!=t,this.l_title.string=t)}}),cc._RF.pop()},{PanelBase:"PanelBase"}],PanelNew:[function(t,e,i){"use strict";cc._RF.push(e,"21bd0k1MAlEeYrOZ07uKOO/","PanelNew");var o=t("PanelBase"),n=t("CommonConfig"),s=t("CommonFunc"),a=t("CommonValue"),c=t("GameData"),r=t("CommonAudio"),l=t("Types");cc.Class({extends:o,properties:{uiNode:cc.Node,btnSureNode:cc.Node,rewardNode:cc.Node,lightNode:cc.Node,fontNode:cc.Node,rewradSpr:cc.Sprite,playerSpr:cc.Sprite,weaponNode:cc.Node,shieldNode:cc.Node,atlas_ui:cc.SpriteAtlas},statics:{prefabPath:"prefab/ui/PanelNew"},onLoad:function(){this._dwId=0,this._startPos=cc.Vec2.ZERO,this._callBack=null,window.xmgame.showBanner()},onDisable:function(){window.xmgame.hideBanner()},start:function(){s.GFunc.adjustScreen(this.uiNode),this.playEnterAction(),this.weaponNode.runAction(cc.repeatForever(cc.rotateBy(1,-c.TData.HRotateSpeedIn)))},onBtnSureClicked:function(){this.shieldNode.active=!0;var t=this,e=cc.scaleTo(3*n.GConfig.actionFrameTime,.45,.9),i=cc.callFunc(function(){t._callBack&&t._callBack(),t.onExit()});this.lightNode.runAction(cc.sequence(e,i))},create:function(t,e,i){this._dwId=t,this._startPos=e,this._callBack=i,this.initReward(),this.initAction()},initReward:function(){switch(this.rewradSpr.spriteFrame=this.atlas_ui.getSpriteFrame("dwi"+this._dwId),this._dwId){case l.DWType.Knife:case l.DWType.Fire:case l.DWType.Ice:this.playerSpr.spriteFrame=a.GValue.Atlas_Game.getSpriteFrame("h"+this._dwId);for(var t=0;t<this.weaponNode.childrenCount;t++)this.weaponNode.children[t].getComponent(cc.Sprite).spriteFrame=a.GValue.Atlas_Game.getSpriteFrame("dw"+this._dwId);break;case l.DWType.Laser:this.playerSpr.spriteFrame=a.GValue.Atlas_Game.getSpriteFrame("h"+this._dwId),this.weaponNode.removeAllChildren();var e=new cc.Node;for(this.weaponNode.addChild(e),e.addComponent(cc.Sprite).spriteFrame=a.GValue.Atlas_Game.getSpriteFrame("dw2_0"),t=0;t<6;t++)(e=new cc.Node).anchorX=1,e.angle=60*t,this.weaponNode.addChild(e),e.addComponent(cc.Sprite).spriteFrame=a.GValue.Atlas_Game.getSpriteFrame("dw2")}},initAction:function(){this.lightNode.active=!1,this.btnSureNode.active=!1,this.fontNode.opacity=0},playEnterAction:function(){r.GAudio.playSound(r.Enum_Audio.newDW);var t=this,e=n.GConfig.actionFrameTime,i=this.rewardNode.scale,o=this.rewardNode.position,s=this.rewardNode.parent.convertToNodeSpaceAR(this._startPos);this.rewardNode.scale=.58,this.rewardNode.position=s;var a=cc.moveTo(3*e,s.add(cc.v2(2,73))),c=cc.moveTo(3*e,s.add(cc.v2(4,240))),l=cc.scaleTo(3*e,i),h=cc.spawn(c,l),d=cc.moveTo(5*e,o.add(cc.v2(0,-24))),u=cc.moveTo(5*e,o.add(cc.v2(0,5))),m=cc.moveTo(5*e,o),p=cc.scaleTo(2*e,i),f=cc.sequence(a,h,d,u,m,p);this.rewardNode.runAction(f),this.scheduleOnce(function(){t.lightNode.active=!0,t.lightNode.scaleX=.2,t.lightNode.scaleY=.19;var i=cc.scaleTo(e,.24,.7),o=cc.scaleTo(2*e,1.03,1.08),n=cc.scaleTo(4*e,1,1),s=cc.sequence(i,o,n);t.lightNode.runAction(s)},26*e),this.scheduleOnce(function(){t.fontNode.runAction(cc.fadeIn(5*e))},33*e),this.scheduleOnce(function(){t.btnSureNode.active=!0,t.btnSureNode.scale=.7;var i=cc.scaleTo(3*e,1.1),o=cc.scaleTo(3*e,.95),n=cc.scaleTo(3*e,1),s=cc.sequence(i,o,n);t.btnSureNode.runAction(s)},39*e)}}),cc._RF.pop()},{CommonAudio:"CommonAudio",CommonConfig:"CommonConfig",CommonFunc:"CommonFunc",CommonValue:"CommonValue",GameData:"GameData",PanelBase:"PanelBase",Types:"Types"}],PanelOffline:[function(t,e,i){"use strict";cc._RF.push(e,"37ca7ZWhddNk6jaeJLp6j2K","PanelOffline");var o=t("CommonFunc"),n=t("CommonValue"),s=t("GameData"),a=t("ADShareManager"),c=t("CommonEnum"),r=t("PfNum"),l=t("CommonSdk"),h=t("AndroidManager");cc.Class({extends:cc.Component,properties:{node_gray:cc.Node,node_ui:cc.Node,node_num:cc.Node,btn_normal:cc.Node,btn_2:cc.Node,sp_2:cc.Sprite,skel_btn_shine_2:sp.Skeleton,btn_3:cc.Node,sp_3:cc.Sprite,skel_btn_shine_3:sp.Skeleton,btn_close:cc.Node,btn_no:cc.Node,atlas_offline:cc.SpriteAtlas,atlas_gameui:cc.SpriteAtlas},onLoad:function(){this.factor=2,this.adShare=1,this.count=0,this.com_num=null;var t=this;o.GFunc.set_click(this.node_gray,function(){},this),o.GFunc.set_click(this.btn_normal,function(){t.get_normal()},this),o.GFunc.set_click(this.btn_2,function(){t.get_factor()},this),o.GFunc.set_click(this.btn_3,function(){t.get_factor()},this),o.GFunc.set_click(this.btn_close,function(){t.close()},this),o.GFunc.set_click(this.btn_no,function(){t.close()},this),this.btn_normal.active=!1,o.GFunc.set_action_btn(this.btn_2,this.skel_btn_shine_2),o.GFunc.set_action_btn(this.btn_3,this.skel_btn_shine_3),window.xmgame.showBanner()},onDisable:function(){window.xmgame.hideBanner()},init:function(t,e,i){var o=this;this.factor=e,this.adShare=i,this.count=t,this.initUI(),c.Enum_AdShareType.Ad==i?l.GSDK.sendVideoShow(c.Enum_ADShare.AS_Offline):c.Enum_AdShareType.Share==i&&a.ADShareMgr.clearShareProbCount(c.Enum_ADShare.AS_Offline),this.scheduleOnce(function(){o.btn_normal.active=!0,o.btn_normal.opacity=0;var t=cc.fadeTo(0,0),e=cc.fadeTo(.5,255),i=cc.sequence(t,e);o.btn_normal.runAction(i)},2)},initUI:function(){var t=this,e=cc.instantiate(n.GValue.pf_num);this.node_num.addChild(e),this.com_num=e.getComponent(r),this.com_num.setParam(c.Enum_Num.Blood,cc.v2(.5,.5),2,this.atlas_gameui),this.com_num.setString(o.GFunc.getNumK(this.count)),2==this.factor?(this.btn_2.active=!0,this.btn_3.active=!1,1==h.AndroidMgr.getAfStatus()?this.sp_2.node.active=!1:this.adShare==c.Enum_AdShareType.Share&&o.GFunc.changeAtlasSprite(this.atlas_offline,this.sp_2,"icon_share")):(this.btn_2.active=!1,this.btn_3.active=!0,1==h.AndroidMgr.getAfStatus()?this.sp_3.node.active=!1:this.adShare==c.Enum_AdShareType.Share&&o.GFunc.changeAtlasSprite(this.atlas_offline,this.sp_3,"icon_share")),this.schedule(function(){var e=s.TData.getOfflineGold();t.refresh_count(e)},1,cc.macro.REPEAT_FOREVER)},refresh_count:function(t){this.count=t,this.com_num&&this.com_num.setString(o.GFunc.getNumK(this.count))},get_normal:function(){var t=s.TData.getOfflineGold();n.GValue.HomeUI.getOfflineGoldValue(t),this.close()},get_factor:function(){var t=this,e=function(){t.close();var e=s.TData.getOfflineGold();n.GValue.HomeUI.getOfflineGoldValue(e*t.factor)};a.ADShareMgr.adShare(c.Enum_ADShare.AS_Offline,e,e)},close:function(){this.node.destroy(),window.initOfflineWinOk}}),cc._RF.pop()},{ADShareManager:"ADShareManager",AndroidManager:"AndroidManager",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonSdk:"CommonSdk",CommonValue:"CommonValue",GameData:"GameData",PfNum:"PfNum"}],PanelOver:[function(t,e,i){"use strict";var o;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"4da6bFgfDZB0bvc4zbsgY1+","PanelOver");var s=t("PanelBase"),a=t("Tools"),c=t("CommonValue"),r=t("CommonEnum"),l=t("CommonConfig"),h=t("CommonFunc"),d=t("GameData"),u=t("CEntityKnife"),m=t("CommonAudio"),p=t("CommonSdk"),f=t("ADShareManager"),_=t("AndroidManager");cc.Class((n(o={extends:s,properties:{layerNode:cc.Node,uiNode:cc.Node,levelNode:cc.Node,levelNum:cc.Node,passNode:cc.Node,lvList:[cc.Node],lvIconList:[cc.Sprite],successNode:cc.Node,sucFontNode:cc.Node,sucRewardNode:cc.Node,sucPowerNum:cc.Node,faildNode:cc.Node,rewardNode:cc.Node,rewardBgNode:cc.Node,goldFont:cc.Node,goldIcon:cc.Node,goldNum:cc.Node,addNode:cc.Node,addNum:cc.Node,btnGetNode:cc.Node,btnGet3Node:cc.Node,times3Node:cc.Node,type3Spr:cc.Sprite,skel3Light:sp.Skeleton,shieldNode:cc.Node,pf_num:cc.Prefab,atlas_ui:cc.SpriteAtlas},statics:{prefabPath:"prefab/ui/PanelOver"},onEnable:function(){window.xmgame.showFloat(),window.xmgame.showInter()},onDisable:function(){window.xmgame.hideFloat()},onLoad:function(){this.goldCount=0,this.addGoldCount=0,this.initGold=!1,this.addGold=!1,this.goldDelta=0,this.curGoldCount=0,this.rewardPower=0,this.totalGold=0,this._goldNum=null,this.layerNode.zIndex=-1,this.uiNode.zIndex=10,this.shieldNode.zIndex=100,this.isClickedOver=!1},start:function(){h.GFunc.adjustScreen(this.uiNode),this.initAction(),this.doEnterAction(),window.xmgame.showBanner()}},"onDisable",function(){window.xmgame.hideBanner()}),n(o,"update",function(t){if(this.initGold)e=(e=Math.floor(this.goldDelta*t))<1?1:e,this.curGoldCount+=e,this.curGoldCount>this.goldCount&&(this.curGoldCount=this.goldCount,this.initGold=!1),this._goldNum.setString(a.DYTools.numberToString(this.curGoldCount)),this.goldNum.width=this._goldNum.size.width*this._goldNum.node.scale;else if(this.addGold){var e;e=(e=Math.floor(this.goldDelta*t))<1?1:e,this.curGoldCount+=Math.floor(this.goldDelta*t),this.curGoldCount>this.goldCount+this.addGoldCount&&(this.curGoldCount=this.goldCount+this.addGoldCount,this.addGold=!1),this._goldNum.setString(a.DYTools.numberToString(this.curGoldCount)),this.goldNum.width=this._goldNum.size.width*this._goldNum.node.scale}}),n(o,"onBtnGetClicked",function(){this.onBtnClicked(0)}),n(o,"onBtnGet3Clicked",function(){this.onBtnClicked(1)}),n(o,"onBtnClicked",function(t){if(0==t)c.GValue.GameOverGold=this.totalGold,this.clickOver();else{var e=this;f.ADShareMgr.adShare(r.Enum_ADShare.AS_Over,function(){e.AdverSuccess(!1)},function(){e.AdverSuccess()})}}),n(o,"AdverSuccess",function(t){void 0===t&&(t=!0),c.GValue.GameOverGold=3*this.totalGold,this.totalGold*=2,d.TData.setGold(d.TData.getGold()+this.totalGold),this.clickOver()}),n(o,"clickOver",function(){this.isClickedOver||(this.isClickedOver=!0,setTimeout(function(){h.GFunc.preLoadMap(d.TData.getStage()),c.GValue.DDSDK&&(c.GValue.DDSDK.parent=null),c.GValue.HomeUI=null,cc.director.loadScene("Game")},300))}),n(o,"setGoldDelta",function(t){t=t<1?1:t,this.goldDelta=t}),n(o,"create",function(t,e,i){if(c.GValue.ArmsSub_TryWill=0,c.GValue.ArmsSub_TryFinish=0,this.totalGold=e,this.goldCount=e,this.rewardPower=i,t){var o=c.GValue.EntityWorld.player.getKnivesCount()-d.TData.WeaponCount+c.GValue.EntityWorld.landKnifes.length;o>0&&(this.totalGold+=o*c.GValue.EntityWorld.levelData.knifeGold),this.initLevelPass(),c.GValue.EntityWorld.levelData.fun>0&&d.TData.addListSub(c.GValue.EntityWorld.levelData.fun),d.TData.getMaxPassStage()<d.TData.getStage()&&this.rewardPower>0&&d.TData.setPower(d.TData.getPower()+this.rewardPower),d.TData.setMaxPassStage(d.TData.getStage()),d.TData.getStage()<l.GConfig.MaxLevel&&d.TData.setStage(d.TData.getStage()+1,!0)&&(c.GValue.ChangeStage=!0),this.totalGold>999&&(this.addNode.x=140),c.GValue.Level_FailCount=0}else{c.GValue.Level_FailCount++;var n=parseInt(l.GConfig.getGbData(r.Enum_Gb.SubTryDie)),s=d.TData.getTodayArmsSubTryCount(),u=parseInt(l.GConfig.getGbData(r.Enum_Gb.SubTryMaxCount)),m=d.TData.getStage(),y=l.GConfig.getLevelData(m),g=parseInt(l.GConfig.getGbData(r.Enum_Gb.SubTryStage));f.ADShareMgr.getActualAdShare(r.Enum_ADShare.AS_TrySub)==r.Enum_AdShareType.Ad&&y&&!y.boss&&m>=g&&c.GValue.Level_FailCount>=n&&s<u&&h.GFunc.randomTrySub(y.subTryLv)}if(d.TData.setGold(d.TData.getGold()+this.totalGold),this.shieldNode.active=!0,this.successNode.active=t,this.faildNode.active=!t,window.xmgame.sendEvents("level_end",t?"pass":"fail"),i>0){var v=a.DYTools.createPrefabCom(this.sucPowerNum,this.pf_num,"PfNum");v.setParam(r.Enum_Num.Blood,cc.v2(.5,.5),2,this.atlas_ui),v.setString("+"+i),v.node.scale=.68,this.sucPowerNum.width=v.size.width*v.node.scale}else this.sucRewardNode.active=!1;var C=a.DYTools.createPrefabCom(this.levelNum,this.pf_num,"PfNum");C.setParam(r.Enum_Num.Level,cc.v2(.5,.5),0,this.atlas_ui),C.setNum(c.GValue.EntityWorld.curLevel),this.levelNum.width=C.size.width*C.node.scale,this._goldNum=a.DYTools.createPrefabCom(this.goldNum,this.pf_num,"PfNum"),this._goldNum.setParam(r.Enum_Num.Blood,cc.v2(.5,.5),2,this.atlas_ui),this._goldNum.setString(a.DYTools.numberToString(e)),this._goldNum.node.scale=.68,this.goldNum.width=this._goldNum.size.width*this._goldNum.node.scale;var S=parseInt(l.GConfig.getGbData(r.Enum_Gb.GiftGoldStage));e>0&&c.GValue.EntityWorld.curLevel>S?(this.type3Spr.spriteFrame=this.atlas_ui.getSpriteFrame("video"),p.GSDK.sendVideoShow(r.Enum_ADShare.AS_Over)):this.btnGet3Node.active=!0,1==_.AndroidMgr.getAfStatus()&&(this.type3Spr.node.active=!1)}),n(o,"initLevelPass",function(){var t=d.TData.getStage();if(1==t){for(var e=1;e<this.lvList.length;e++)(i=this.lvList[e]).active=!0,this.createLvNum(i,t+e-1),e==this.lvList.length-1&&(i.opacity=0);for(e=1;e<this.lvIconList.length;e++)(o=this.lvIconList[e]).node.active=!0,e==this.lvIconList.length-1&&(o.node.opacity=0)}else if(t==l.GConfig.MaxLevel-1){for(e=0;e<this.lvList.length-1;e++){var i=this.lvList[e];this.createLvNum(i,t+e-1),i.active=!0}for(e=0;e<this.lvIconList.length-1;e++)(o=this.lvIconList[e]).node.active=!0}else if(t==l.GConfig.MaxLevel){for(e=0;e<this.lvList.length-2;e++)i=this.lvList[e],this.createLvNum(i,t+e-1),i.active=!0;for(e=0;e<this.lvIconList.length-2;e++)(o=this.lvIconList[e]).node.active=!0}else{for(e=0;e<this.lvList.length;e++)(i=this.lvList[e]).active=!0,this.createLvNum(i,t+e-1),e==this.lvList.length-1&&(i.opacity=0);for(e=0;e<this.lvIconList.length;e++){var o;(o=this.lvIconList[e]).node.active=!0,e==this.lvIconList.length-1&&(o.node.opacity=0)}}}),n(o,"createLvNum",function(t,e){var i=l.GConfig.getLevelData(e);if(i&&1==i.boss){var o=new cc.Node;o.parent=t;var n=o.addComponent(cc.Sprite);return n.spriteFrame=this.atlas_ui.getSpriteFrame("boss"),n}var s=a.DYTools.createPrefabCom(t,this.pf_num,"PfNum");return s.setParam(r.Enum_Num.Blood,cc.v2(.5,.5),0,this.atlas_ui),s.setNum(e),s.node.scale=.5,s}),n(o,"initAction",function(){this.shieldNode.active=!0,this.levelNode.active=!1,this.rewardNode.active=!1,this.goldNum.parent.parent.active=!1,this.btnGet3Node.opacity=0,this.times3Node.opacity=0,this.btnGetNode.opacity=0,this.btnGetNode.active=!1,this.successNode.active?(this.sucRewardNode.opacity=0,this.sucFontNode.active=!1,this.layerNode.opacity=1):this.faildNode.opacity=0}),n(o,"doEnterAction",function(){var t=this,e=l.GConfig.actionFrameTime;if(c.GValue.GameUI.playGameOverAction(),this.successNode.active){m.GAudio.playSound(m.Enum_Audio.overSuccess),t.sucFontNode.active=!0,t.sucFontNode.scale=2.8;var i=cc.scaleTo(5*e,.85),o=cc.callFunc(function(){var i=new cc.Node;t.sucFontNode.parent.addChild(i),i.position=t.sucFontNode.position,i.scale=.85,i.addComponent(cc.Sprite).spriteFrame=t.sucFontNode.getComponent(cc.Sprite).spriteFrame,i.runAction(cc.sequence(cc.spawn(cc.scaleTo(5*e,1.65),cc.fadeOut(5*e)),cc.removeSelf()))}),n=cc.scaleTo(3*e,1),s=cc.callFunc(function(){}),a=cc.sequence(i,o,n,s);t.sucFontNode.runAction(a),this.scheduleOnce(function(){t.levelNode.active=!0},5*e),this.scheduleOnce(function(){t.sucRewardNode.runAction(cc.fadeIn(5*e))},13*e),this.scheduleOnce(function(){c.GValue.EntityWorld.gamePass(function(){t.scheduleOnce(function(){t.successNode.active=!1,t.levelNode.active=!1,t.layerNode.opacity=255,t.playPassLevelAct()},10*e)})},21*e)}else{c.GValue.DDSDKUI&&c.GValue.DDSDKUI.showFavGame(!0),this.levelNode.active=!0,this.layerNode.opacity=1;var r=this.levelNode.position;this.levelNode.position=c.GValue.GameUI.curLevNum.parent.position,this.levelNode.runAction(cc.moveTo(11*e,r)),this.scheduleOnce(function(){m.GAudio.playSound(m.Enum_Audio.overFailed),t.faildNode.scale=2.8,t.faildNode.opacity=255;var i=cc.scaleTo(5*e,.85),o=cc.scaleTo(3*e,1),n=cc.sequence(i,o);t.faildNode.runAction(n)},5*e),this.scheduleOnce(function(){t.layerNode.runAction(cc.fadeIn(6*e))},10*e),this.scheduleOnce(function(){t.levelNum.parent.active=!0,t.rewardNode.active=!0,t.rewardNode.y-=73,t.rewardNode.runAction(cc.moveBy(4*e,cc.v2(0,73))),t.rewardBgNode.scaleY=.06,t.rewardBgNode.runAction(cc.scaleTo(4*e,1,.3))},18*e),this.scheduleOnce(function(){m.GAudio.playSound(m.Enum_Audio.overGoldChange),t.goldNum.parent.parent.active=!0,t.goldFont.runAction(cc.sequence(cc.scaleTo(5*e,1.65),cc.scaleTo(4*e,1))),t.goldNum.scale=.6;var i=cc.scaleTo(8*e,2.05),o=cc.scaleTo(6*e,1.85),n=cc.scaleTo(2*e,.95),s=cc.scaleTo(4*e,1),a=cc.sequence(i,o,n,s);t.goldNum.runAction(a),t.initGold=!0,t.setGoldDelta(t.goldCount/(6*e))},22*e),this.scheduleOnce(function(){t.rewardBgNode.runAction(cc.sequence(cc.scaleTo(4*e,1,1.05),cc.scaleTo(3*e,1,1)))},42*e),this.scheduleOnce(function(){var i=cc.scaleTo(3*e,1.05),o=cc.fadeIn(3*e),n=cc.spawn(i,o),s=cc.scaleTo(3*e,.95),a=cc.scaleTo(3*e,1),c=cc.sequence(n,s,a);t.btnGetNode.runAction(cc.sequence(c,cc.callFunc(function(){t.shieldNode.active=!1}))),t.scheduleOnce(function(){t.btnGetNode.active=!0,t.btnGetNode.scale=.75,t.btnGetNode.opacity=0,t.btnGetNode.runAction(cc.sequence(c,cc.callFunc(function(){t.shieldNode.active=!1})))},2),t.btnGet3Node.scale=.75,t.btnGet3Node.runAction(cc.sequence(c.clone(),cc.callFunc(function(){t.shieldNode.active=!1,t.times3Node.opacity=255}),cc.delayTime(.2),cc.callFunc(function(){t.btnGet3Node.stopAllActions(),t.btnGet3Node.scale=1,t.skel3Light.node.active=!0,h.GFunc.set_action_btn(t.btnGet3Node,t.skel3Light)})))},50*e)}}),n(o,"playPassLevelAct",function(){var t=this;c.GValue.PlayerSlowRatio=.2;var e=this,i=l.GConfig.actionFrameTime;this.passNode.active=!0;var o=this.passNode.position;this.passNode.y=o.y+60;var n=cc.moveTo(6*i,o);this.passNode.runAction(n);var s=0;this.lvList[2].active?(this.scheduleOnce(function(){var t=e.lvList[0].position.add(cc.v2(-40,0)),o=e.lvList[0].position,n=e.lvList[1].position,s=e.lvList[2].position,a=e.lvList[2].position.add(cc.v2(40,0)),c=[];c.push(t.sub(o)),c.push(o.sub(n)),c.push(n.sub(s)),c.push(s.sub(a));for(var r=e.lvList[0].active?0:1,l=r;l<e.lvList.length;l++){var h=e.lvList[l];h.zIndex=10;var d=cc.moveBy(7*i,c[l]);if(0==l){h.zIndex=0;var u=cc.fadeOut(7*i),p=cc.scaleTo(7*i,.8);h.runAction(cc.spawn(u,d,p))}else 3==l?(h.scale=.8,h.position=a,h.zIndex=0,u=cc.fadeIn(7*i),p=cc.scaleTo(7*i,1),h.runAction(cc.spawn(u,d,p))):1==l?h.runAction(cc.spawn(d,cc.scaleTo(7*i,1))):2==l&&h.runAction(cc.spawn(d,cc.scaleTo(7*i,1.5)))}t=e.lvIconList[0].node.position.add(cc.v2(-50,0)),o=e.lvIconList[0].node.position,n=e.lvIconList[1].node.position,s=n.add(cc.v2(50,0)),c.splice(0),c.push(t.sub(o)),c.push(o.sub(n)),c.push(n.sub(s));var f=function(t){var o=e.lvIconList[t],n=o.node,a=cc.moveBy(7*i,c[t]);if(0==t){var r=cc.fadeOut(7*i),l=cc.scaleTo(7*i,.8);n.runAction(cc.spawn(r,a,l))}else 2==t?(n.scale=.8,n.position=s,r=cc.fadeIn(7*i),l=cc.scaleTo(7*i,1),n.runAction(cc.spawn(r,a,l))):1==t&&(n.zIndex=10,n.runAction(cc.spawn(a,cc.scaleTo(7*i,1),cc.callFunc(function(){o.spriteFrame=e.atlas_ui.getSpriteFrame("pass")}))))};for(l=r;l<e.lvIconList.length;l++)f(l);m.GAudio.playSound(m.Enum_Audio.overLevelChange)},21*i),s=38*i):s=17*i,this.scheduleOnce(function(){e.rewardNode.active=!0,e.rewardNode.y-=73,e.rewardNode.runAction(cc.moveBy(4*i,cc.v2(0,73))),e.rewardBgNode.scaleY=.06,e.rewardBgNode.runAction(cc.scaleTo(4*i,1,.3)),e.scheduleOnce(function(){m.GAudio.playSound(m.Enum_Audio.overGoldChange),e.goldNum.parent.parent.active=!0,e.goldFont.runAction(cc.sequence(cc.scaleTo(5*i,1.65),cc.scaleTo(4*i,1))),e.goldNum.scale=.6;var t=cc.scaleTo(8*i,2.05),o=cc.scaleTo(6*i,1.85),n=cc.scaleTo(2*i,.95),s=cc.scaleTo(4*i,1),a=cc.sequence(t,o,n,s);e.goldNum.runAction(a),e.initGold=!0,e.setGoldDelta(e.goldCount/(14*i))},2*i),e.scheduleOnce(function(){h.GFunc.changePlayerParentToUI(e.node),e.layerNode.runAction(cc.fadeIn(6*i)),c.GValue.EntityWorld.player.playMoveAct(cc.v2(0,.5*-c.GValue.Size_View.height/c.GValue.MapScale-100),cc.v2(0,.3*-c.GValue.Size_View.height),null)},20*i);var o=c.GValue.EntityWorld.player.getKnivesCount()-d.TData.WeaponCount,n=0;if(o>0){var s=c.GValue.EntityWorld.player.followPlayerOut.knivesCmp.knives,p=[];e.addGoldCount=o*c.GValue.EntityWorld.levelData.knifeGold,e.scheduleOnce(function(){m.GAudio.playSound(m.Enum_Audio.overWGold);var t=e.goldIcon.convertToWorldSpaceAR(cc.v2(0,0));t=e.node.convertToNodeSpaceAR(t);for(var n=function(o){var n=a.DYTools.random_int(0,s.length-1),r=s[n];p.push(r),s.splice(n,1),e.knifeToGold(r.convertToWorldSpaceAR(cc.v2(0,0)),t,function(){r.runAction(cc.sequence(cc.fadeOut(3*i),cc.callFunc(function(){c.GValue.EntityWorld.player.followPlayerOut.node.emit("reduceKnife",r)}),cc.callFunc(function(){r.getComponent(u).removeSelf()})))})},r=0;r<o;r++)n()},41*i),e.scheduleOnce(function(){e.addNode.active=!0,e.addNode.scale=.7;var n=cc.scaleTo(4*i,1),s=cc.delayTime(30*i),c=cc.fadeOut(2*i),h=cc.callFunc(function(){m.GAudio.playSound(m.Enum_Audio.overGoldChange),e.addGold=!0,e.setGoldDelta(e.addGoldCount/(7*i))});e.addNode.runAction(cc.sequence(n,s,c,h));var u=a.DYTools.createPrefabCom(e.addNum,t.pf_num,"PfNum");u.setParam(r.Enum_Num.Blood,cc.v2(.5,.5),2,e.atlas_ui),u.setString("+"+o*l.GConfig.getLevelData(d.TData.getStage()-1).knifeGold),u.color=cc.color(255,204,0),u.node.scale=.6,e.addNum.width=u.size.width*u.node.scale},56*i),n=20*i}e.scheduleOnce(function(){h.GFunc.changePlayerParentToMap(),e.rewardBgNode.runAction(cc.sequence(cc.scaleTo(4*i,1,1.05),cc.scaleTo(3*i,1,1))),c.GValue.DDSDKUI&&c.GValue.DDSDKUI.showFavGame(!0)},56*i+n),e.scheduleOnce(function(){var t=cc.scaleTo(3*i,1.05),o=cc.fadeIn(3*i),n=cc.spawn(t,o),s=cc.scaleTo(3*i,.95),a=cc.scaleTo(3*i,1),c=cc.sequence(n,s,a,cc.callFunc(function(){e.shieldNode.active=!1}));e.scheduleOnce(function(){e.btnGetNode.active=!0,e.btnGetNode.scale=.75,e.btnGetNode.opacity=0,e.btnGetNode.runAction(c)},2),e.btnGet3Node.scale=.75,e.btnGet3Node.runAction(cc.sequence(cc.delayTime(4*i),c.clone(),cc.callFunc(function(){e.shieldNode.active=!1,e.times3Node.opacity=255}),cc.delayTime(.2),cc.callFunc(function(){e.btnGet3Node.stopAllActions(),e.btnGet3Node.scale=1,e.skel3Light.node.active=!0,h.GFunc.set_action_btn(e.btnGet3Node,e.skel3Light)})))},63*i+n)},s)}),n(o,"knifeToGold",function(t,e,i){var o=l.GConfig.actionFrameTime;t=this.node.convertToNodeSpaceAR(t);var n=new cc.Node;n.position=t,this.node.addChild(n,11);var s=new cc.Node;n.addChild(s),s.addComponent(cc.Sprite).spriteFrame=this.atlas_ui.getSpriteFrame("gold"),s.setContentSize(32,32),s.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(3*o,-1,1),cc.scaleTo(3*o,1,1)))),s.scale=.6;var c=cc.scaleTo(o*a.DYTools.random_int(2,4),1.2),r=cc.scaleTo(o*a.DYTools.random_int(2,4),1),h=cc.moveTo(5*o,t.add(cc.v2(16,-40))),d=cc.moveTo(8*o,e),u=cc.sequence(c,cc.callFunc(function(){i&&i()}),r,h,d,cc.removeSelf());n.runAction(u)}),o)),cc._RF.pop()},{ADShareManager:"ADShareManager",AndroidManager:"AndroidManager",CEntityKnife:"CEntityKnife",CommonAudio:"CommonAudio",CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonSdk:"CommonSdk",CommonValue:"CommonValue",GameData:"GameData",PanelBase:"PanelBase",Tools:"Tools"}],PanelPower:[function(t,e,i){"use strict";cc._RF.push(e,"764eckNWxhIA7JZKF0dlakg","PanelPower");var o=t("CommonFunc"),n=t("CommonValue"),s=t("GameData"),a=t("ADShareManager"),c=t("CommonEnum"),r=t("PfNum"),l=t("CommonSdk"),h=t("AndroidManager");cc.Class({extends:cc.Component,properties:{node_gray:cc.Node,node_ui:cc.Node,node_num:cc.Node,btn_get:cc.Node,sp_get:cc.Sprite,font_collect:cc.Sprite,skel_btn_shine_get:sp.Skeleton,btn_close:cc.Node,btn_no:cc.Node,atlas_offline:cc.SpriteAtlas,atlas_gameui:cc.SpriteAtlas},onLoad:function(){this.adShare=1,this.count=0,this.com_num=null;var t=this;o.GFunc.set_click(this.node_gray,function(){},this),o.GFunc.set_click(this.btn_get,function(){t.get_normal()},this),o.GFunc.set_click(this.btn_close,function(){t.close()},this),o.GFunc.set_click(this.btn_no,function(){t.close()},this),o.GFunc.set_action_btn(this.btn_get,this.skel_btn_shine_get),window.xmgame.showBanner()},onDisable:function(){window.xmgame.hideBanner()},init:function(t,e){this.adShare=e,this.count=t,this.initUI(),c.Enum_AdShareType.Ad==e?l.GSDK.sendVideoShow(c.Enum_ADShare.AS_Power):c.Enum_AdShareType.Share==e&&a.ADShareMgr.clearShareProbCount(c.Enum_ADShare.AS_Power)},initUI:function(){var t=cc.instantiate(n.GValue.pf_num);this.node_num.addChild(t),this.com_num=t.getComponent(r),this.com_num.setParam(c.Enum_Num.Blood,cc.v2(.5,.5),2,this.atlas_gameui),this.com_num.setString(o.GFunc.getNumK(this.count)),1==h.AndroidMgr.getAfStatus()?(this.sp_get.node.active=!1,this.font_collect.node.x=0):this.adShare==c.Enum_AdShareType.Share&&o.GFunc.changeAtlasSprite(this.atlas_offline,this.sp_get,"icon_share")},get_normal:function(){var t=this;window.loadSuc=function(){t.close();var e=s.TData.getPower();n.GValue.HomeUI.reducePowerAction(t.count,!1),s.TData.setPower(e+t.count),n.GValue.HomeUI.refreshPower(),s.TData.setHasGiftPower(!1),n.GValue.HomeUI.refresh_gift_power()},window.loadFail=function(){},window.xmgame.showVideo(function(){t.close();var e=s.TData.getPower();n.GValue.HomeUI.reducePowerAction(t.count,!1),s.TData.setPower(e+t.count),n.GValue.HomeUI.refreshPower(),s.TData.setHasGiftPower(!1),n.GValue.HomeUI.refresh_gift_power()},function(){},function(){window.xmgame.showPanelLoad()})},close:function(){this.node.destroy()}}),cc._RF.pop()},{ADShareManager:"ADShareManager",AndroidManager:"AndroidManager",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonSdk:"CommonSdk",CommonValue:"CommonValue",GameData:"GameData",PfNum:"PfNum"}],PanelRevive:[function(t,e,i){"use strict";cc._RF.push(e,"9bc09NYkAhMGIop8So085JW","PanelRevive");var o=t("PanelBase"),n=t("Tools"),s=t("CommonEnum"),a=t("CommonFunc"),c=t("GameData"),r=t("ADShareManager"),l=t("CommonValue"),h=t("CommonConfig"),d=t("CommonSdk"),u=t("AndroidManager");cc.Class({extends:o,properties:{uiNode:cc.Node,node_time:cc.Node,node_btn:cc.Node,node_tips:cc.Node,spr_type:cc.Sprite,skel_light:sp.Skeleton,num_time:cc.Node,node_shield:cc.Node,s_time:cc.Sprite,pf_num:cc.Prefab,atlas_ui:cc.SpriteAtlas},statics:{prefabPath:"prefab/ui/PanelRevive"},onLoad:function(){this._recoverDuration=5,this._recoverTime=5,this._recoverAble=!0,this._recoverType=0,this._timeNum=null,this._curTime=5,this._isVideo=!1,this._isFree=!1,this._closeCall=null,this._okCall=null},start:function(){this._btnTime=1,a.GFunc.adjustScreen(this.uiNode),window.xmgame.showBanner()},onDisable:function(){window.xmgame.hideBanner()},update:function(t){if(!this._isVideo&&this._recoverAble&&this._timeNum)if(this._recoverTime-=1/60,this._recoverTime<=0)this._recoverAble=!1,this.removeSelf();else{if(this._timeNum){var e=Math.ceil(this._recoverTime);this._curTime!=e&&(this._curTime=e),this._timeNum.setNum(e)}this.s_time.fillRange=this._recoverTime/this._recoverDuration}},removeSelf:function(t){void 0===t&&(t=0);var e=function(){this._closeCall&&this._closeCall(),this.onExit()}.bind(this);t>0?this.scheduleOnce(e,t):e()},onBtnRecoverClicked:function(){if(this.btnClickAble()){var t=this;t._isFree?t.AdverSuccess():(t._isVideo=!0,r.ADShareMgr.adShare(s.Enum_ADShare.AS_Over,function(){console.log("123213a"),t._isVideo=!1,t.AdverSuccess()},function(){console.log("123213b"),t._isVideo=!1},null,function(){console.log("123213c"),t._isVideo=!1}))}},create:function(t,e,i){if(void 0===i&&(i=null),this._closeCall=e,this._okCall=i,t){this.node_time.active=!1,this.node_btn.active=!1,this.node_tips.active=!0;var o=this;this.scheduleOnce(function(){o.node_btn.active=!0,o.node_btn.opacity=1,o.node_btn.runAction(cc.sequence(cc.fadeIn(.2),cc.callFunc(function(){a.GFunc.set_action_btn(o.node_btn,o.skel_light)})))},1)}else this.node_time.active=!0,this.node_btn.active=!0,this.node_tips.active=!1,a.GFunc.set_action_btn(this.node_btn,this.skel_light),this._timeNum=n.DYTools.createPrefabCom(this.num_time,this.pf_num,"PfNum"),this._timeNum.setParam(s.Enum_Num.Blood,cc.v2(.5,.5),2,this.atlas_ui);this.node_tips.active||parseInt(h.GConfig.getGbData(s.Enum_Gb.ReviveFree))>=l.GValue.EntityWorld.curLevel?this._isFree=!0:this._isFree=!1,this._isFree?this.spr_type.node.active=!1:l.GValue.AdShareSwitch&&(this.spr_type.spriteFrame=this.atlas_ui.getSpriteFrame("video"),d.GSDK.sendVideoShow(s.Enum_ADShare.AS_Revive)),1==u.AndroidMgr.getAfStatus()&&(this.spr_type.node.active=!1)},doRecover:function(){var t=this;this.scheduleOnce(function(){t._okCall&&(c.TData.isFirstRevive()&&c.TData.setFirstRevive(),t._okCall(),t.onExit()),t.node_shield.active=!1},.1)},AdverSuccess:function(){this._recoverAble=!1,this.node_shield.active=!0,this.doRecover()}}),cc._RF.pop()},{ADShareManager:"ADShareManager",AndroidManager:"AndroidManager",CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonSdk:"CommonSdk",CommonValue:"CommonValue",GameData:"GameData",PanelBase:"PanelBase",Tools:"Tools"}],PanelSetting:[function(t,e,i){"use strict";cc._RF.push(e,"59425QaDWJNYZV4M3Ok25Zs","PanelSetting");var o=t("PanelBase"),n=t("CommonAudio"),s=t("GameData"),a=t("CommonConfig"),c=t("CommonSdk");cc.Class({extends:o,properties:{spr_sound:cc.Sprite,spr_vibrate:cc.Sprite,lab_version:cc.Label,atlas_ui:cc.SpriteAtlas},statics:{prefabPath:"prefab/ui/PanelSetting"},onLoad:function(){},start:function(){this.lab_version.string="V"+a.GConfig.Version_Num,this.refreshSound(),this.refreshVibrate(),window.xmgame.showInterByType("pause"),window.xmgame.showBanner()},onDisable:function(){window.xmgame.hideBanner()},onBtnSoundClicked:function(){this.onBtnClicked(1)},onBtnVibrateClicked:function(){this.onBtnClicked(2)},onBtnCloseClicked:function(){this.onBtnClicked(0)},onBtnGgClicked:function(){this.onBtnClicked(3)},onBtnFbClicked:function(){this.onBtnClicked(4)},onBtnPPClicked:function(){this.onBtnClicked(5)},onBtnTSClicked:function(){this.onBtnClicked(6)},onBtnClicked:function(t){if(this.btnClickAble())switch(t){case 0:this.onExit();break;case 1:n.GAudio.musicOn=!n.GAudio.musicOn,n.GAudio.soundOn=n.GAudio.musicOn,this.refreshSound();break;case 2:1==s.TData.SettingData.shake?s.TData.setSettingShake(0):s.TData.setSettingShake(1),this.refreshVibrate();break;case 3:c.GSDK.openUrl("https://play.google.com/store/apps/details?id=com.gameley.blademaster.spinning.en");break;case 4:c.GSDK.openUrl("https://www.facebook.com/Blade-Master-2171609006411569");break;case 5:c.GSDK.openUrl("https://docs.google.com/document/d/e/2PACX-1vSe03ILolzBI5Zro4dqOoqtsML8374TRd0gOzSTUWlgl8oqD1NQIDhipLh_8A14GdoxPB7CSJJyfmcL/pub");break;case 6:c.GSDK.openUrl("https://docs.google.com/document/d/e/2PACX-1vTjpxjPfJUt5J_W2Cz30TqbOBG9hFMxPsDyOq9Im8cgiTj4rAWmks5qXsVWhW2DGFkzOPegHuKcclXl/pub")}},refreshSound:function(){n.GAudio.musicOn?this.spr_sound.spriteFrame=this.atlas_ui.getSpriteFrame("sy"):this.spr_sound.spriteFrame=this.atlas_ui.getSpriteFrame("sy2")},refreshVibrate:function(){var t=s.TData.SettingData.shake;this.spr_vibrate.spriteFrame=1==t?this.atlas_ui.getSpriteFrame("zd"):this.atlas_ui.getSpriteFrame("zd2")}}),cc._RF.pop()},{CommonAudio:"CommonAudio",CommonConfig:"CommonConfig",CommonSdk:"CommonSdk",GameData:"GameData",PanelBase:"PanelBase"}],PfFrameAnim:[function(t,e,i){"use strict";cc._RF.push(e,"a8cfef4AVRLk53b1u4Z4+JA","PfFrameAnim");var o=t("CommonValue"),n=t("CommonConfig");cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite},ctor:function(){this.imageSrc="",this.count=0,this.duration=0,this.imageArr=[],this.time=0,this.index=0,this.selfUpdate=!0},init:function(t,e,i,o,n,s,a){void 0===n&&(n=null),void 0===s&&(s=null),void 0===a&&(a=null),this.node.opacity=0,this.atlas=t,this.imageSrc=e,this.count=i,this.duration=o,this.call=n,this.resetCall=a,this.stopCall=s;for(var c=0;c<i;c++)this.imageArr.push(this.atlas.getSpriteFrame(e+c))},reset:function(){this.time=0,this.index=0,this.sprite.spriteFrame=this.imageArr[0],this.node.opacity=255,this.resetCall&&this.resetCall()},stop:function(t){void 0===t&&(t=!1),this.stopCall&&this.stopCall(),t?this.node.runAction(cc.fadeOut(4*n.GConfig.actionFrameTime)):this.node.opacity=0},isPlaying:function(){return this.node.opacity>100},update:function(t){this.selfUpdate&&(t*=o.GValue.PauseSlowRatio,this.updateGameLogic(t))},updateGameLogic:function(t){this.node.opacity>0&&(this.time+=t,this.time>=this.duration&&(this.index++,this.index>=this.count&&(this.index=0,this.call&&this.call()),this.time=0,this.sprite.spriteFrame=this.imageArr[this.index]))}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonValue:"CommonValue"}],PfNum:[function(t,e,i){"use strict";cc._RF.push(e,"9bd6b8Uuv1BCYI9pzrwWETt","PfNum");var o=t("CommonEnum");cc.Class({extends:cc.Component,properties:{},ctor:function(){this._type=o.Enum_Num.Blood,this._anchor=cc.v2(.5,.5),this._diffX=0,this.m_signOffsetY=5,this._add_after=!1,this._sem_diffY=0,this.g_diffY=0,this.add_diffY=0,this.sub_diffY=0,this._width=0,this._height=0,this._value=0,this._atlas=null,this._path="",this.numNode=null,this._color=cc.Color.WHITE,Object.defineProperty(this,"color",{set:function(t){this._color=t;for(var e=this.node.children,i=0;i<e.length;i++){var o=e[i];o.color=t;for(var n=o.children,s=0;s<n.length;s++)n[s].color=t}},enumerable:!0,configurable:!0}),Object.defineProperty(this,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(this,"size",{get:function(){return cc.size(this._width,this._height)},enumerable:!0,configurable:!0})},setParam:function(t,e,i,o){this.dict={},this._type=t,this._anchor=e,this._diffX=i,this._path="n_"+this._type+"_",this._atlas=o,this.numNode=new cc.Node,this.node.addChild(this.numNode);for(var n=0;n<10;n++)this.dict[n.toString()]=this._path+n;var s="a".charCodeAt(0);for(n=0;n<26;n++){var a=String.fromCharCode(s+n);this.dict[a]=this._path+a}this.dict["."]=this._path+"pt",this.dict.k=this._path+"k",this.dict["+"]=this._path+"add",this.dict["-"]=this._path+"sub"},f_set_sem_diffY:function(t){this._sem_diffY=t},setString:function(t){var e=t;if(this._width=0,this._height=0,this._atlas){for(var i=0;i<e.length;i++){(c=this.numNode.children[i])?c.opacity=255:((c=new cc.Node).addComponent(cc.Sprite),c.setAnchorPoint(0,0),c.color=t,this.numNode.addChild(c));var o=0,n=e[i],s=this.dict[n];"-"==n&&(o+=this.sub_diffY),c.getComponent(cc.Sprite).spriteFrame=this._atlas.getSpriteFrame(s);var a=c.getContentSize();c.x=this._width+this._diffX,c.y=o,this._width=this._width+this._diffX+a.width,this._height=a.height}for(i=this.numNode.childrenCount-1;i>=e.length;i--){var c;(c=this.numNode.children[i]).opacity=0}var r=-this._width*this._anchor.x,l=-this._height*this._anchor.y;this.numNode.position=cc.v2(r,l)}},setNum:function(t){this._value=t,this.setString(t.toString())}}),cc._RF.pop()},{CommonEnum:"CommonEnum"}],PfTip:[function(t,e,i){"use strict";cc._RF.push(e,"c90ecIvwoxCCKVuRESxOQWD","PfTip");var o=t("CommonFunc");cc.Class({extends:cc.Component,properties:{label_font:cc.Label,sp_font:cc.Sprite},onLoad:function(){},start:function(){o.GFunc.adjustScreen(this.node)},show:function(t,e,i,n){void 0===n&&(n=null),this.node.y=null==n?0:-150,t.length>0?(this.label_font.node.active=!0,this.sp_font.node.active=!1,this.label_font.string=t):(this.label_font.node.active=!1,this.sp_font.node.active=!0,o.GFunc.changeAtlasSprite(e,this.sp_font,i));var s=cc.moveBy(1.5,cc.v2(0,100)),a=cc.fadeOut(.2),c=cc.sequence(s,a,cc.removeSelf());this.node.runAction(c)}}),cc._RF.pop()},{CommonFunc:"CommonFunc"}],PlayerAnimComponent:[function(t,e,i){"use strict";cc._RF.push(e,"6ec4cAezphIXakTEIo8j3pD","PlayerAnimComponent");var o=t("PfFrameAnim"),n=t("CommonValue");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.uiNode=null,this.xuliFrameAnim=null,this.xuliCall=null},init:function(t){this.uiNode=t;var e=this,i=cc.instantiate(n.GValue.pf_anim);i.scale=2,this.xuliFrameAnim=i.getComponent(o),this.xuliFrameAnim.init(n.GValue.Atlas_Game,"adw0_",6,.02,function(){e.onXuliAnimFinished()}),this.uiNode.addChild(i)},onXuliAnimFinished:function(){this.xuliCall&&this.xuliCall(),this.xuliFrameAnim.stop()},playXuliAnim:function(t){this.xuliCall=t,this.xuliFrameAnim.reset()}}),cc._RF.pop()},{CommonValue:"CommonValue",PfFrameAnim:"PfFrameAnim"}],PlayerCollisionEnemyComponent:[function(t,e,i){"use strict";cc._RF.push(e,"2fea4JpduRHe4yF3vKci+nn","PlayerCollisionEnemyComponent");var o=t("CommonValue"),n=t("EntityEnemy");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.player=null,this.enemys=[],this.radius=0},init:function(t){this.player=t,this.enemys=o.GValue.EntityWorld.Enemys,this.radius=20},updateGameLogic:function(t){if(!this.player.isDead&&!this.player.invincible){for(var e=!1,i=this.player.getPositionForMap(),s=0,a=this.enemys;s<a.length;s++){var c=(g=a[s]).radius+this.radius,r=cc.rect(i.x-c,i.y-c,2*c,2*c),l=g.node.position;if(r.contains(l)&&i.sub(l).mag()<=c){this.node.emit("die",g),e=!0;break}}if(!e)for(var h in i=cc.v2(0,0),o.GValue.EntityWorld.SnakeEnemys){var d=o.GValue.EntityWorld.SnakeEnemys[h];if(d)for(var u=d.list_snake,m=0;m<u.length;m++){var p=u[m];if(c=d.dic_radius[m]+this.radius,r=cc.rect(i.x-c,i.y-c,2*c,2*c),l=p.convertToWorldSpaceAR(cc.v2(0,0)),l=this.node.convertToNodeSpaceAR(l),r.contains(l)&&i.sub(l).mag()<=c){o.GValue.EntityWorld.player.dieBySnake(),e=!0;break}}}if(!e)for(var h in i=cc.v2(0,0),o.GValue.EntityWorld.CircleEnemys){var f=o.GValue.EntityWorld.CircleEnemys[h];if(f){var _=f.dic_node;for(var y in _){var g;if((g=(p=_[y]).getComponent(n))&&(c=g.radius+this.radius,r=cc.rect(i.x-c,i.y-c,2*c,2*c),l=p.convertToWorldSpaceAR(cc.v2(0,0)),l=this.node.convertToNodeSpaceAR(l),r.contains(l)&&i.sub(l).mag()<=c)){this.node.emit("die",g),e=!0;break}}}}if(!e)for(var h in i=cc.v2(0,0),o.GValue.EntityWorld.FireEnemys){var v=o.GValue.EntityWorld.FireEnemys[h];if(!v.isDead&&v){if(p=v.node_collider,c=v.radius+this.radius,r=cc.rect(i.x-c,i.y-c,2*c,2*c),l=p.convertToWorldSpaceAR(cc.v2(0,0)),l=this.node.convertToNodeSpaceAR(l),r.contains(l)&&i.sub(l).mag()<=c){o.GValue.EntityWorld.player.dieBySnake(),e=!0;break}if(!e){var C=v.list_hand_collider;for(m=0;m<C.length;m++){var S=C[m],D=S.getComponent(cc.CircleCollider);if(D){var T=D.radius+this.radius,G=cc.rect(i.x-T,i.y-T,2*T,2*T),A=S.convertToWorldSpaceAR(cc.v2(0,0));if(A=this.node.convertToNodeSpaceAR(A),G.contains(A)&&i.sub(A).mag()<=T){o.GValue.EntityWorld.player.dieBySnake(),e=!0;break}}}}}}if(!e)for(var w in i=cc.v2(0,0),o.GValue.DicBossEnemy){var b=o.GValue.DicBossEnemy[w];for(var h in b)if(b[h].isPlayerDie(this.node,i,this.radius)){o.GValue.EntityWorld.player.dieBySnake(),e=!0;break}if(e)break}}}}),cc._RF.pop()},{CommonValue:"CommonValue",EntityEnemy:"EntityEnemy"}],PlayerDWElectricityComponent:[function(t,e,i){"use strict";cc._RF.push(e,"ef1c17YoiBM3Zg1/2O7XG6U","PlayerDWElectricityComponent");var o=t("CommonValue"),n=t("GameData"),s=t("Types"),a=t("Tools");t("PlayerDeputyWeaponBase");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.uiNode=null,this.atkNode=null,this.knives=[],this.heroRotate=null,this.duration=0,this.atkRadius=0,this.atkCount=0,this.atkHurt=0,this.curAtkHurt=0,this.time=0},init:function(t){this.followEntity=t,this.initUI(),this.heroRotate=a.DYTools.addScript(this.uiNode,"CHRotate")},initUI:function(){this.uiNode=new cc.Node,this.node.addChild(this.uiNode),this.atkNode=new cc.Node,this.node.addChild(this.atkNode);var t=new cc.Node;this.uiNode.addChild(t,-1),t.addComponent(cc.Sprite).spriteFrame=o.GValue.Atlas_Game.getSpriteFrame("dw5_0");for(var e=o.GValue.EntityWorld.addEntitySys.addDWKnife(n.TData.HWeaponCountIn,s.DWType.Electricity),i=cc.v2(0,n.TData.HeroRaduisIn),a=360/e.length,c=0;c<e.length;c++){var r=e[c].node,l=a*c;r.parent=this.uiNode,r.angle=l,r.position=i.rotate(cc.misc.degreesToRadians(-l)),this.knives.push(r)}},updateGameLogic:function(t){var e=this;if(this.heroRotate.updateGameLogic(t),this.time+=t,this.time>this.duration){var i=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),n=o.GValue.EntityWorld.getRangeEnemys(i,this.atkRadius);if((n=o.GValue.EntityWorld.getFarthestEnemys(n,i,1)).length>0){var s=n[0];this.followEntity.player.playEleAct(function(){s.node.emit("hurt",2,e.curAtkHurt,function(){})})}else this.time-=.5}},checkEleTarget:function(t){var e=t.convertToWorldSpaceAR(cc.Vec2.ZERO),i=o.GValue.EntityWorld.getRangeEnemys(e,this.atkRadius);i=o.GValue.EntityWorld.getFarthestEnemys(i,e,1)},setRotateSpeed:function(t){this.heroRotate&&this.heroRotate.setRotateSpeed(t)},setHurtRatio:function(t){this.curAtkHurt=this.atkHurt*t},removeSelf:function(){this.node.removeComponent(this.heroRotate),this.uiNode.removeFromParent(),this.atkNode.removeFromParent(),this.knives.splice(0),this.destroy()}}),cc._RF.pop()},{CommonValue:"CommonValue",GameData:"GameData",PlayerDeputyWeaponBase:"PlayerDeputyWeaponBase",Tools:"Tools",Types:"Types"}],PlayerDWFireComponent:[function(t,e,i){"use strict";cc._RF.push(e,"9ab11hl3zBJZITeNlZYUvVS","PlayerDWFireComponent");var o=t("Tools"),n=t("CommonValue"),s=t("GameData"),a=t("CommonFunc"),c=t("PlayerDWNormalBase");cc.Class({extends:c,properties:{},ctor:function(){this.landKnives=[],this.knivesAcce=[],this.knivesFinalPos=[]},init:function(t,e,i){void 0===i&&(i=!1),c.prototype.init.call(this,t,e),this.heroRotate=o.DYTools.addScript(this.node,"CHRotate"),i||this.initKnives()},updateGameLogic:function(t){if(c.prototype.updateGameLogic.call(this,t),this.landKnives.length>0){t*=n.GValue.PauseSlowRatio;for(var e=0;e<this.landKnives.length;e++){var i=this.landKnives[e],o=this.knivesFinalPos[e];if(o.x===i.position.x&&o.y===i.position.y)return;var s=o.sub(i.position),a=s.mag(),r=500*t;this.knivesAcce[e]+=30*t,(r+=this.knivesAcce[e])<a?i.position=i.position.add(s.mul(r/a)):(i.position=o,this.landKnives.splice(e,1),this.knivesFinalPos.splice(e,1),this.knivesAcce.splice(e,1),e--)}}},getFinalPosition:function(t){var e=this.knives.indexOf(t),i=cc.v2(0,s.TData.HeroRaduisIn),o=360/this.knives.length*e;return t.angle=o,a.GFunc.changeParent(t,this.node),i.rotate(cc.misc.degreesToRadians(-o))},addKnife:function(t){this.knives.push(t),this.landKnives.push(t),this.knivesAcce.push(0),this.knivesFinalPos.splice(0);for(var e=0;e<this.landKnives.length;e++)this.knivesFinalPos.push(this.getFinalPosition(this.landKnives[e]));var i=cc.v2(0,s.TData.HeroRaduisIn),o=360/this.knives.length;for(e=0;e<this.knives.length-this.landKnives.length;e++){var n=this.knives[e],a=o*e;n.parent=this.node,n.angle=a,n.position=i.rotate(cc.misc.degreesToRadians(-a))}}}),cc._RF.pop()},{CommonFunc:"CommonFunc",CommonValue:"CommonValue",GameData:"GameData",PlayerDWNormalBase:"PlayerDWNormalBase",Tools:"Tools"}],PlayerDWIceComponent:[function(t,e,i){"use strict";cc._RF.push(e,"a8989C9zk9P9JNgq676fScF","PlayerDWIceComponent");var o=t("PlayerDWNormalBase");cc.Class({extends:o,properties:{},ctor:function(){},init:function(t,e){o.prototype.init.call(this,t,e),this.initKnives()}}),cc._RF.pop()},{PlayerDWNormalBase:"PlayerDWNormalBase"}],PlayerDWKnifeComponent:[function(t,e,i){"use strict";cc._RF.push(e,"37116DMqHpJXo8LPnp6q7V/","PlayerDWKnifeComponent");var o=t("Tools"),n=t("CommonValue"),s=t("GameData"),a=t("CommonFunc"),c=t("PlayerDWNormalBase");cc.Class({extends:c,properties:{},ctor:function(){this.landKnives=[],this.knivesAcce=[],this.knivesFinalPos=[]},init:function(t,e,i){void 0===i&&(i=!1),c.prototype.init.call(this,t,e),this.heroRotate=o.DYTools.addScript(this.node,"CHRotate"),i||this.initKnives()},updateGameLogic:function(t){if(c.prototype.updateGameLogic.call(this,t),this.landKnives.length>0){t*=n.GValue.PauseSlowRatio;for(var e=0;e<this.landKnives.length;e++){var i=this.landKnives[e],o=this.knivesFinalPos[e];if(o.x===i.position.x&&o.y===i.position.y)return;var s=o.sub(i.position),a=s.mag(),r=500*t;this.knivesAcce[e]+=30*t,(r+=this.knivesAcce[e])<a?i.position=i.position.add(s.mul(r/a)):(i.position=o,this.landKnives.splice(e,1),this.knivesFinalPos.splice(e,1),this.knivesAcce.splice(e,1),e--)}}},getFinalPosition:function(t){var e=this.knives.indexOf(t),i=cc.v2(0,s.TData.HeroRaduisIn),o=360/this.knives.length*e;return t.angle=o,a.GFunc.changeParent(t,this.node),i.rotate(cc.misc.degreesToRadians(-o))},addKnife:function(t){this.knives.push(t),this.landKnives.push(t),this.knivesAcce.push(0),this.knivesFinalPos.splice(0);for(var e=0;e<this.landKnives.length;e++)this.knivesFinalPos.push(this.getFinalPosition(this.landKnives[e]));var i=cc.v2(0,s.TData.HeroRaduisIn),o=360/this.knives.length;for(e=0;e<this.knives.length-this.landKnives.length;e++){var n=this.knives[e],a=o*e;n.parent=this.node,n.angle=a,n.position=i.rotate(cc.misc.degreesToRadians(-a))}}}),cc._RF.pop()},{CommonFunc:"CommonFunc",CommonValue:"CommonValue",GameData:"GameData",PlayerDWNormalBase:"PlayerDWNormalBase",Tools:"Tools"}],PlayerDWLaserComponent:[function(t,e,i){"use strict";cc._RF.push(e,"5d9533tMMxDpodb2AieMT7h","PlayerDWLaserComponent");var o=t("PlayerDeputyWeaponBase"),n=t("CommonValue"),s=t("Tools"),a=t("GameData"),c=t("CommonConfig"),r=t("LaserComponent"),l=t("Types"),h=t("CommonAudio");cc.Class({extends:o,properties:{},ctor:function(){this.radius=0,this.knives=[],this.atkEnemys=[],this.lightList=[],this.durationList=[],this.timeList=[],this.atkCount=0,this.atkDuration=.1,this.atkTime=0,this.atkHurt=0,this.curAtkHurt=0,this.lightPool=null,this.lightUIList=[],this.strongNode=null},init:function(t){this.followEntity=t,this.radius=68;var e=null;if(n.GValue.ArmsSub_TryFinish>0&&a.TData.getCurSubFun()==n.GValue.ArmsSub_TryFinish){var i=c.GConfig.getLevelData(a.TData.getStage());e=c.GConfig.getPropertyArmsSubData(n.GValue.ArmsSub_TryFinish,i.subTryLv)}else e=c.GConfig.getPropertyData_Sub(a.TData.getCurSubFun());this.atkHurt=e.atk;var o=s.DYTools.stringToNumber(e.var,c.GConfig.SeparatorII);this.atkRadius=o[0],this.atkCount=o[1],this.atkTime=o[2],this.atkHurt=o[3]*this.atkDuration,this.curAtkHurt=this.atkHurt,this.initUI(),this.heroRotate=s.DYTools.addScript(this.uiNode,"CHRotate")},initUI:function(){this.uiNode=new cc.Node,this.node.addChild(this.uiNode),this.atkNode=new cc.Node,this.node.addChild(this.atkNode);var t=new cc.Node;this.uiNode.addChild(t,-1),t.addComponent(cc.Sprite).spriteFrame=n.GValue.Atlas_Game.getSpriteFrame("dw2_0"),this.lightPool=new cc.NodePool;for(var e=0;e<this.atkCount;e++){(t=new cc.Node).anchorY=0;var i=s.DYTools.addScript(t,r);i.init(this.followEntity,a.TData.getCurSubFun()),this.lightPool.put(t),this.lightUIList.push(i)}var o=n.GValue.EntityWorld.addEntitySys.addDWKnife(a.TData.HWeaponCountIn,l.DWType.Laser),c=360/o.length,h=cc.v2(0,37);for(e=0;e<o.length;e++){var d=o[e].node,u=c*e;d.parent=this.uiNode,d.angle=u,d.position=h.rotate(cc.misc.degreesToRadians(-u)),this.knives.push(d)}},setRotateSpeed:function(t){this.heroRotate&&this.heroRotate.setRotateSpeed(t)},setHurtRatio:function(t){this.curAtkHurt=this.atkHurt*t},updateGameLogic:function(t){this.heroRotate.updateGameLogic(t),this.strongNode&&(this.strongNode.angle=this.uiNode.angle);for(var e=this.atkEnemys.length-1;e>=0;e--)if((p=this.atkEnemys[e]).isDead){this.enemyRemoveLaser(p),this.atkEnemys.splice(e,1),this.durationList.splice(e,1),this.timeList.splice(e,1);var i=this.lightList[e];this.lightPool.put(i.node),this.lightList.splice(e,1)}else{var o=cc.Vec2.ZERO;o=p.isSnake?p.node_tail.convertToWorldSpaceAR(cc.Vec2.ZERO):p.isFire?p.node_collider.convertToWorldSpaceAR(cc.Vec2.ZERO):p.node.convertToWorldSpaceAR(cc.Vec2.ZERO);var a=this.node.convertToWorldSpaceAR(cc.v2(0,0));o=o.sub(a);var c=this.atkRadius+p.radius;Math.abs(o.x)>c||Math.abs(o.y)>c?(this.enemyRemoveLaser(p),this.atkEnemys.splice(e,1),this.durationList.splice(e,1),this.timeList.splice(e,1),i=this.lightList[e],this.lightPool.put(i.node),this.lightList.splice(e,1)):this.timeList[e]>=this.atkTime&&(this.enemyRemoveLaser(p),this.atkEnemys.splice(e,1),this.durationList.splice(e,1),this.timeList.splice(e,1),i=this.lightList[e],this.lightPool.put(i.node),this.lightList.splice(e,1))}if(this.atkEnemys.length<this.atkCount)for(var l=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO),d=n.GValue.EntityWorld.getRangeEnemys(l,this.atkRadius),u=0,m=d=n.GValue.EntityWorld.getNeareastEnemys(d,l,this.atkCount-this.atkEnemys.length);u<m.length;u++){var p=m[u];s.DYTools.arrContains(this.atkEnemys,p)||(this.atkEnemys.push(p),this.durationList.push(10),this.timeList.push(0),i=this.lightPool.get(),this.atkNode.addChild(i),this.lightList.push(i.getComponent(r)),i.opacity=0)}for(e=0;e<this.atkEnemys.length;e++){this.durationList[e]=this.durationList[e]+t,this.timeList[e]+=t,p=this.atkEnemys[e];var f=(i=this.lightList[e]).setEnemy(p,this.radius);i.updateGameLogic(t),this.durationList[e]>=this.atkDuration&&(this.durationList[e]=0,p.isSnake?p.laserAtkTail(this.curAtkHurt,f):p.isFire?p.laserAttack(this.curAtkHurt,f):p.node.emit("hurt",2,this.curAtkHurt))}if(this.atkEnemys.length>0){var _=h.GAudio.soundIdDict[h.Enum_Audio.laserAtk];(!_||_<0)&&h.GAudio.playSound(h.Enum_Audio.laserAtk,!0)}else h.GAudio.stopSoundByName(h.Enum_Audio.laserAtk)},enemyRemoveLaser:function(t){t.isSnake||t.isFire||t.removeAnim(l.EnemyAnim.HurtLaser)},enterStrong:function(t){0==t?this.strongNode&&(this.strongNode.removeFromParent(),this.strongNode=null):this.strongNode||(this.strongNode=new cc.Node,this.node.addChild(this.strongNode,-1),this.strongNode.scale=1.1,this.strongNode.addComponent(cc.Sprite).spriteFrame=n.GValue.Atlas_Game.getSpriteFrame("strongDW"));for(var e=0,i=this.lightUIList;e<i.length;e++)i[e].enterStrong(t)},die:function(){for(var t=0;t<this.atkEnemys.length;t++){var e=this.atkEnemys[t];this.enemyRemoveLaser(e)}this.atkEnemys.splice(0)},removeSelf:function(){this.node.removeComponent(this.heroRotate),this.uiNode.removeFromParent(),this.atkNode.removeFromParent(),this.lightPool.clear(),this.knives.splice(0),this.destroy()}}),cc._RF.pop()},{CommonAudio:"CommonAudio",CommonConfig:"CommonConfig",CommonValue:"CommonValue",GameData:"GameData",LaserComponent:"LaserComponent",PlayerDeputyWeaponBase:"PlayerDeputyWeaponBase",Tools:"Tools",Types:"Types"}],PlayerDWNormalBase:[function(t,e,i){"use strict";cc._RF.push(e,"4df4eiOg+lDfqyOaRVoIkqE","PlayerDWNormalBase");var o=t("PlayerDeputyWeaponBase"),n=t("Tools"),s=t("CEntityKnife"),a=t("CommonValue"),c=t("GameData"),r=t("EntityDWKnife");cc.Class({extends:o,properties:{},ctor:function(){this.knives=[],this.heroRotate=null,this.dwId=0,this.strongNode=null},init:function(t,e){this.followEntity=t,this.dwId=e,this.heroRotate=n.DYTools.addScript(this.node,"CHRotate")},initKnives:function(){for(var t=a.GValue.EntityWorld.addEntitySys.addDWKnife(c.TData.HWeaponCountIn,this.dwId),e=cc.v2(0,c.TData.HeroRaduisIn),i=360/t.length,o=0;o<t.length;o++){var n=t[o].node,s=i*o;n.parent=this.node,n.angle=s,n.position=e.rotate(cc.misc.degreesToRadians(-s)),this.knives.push(n)}},updateGameLogic:function(t){this.heroRotate.updateGameLogic(t)},enterStrong:function(t){o.prototype.enterStrong.call(this,t),0==t?this.strongNode&&(this.strongNode.removeFromParent(),this.strongNode=null):this.strongNode||(this.strongNode=new cc.Node,this.node.addChild(this.strongNode,1),this.strongNode.scale=1.1,this.strongNode.addComponent(cc.Sprite).spriteFrame=a.GValue.Atlas_Game.getSpriteFrame("strongDW"))},die:function(){for(var t=0,e=this.knives;t<e.length;t++){var i=e[t].getComponent(r);i&&i.shadow&&(i.shadow.active=!1)}},revive:function(){for(var t=0,e=this.knives;t<e.length;t++){var i=e[t].getComponent(s);i&&i.shadow&&(i.shadow.active=!0)}},setRotateSpeed:function(t){o.prototype.setRotateSpeed.call(this,t),this.heroRotate.setRotateSpeed(t)},setShadowOpacity:function(t){for(var e=0;e<this.knives.length;e++)this.knives[e].getComponent(r).shadow.opacity=t},removeSelf:function(){this.node.removeComponent(this.heroRotate);for(var t=0;t<this.knives.length;t++)this.knives[t].getComponent(r).shadow.removeFromParent(),this.knives[t].removeFromParent();this.knives.splice(0),this.destroy()}}),cc._RF.pop()},{CEntityKnife:"CEntityKnife",CommonValue:"CommonValue",EntityDWKnife:"EntityDWKnife",GameData:"GameData",PlayerDeputyWeaponBase:"PlayerDeputyWeaponBase",Tools:"Tools"}],PlayerDeputyWeaponBase:[function(t,e,i){"use strict";cc._RF.push(e,"8aacdOuWG9Fs5PLbrBahmZb","PlayerDeputyWeaponBase");var o=t("GameData"),n=t("CommonEnum"),s=t("CommonConfig"),a=t("CommonValue");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.followEntity=null,this.rtSpeed=0},enterStrong:function(t){0==t?(this.setRotateSpeed(-o.TData.HRotateSpeedIn),this.setHurtRatio(1)):(this.setRotateSpeed(-o.TData.HRotateSpeedIn*a.GValue.StrongRT),this.setHurtRatio(Number(s.GConfig.getGbData(n.Enum_Gb.StrongAtk))))},setHurtRatio:function(t){},setShadowOpacity:function(t){},setRotateSpeed:function(t){this.rtSpeed=t},getKnives:function(){return[]}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonValue:"CommonValue",GameData:"GameData"}],PlayerPickupComponent:[function(t,e,i){"use strict";cc._RF.push(e,"97661NhXrBDY70HDX5zgzEb","PlayerPickupComponent");var o=t("CommonValue"),n=t("Tools"),s=t("Types");cc.Class({extends:cc.Component,properties:{},ctor:function(){this._entity=null,this._pickRadius=0,this._pickRadiusSqr=0},init:function(t){this._entity=t},updateGameLoginc:function(t){this._pickRadius=this._entity.radius+20,this._pickRadiusSqr=this._pickRadius*this._pickRadius;for(var e=0,i=o.GValue.EntityWorld.landKnifes;e<i.length;e++){var a=i[e],c=a.node.position.add(o.GValue.EntityWorld.mapMgr.mapTop.position).sub(this.node.position);Math.abs(c.x)<this._pickRadius&&Math.abs(c.y)<this._pickRadius&&c.magSqr()<this._pickRadiusSqr&&(n.DYTools.arrRemove(o.GValue.EntityWorld.landKnifes,a),a.removeDropUI(),a.node.emit("changeTag",this._entity.teamID),a.node.emit("updateState",s.KnifeState.Capture),a.node.emit("stopResetPos"),a.node.emit("changeKnifeAttackGroup","knife"),this.node.emit("addKnife",a.node),o.GValue.EntityWorld.addKnife(a))}},pickupAllKnives:function(){for(var t=o.GValue.EntityWorld.landKnifes.length-1;t>=0;t--){var e=o.GValue.EntityWorld.landKnifes[t];n.DYTools.arrRemove(o.GValue.EntityWorld.landKnifes,e),e.removeDropUI(),e.node.emit("changeTag",this._entity.teamID),e.node.emit("updateState",s.KnifeState.Capture),e.node.emit("stopResetPos"),e.node.emit("changeKnifeAttackGroup","knife"),this.node.emit("addKnife",e.node),o.GValue.EntityWorld.addKnife(e)}}}),cc._RF.pop()},{CommonValue:"CommonValue",Tools:"Tools",Types:"Types"}],PlayerStateComponent:[function(t,e,i){"use strict";cc._RF.push(e,"0a3ec2bT3dEzYa7p3duz64M","PlayerStateComponent");var o=t("Types"),n=t("CommonValue"),s=t("CommonConfig");cc.Class({extends:cc.Component,properties:{},ctor:function(){this._player=null,this.state=o.HeroState.Normal},init:function(t){this._player=t,this.state=o.HeroState.Normal,this.node.on("prop",this.getProp,this)},updateGameLogic:function(t){n.GValue.PropMgr.hasProp(o.PropType.Strong)||this.state!=o.HeroState.StrongIII||(this.state=o.HeroState.Normal,this.node.emit("updateState",this.state))},getProp:function(t){var e=t.node.getComponent("EntityProp");if(e){switch(n.GValue.EntityWorld.removeProp(e),e.propId){case o.PropType.Strong:this.state=o.HeroState.StrongIII,this.node.emit("updateState",this.state);break;case o.PropType.Slow:case o.PropType.Gold:}n.GValue.PropMgr.addProp(e.propId),this.playGetPropAnim(e.propId)}},playGetPropAnim:function(t){var e=s.GConfig.actionFrameTime,i=this.node.getChildByName("blast");i||((i=new cc.Node).name="blast",i.y=70,this.node.addChild(i));var o=new cc.Node;i.addChild(o),o.addComponent(cc.Sprite).spriteFrame=n.GValue.Atlas_Game.getSpriteFrame("prop_f_"+t),o.scale=.94;var a=cc.moveTo(4*e,cc.v2(0,3)),c=cc.scaleTo(4*e,1.2),r=cc.spawn(a,c),l=cc.moveTo(8*e,cc.v2(0,5)),h=cc.scaleTo(8*e,1.46),d=cc.fadeOut(8*e),u=cc.spawn(l,h,d),m=cc.sequence(r,u,cc.removeSelf());o.runAction(m),o=new cc.Node,i.addChild(o),o.addComponent(cc.Sprite).spriteFrame=n.GValue.Atlas_Game.getSpriteFrame("pa1_3"),c=cc.scaleTo(10*e,2.5,.36);var p=cc.fadeOut(10*e);m=cc.sequence(cc.spawn(c,p),cc.removeSelf()),o.runAction(m)}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonValue:"CommonValue",Types:"Types"}],PropCollisionWallListener:[function(t,e,i){"use strict";cc._RF.push(e,"a598cuOxyBGXYdenTvrBVUP","PropCollisionWallListener");var o=t("Types");t("CommonValue"),t("CommonConfig");cc.Class({extends:cc.Component,properties:{},ctor:function(){this._player=null,this.state=o.HeroState.Normal},onCollisionExit:function(t,e){4!=t.node.groupIndex&&10!=t.node.groupIndex||this.noticeWallLeave(t)},onCollisionEnter:function(t,e){4!=t.node.groupIndex&&10!=t.node.groupIndex||this.noticeWallCollision(t)},noticeWallCollision:function(t){this.node.emit("wallCollision",t)},noticeWallLeave:function(t){this.node.emit("wallLeave",t)}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonValue:"CommonValue",Types:"Types"}],PropManager:[function(t,e,i){"use strict";cc._RF.push(e,"44ba4hQ4QRP0YvJwj3DwuOm","PropManager");var o=t("Tools"),n=t("Types"),s=t("CommonValue");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.propArr=[],this.propTimeArr=[],this.propDurationArr=[],this.durationDict={}},init:function(){this.durationDict[n.PropType.Strong]=s.GValue.StrongTime,this.durationDict[n.PropType.Slow]=s.GValue.SlowTime,this.durationDict[n.PropType.Gold]=s.GValue.GoldTime},clear:function(){this.propArr.splice(0),this.propTimeArr.splice(0),this.propDurationArr.splice(0)},addProp:function(t){var e=this.propArr.indexOf(t);e>=0?this.propTimeArr[e]=0:(this.propArr.push(t),this.propTimeArr.push(0),this.propDurationArr.push(this.durationDict[t]))},removeProp:function(t){var e=this.propArr.indexOf(t);e>=0&&(this.propArr.splice(e,1),this.propTimeArr.splice(e,1),this.propDurationArr.splice(e,1))},hasProp:function(t){return o.DYTools.arrContain(this.propArr,t)},getProgress:function(t){var e=this.propArr.indexOf(t);return e>=0?1-this.propTimeArr[e]/this.propDurationArr[e]:0},updateGameLogic:function(t){for(var e=0;e<this.propTimeArr.length;e++)this.propTimeArr[e]+=t,s.GValue.EntityWorld.gameUI.refreshPropProgress(this.propArr[e],this.getProgress(this.propArr[e])),this.propTimeArr[e]>this.propDurationArr[e]&&(this.removeProp(this.propArr[e]),e--)}}),cc._RF.pop()},{CommonValue:"CommonValue",Tools:"Tools",Types:"Types"}],PropMoveFix:[function(t,e,i){"use strict";cc._RF.push(e,"5d0e8Mmah1Iga4LHBP15tvq","PropMoveFix");var o=t("CommonValue"),n=t("Tools");cc.Class({extends:cc.Component,properties:{},ctor:function(){this._entity=null,this._collider=null,this._radius=0,this._speed=0,this._dir=cc.Vec2.ZERO,this._time=-1,this._blinking=!1,this._minViewX=0,this._maxViewX=0,this._minViewY=0,this._maxViewY=0,this._minX=null,this._maxX=null,this._minY=null,this._maxY=null,this._collisionWalls=[],this.colingWalls=[],this._dxDirty=!1,this._dyDirty=!1},init:function(t,e,i,n){void 0===n&&(n=-1),this._entity=t,this._collider=this._entity.node.getComponent(cc.CircleCollider),this._speed=e,this._dir=i.normalize(),this._time=n,this._blinking=!1,this._radius=this._collider.radius*this.node.scale,this._minViewX=this._radius+0,this._maxViewX=o.GValue.Size_View.width-this._radius-0,this._minViewY=this._radius+0,this._maxViewY=o.GValue.Size_View.height-this._radius-0,this.node.on("wallCollision",this.collisionWall,this),this.node.on("wallLeave",this.leaveWall,this)},updateGameLogic:function(t){if(this._collider)if(this._time-=t,this._time<=0)this.node.stopAllActions(),this.node.opacity=255,o.GValue.EntityWorld.removeProp(this._entity);else{this._time<4&&!this._blinking&&(this._blinking=!0,this.node.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.1,50),cc.fadeTo(.1,255)))));var e=this._speed*t,i=this._dir.mul(e);this.node.position=this.node.position.add(i),this.fixPositionByWall()||this.fixPositionByScreen(),this._dxDirty&&(this._dir.x=-this._dir.x,this._dxDirty=!1),this._dyDirty&&(this._dir.y=-this._dir.y,this._dyDirty=!1)}},fixPositionByScreen:function(){var t=this.node.convertToWorldSpaceAR(cc.v2(0,0));t.x<this._minViewX?(this.node.x=this.node.parent.convertToNodeSpaceAR(cc.v2(this._minViewX,0)).x,this._dxDirty=!0):t.x>this._maxViewX&&(this.node.x=this.node.parent.convertToNodeSpaceAR(cc.v2(this._maxViewX,0)).x,this._dxDirty=!0),t.y<this._minViewY?(this.node.y=this.node.parent.convertToNodeSpaceAR(cc.v2(0,this._minViewY)).y,this._dyDirty=!0):t.y>this._maxViewY&&(this.node.y=this.node.parent.convertToNodeSpaceAR(cc.v2(0,this._maxViewY)).y,this._dyDirty=!0)},fixPositionByWall:function(){if(0==this._collisionWalls.length)return!1;for(var t=0;t<this._collisionWalls.length;t++){var e=this._collisionWalls[t],i=this._collider,s=e.node.parent,a=this.node.parent,c=s.position.add(o.GValue.EntityWorld.mapMgr.mapTop.position);switch(e.tag){case 0:var r=e.size.height;this._maxY=c.y-e.offset.y-.5*r-i.radius*i.node.scale,this.node.y>this._maxY&&(this.node.y=this._maxY,this._dyDirty=!0);break;case 1:r=e.size.height,this._minY=c.y+e.offset.y+.5*r+i.radius*i.node.scale,this.node.y<this._minY&&(this.node.y=this._minY,this._dyDirty=!0);break;case 2:r=e.size.height,this._minX=c.x+e.offset.y+.5*r+i.radius*i.node.scale,this.node.x<this._minX&&(this.node.x=this._minX,this._dxDirty=!0);break;case 3:r=e.size.height,this._maxX=c.x-e.offset.y-.5*r-i.radius*i.node.scale,this.node.x>this._maxX&&(this.node.x=this._maxX,this._dxDirty=!0);break;case 4:if(c=c.add(e.node.position),(m=(u=this.node.position.sub(c)).mag())<(p=this._radius+e.radius-6)){var l=u.x/m,h=u.y/m,d=c.add(cc.v2(p*l,p*h));this.node.position=d,this._dyDirty=!0,this._dxDirty=!0}break;case 5:c.addSelf(e.node.position),(m=(u=this.node.position.sub(c)).mag())<(p=this._radius+e.radius-6)&&(l=u.x/m,h=u.y/m,d=c.add(cc.v2(p*l,p*h)),this.node.position=d,this._dyDirty=!0,this._dxDirty=!0);break;case 6:var u,m;c=e.node.convertToWorldSpaceAR(cc.v2(0,0)),c=a.convertToNodeSpaceAR(c),(m=(u=this.node.position.sub(c)).mag())<(p=this._radius+.5*e.size.width-6)&&(l=u.x/m,h=u.y/m,d=c.add(cc.v2(p*l,p*h)),this.node.position=d,this._dyDirty=!0,this._dxDirty=!0);break;case 101:if(n.DYTools.arrContain(this.colingWalls,e))break;this.colingWalls.push(e);var p=e.size.width,f=e.size.height,_=Math.abs(s.angle);(_>80&&_<100||_>260&&_<280)&&(p=e.size.height,f=e.size.width),c.addSelf(e.node.position),n.DYTools.isNumberDiffRange(this.node.y,c.y,f/2)?this._dxDirty=!0:n.DYTools.isNumberDiffRange(this.node.x,c.x,p/2)?this._dyDirty=!0:this.node.x>c.x&&this.node.y>c.y?this._dir.x<0&&this._dir.y<0?(this._dyDirty=!0,this._dxDirty=!0):this._dir.x<0?this._dxDirty=!0:this._dir.y<0&&(this._dyDirty=!0):this.node.x>c.x&&this.node.y<c.y?this._dir.x<0&&this._dir.y>0?(this._dyDirty=!0,this._dxDirty=!0):this._dir.x<0?this._dxDirty=!0:this._dir.y>0&&(this._dyDirty=!0):this.node.x<c.x&&this.node.y<c.y?this._dir.x>0&&this._dir.y>0?(this._dyDirty=!0,this._dxDirty=!0):this._dir.x>0?this._dxDirty=!0:this._dir.y>0&&(this._dyDirty=!0):this._dir.x>0&&this._dir.y<0?(this._dyDirty=!0,this._dxDirty=!0):this._dir.x>0?this._dxDirty=!0:this._dir.y<0&&(this._dyDirty=!0)}}return!0},collisionWall:function(t){n.DYTools.arrContains(this._collisionWalls,t)||this._collisionWalls.push(t)},leaveWall:function(t){n.DYTools.arrRemove(this._collisionWalls,t),n.DYTools.arrRemove(this.colingWalls,t)}}),cc._RF.pop()},{CommonValue:"CommonValue",Tools:"Tools"}],PropertyUI:[function(t,e,i){"use strict";cc._RF.push(e,"372a6I+XxBB9LzvgTm+z2q4","PropertyUI");var o=t("CommonEnum"),n=t("ItemProperty"),s=t("CommonFunc"),a=t("GameData"),c=t("CommonConfig"),r=t("CommonValue"),l=t("Tools"),h=t("PfNum"),d=t("ADShareManager"),u=t("AndroidManager");cc.Class({extends:cc.Component,properties:{node_ui:cc.Node,node_arms1:cc.Node,node_show_arms1:cc.Node,node_showlistmain:cc.Node,node_arm1_arrowdown:cc.Node,node_listmain:cc.Node,node_arms2:cc.Node,node_show_arms2:cc.Node,node_gold:cc.Node,node_show_gold_kill:cc.Node,node_show_gold_offline:cc.Node,node_showlistsub:cc.Node,node_listsub:cc.Node,btn_l:cc.Node,btn_r:cc.Node,node_shield:cc.Node,pf_itemProperty:cc.Prefab,atlas_property:cc.SpriteAtlas,atlas_offline:cc.SpriteAtlas},onLoad:function(){this.com_arms1=null,this.com_arms2=null,this.com_gold_kill=null,this.com_gold_offline=null,this.scrollView=null,this.scrollView_offset=cc.v2(0,0),this.dic_main_icon={},this.dic_main_lv={},this.sp_line_gray=null,this.dic_listsub_scale={},this.dic_listsub_pos={},this.dic_listsub_node={},this.dic_listsub_sp={},this.selectsub_index=1;var t=this;s.GFunc.set_click(this.node_shield,function(){},this),s.GFunc.set_click(this.node_listsub,function(){},this),s.GFunc.set_click(this.btn_l,function(){t.toR_listsub()},this),s.GFunc.set_click(this.btn_r,function(){t.toL_listsub()},this)},init:function(){var t=cc.instantiate(this.pf_itemProperty);this.node_show_arms1.addChild(t),this.com_arms1=t.getComponent(n),this.com_arms1.init(o.Enum_PropertyId.ArmsMain,"font_attack","");var e=cc.instantiate(this.pf_itemProperty);this.node_show_arms2.addChild(e),this.com_arms2=e.getComponent(n),this.com_arms2.init(o.Enum_PropertyId.ArmsSub,"font_attack","",1);var i=cc.instantiate(this.pf_itemProperty);this.node_show_gold_kill.addChild(i),this.com_gold_kill=i.getComponent(n),this.com_gold_kill.init(o.Enum_PropertyId.GoldKill,"font_goldkill","icon_goldkill");var s=cc.instantiate(this.pf_itemProperty);this.node_show_gold_offline.addChild(s),this.com_gold_offline=s.getComponent(n),this.com_gold_offline.init(o.Enum_PropertyId.GoldOffline,"font_goldoffline","icon_goldoffline");var c=this;this.scheduleOnce(function(){c.init_listmain()},1),this.selectsub_index=a.TData.getCurSubIndex(),this.selectsub_index=-1==this.selectsub_index?0:this.selectsub_index,this.init_listsub(),this.changeArmsSubEnd(!0),this.refresh_listsub()},get_listmainData:function(){for(var t=r.GValue.List_Main_Change,e=[],i=0;i<t.length;i++)e.push(t[i]);return e},moveArrowdown:function(t){this.node_arm1_arrowdown.position=this.node_arm1_arrowdown.position.add(cc.v2(t,0))},init_listmain:function(){var t=this.get_listmainData(),e=s.GFunc.getCurMainChange();this.node_listmain.destroyAllChildren();var i=new cc.Node;this.node_listmain.addChild(i);var n=this.node_listmain.convertToWorldSpaceAR(cc.v2(0,0)),a=r.GValue.Size_View.width-n.x,c=this.node_listmain.getContentSize();c.width=a;var l=t.length,d=150*l,u=cc.v2(0,0),m=new cc.Node;i.addChild(m),m.setPosition(u),m.setContentSize(c),m.setAnchorPoint(0,.5),m.addComponent(cc.Mask);var p=new cc.Node;p.setAnchorPoint(0,.5),p.setContentSize(c),m.addChild(p),this.scrollView=p.addComponent(cc.ScrollView),this.scrollView.horizontal=!0,this.scrollView.vertical=!1,this.scrollView.elastic=!1;var f=new cc.Node;f.setAnchorPoint(0,.5),p.addChild(f),this.scrollView.content=f,this.scrollView.content.width=d;var _=new cc.Node,y=_.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(this.atlas_property,y,"main_line_white"),_.anchorX=0,_.setPosition(50,0),f.addChild(_),_.width=d-150;var g=new cc.Node;this.sp_line_gray=g.addComponent(cc.Sprite),s.GFunc.changeAtlasSprite(this.atlas_property,this.sp_line_gray,"main_line_gray"),g.anchorX=0,g.setPosition(50,0),f.addChild(g),g.width=d-150;for(var v=0;v<l;v++){var C=t[v],S=new cc.Node;S.setPosition(50+150*v,0),f.addChild(S);var D="k"+C.imageId,T=new cc.Node,G=T.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(r.GValue.Atlas_Game,G,D),S.addChild(T),this.dic_main_icon[C.lv]=T;var A=cc.instantiate(r.GValue.pf_num),w=A.getComponent(h);w.setParam(o.Enum_Num.SubLv,cc.v2(.5,.5),0,this.atlas_property),w.setString("l"+C.lv),A.setPosition(0,40),S.addChild(A),this.dic_main_lv[C.lv]=A,C.lv<e.lv?T.color=cc.Color.GRAY:C.lv>e.lv&&(T.opacity=150)}this.sp_line_gray.type=cc.Sprite.Type.FILLED,this.sp_line_gray.fillType=cc.Sprite.FillType.HORIZONTAL,this.sp_line_gray.fillCenter=cc.v2(0,.5),this.sp_line_gray.fillRange=this.getMainProgress(),this.setMainScrollPos(0),this.setListMainVisible()},setListMainVisible:function(){var t=this.get_listmainData(),e=s.GFunc.getCurMainChange();t.length>0&&e!=t[0]?this.node_showlistmain.active=!0:this.node_showlistmain.active=!1},getMainProgress:function(){for(var t=this.get_listmainData(),e=s.GFunc.getCurMainChange(),i=0,o=0;o<t.length;o++)t[o].lv<e.lv&&i++;var n=0;return t.length-1>0&&(n=i/(t.length-1)),n},setMainScrollPos:function(t){var e=this.scrollView.content.width,i=this.getMainProgress();this.scrollView.scrollToOffset(cc.v2(e*i-200-60*i,0),t)},changeMain:function(t,e){var i=this,o=this,n=c.GConfig.actionFrameTime;this.setListMainVisible(),this.setMainScrollPos(n),this.scheduleOnce(function(){var a=o.dic_main_icon[t.lv],c=o.dic_main_icon[e.lv],r=c.convertToWorldSpaceAR(cc.v2(0,0)).x-a.convertToWorldSpaceAR(cc.v2(0,0)).x,l=new cc.Node;a.addChild(l);var h=l.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(i.atlas_property,h,"main_shine_line"),l.anchorX=0,l.width=.3*r,l.scaleX=.47,l.scaleY=1.95;var d=cc.scaleTo(3*n,2.51,1),u=cc.scaleTo(2*n,1.88,1),m=cc.moveBy(2*n,cc.v2(88,0)),p=cc.spawn(u,m),f=cc.callFunc(function(){a.opacity=255,a.color=cc.Color.GRAY,c.opacity=255,c.color=cc.Color.WHITE;var t=cc.instantiate(c);c.addChild(t),t.scale=1.6;var i=cc.scaleTo(7*n,2),s=cc.fadeTo(7*n,0),r=cc.spawn(i,s),l=cc.sequence(r,cc.removeSelf());t.runAction(l);var h=o.dic_main_lv[e.lv];if(h){var d=cc.scaleTo(3*n,1.8),u=cc.scaleTo(5*n,1),m=cc.sequence(d,u);h.runAction(m)}o.sp_line_gray.fillRange=o.getMainProgress()}),_=cc.sequence(d,p,f,cc.removeSelf());l.runAction(_)},.3)},getFunByIndex:function(t){var e=a.TData.getSubFunByIndex(t);if(t>=a.TData.getListSub().length){var i=t-a.TData.getListSub().length,o=s.GFunc.getUnGetArmsSubList();i<o.length&&(e=o[i])}return e},init_listsub:function(){var t=this,e=c.GConfig.actionFrameTime;this.node_listsub.destroyAllChildren(),this.dic_listsub_scale={},this.dic_listsub_scale[0]=1,this.dic_listsub_scale[1]=1,this.dic_listsub_scale[2]=1,this.dic_listsub_scale[3]=1.2,this.dic_listsub_scale[4]=1,this.dic_listsub_scale[5]=1,this.dic_listsub_scale[6]=1;var i=cc.v2(50,0);for(var n in this.dic_listsub_pos={},this.dic_listsub_pos[0]=cc.v2(-310,0).add(i),this.dic_listsub_pos[1]=cc.v2(-210,0).add(i),this.dic_listsub_pos[2]=cc.v2(-110,0).add(i),this.dic_listsub_pos[3]=cc.v2(0,0).add(i),this.dic_listsub_pos[4]=cc.v2(110,0).add(i),this.dic_listsub_pos[5]=cc.v2(210,0).add(i),this.dic_listsub_pos[6]=cc.v2(310,0).add(i),this.dic_listsub_node={},this.dic_listsub_sp={},this.dic_listsub_pos){var l=new cc.Node;this.node_listsub.addChild(l);var d=l.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(this.atlas_property,d,"sub_board"),this.dic_listsub_node[n]=l;var m=new cc.Node;l.addChild(m);var p=m.addComponent(cc.Sprite);this.dic_listsub_sp[n]=p;var f=cc.instantiate(r.GValue.pf_num);l.addChild(f);var _=f.getComponent(h);_.setParam(o.Enum_Num.SubLv,cc.v2(1,0),0,this.atlas_property),_.setString("l1"),f.setPosition(30,-30),f.name="lv",f.scale=.7;var y=new cc.Node;l.addChild(y,1),y.name="try";var g=new cc.Node,v=g.addComponent(cc.Sprite);if(s.GFunc.changeAtlasSprite(this.atlas_property,v,"sub_box_try"),y.addChild(g),s.GFunc.set_click(g,function(){console.log("123123"),t.tryArmsSub()},this),1!=u.AndroidMgr.getAfStatus()){var C=new cc.Node,S=C.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(this.atlas_property,S,"try_video"),y.addChild(C),C.position=cc.v2(-19,-20)}var D=new cc.Node,T=D.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(this.atlas_property,T,"arms_sub_try"),y.addChild(D),D.anchorY=0,D.y=30;var G=new cc.Node;l.addChild(G,1);var A=G.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(this.atlas_property,A,"sub_box_select"),G.scale=.8,G.setPosition(0,-8),G.name="select";var w=cc.scaleTo(11*e,.664),b=cc.scaleTo(6*e,.8),E=cc.sequence(w,b),P=cc.repeatForever(E);G.runAction(P)}this.refresh_listsub();var N=this;for(var t in this.dic_listsub_node){p=this.dic_listsub_node[t],this.dic_listsub_sp[t],p.$skinIdx;var k=parseInt(t)+this.selectsub_index-3;m=this.getFunByIndex(k);c.GConfig.getPropertyArmsSubData(m,n)&&s.GFunc.set_click(p,function(){var t=N.getFunByIndex(N.selectsub_index);console.log("skinIdx:",t),a.TData.getListSub().indexOf(t)>-1||(window.loadSuc=function(){var e=t;a.TData.addListSub(e),e<5&&s.GFunc.createPrefabByName("PanelNew",r.GValue.HomeUI.node,function(t){t.create(e,cc.Vec2.ZERO,function(){})}),a.TData.setCurSubFun(e),N.init_listsub()},window.loadFail=null,window.xmgame.showVideo(function(){var e=t;a.TData.addListSub(e),e<5&&s.GFunc.createPrefabByName("PanelNew",r.GValue.HomeUI.node,function(t){t.create(e,cc.Vec2.ZERO,function(){})}),a.TData.setCurSubFun(e),N.init_listsub(),r.GValue.HomeUI.refreshPos()},function(){},function(){window.xmgame.showPanelLoad()}))},this)}},refresh_sublv:function(){for(var t in this.dic_listsub_node){var e=this.dic_listsub_node[t].getChildByName("lv");if(e){var i=e.getComponent(h);if(i){var o=parseInt(t)+this.selectsub_index-3,n=this.getFunByIndex(o),s=a.TData.getPropertyLv_Sub(n);r.GValue.ArmsSub_TryFinish==n?i.setString("m"):i.setString("l"+s)}}}},refreshNext:function(){for(var t=[5,4,3,2,1],e=a.TData.getListSub(),i=t.length-1;i>=0;i--)e.indexOf(t[i])>-1&&t.splice(i,1);for(var o=9999,n=0;n<t.length;n++)o>t[n]&&(o=t[n]);9999!=o&&(this.selectsub_index=o-1),r.GValue.HomeUI.changeSubEffect(this.getFunByIndex(this.selectsub_index));for(var s=this,c=1;c<7;c++){var l=null;6==c&&(this.node_shield.active=!0,l=function(){var t=s.dic_listsub_node[0];s.dic_listsub_node[0]=s.dic_listsub_node[1],s.dic_listsub_node[1]=s.dic_listsub_node[2],s.dic_listsub_node[2]=s.dic_listsub_node[3],s.dic_listsub_node[3]=s.dic_listsub_node[4],s.dic_listsub_node[4]=s.dic_listsub_node[5],s.dic_listsub_node[5]=s.dic_listsub_node[6],s.dic_listsub_node[6]=t;var e=s.dic_listsub_sp[0];s.dic_listsub_sp[0]=s.dic_listsub_sp[1],s.dic_listsub_sp[1]=s.dic_listsub_sp[2],s.dic_listsub_sp[2]=s.dic_listsub_sp[3],s.dic_listsub_sp[3]=s.dic_listsub_sp[4],s.dic_listsub_sp[4]=s.dic_listsub_sp[5],s.dic_listsub_sp[5]=s.dic_listsub_sp[6],s.dic_listsub_sp[6]=e,s.node_shield.active=!1,s.changeArmsSubEnd()}),this.action_sub(c,c-1,l)}var h=this.dic_listsub_node[0];h&&(h.setPosition(this.dic_listsub_pos[6]),h.scale=this.dic_listsub_scale[6])},refresh_listsub:function(){for(var t in this.dic_listsub_node){var e=this.dic_listsub_node[t],i=e.getComponent(cc.Sprite);e.scale=this.dic_listsub_scale[t],e.setPosition(this.dic_listsub_pos[t]);var o=e.getChildByName("select"),n=e.getChildByName("lv");if(3==parseInt(t)){o&&(o.active=!0);var h=parseInt(t)+this.selectsub_index-3,d=this.getFunByIndex(h),u=l.DYTools.arrContain(a.TData.getListSub(),d);n&&u&&(n.active=!0)}else s.GFunc.changeAtlasSprite(this.atlas_property,i,"sub_board"),o&&(o.active=!1),n&&(n.active=!1)}for(var t in this.dic_listsub_node){var m=this.dic_listsub_node[t];if(i=this.dic_listsub_sp[t],h=parseInt(t)+this.selectsub_index-3,d=this.getFunByIndex(h),u=l.DYTools.arrContain(a.TData.getListSub(),d),n=a.TData.getPropertyLv_Sub(d),c.GConfig.getPropertyArmsSubData(d,n)){m.opacity=255,s.GFunc.changeAtlasSprite(this.atlas_property,i,"arms_sub_"+d);var p=null;if(m&&(p=m.getChildByName("lock")),u){if(m){for(var f=m.children.length-1;f>=0;f--){if(m&&m.children[f])"lock"==(G=m.children[f]).name&&G.removeFromParent&&G.removeFromParent()}m.color=cc.color(255,255,255),i.node.color=cc.color(255,255,255)}}else if(console.log(d,"PK:",a.TData.getListSub()),!p&&!l.DYTools.arrContain(a.TData.getListSub(),d)){console.log("unlock1111"),m.color=cc.color(255,255,255),i.node.color=cc.color(255,255,255);var _=new cc.Node;_.setPosition(-25,25),m.addChild(_),_.name="lock";var y=_.addComponent(cc.Sprite);_.scaleX=_.scaleY=.5,s.GFunc.changeAtlasSprite(this.atlas_offline,y,"icon_ad")}}else if(m.opacity=0,m){for(var g=m.numChildren-1;g>=0;g--){"lock"==(G=m.getChildAt(g)).name&&G.removeFromParent&&G.removeFromParent()}m.color=cc.color(255,255,255),i.node.color=cc.color(255,255,255)}var v=!1,C=m.getChildByName("try");C&&(r.GValue.ArmsSub_TryWill==d?(C.active=!0,v=!0):C.active=!1);var S=m.getChildByName("new");if(!v&&l.DYTools.arrContain(a.TData.getListNewSub(),d)){if(!S){S=new cc.Node,m.addChild(S);var D=S.addComponent(cc.Sprite);s.GFunc.changeAtlasSprite(this.atlas_property,D,"arms_sub_new"),S.setPosition(-15,38),S.name="new"}if(m){for(var T=m.numChildren-1;T>=0;T--){var G;"lock"==(G=m.getChildAt(T)).name&&G.removeSelf&&G.removeSelf()}m.color=cc.color(255,255,255),i.node.color=cc.color(255,255,255)}S.opacity=255}else S&&(S.opacity=0)}this.refresh_sublv()},resetSub:function(){this.selectsub_index;var t=this.getFunByIndex(this.selectsub_index);this.selectsub_index=a.TData.getCurSubIndex();var e=this.getFunByIndex(this.selectsub_index),i=e;a.TData.getListSub().indexOf(t)>-1?t!=e&&(i=e,this.init_listsub(),this.changeArmsSubEnd(),r.GValue.HomeUI.changeSubEffect(i)):(i=e,this.init_listsub(),this.changeArmsSubEnd(),r.GValue.HomeUI.changeSubEffect(i))},toR_listsub:function(){if(0!=this.selectsub_index){this.selectsub_index--,r.GValue.HomeUI.changeSubEffect(this.getFunByIndex(this.selectsub_index));for(var t=this,e=0;e<6;e++){var i=null;5==e&&(this.node_shield.active=!0,i=function(){var e=t.dic_listsub_node[6];t.dic_listsub_node[6]=t.dic_listsub_node[5],t.dic_listsub_node[5]=t.dic_listsub_node[4],t.dic_listsub_node[4]=t.dic_listsub_node[3],t.dic_listsub_node[3]=t.dic_listsub_node[2],t.dic_listsub_node[2]=t.dic_listsub_node[1],t.dic_listsub_node[1]=t.dic_listsub_node[0],t.dic_listsub_node[0]=e;var i=t.dic_listsub_sp[6];t.dic_listsub_sp[6]=t.dic_listsub_sp[5],t.dic_listsub_sp[5]=t.dic_listsub_sp[4],t.dic_listsub_sp[4]=t.dic_listsub_sp[3],t.dic_listsub_sp[3]=t.dic_listsub_sp[2],t.dic_listsub_sp[2]=t.dic_listsub_sp[1],t.dic_listsub_sp[1]=t.dic_listsub_sp[0],t.dic_listsub_sp[0]=i,t.node_shield.active=!1,t.changeArmsSubEnd()}),this.action_sub(e,e+1,i)}var o=this.dic_listsub_node[6];o&&(o.setPosition(this.dic_listsub_pos[0]),o.scale=this.dic_listsub_scale[0])}},toL_listsub:function(){if(this.selectsub_index!=a.TData.getListSub().length-1+s.GFunc.getUnGetArmsSubList().length){this.selectsub_index++,r.GValue.HomeUI.changeSubEffect(this.getFunByIndex(this.selectsub_index));for(var t=this,e=1;e<7;e++){var i=null;6==e&&(this.node_shield.active=!0,i=function(){var e=t.dic_listsub_node[0];t.dic_listsub_node[0]=t.dic_listsub_node[1],t.dic_listsub_node[1]=t.dic_listsub_node[2],t.dic_listsub_node[2]=t.dic_listsub_node[3],t.dic_listsub_node[3]=t.dic_listsub_node[4],t.dic_listsub_node[4]=t.dic_listsub_node[5],t.dic_listsub_node[5]=t.dic_listsub_node[6],t.dic_listsub_node[6]=e;var i=t.dic_listsub_sp[0];t.dic_listsub_sp[0]=t.dic_listsub_sp[1],t.dic_listsub_sp[1]=t.dic_listsub_sp[2],t.dic_listsub_sp[2]=t.dic_listsub_sp[3],t.dic_listsub_sp[3]=t.dic_listsub_sp[4],t.dic_listsub_sp[4]=t.dic_listsub_sp[5],t.dic_listsub_sp[5]=t.dic_listsub_sp[6],t.dic_listsub_sp[6]=i,t.node_shield.active=!1,t.changeArmsSubEnd()}),this.action_sub(e,e-1,i)}var o=this.dic_listsub_node[0];o&&(o.setPosition(this.dic_listsub_pos[6]),o.scale=this.dic_listsub_scale[6])}},action_sub:function(t,e,i){var o=this.dic_listsub_scale[e],n=this.dic_listsub_pos[e],s=cc.scaleTo(.1,o),a=cc.moveTo(.1,n),c=cc.spawn(s,a),r=cc.sequence(c,cc.callFunc(function(){i&&i()})),l=this.dic_listsub_node[t];l&&l.runAction(r)},show:function(t,e){void 0===e&&(e=!0);var i=this,n=c.GConfig.actionFrameTime,s=null;t==o.Enum_PropertySys.ArmsMain?(this.node_arms1.active=!0,this.node_arms2.active=!1,this.node_gold.active=!1,this.com_arms1.refresh(),this.com_arms1.checkGuide(),e&&(this.com_arms1.hide_op(),s=function(){i.com_arms1.show_op()})):t==o.Enum_PropertySys.ArmsSub?(this.node_arms1.active=!1,this.node_arms2.active=!0,this.node_gold.active=!1,this.com_arms2.refresh(),this.com_arms2.checkGuide(),e&&(this.com_arms2.hide_op(),this.node_showlistsub.opacity=0,s=function(){i.com_arms2.show_op(),i.node_showlistsub.stopAllActions();var t=cc.fadeIn(3*n);i.node_showlistsub.runAction(t)})):t==o.Enum_PropertySys.Gold?(this.node_arms1.active=!1,this.node_arms2.active=!1,this.node_gold.active=!0,this.com_gold_kill.refresh(),this.com_gold_offline.refresh(),e&&(this.com_gold_kill.hide_op(),this.com_gold_offline.hide_op(),s=function(){i.com_gold_kill.show_op(),i.com_gold_offline.show_op()})):(this.node_arms1.active=!1,this.node_arms2.active=!1,this.node_gold.active=!1),e&&this.showAction(null),s&&setTimeout(function(){s()},1e3*n*6)},showAction:function(t){var e=c.GConfig.actionFrameTime;this.node_ui.stopAllActions(),this.node_ui.opacity=0,this.node_ui.scale=.9,this.node_ui.setPosition(-180,-22);var i=cc.delayTime(2*e),o=cc.moveTo(4*e,cc.v2(0,0)),n=cc.scaleTo(4*e,1),s=cc.fadeTo(4*e,255),a=cc.spawn(o,n,s),r=cc.callFunc(function(){t&&t()}),l=cc.sequence(i,a,r);this.node_ui.runAction(l)},onDisable:function(){},changeArmsSubEnd:function(t){void 0===t&&(t=!1);var e=this.getFunByIndex(this.selectsub_index);e=e<1?1:e;var i=a.TData.getListSub();console.log("data:",i),this.com_arms2.init(o.Enum_PropertyId.ArmsSub,"","",e),this.com_arms2.refresh(),this.refresh_listsub(),t||r.GValue.ArmsSub_TryWill!=e||this.tryArmsSub(),r.GValue.HomeUI.refreshSub()},tryArmsSub:function(){var t=this,e=function(){r.GValue.ArmsSub_TryFinish=r.GValue.ArmsSub_TryWill,r.GValue.ArmsSub_TryWill=0;var e=a.TData.getTodayArmsSubTryCount();a.TData.setTodayArmsSubTryCount(e+1),t.refresh_listsub(),t.com_arms2.refresh()};d.ADShareMgr.adShare(o.Enum_ADShare.AS_TrySub,e,e)}}),cc._RF.pop()},{ADShareManager:"ADShareManager",AndroidManager:"AndroidManager",CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonValue:"CommonValue",GameData:"GameData",ItemProperty:"ItemProperty",PfNum:"PfNum",Tools:"Tools"}],ShadowOwnerComponent:[function(t,e,i){"use strict";cc._RF.push(e,"a0733kOmJ1CwpcKgqe0BpB6","ShadowOwnerComponent");var o=t("CommonValue");t("Tools");cc.Class({extends:cc.Component,properties:{},ctor:function(){this.ownerNode=null,this.shadowNode=null,this.posConvert=!1,this.isKnife=!1,this.rtDiff=0},init:function(t,e,i){switch(this.ownerNode=t,this.shadowNode=e,i){case 0:this.posConvert=!0;break;case 1:this.posConvert=!0,this.isKnife=!0;break;case 2:this.posConvert=!0,this.isKnife=!0,this.rtDiff=-70;break;case 3:break;case 4:this.posConvert=!0}},lateUpdate:function(){var t=this.ownerNode.position;this.posConvert?(t=this.ownerNode.convertToWorldSpaceAR(cc.v2(0,0)),t=(t=o.GValue.EntityWorld.mapMgr.mapBottom.convertToNodeSpaceAR(t)).add(cc.v2(20,-20))):t.addSelf(cc.v2(20,-20)),this.shadowNode.position=t,this.shadowNode.scaleX=2*this.ownerNode.scaleX,this.shadowNode.scaleY=2*this.ownerNode.scaleY;var e=this.ownerNode.angle;this.isKnife&&this.ownerNode.parent&&(e=this.ownerNode.angle+this.ownerNode.parent.angle),this.shadowNode.angle=e+this.rtDiff,this.ownerNode.parent||this.node.removeFromParent()}}),cc._RF.pop()},{CommonValue:"CommonValue",Tools:"Tools"}],StageUI:[function(t,e,i){"use strict";cc._RF.push(e,"71b596aP6ZD0KhJuzDq8LGi","StageUI");var o=t("PfNum"),n=t("CommonEnum"),s=t("CommonConfig"),a=t("CommonFunc");cc.Class({extends:cc.Component,properties:{node_stages:cc.Node,node_gray:cc.Node,node_shield:cc.Node,list_stage:[cc.Node],pf_num:cc.Prefab,atlas_game:cc.SpriteAtlas,atlas_homeui:cc.SpriteAtlas},onLoad:function(){a.GFunc.set_click(this.node_shield,function(){},this)},init:function(t){for(var e=0;e<this.list_stage.length;e++){var i=this.list_stage[e],c=t-2+e,r=s.GConfig.LevelDict[c];if(c>0&&r&&c<=s.GConfig.MaxLevel)if(r.boss){var l=new cc.Node;i.addChild(l),l.name="boss";var h=l.addComponent(cc.Sprite);l.setPosition(-5,8),a.GFunc.changeAtlasSprite(this.atlas_homeui,h,"btn_stage_boss")}else{(l=cc.instantiate(this.pf_num)).setPosition(-5,8),i.addChild(l),l.name="num";var d=l.getComponent(o);d.setParam(n.Enum_Num.Blood,cc.v2(.5,.5),1,this.atlas_game),d.setNum(c),c>9&&c<100?d&&(d.node.scale*=.75):c>99&&d&&(d.node.scale*=.66)}else i.active=!1;e==this.list_stage.length-1&&(i.opacity=0)}},showRound:function(t,e,i,o,n){e<i?(t&&(t.color=cc.color(4,37,66,255),t.node.scale=.45),n&&(n.color=cc.color(4,37,66,255),n.scale=.9)):e==i?(t&&(t.node.scale=.62,t.color=cc.color(255,255,255,255)),n&&(n.color=cc.color(255,255,255,255),n.scale=1)):(t&&(t.node.scale=.45,t.color=cc.color(180,216,227,255)),n&&(n.color=cc.color(180,216,227,255),n.scale=.9)),o>9&&o<100?t&&(t.node.scale*=.9):o>99&&t&&(t.node.scale*=.66)},showRoundSpecial:function(){var t=this.list_stage[3],e=cc.instantiate(t);t.parent.addChild(e);var i=cc.fadeTo(s.GConfig.actionFrameTime,255),o=cc.fadeTo(6*s.GConfig.actionFrameTime,0),n=cc.scaleTo(s.GConfig.actionFrameTime,1.5),a=cc.scaleTo(6*s.GConfig.actionFrameTime,4),c=cc.spawn(i,n),r=cc.spawn(o,a),l=cc.sequence(c,r,cc.removeSelf());e.runAction(l)},showNext:function(){this.changeStage()},changeStage:function(){for(var t=0;t<this.list_stage.length;t++){var e=this.list_stage[t];if(0==t)e.opacity=0;else if(t==this.list_stage.length-1){var i=this.list_stage[t-1];e.opacity=255,e.setPosition(i.getPosition()),e.scale=i.scale}else if(i=this.list_stage[t-1],e.setPosition(i.getPosition()),2==t){var o=e.getComponent(cc.Sprite);a.GFunc.changeAtlasSprite(this.atlas_homeui,o,"btn_stage_finish")}else 3==t&&(o=e.getComponent(cc.Sprite),a.GFunc.changeAtlasSprite(this.atlas_homeui,o,"btn_stage_cur"))}}}),cc._RF.pop()},{CommonConfig:"CommonConfig",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",PfNum:"PfNum"}],Test:[function(t,e,i){"use strict";cc._RF.push(e,"81c24uI3WVGf4Qr9NFE0Q9+","Test");var o=t("GameData"),n=t("CommonFunc"),s=t("CommonValue");cc.Class({extends:cc.Component,properties:{theme:cc.EditBox,moveType:cc.EditBox,mapStop:cc.EditBox,editArr:[cc.EditBox]},ctor:function(){},onLoad:function(){this.theme.string=o.TData.ThemeId+"",this.editArr[0].string=o.TData.WeaponCount+"",this.editArr[2].string=o.TData.HeroRotateSpeed+"",this.editArr[4].string=o.TData.HeroRaduis+"",this.editArr[17].string=o.TData.HWeaponCountIn+"",this.editArr[18].string=o.TData.HRotateSpeedIn+"",this.editArr[19].string=o.TData.HeroAttackIn+"",this.editArr[20].string=o.TData.HeroRaduisIn+"",this.editArr[21].string=o.TData.EnemyOffset+""},start:function(){n.GFunc.adjustScreen(this.node)},onBtnClicked:function(){o.TData.ThemeId=parseInt(this.theme.string),o.TData.WeaponCount=parseInt(this.editArr[0].string),o.TData.HeroRotateSpeed=parseInt(this.editArr[2].string),o.TData.HeroRaduis=parseInt(this.editArr[4].string),o.TData.HWeaponCountIn=parseInt(this.editArr[17].string),o.TData.HRotateSpeedIn=parseInt(this.editArr[18].string),o.TData.HeroAttackIn=parseInt(this.editArr[19].string),o.TData.HeroRaduisIn=parseInt(this.editArr[20].string),o.TData.EnemyOffset=Number(this.editArr[21].string),this.node.active=!1,s.GValue.EntityWorld.gameStart(o.TData.ThemeId)}}),cc._RF.pop()},{CommonFunc:"CommonFunc",CommonValue:"CommonValue",GameData:"GameData"}],Tools:[function(t,e,i){"use strict";cc._RF.push(e,"f8143EsQ8ZDkLEmvJuGuuy5","Tools");var o=e.exports,n=t("CommonConfig"),s=t("CommonValue"),a=t("GameData"),c=function(){function t(){this.charArr=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]}return t.prototype.getCurTimestamp=function(){var t=new Date;return Date.parse(t.toString())},t.prototype.log=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];n.GConfig.hasLog&&console.log.apply(console,[t].concat(e))},t.prototype.error=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];console.error.apply(console,[t].concat(e))},t.prototype.warn=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];console.warn.apply(console,[t].concat(e))},t.prototype.random_int=function(t,e){var i=t+(e-t+1)*Math.random(),o=Math.floor(i);return o<t?o=t:o>e&&(o=e),o},t.prototype.isLaterDay=function(t){var e=!1,i=new Date(t),o=i.getFullYear(),n=i.getMonth(),s=i.getDate(),a=new Date,c=a.getFullYear(),r=a.getMonth(),l=a.getDate();return o!=c?o<c&&(e=!0):n!=r?n<r&&(e=!0):s<l&&(e=!0),e},t.prototype.stringToPoint=function(t,e){var i=cc.Vec2.ZERO;if(""!=t){var o=t.split(e);o.length>1&&(i=cc.v2(Number(o[0]),Number(o[1])))}return i},t.prototype.stringToSize=function(t,e){var i=cc.Size.ZERO;if(""!=t){var o=t.split(e);o.length>1&&(i=cc.size(Number(o[0]),Number(o[1])))}return i},t.prototype.stringToNumber=function(t,e){for(var i=[],o=t.split(e),n=0;n<o.length;n++){var s=o[n];""!=s&&i.push(Number(s))}return i},t.prototype.getPosDis=function(t,e){var i=e.x-t.x,o=e.y-t.y;return Math.sqrt(i*i+o*o)},t.prototype.setUrlFrame=function(t,e,i){void 0===i&&(i=null),void 0!=t&&null!=t&&""!=t&&cc.loader.load({url:t,type:"png"},function(t,o){if(t)this.error(t.message||t);else{var n=new cc.SpriteFrame(o);e.spriteFrame=n,i&&i()}}.bind(this))},t.prototype.loadResSprite=function(t,e,i){var o=this;void 0===i&&(i=null),cc.loader.loadRes(t,cc.SpriteFrame,function(t,n){t?o.error(t):(e&&(e.spriteFrame=n),i&&i(n))})},t.prototype.getConstructor=function(t){return t?"string"==typeof t?cc.js.getClassByName(t):t:null},t.prototype.createPrefab=function(t,e){var i=cc.instantiate(e);return i.parent=t,i},t.prototype.createPrefabCom=function(t,e,i){return this.createPrefab(t,e).getComponent(i)},t.prototype.timedat=function(t){var e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+"-"+e.getHours()},t.prototype.getWeek=function(t){var e="";return 0==t.getDay()&&(e="\u661f\u671f\u65e5"),1==t.getDay()&&(e="\u661f\u671f\u4e00"),2==t.getDay()&&(e="\u661f\u671f\u4e8c"),3==t.getDay()&&(e="\u661f\u671f\u4e09"),4==t.getDay()&&(e="\u661f\u671f\u56db"),5==t.getDay()&&(e="\u661f\u671f\u4e94"),6==t.getDay()&&(e="\u661f\u671f\u516d"),e},t.prototype.getLimitStr=function(t,e){return this.getStringCharacterLength(t)>e?this.subStrByCharacter(t,e)+"...":t},t.prototype.getStringCharacterLength=function(t){var e=0,i=-1;if(t)for(var o=0;o<t.length;o++)e+=(i=t.charCodeAt(o))>=0&&i<=128?1:2;return e},t.prototype.subStrByCharacter=function(t,e){for(var i=0,o=0,n=-1,s=0;s<t.length&&!((o+=(n=t.charCodeAt(s))>=0&&n<=128?1:2)>e);s++)i+=1;return t.substring(0,i)},t.prototype.version_compare=function(t,e){if(t===e)return 0;for(var i=t.split("."),o=e.split("."),n=Math.min(i.length,o.length),s=0;s<n;s++){if(parseInt(i[s])>parseInt(o[s]))return 1;if(parseInt(i[s])<parseInt(o[s]))return-1}return i.length>o.length?1:i.length<o.length?-1:0},t.prototype.numberDiffAbs=function(t,e){return Math.abs(t-e)},t.prototype.numberDiff=function(t,e){return t-e},t.prototype.isNumberDiffRange=function(t,e,i){return this.numberDiffAbs(t,e)<=i},t.prototype.isAbsNumDiffRange=function(t,e,i){var o=Math.abs(t),n=Math.abs(t);return Math.abs(o-n)<=i},t.prototype.isVec2DiffRange=function(t,e,i){var o=t.sub(e);return Math.abs(o.x)<=i&&Math.abs(o.y)<=i},t.prototype.getRandomUserId=function(){for(var t=this.charArr.length-1,e="",i=0;i<32;i++){var o=this.random_int(0,t);e+=this.charArr[o]}return e},t.prototype.numberToString=function(t){var e="",i="";if(t<1e3)e=t.toString();else{var o=0,n=0,s=0;t>=1e6?(o=Math.floor(t/1e6),n=Math.floor(t%1e6/1e5),s=Math.floor(t%1e5/1e4),i="m"):t>=1e3&&(o=Math.floor(t/1e3),n=Math.floor(t%1e3/100),s=Math.floor(t%100/10),i="k"),e=o>99?o.toString():o>9?o+"."+n:o+"."+n+s}return e+i},t.prototype.getRandomVec2=function(t,e){return cc.v2(this.random_int(t.x,t.y),this.random_int(e.x,e.y))},t.prototype.subScreen=function(t,e){var i=cc.Vec2.ZERO;switch(t){case 0:i=cc.v2(.5*s.GValue.Size_View.width,.5*s.GValue.Size_View.height);break;case 1:i=cc.v2(.5*s.GValue.Size_View.width,s.GValue.Size_View.height);break;case 2:i=cc.v2(.5*s.GValue.Size_View.width,0);break;case 3:i=cc.v2(0,.5*s.GValue.Size_View.height);break;case 4:i=cc.v2(s.GValue.Size_View.width,.5*s.GValue.Size_View.height)}return e.sub(i)},t.prototype.isInSreen=function(t,e){return void 0===e&&(e=0),cc.rect(e,e,s.GValue.Size_View.width-2*e,s.GValue.Size_View.height-2*e).contains(t)},t.prototype.getEnemyDropAble=function(){return s.GValue.EntityWorld.enemyDropNumber<s.GValue.EntityWorld.levelData.dropKCount},t.prototype.getRadiusByKnifeInCount=function(t){return void 0===t&&(t=0),a.TData.HeroRaduisIn},t.prototype.getRadiusByKnifeCount=function(t){var e=a.TData.HeroRaduis+35*(t-a.TData.WeaponCount)/7;return e<a.TData.HeroRaduis?a.TData.HeroRaduis:e},t.prototype.getRadioByCount=function(t){return(t<8?0:t>20?12:t-8)/12+1},t.prototype.getIntervalByCount=function(t){return t<50?10:500/t},t.prototype.cleanUp=function(t){t&&t.node&&(cc.game.isPersistRootNode(t.node)&&cc.game.removePersistRootNode(t.node),t.node.destroy())},t.prototype.arrContains=function(t,e){if(t)for(var i=0;i<t.length;i++)if(t[i]===e)return!0;return!1},t.prototype.arrRemove=function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return t.splice(i,1),!0;return!1},t.prototype.arrContain=function(t,e){return!(!t||!e)&&t.indexOf(e)>=0},t.prototype.addScript=function(t,e){if(t&&e){var i=t.getComponent(e);return i||(i=t.addComponent(e)),i}return null},t.prototype.removeChildByName=function(t,e){if(t){var i=t.getChildByName(e);i&&i.removeFromParent()}},t.prototype.isRectInterectLine=function(t,e,i){if(t.contains(e)||t.contains(i))return!0;var o=new cc.Vec2(t.x,t.y),n=new cc.Vec2(t.x,t.yMax),s=new cc.Vec2(t.xMax,t.yMax),a=new cc.Vec2(t.xMax,t.y);return!!this.isLineLine(e,i,o,s)||!!this.isLineLine(e,i,n,a)},t.prototype.isLineLine=function(t,e,i,o){var n=(o.x-i.x)*(t.y-i.y)-(o.y-i.y)*(t.x-i.x),s=(e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x),a=(o.y-i.y)*(e.x-t.x)-(o.x-i.x)*(e.y-t.y);if(0!==a){var c=n/a,r=s/a;if(0<=c&&c<=1&&0<=r&&r<=1)return!0}return!1},t.prototype.clamp=function(t,e,i){return Math.max(t,Math.min(e,i))},t.prototype.smoothDamp=function(t,e,i,o,n,s){var a=2/(o=Math.max(1e-4,o)),c=a*s,r=1/(1+c+.48*c*c+.235*c*c*c),l=t-e,h=e,d=n*o,u=(i+a*(l=this.clamp(l,-d,d)))*s;i=(i-a*u)*r;var m=(e=t-l)+(l+u)*r;return h-t>0==m>h&&(i=((m=h)-h)/s),[m,i]},t.prototype.isFloatEqual=function(t,e){return Math.abs(t-e)<.01},t.instance=new t,t}();o.DYTools=c.instance,cc._RF.pop()},{CommonConfig:"CommonConfig",CommonValue:"CommonValue",GameData:"GameData"}],Types:[function(t,e,i){"use strict";cc._RF.push(e,"0be014Q8BJOLYJkjSh9j3Ie","Types");var o=e.exports;Object.defineProperty(o,"__esModule",{value:!0}),o.EntityTag=cc.Enum({None:-1,Player:1,Enemy:2}),o.DWType=cc.Enum({Knife:1,Laser:2,Fire:3,Ice:4,Electricity:5}),o.KnifeState=cc.Enum({Drop:-1,Normal:-1,Capture:-1,CaptureFinish:-1,Attack:-1,Defence:-1,Release:-1,Init:-1}),o.ActionState=cc.Enum({Begin:-1,Ing:-1,End:-1}),o.AIMoveState=cc.Enum({Normal:-1,Moving:-1,Thinking:-1}),o.EnemyType=cc.Enum({Normal:1,Special:2,Connect:11,Knife:100,Snake:101,Circle:102,Fire:103}),o.EnemyAttr=cc.Enum({Normal:1,Sleep:2,Gold:3,RanDir:4,Thron:5,bulScreen:6,Doctor:7,Connect:8,Split:9,Vomit:10,Enter:11,Track:12,InitDir:13,SplitMin:10001}),o.EnemyAction=cc.Enum({None:-1,Action:0,Sleep:1,Awaking:2,Dead:3}),o.EnemyMoveType=cc.Enum({Follow:1,Elastic:2,SpeedUp:3}),o.EnemyBuff=cc.Enum({SlowDown:1,Frozen:2,Firing:3,Treat:4}),o.EnemyHurtState=cc.Enum({None:-1,Normal:0,Knife:1,Laser:2,Frozen:3,Fire:4,Ele:5}),o.EnemyAnim=cc.Enum({Idle:0,HurtNormal:1,HurtLaser:2,Die:3}),o.BossType=cc.Enum({Knife:1,Snake:2,Circle:3,Fire:4,Electr:5}),o.HeroState=cc.Enum({Normal:1,StrongIII:4,Dead:5}),o.DropType=cc.Enum({Weapon:1,Prop:2}),o.PropType=cc.Enum({Strong:1,Slow:2,Gold:3}),o.PoolType=cc.Enum({PLAYER:0,PLAYER_MAIN_FOLLOW:1,PLAYER_DW_FOLLOW:2,KNIFE:3,ENEMY:4,PROP:5,FOLLOW_ENEMY:6,EFFECT:7,DW_KNIFE:8,WALL:9,COUNT:15}),o.ShareType=cc.Enum({NONE:-2,HOME:0,WIN:1}),o.AdverType=cc.Enum({Revive:-1}),cc._RF.pop()},{}],aes:[function(t,e,i){"use strict";cc._RF.push(e,"113f4EatRFGB5803VZ8Lrwo","aes");var o=e.exports.CryptoJS=o||function(t,e){var i={},o=i.lib={},n=function(){},s=o.Base={extend:function(t){n.prototype=this;var e=new n;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},a=o.WordArray=s.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=void 0!=e?e:4*t.length},toString:function(t){return(t||r).stringify(this)},concat:function(t){var e=this.words,i=t.words,o=this.sigBytes;if(t=t.sigBytes,this.clamp(),o%4)for(var n=0;n<t;n++)e[o+n>>>2]|=(i[n>>>2]>>>24-n%4*8&255)<<24-(o+n)%4*8;else if(65535<i.length)for(n=0;n<t;n+=4)e[o+n>>>2]=i[n>>>2];else e.push.apply(e,i);return this.sigBytes+=t,this},clamp:function(){var e=this.words,i=this.sigBytes;e[i>>>2]&=4294967295<<32-i%4*8,e.length=t.ceil(i/4)},clone:function(){var t=s.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var i=[],o=0;o<e;o+=4)i.push(4294967296*t.random()|0);return new a.init(i,e)}}),c=i.enc={},r=c.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var i=[],o=0;o<t;o++){var n=e[o>>>2]>>>24-o%4*8&255;i.push((n>>>4).toString(16)),i.push((15&n).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,i=[],o=0;o<e;o+=2)i[o>>>3]|=parseInt(t.substr(o,2),16)<<24-o%8*4;return new a.init(i,e/2)}},l=c.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var i=[],o=0;o<t;o++)i.push(String.fromCharCode(e[o>>>2]>>>24-o%4*8&255));return i.join("")},parse:function(t){for(var e=t.length,i=[],o=0;o<e;o++)i[o>>>2]|=(255&t.charCodeAt(o))<<24-o%4*8;return new a.init(i,e)}},h=c.Utf8={stringify:function(t){try{return decodeURIComponent(escape(l.stringify(t)))}catch(t){throw Error("Malformed UTF-8 data==="+t)}},parse:function(t){return l.parse(unescape(encodeURIComponent(t)))}},d=o.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=h.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var i=this._data,o=i.words,n=i.sigBytes,s=this.blockSize,c=n/(4*s);if(e=(c=e?t.ceil(c):t.max((0|c)-this._minBufferSize,0))*s,n=t.min(4*e,n),e){for(var r=0;r<e;r+=s)this._doProcessBlock(o,r);r=o.splice(0,e),i.sigBytes-=n}return new a.init(r,n)},clone:function(){var t=s.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});o.Hasher=d.extend({cfg:s.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,i){return new t.init(i).finalize(e)}},_createHmacHelper:function(t){return function(e,i){return new u.HMAC.init(t,i).finalize(e)}}});var u=i.algo={};return i}(Math);(function(){var t=o,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,i=t.sigBytes,o=this._map;t.clamp(),t=[];for(var n=0;n<i;n+=3)for(var s=(e[n>>>2]>>>24-n%4*8&255)<<16|(e[n+1>>>2]>>>24-(n+1)%4*8&255)<<8|e[n+2>>>2]>>>24-(n+2)%4*8&255,a=0;4>a&&n+.75*a<i;a++)t.push(o.charAt(s>>>6*(3-a)&63));if(e=o.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var i=t.length,o=this._map;(n=o.charAt(64))&&-1!=(n=t.indexOf(n))&&(i=n);for(var n=[],s=0,a=0;a<i;a++)if(a%4){var c=o.indexOf(t.charAt(a-1))<<a%4*2,r=o.indexOf(t.charAt(a))>>>6-a%4*2;n[s>>>2]|=(c|r)<<24-s%4*8,s++}return e.create(n,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})(),function(t){function e(t,e,i,o,n,s,a){return((t=t+(e&i|~e&o)+n+a)<<s|t>>>32-s)+e}function i(t,e,i,o,n,s,a){return((t=t+(e&o|i&~o)+n+a)<<s|t>>>32-s)+e}function n(t,e,i,o,n,s,a){return((t=t+(e^i^o)+n+a)<<s|t>>>32-s)+e}function s(t,e,i,o,n,s,a){return((t=t+(i^(e|~o))+n+a)<<s|t>>>32-s)+e}for(var a=o,c=(l=a.lib).WordArray,r=l.Hasher,l=a.algo,h=[],d=0;64>d;d++)h[d]=4294967296*t.abs(t.sin(d+1))|0;l=l.MD5=r.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,o){for(var a=0;16>a;a++){var c=t[d=o+a];t[d]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}a=this._hash.words;var r,l,d=t[o+0],u=(c=t[o+1],t[o+2]),m=t[o+3],p=t[o+4],f=t[o+5],_=t[o+6],y=t[o+7],g=t[o+8],v=t[o+9],C=t[o+10],S=t[o+11],D=t[o+12],T=t[o+13],G=t[o+14],A=t[o+15],w=a[0],b=s(b=s(b=s(b=s(b=n(b=n(b=n(b=n(b=i(b=i(b=i(b=i(b=e(b=e(b=e(b=e(b=a[1],l=e(l=a[2],r=e(r=a[3],w=e(w,b,l,r,d,7,h[0]),b,l,c,12,h[1]),w,b,u,17,h[2]),r,w,m,22,h[3]),l=e(l,r=e(r,w=e(w,b,l,r,p,7,h[4]),b,l,f,12,h[5]),w,b,_,17,h[6]),r,w,y,22,h[7]),l=e(l,r=e(r,w=e(w,b,l,r,g,7,h[8]),b,l,v,12,h[9]),w,b,C,17,h[10]),r,w,S,22,h[11]),l=e(l,r=e(r,w=e(w,b,l,r,D,7,h[12]),b,l,T,12,h[13]),w,b,G,17,h[14]),r,w,A,22,h[15]),l=i(l,r=i(r,w=i(w,b,l,r,c,5,h[16]),b,l,_,9,h[17]),w,b,S,14,h[18]),r,w,d,20,h[19]),l=i(l,r=i(r,w=i(w,b,l,r,f,5,h[20]),b,l,C,9,h[21]),w,b,A,14,h[22]),r,w,p,20,h[23]),l=i(l,r=i(r,w=i(w,b,l,r,v,5,h[24]),b,l,G,9,h[25]),w,b,m,14,h[26]),r,w,g,20,h[27]),l=i(l,r=i(r,w=i(w,b,l,r,T,5,h[28]),b,l,u,9,h[29]),w,b,y,14,h[30]),r,w,D,20,h[31]),l=n(l,r=n(r,w=n(w,b,l,r,f,4,h[32]),b,l,g,11,h[33]),w,b,S,16,h[34]),r,w,G,23,h[35]),l=n(l,r=n(r,w=n(w,b,l,r,c,4,h[36]),b,l,p,11,h[37]),w,b,y,16,h[38]),r,w,C,23,h[39]),l=n(l,r=n(r,w=n(w,b,l,r,T,4,h[40]),b,l,d,11,h[41]),w,b,m,16,h[42]),r,w,_,23,h[43]),l=n(l,r=n(r,w=n(w,b,l,r,v,4,h[44]),b,l,D,11,h[45]),w,b,A,16,h[46]),r,w,u,23,h[47]),l=s(l,r=s(r,w=s(w,b,l,r,d,6,h[48]),b,l,y,10,h[49]),w,b,G,15,h[50]),r,w,f,21,h[51]),l=s(l,r=s(r,w=s(w,b,l,r,D,6,h[52]),b,l,m,10,h[53]),w,b,C,15,h[54]),r,w,c,21,h[55]),l=s(l,r=s(r,w=s(w,b,l,r,g,6,h[56]),b,l,A,10,h[57]),w,b,_,15,h[58]),r,w,T,21,h[59]),l=s(l,r=s(r,w=s(w,b,l,r,p,6,h[60]),b,l,S,10,h[61]),w,b,u,15,h[62]),r,w,v,21,h[63]);a[0]=a[0]+w|0,a[1]=a[1]+b|0,a[2]=a[2]+l|0,a[3]=a[3]+r|0},_doFinalize:function(){var e=this._data,i=e.words,o=8*this._nDataBytes,n=8*e.sigBytes;i[n>>>5]|=128<<24-n%32;var s=t.floor(o/4294967296);for(i[15+(n+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),i[14+(n+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),e.sigBytes=4*(i.length+1),this._process(),i=(e=this._hash).words,o=0;4>o;o++)n=i[o],i[o]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8);return e},clone:function(){var t=r.clone.call(this);return t._hash=this._hash.clone(),t}}),a.MD5=r._createHelper(l),a.HmacMD5=r._createHmacHelper(l)}(Math),function(){var t,e=o,i=(t=e.lib).Base,n=t.WordArray,s=(t=e.algo).EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var i=(c=this.cfg).hasher.create(),o=n.create(),s=o.words,a=c.keySize,c=c.iterations;s.length<a;){r&&i.update(r);var r=i.update(t).finalize(e);i.reset();for(var l=1;l<c;l++)r=i.finalize(r),i.reset();o.concat(r)}return o.sigBytes=4*a,o}});e.EvpKDF=function(t,e,i){return s.create(i).compute(t,e)}}(),o.lib.Cipher||function(t){var e=(p=o).lib,i=e.Base,n=e.WordArray,s=e.BufferedBlockAlgorithm,a=p.enc.Base64,c=p.algo.EvpKDF,r=e.Cipher=s.extend({cfg:i.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,i){this.cfg=this.cfg.extend(i),this._xformMode=t,this._key=e,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(e,i,o){return("string"==typeof i?f:m).encrypt(t,e,i,o)},decrypt:function(e,i,o){return("string"==typeof i?f:m).decrypt(t,e,i,o)}}}});e.StreamCipher=r.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var l=p.mode={},h=function(t,e,i){var o=this._iv;o?this._iv=void 0:o=this._prevBlock;for(var n=0;n<i;n++)t[e+n]^=o[n]},d=(e.BlockCipherMode=i.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}})).extend();d.Encryptor=d.extend({processBlock:function(t,e){var i=this._cipher,o=i.blockSize;h.call(this,t,e,o),i.encryptBlock(t,e),this._prevBlock=t.slice(e,e+o)}}),d.Decryptor=d.extend({processBlock:function(t,e){var i=this._cipher,o=i.blockSize,n=t.slice(e,e+o);i.decryptBlock(t,e),h.call(this,t,e,o),this._prevBlock=n}}),l=l.CBC=d,d=(p.pad={}).Pkcs7={pad:function(t,e){for(var i,o=(i=(i=4*e)-t.sigBytes%i)<<24|i<<16|i<<8|i,s=[],a=0;a<i;a+=4)s.push(o);i=n.create(s,i),t.concat(i)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},e.BlockCipher=r.extend({cfg:r.cfg.extend({mode:l,padding:d}),reset:function(){r.reset.call(this);var t=(e=this.cfg).iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var i=e.createEncryptor;else i=e.createDecryptor,this._minBufferSize=1;this._mode=i.call(e,this,t&&t.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var u=e.CipherParams=i.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),m=(l=(p.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return((t=t.salt)?n.create([1398893684,1701076831]).concat(t).concat(e):e).toString(a)},parse:function(t){var e=(t=a.parse(t)).words;if(1398893684==e[0]&&1701076831==e[1]){var i=n.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return u.create({ciphertext:t,salt:i})}},e.SerializableCipher=i.extend({cfg:i.extend({format:l}),encrypt:function(t,e,i,o){o=this.cfg.extend(o);var n=t.createEncryptor(i,o);return e=n.finalize(e),n=n.cfg,u.create({ciphertext:e,key:i,iv:n.iv,algorithm:t,mode:n.mode,padding:n.padding,blockSize:t.blockSize,formatter:o.format})},decrypt:function(t,e,i,o){return o=this.cfg.extend(o),e=this._parse(e,o.format),t.createDecryptor(i,o).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}})),p=(p.kdf={}).OpenSSL={execute:function(t,e,i,o){return o||(o=n.random(8)),t=c.create({keySize:e+i}).compute(t,o),i=n.create(t.words.slice(e),4*i),t.sigBytes=4*e,u.create({key:t,iv:i,salt:o})}},f=e.PasswordBasedCipher=m.extend({cfg:m.cfg.extend({kdf:p}),encrypt:function(t,e,i,o){return i=(o=this.cfg.extend(o)).kdf.execute(i,t.keySize,t.ivSize),o.iv=i.iv,(t=m.encrypt.call(this,t,e,i.key,o)).mixIn(i),t},decrypt:function(t,e,i,o){return o=this.cfg.extend(o),e=this._parse(e,o.format),i=o.kdf.execute(i,t.keySize,t.ivSize,e.salt),o.iv=i.iv,m.decrypt.call(this,t,e,i.key,o)}})}(),function(){for(var t=o,e=t.lib.BlockCipher,i=t.algo,n=[],s=[],a=[],c=[],r=[],l=[],h=[],d=[],u=[],m=[],p=[],f=0;256>f;f++)p[f]=128>f?f<<1:f<<1^283;var _=0,y=0;for(f=0;256>f;f++){var g=(g=y^y<<1^y<<2^y<<3^y<<4)>>>8^255&g^99;n[_]=g,s[g]=_;var v=p[_],C=p[v],S=p[C],D=257*p[g]^16843008*g;a[_]=D<<24|D>>>8,c[_]=D<<16|D>>>16,r[_]=D<<8|D>>>24,l[_]=D,D=16843009*S^65537*C^257*v^16843008*_,h[g]=D<<24|D>>>8,d[g]=D<<16|D>>>16,u[g]=D<<8|D>>>24,m[g]=D,_?(_=v^p[p[p[S^v]]],y^=p[p[y]]):_=y=1}var T=[0,1,2,4,8,16,32,64,128,27,54];i=i.AES=e.extend({_doReset:function(){for(var t=(i=this._key).words,e=i.sigBytes/4,i=4*((this._nRounds=e+6)+1),o=this._keySchedule=[],s=0;s<i;s++)if(s<e)o[s]=t[s];else{var a=o[s-1];s%e?6<e&&4==s%e&&(a=n[a>>>24]<<24|n[a>>>16&255]<<16|n[a>>>8&255]<<8|n[255&a]):(a=n[(a=a<<8|a>>>24)>>>24]<<24|n[a>>>16&255]<<16|n[a>>>8&255]<<8|n[255&a],a^=T[s/e|0]<<24),o[s]=o[s-e]^a}for(t=this._invKeySchedule=[],e=0;e<i;e++)s=i-e,a=e%4?o[s]:o[s-4],t[e]=4>e||4>=s?a:h[n[a>>>24]]^d[n[a>>>16&255]]^u[n[a>>>8&255]]^m[n[255&a]]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,a,c,r,l,n)},decryptBlock:function(t,e){var i=t[e+1];t[e+1]=t[e+3],t[e+3]=i,this._doCryptBlock(t,e,this._invKeySchedule,h,d,u,m,s),i=t[e+1],t[e+1]=t[e+3],t[e+3]=i},_doCryptBlock:function(t,e,i,o,n,s,a,c){for(var r=this._nRounds,l=t[e]^i[0],h=t[e+1]^i[1],d=t[e+2]^i[2],u=t[e+3]^i[3],m=4,p=1;p<r;p++){var f=o[l>>>24]^n[h>>>16&255]^s[d>>>8&255]^a[255&u]^i[m++],_=o[h>>>24]^n[d>>>16&255]^s[u>>>8&255]^a[255&l]^i[m++],y=o[d>>>24]^n[u>>>16&255]^s[l>>>8&255]^a[255&h]^i[m++];u=o[u>>>24]^n[l>>>16&255]^s[h>>>8&255]^a[255&d]^i[m++],l=f,h=_,d=y}f=(c[l>>>24]<<24|c[h>>>16&255]<<16|c[d>>>8&255]<<8|c[255&u])^i[m++],_=(c[h>>>24]<<24|c[d>>>16&255]<<16|c[u>>>8&255]<<8|c[255&l])^i[m++],y=(c[d>>>24]<<24|c[u>>>16&255]<<16|c[l>>>8&255]<<8|c[255&h])^i[m++],u=(c[u>>>24]<<24|c[l>>>16&255]<<16|c[h>>>8&255]<<8|c[255&d])^i[m++],t[e]=f,t[e+1]=_,t[e+2]=y,t[e+3]=u},keySize:8}),t.AES=e._createHelper(i)}(),cc._RF.pop()},{}],ddsdk_ui:[function(t,e,i){"use strict";cc._RF.push(e,"63d3bQDsj1BGbaYcrYpDO6C","ddsdk_ui");var o=t("CommonValue"),n=t("GameData"),s=t("CommonFunc"),a=t("ADShareManager"),c=t("CommonEnum");cc.Class({extends:cc.Component,properties:{city:"",tryShow:!1,bkShow:!1,adShow:!1,favShow:!1},onLoad:function(){if(!window._loadDDSDK){this.sdk=window.DDSDK,window._loadDDSDK=!0,this.sdk.init(this.sdkLoaded.bind(this)),console.log("lingjing init"),DDSDK.isWx()&&window.wx.showShareMenu({withShareTicket:!1,success:function(t){console.log("showShareMenu success")},fail:function(t){console.log(t),console.log("showShareMenu fail"+t)},complete:function(t){console.log("showShareMenu complete-------")}}),DDSDK.OnShareAppMessage(function(){var t=a.ADShareMgr.getAdShareData(c.Enum_ADShare.AS_Menu),e=a.ADShareMgr.getShareData(t.id),i="shareID="+t.id+"&imageId="+e.id+"&otherId="+n.TData.userId;return{title:e.title,imageUrl:e.imageUrl,query:i}});var t=cc.find("Canvas/share");t&&t.on(cc.Node.EventType.TOUCH_END,this.onTapBtn,this),cc.game.addPersistRootNode(this.node)}},onTapBtn:function(t){DDSDK.ShareAppMessage({title:"\u8f6c\u53d1\u6807\u9898",imageUrl:"https://picconfig.chiji-h5.com/h5_pic/square_img_20190116164520.jpg"})},onShare:function(t,e,i){DDSDK.ShareAppMessage({title:t,imageUrl:e,query:i})},testLogEvent:function(){this.sdk.logEvent("start",{}),this.sdk.logEvent("register",{}),this.sdk.logEvent("startorder",{}),this.sdk.logEvent("completeorder",{})},adjustUI:function(){console.log("lingjing adjustUI");var t=this.node.getChildByName("favlist"),e=this.node.getChildByName("trydlg");s.GFunc.adjustScreen(t),s.GFunc.adjustScreen(e)},showSDKUI:function(){console.warn("lingjing showsdk");var t=this.sdk.getRender();if(t){var e=this.node.getChildByName("favlist"),i=(this.node.getChildByName("bkgame"),this.node.getChildByName("list1"),this.node.getChildByName("list2"),this.node.getChildByName("trybtn")),o=this.node.getChildByName("trydlg"),n=this.node.getChildByName("aniad"),s=this.node.getChildByName("hbtn1"),a=this.node.getChildByName("hbtn2"),c=t.getAniAD();c&&n.addChild(c.getNode());var r=t.getTryBtn();r&&i.addChild(r.getNode());var l=t.getTryDlg();if(l.setCloseCB(function(){console.log("trydlg close...")}),l){var h=l.getDlg();o.addChild(h)}var d=t.getFavAD(4,1);d&&e.addChild(d.getNode());var u,m=t.getHotGames();if(m){u=m.getBtns(),console.log("Btns length:",u.length),u.length>0&&(s&&s.addChild(u[0].getNode()),u[1]&&a&&a.addChild(u[1].getNode()));var p=m.getDlg();o.addChild(p)}}},sdkLoaded:function(){console.warn("----------------lingjing sdk onLoaded--------------");var t=n.TData.getUserID();console.error("abc = "+t),this.sdk.setAccount(t),this.sdk.setRewardCB(function(t,e){switch(console.log("give reward:",t,"type:",e),e){case 1:n.TData.setGold(Math.floor(n.TData.getGold()+t),!0,!0);break;case 2:n.TData.setPower(Math.floor(n.TData.getPower()+t),!0,!0)}});var e=this;DDSDK.getIPInfo(function(t){0==t.error_code&&(e.city=t.result.city,console.warn("lingjing city = ",e.city),["\u5e7f\u4e1c","\u6df1\u5733"].indexOf(e.city)<0&&e.showSDKUI())})},showFavGame:function(t){this.favShow=t;var e=this.node.getChildByName("favlist");o.GValue.favGame?e&&(e.active=t):e.active=!1},showMain:function(t){this.tryShow=t,this.bkShow=t,this.adShow=t;var e=this.node.getChildByName("trybtn"),i=this.node.getChildByName("aniad"),n=this.node.getChildByName("hbtn1"),s=this.node.getChildByName("hbtn2");o.GValue.tryGamme?e&&(e.active=t):e.active=!1,o.GValue.adImage?i&&(i.active=t):i.active=!1,o.GValue.moreGame?n&&(n.active=t):n.active=!1,o.GValue.moreGame?s&&(s.active=t):s.active=!1},refreshSDKShow:function(){console.warn("lingjing refreshsdk"),this.showMain(this.bkShow),this.showFavGame(this.favShow)}}),cc._RF.pop()},{ADShareManager:"ADShareManager",CommonEnum:"CommonEnum",CommonFunc:"CommonFunc",CommonValue:"CommonValue",GameData:"GameData"}],"pad-zeropadding":[function(t,e,i){"use strict";cc._RF.push(e,"06896l8ao9JqKzAu1GwxMzd","pad-zeropadding"),t("aes").CryptoJS.pad.ZeroPadding={pad:function(t,e){var i=4*e;t.clamp(),t.sigBytes+=i-(t.sigBytes%i||i)},unpad:function(t){for(var e=t.words,i=t.sigBytes-1;!(e[i>>>2]>>>24-i%4*8&255);)i--;t.sigBytes=i+1}},cc._RF.pop()},{aes:"aes"}]},{},["ADShareManager","AndroidManager","BossKnivesComponent","BossKnivesCtrl","BossKnivesDropCtrl","CBaseCollisionHandleSystem","CEnemyEffect","CEntityBase","CEntityBoss","CEntityBossCircle","CEntityBossElectr","CEntityBossFire","CEntityFollowPlayer","CEntityKnife","CEntityPlayer","CEntitySnake","CEntityWall","CEntityWorld","CGameRuleSystem","CHMove","CHMoveFix","CHRotate","CHeroCollisionHandleSystem","CHeroCollisionWallListener","CHeroKnifeCollisionWallListener","CKnifeColliderListener","CKnifeColliderNodeCtrl","CKnifeCollisionHandleSystem","CKnifeCountComponent","CKnifeFixByWallCtrl","CKnifeInit","CKnifeMoveCtrl","CKnifeOwnerComponent","CKnifeParentCtrl","CKnifeSkinCtrl","CKnifeStateComponent","CLogicPlayer","CLoginEnemy","CMoveByTouch","CMoveWithOwnerNode","CNodeCollider","CPickKnifeCollisionHandleSystem","CPlayerKnivesComponent","CPoolMgr","CollisionEventManager","CommonAudio","CommonConfig","CommonEnum","CommonFunc","CommonSdk","CommonUI","CommonValue","ConfigData","DWK","DeputyWeaponCollisionHandleSys","EnemyActionMoveComponent","EnemyAnimComponent","EnemyAttrBaseCom","EnemyAttrComponent","EnemyAttrDoctorCom","EnemyAttrEnterCom","EnemyAttrSplitCom","EnemyAttrThronCom","EnemyAttrTrackCom","EnemyAttrVomitCom","EnemyBase","EnemyBaseComponent","EnemyBuffComponent","EnemyCollisionBlockListener","EnemyCollisionWallListener","EnemyDropComponent","EnemyMoveBaseComponent","EnemyMoveFix","EnemySpeedUpMoveComponent","EnemyStateComponent","EnemyUIComponent","EntityAddSys","EntityBlock","EntityDWBase","EntityDWKnife","EntityEnemy","EntityFollowEnemy","EntityPlayerDeputyFollow","EntityProp","GameData","GameUI","GuideUI","Hawkeye","HomeUI","ItemProperty","KnifeDropCollisionWallListener","KnifeRivalEffect","KnifeThrowCtrl","LaserComponent","Launcherr","LoadingData","MapManager","NetBase","NetDown","NetUp","PanelAddProgram","PanelBase","PanelCheat copy","PanelCheat","PanelGold","PanelLevelGuide","PanelLoad","PanelLoading","PanelModal","PanelNew","PanelOffline","PanelOver","PanelPower","PanelRevive","PanelSetting","PfFrameAnim","PfNum","PfTip","PlayerAnimComponent","PlayerCollisionEnemyComponent","PlayerDWElectricityComponent","PlayerDWFireComponent","PlayerDWIceComponent","PlayerDWKnifeComponent","PlayerDWLaserComponent","PlayerDWNormalBase","PlayerDeputyWeaponBase","PlayerPickupComponent","PlayerStateComponent","PropCollisionWallListener","PropManager","PropMoveFix","PropertyUI","ShadowOwnerComponent","StageUI","Test","Tools","Types","aes","ddsdk_ui","pad-zeropadding"]);